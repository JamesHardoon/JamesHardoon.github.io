(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d6ac37e","chunk-2d0de953","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953"],{"202d":function(e,t,a){"use strict";a("465a")},"2dab":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-date-picker",{attrs:{disabled:e.disabled||e.readOnly,placeholder:e.placeholder,value:e.momVal,showTime:e.showTime,format:e.dateFormat,getCalendarContainer:e.getCalendarContainer},on:{change:e.handleDateChange}})},i=[],o=a("caaf"),n=a.n(o),s={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(e){return e.parentNode}}},data:function(){var e=this.value;return{decorator:"",momVal:e?n()(e,this.dateFormat):null}},watch:{value:function(e){this.momVal=e?n()(e,this.dateFormat):null}},methods:{moment:n.a,handleDateChange:function(e,t){this.$emit("change",t)}},model:{prop:"value",event:"change"}},c=s,l=a("cba8"),d=Object(l["a"])(c,r,i,!1,null,null,null);t["default"]=d.exports},"35b0":function(e,t,a){"use strict";a("70dc")},"392e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,visible:e.visible,"confirm-loading":e.confirmLoading,width:"50%"},on:{ok:e.handleOk,cancel:e.handleCancel}},[[a("div",[e._v("\n         名称: \n      "),a("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"名称"},model:{value:e.queryName,callback:function(t){e.queryName=t},expression:"queryName"}}),e._v("   \n      "),a("a-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.handle_query(1,null)}}},[e._v("查询")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,customRow:e.rowClick,pagination:!1,scroll:{y:240}},scopedSlots:e._u([{key:"action",fn:function(t){return a("a",{attrs:{href:"javascript:;"}},[a("a-checkbox",{on:{change:e.onChange},model:{value:t.isChecked,callback:function(a){e.$set(t,"isChecked",a)},expression:"text.isChecked"}},[e._v("\n          选择\n        ")])],1)}}])}),a("div",{staticClass:"pageAtion"},[a("a-pagination",{attrs:{size:"small",total:e.total,"page-size":e.pageSize,"show-size-changer":"","show-quick-jumper":""},on:{change:e.changePage,showSizeChange:e.changePageSize}})],1)]],2)},i=[],o=a("0fea"),n={name:"addSelect",props:{visble:null,title:null,typeKinds:null,checkProjectId:null,checkSupplerId:null},watch:{visble:function(e){this.visible=e,e&&this.getList()},queryName:function(e){this.queryName=e.replace(/(^\s*)|(\s*$)/g,"")},typeKinds:function(e){},checkProjectId:function(e){},checkSupplerId:function(e){}},data:function(){return{myCheckedItem:{},queryName:"",total:null,pageNo:1,pageSize:10,data:[],columns:[{title:"名称",dataIndex:"name",with:"auto"},{width:150,title:"选择",dataIndex:"",key:"x",scopedSlots:{customRender:"action"}}],ModalText:"Content of the modal",visible:!1,confirmLoading:!1}},methods:{onChange:function(e){},rowClick:function(e,t){var a=this;return{on:{click:function(){a.data.forEach((function(e,t){e.isChecked=!1,a.$set(a.data,t,e)})),e.isChecked=!e.isChecked,a.$set(a.data,t,e),e.isChecked&&(a.myCheckedItem=e)}}}},handle_query:function(e,t){var a=this,r={pageNo:e};r.pageSize=t||this.pageSize,r.name=this.queryName;var i="project"===this.typeKinds?"/basicdata/baseProject/getBaseProject?supplierId=".concat(this.checkSupplerId):"/basicdata/baseSupplier/getBaseSupplier?projectId=".concat(this.checkProjectId);Object(o["c"])(i,r).then((function(e){e.success&&e.result&&(a.data=e.result.records,a.total=e.result.total)}))},changePage:function(e,t){this.pageNo=e,this.pageSize=t,this.handle_query(e,t)},changePageSize:function(e,t){this.pageNo=e,this.pageSize=t,this.data=[],this.total=0,this.handle_query(e,t)},getList:function(){var e=this;this.myCheckedItem={},this.queryName="";var t="project"===this.typeKinds?"/basicdata/baseProject/getBaseProject?supplierId=".concat(this.checkSupplerId):"/basicdata/baseSupplier/getBaseSupplier?projectId=".concat(this.checkProjectId);this.pageSize=10,this.pageNo=1;var a={pageNo:this.pageNo,pageSize:this.pageSize};Object(o["c"])(t,a).then((function(t){t.success&&t.result&&(e.data=t.result.records,e.total=t.result.total)}))},close:function(){},showModal:function(){this.visible=!0},handleOk:function(e){if(!this.myCheckedItem.id)return this.$message.error("请选择！"),!1;this.$emit("closeVisible",!1),"project"===this.typeKinds?this.$emit("clicktableRow",this.myCheckedItem):this.$emit("clicktableRowSupper",this.myCheckedItem)},handleCancel:function(e){this.$emit("closeVisible",!1)}}},s=n,c=(a("202d"),a("cba8")),l=Object(c["a"])(s,r,i,!1,null,"0555d77b",null);t["default"]=l.exports},"465a":function(e,t,a){},"70dc":function(e,t,a){},"85ee":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,i="[object Arguments]",o="[object Function]",n="[object GeneratorFunction]",s="[object Symbol]",c="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,d=c||l||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,i=Array(r);while(++a<r)i[a]=t(e[a],a,e);return i}function p(e,t){var a=-1,r=t.length,i=e.length;while(++a<r)e[i+a]=t[a];return e}var h=Object.prototype,f=h.hasOwnProperty,g=h.toString,b=d.Symbol,v=h.propertyIsEnumerable,y=b?b.isConcatSpreadable:void 0,k=Math.max;function x(e,t,a,r,i){var o=-1,n=e.length;a||(a=w),i||(i=[]);while(++o<n){var s=e[o];t>0&&a(s)?t>1?x(s,t-1,a,r,i):p(i,s):r||(i[i.length]=s)}return i}function N(e,t){return e=Object(e),j(e,t,(function(t,a){return a in e}))}function j(e,t,a){var r=-1,i=t.length,o={};while(++r<i){var n=t[r],s=e[n];a(s,n)&&(o[n]=s)}return o}function S(e,t){return t=k(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,i=k(a.length-t,0),o=Array(i);while(++r<i)o[r]=a[t+r];r=-1;var n=Array(t+1);while(++r<t)n[r]=a[r];return n[t]=o,u(e,this,n)}}function w(e){return I(e)||A(e)||!!(y&&e&&e[y])}function C(e){if("string"==typeof e||D(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function A(e){return P(e)&&f.call(e,"callee")&&(!v.call(e,"callee")||g.call(e)==i)}var I=Array.isArray;function T(e){return null!=e&&$(e.length)&&!R(e)}function P(e){return F(e)&&T(e)}function R(e){var t=q(e)?g.call(e):"";return t==o||t==n}function $(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function q(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function F(e){return!!e&&"object"==typeof e}function D(e){return"symbol"==typeof e||F(e)&&g.call(e)==s}var L=S((function(e,t){return null==e?{}:N(e,m(x(t,1),C))}));e.exports=L}).call(this,a("2409"))},f681:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("j-modal",{staticClass:"addGHt",attrs:{title:e.title,width:"900px",visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",okText:"提交",cancelText:"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[[a("a-form-model",{ref:"ruleForm",attrs:{model:e.formAd,layout:e.vertical,rules:e.rules}},[a("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[a("div",{staticStyle:{display:"flex"}},[a("a-form-model-item",{ref:"contractNo",attrs:{label:"合同编号",prop:"contractNo"}},[a("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[a("a-input",{model:{value:e.formAd.contractNo,callback:function(t){e.$set(e.formAd,"contractNo",t)},expression:"formAd.contractNo"}})],1)]),a("a-form-model-item",{staticStyle:{width:"360px"},attrs:{label:"合同有限期",prop:"date1"}},[a("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:["开始时间","结束时间"]},on:{change:e.onChange,ok:e.onOk},model:{value:e.formAd.date1,callback:function(t){e.$set(e.formAd,"date1",t)},expression:"formAd.date1"}})],1)],1)]),a("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[a("div",{staticStyle:{display:"flex"}},[a("a-form-model-item",{staticStyle:{width:"360px","margin-right":"80px"},attrs:{label:"服务费点数",required:"",prop:"serviceChargePoints"}},[a("a-input-search",{attrs:{max:100,placeholder:""},model:{value:e.formAd.serviceChargePoints,callback:function(t){e.$set(e.formAd,"serviceChargePoints",t)},expression:"formAd.serviceChargePoints"}},[a("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("\n                %\n              ")])],1)],1),a("a-form-model-item",{ref:"projectName",attrs:{label:"项目",prop:"projectName"}},[a("div",{staticStyle:{width:"360px","margin-right":"50px",display:"flex","align-items":"center"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formAd.projectName,callback:function(t){e.$set(e.formAd,"projectName",t)},expression:"formAd.projectName"}}),e.contractType?e._e():a("a-icon",{staticStyle:{"margin-left":"8px",float:"right"},attrs:{type:"plus"},on:{click:function(t){return e.addProject("project")}}})],1)])],1)]),a("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[a("div",{staticStyle:{display:"flex"}},[a("a-form-model-item",{ref:"taxRegistrationNumber",attrs:{label:"税务登记号",prop:"taxRegistrationNumber"}},[a("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formAd.taxRegistrationNumber,callback:function(t){e.$set(e.formAd,"taxRegistrationNumber",t)},expression:"formAd.taxRegistrationNumber"}})],1)]),a("a-form-model-item",{attrs:{label:"签订供应商",prop:"supplierName"}},[a("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formAd.supplierName,callback:function(t){e.$set(e.formAd,"supplierName",t)},expression:"formAd.supplierName"}}),e.contractType?e._e():a("a-icon",{staticStyle:{"margin-left":"8px"},attrs:{type:"plus"},on:{click:function(t){return e.addProject("supplier")}}})],1)])],1)]),a("a-form-model-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:""}},[a("a-form-model-item",{attrs:{label:"合同附件"}},[a("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,multiple:!0,accept:".pdf,.jpg,.doc,docx",customRequest:e.downloadFilesCustomRequest,"file-list":e.fileList,remove:e.removeFile},on:{change:e.handleChange}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 上传文件 ")],1),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("支持扩展名：pdf、jpg、doc、docx、文件大小不超过5M")])],1)],1)],1),a("a-form-model-item",{staticStyle:{"margin-bottom":"-10px"},attrs:{label:""}},[a("a-form-model-item",{attrs:{label:"备注"}},[a("a-input",{staticStyle:{width:"800px",height:"90px"},attrs:{maxLength:200,placeholder:"此处为备注说明， 限制200字以内",type:"textarea"},model:{value:e.formAd.remarks,callback:function(t){e.$set(e.formAd,"remarks",t)},expression:"formAd.remarks"}})],1)],1)],1)],a("addSelectModal",{attrs:{title:e.myaddTitle,checkProjectId:e.checkProjectId,checkSupplerId:e.checkSupplerId,typeKinds:e.typeKinds,visble:e.isShow},on:{clicktableRowSupper:e.clicktableRowSupper,clicktableRow:e.clicktableRow,closeVisible:e.closeVisible}})],2)},i=[],o=a("caaf"),n=a.n(o),s=(a("10ef"),a("0fea")),c=(a("85ee"),a("ca00"),a("2dab")),l=a("392e");function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u={name:"ContractModal",components:{JDate:c["default"],addSelectModal:l["default"]},data:function(){var e;return e={vertical:"vertical",checkProjectId:"",checkSupplerId:"",moment:n.a,startTime:"",endTime:"",dateFormat:"YYYY-MM-DD HH:mm:ss",recordDetail:{},contractType:!1,SupperItem:{},projectItem:{},ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",uploadList:[],fileList:[],typeKinds:"",isShow:!1,myaddTitle:"",headers:{authorization:"authorization-text"},myTime:"",form:this.$form.createForm(this),title:"新增",width:800,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{},url:{add:"/contract/contract/add",edit:"/contract/contract/edit"}},d(e,"labelCol",{span:4}),d(e,"wrapperCol",{span:14}),d(e,"other",""),d(e,"formAd",{projectName:"",taxRegistrationNumber:void 0,contractNo:"",supplierName:void 0,serviceChargePoints:"",date1:[],remarks:""}),d(e,"rules",{projectName:[{required:!0,message:"请选择项目",trigger:"blur"}],taxRegistrationNumber:[{required:!0,message:"税务登记号不能为空 ，请到供应商维护",trigger:"blur"}],contractNo:[{required:!0,message:"请输入合同编号",trigger:"blur"}],supplierName:[{required:!0,message:"请选择签订供应商",trigger:"blur"}],serviceChargePoints:[{required:!0,message:"请输入服务费点数",trigger:"change"},{type:"number",message:"仅支持输入0-100之间的支持输入小数点后两位",trigger:"blur",transform:function(e){if(e){var t=Number(e);return!(t>100)&&(!!/^(\d|[1-9]\d|100)(\.\d{1,2})?$/.test(t)&&t)}}}],date1:[{required:!0,message:"请选择合同有效期",trigger:"change"}],remarks:[{required:!0,message:"Please input activity form",trigger:"blur"}]}),e},created:function(){},methods:{removeFile:function(e,t){var a=this.fileList,r=this.uploadList;a.forEach((function(t,i){t===e&&(a.splice(i,1),r.splice(i,1))})),this.fileList=a,this.uploadList=r},downloadFilesCustomRequest:function(e){},beforeUpload:function(e,t){var a=this,r=e.size/1024/1024<5;if(!r)return this.$message.error("图片大小超出限制，请修改后重新上传"),!1;var i="/sys/common/upload",o=new FormData;o.append("biz","contract"),o.append("file",e),Object(s["l"])(i,o).then((function(e){if(e.success){a.uploadList.push({enclosurePath:e.message,enclosureName:e.result});var t=a.fileList.length;a.fileList.push({uid:t+1,name:e.result,status:"done",url:a.ImagesUrl+e.message})}})).finally((function(){}))},clicktableRowSupper:function(e){this.formAd.supplierName=e.name,this.formAd.taxRegistrationNumber=e.taxRegistrationNumber,this.SupperItem=e,this.supplierId=e.id,this.checkSupplerId=e.id},clicktableRow:function(e){this.formAd.projectName=e.name,this.formAd.taxRegistrationNumber=e.taxRegistrationNumber,this.projectItem=e,this.projectId=e.id,this.checkProjectId=e.id},closeVisible:function(e){this.isShow=e},addProject:function(e){this.isShow=!0,this.myaddTitle="project"===e?"添加项目":"添加供应商",this.typeKinds=e},handleChange:function(e){e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))},onChange:function(e,t){},onOk:function(e){},onSubmit:function(){this.$refs.ruleForm.validate((function(e){if(!e)return!1}))},resetForm:function(){this.$refs.ruleForm.resetFields()},add:function(){this.visible=!0,this.recordDetail={}},edit:function(e){e.contractType&&(this.contractType=!0),this.form.resetFields(),this.model=Object.assign({},e),this.recordDetail=e;var t={projectName:e.projectName,taxRegistrationNumber:e.taxRegistrationNumber,contractNo:e.contractNo,supplierName:e.supplierName,date1:[this.moment(e.startTime,this.dateFormat),n()(e.endTime,this.dateFormat)],serviceChargePoints:"",remarks:""};this.formAd=t,this.startTime=e.startTime,this.endTime=e.endTime,this.visible=!0},close:function(){this.checkProjectId="",this.checkSupplerId="",this.$emit("close"),this.visible=!1},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1;r=r<10?"0"+r:r;var i=t.getDate();i=i<10?"0"+i:i;var o=t.getHours();o=o<10?"0"+o:o;var n=t.getMinutes(),s=t.getSeconds();return n=n<10?"0"+n:n,s=s<10?"0"+s:s,a+"-"+r+"-"+i+" "+o+":"+n+":"+s},handleOk:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var a={projectId:e.projectItem.id?e.projectItem.id:e.recordDetail.projectId,supplierId:e.SupperItem.id?e.SupperItem.id:e.recordDetail.supplierId,taxRegistrationNumber:e.SupperItem.taxRegistrationNumber?e.SupperItem.taxRegistrationNumber:e.recordDetail.taxRegistrationNumber,serviceChargePoints:e.formAd.serviceChargePoints,contractNo:e.formAd.contractNo,fileList:e.uploadList,remarks:e.formAd.remarks,startTime:e.formatDateTime(e.formAd.date1[0]._d),endTime:e.formatDateTime(e.formAd.date1[1]._d),contractType:1};e.recordDetail.contractType&&(a.contractType=e.recordDetail.contractType,a.contractNo=e.recordDetail.contractNo),Object(s["i"])("/contract/add",a).then((function(t){t.success?(e.$refs.ruleForm.resetFields(),e.visible=!1,e.projectItem={},e.recordDetail={},e.formAd.projectName="",e.formAd.taxRegistrationNumber="",e.formAd.contractNo="",e.formAd.supplierName="",e.formAd.projectName="",e.formAd.serviceChargePoints="",e.formAd.remarks="",e.uploadList=[],e.fileList=[],e.startTime="",e.endTime="",e.$message.success(t.message),e.$emit("ok")):e.$message.warning(t.message)})).finally((function(){}))}))},handleCancel:function(){this.close(),this.projectItem={},this.recordDetail={},this.formAd.projectName="",this.formAd.taxRegistrationNumber="",this.formAd.contractNo="",this.formAd.supplierName="",this.formAd.projectName="",this.formAd.serviceChargePoints="",this.formAd.date1="",this.formAd.remarks="",this.uploadList=[],this.fileList=[],this.startTime="",this.endTime="",this.$refs.ruleForm.resetFields()}}},m=u,p=(a("35b0"),a("cba8")),h=Object(p["a"])(m,r,i,!1,null,"f5cb80a8",null);t["default"]=h.exports}}]);