(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f3e1b9c"],{"0799":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{bordered:!1}},[n("input",{staticStyle:{display:"none"},attrs:{type:"file",accept:".jpg,.png,.svg",id:"insert_files"},on:{change:function(t){return e.fileInsert(t)}}}),n("div",{staticClass:"add-receipt"},[e._v("添加回款单")]),[n("div",{staticClass:"clearfix"},[n("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,multiple:!0,"list-type":"picture-card","file-list":e.fileList,remove:e.removeFile,accept:".jpg,.png,.svg",customRequest:e.downloadFilesCustomRequest},on:{preview:e.handlePreview}},[e.fileList.length<5?n("div",[n("a-icon",{attrs:{type:"plus"}}),n("div",{staticClass:"ant-upload-text"},[e._v("\n            上传\n          ")])],1):e._e()])],1)],n("div",{staticClass:"btn",staticStyle:{"margin-bottom":"10px"}},[n("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:e.Uploadloading},on:{click:e.clickStart}},[e._v("\n      开始识别\n    ")]),n("span",[e._v("支持jpg.png格式，最多支持上传5张图片， 图片限制在2M")])],1),n("div",{staticClass:"add-receipt add-tableRow"},[n("span",[e._v("识别结果")]),n("a",{on:{click:e.addRow}},[e._v("添加行")])]),n("a-table",{ref:"table",staticClass:"j-table-force-nowrap",attrs:{size:"middle",bordered:"",pagination:!1,columns:e.columns,scroll:{x:1500,y:400},dataSource:e.dataSource,loading:e.loading},scopedSlots:e._u([{key:"action",fn:function(t,r,i){return[r.editable?e._e():n("a",{on:{click:function(t){return e.edittable(r,i)}}},[e._v("修改")]),r.editable?n("a",{on:{click:function(t){return e.subitable(r,i)}}},[e._v("确认")]):e._e(),n("a",{staticClass:"operation",staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.delRows(r,i)}}},[e._v("删除")])]}},{key:"returnTime",fn:function(t,r){return[r.editable?n("a-date-picker",{attrs:{"default-value":e.moment(r.returnTime,e.dateFormat)},on:{change:e.changeTimes}}):[e._v("\n        "+e._s(t)+"\n      ")]]}},{key:"returnMoney",fn:function(t,r){return[r.editable?n("a-input",{staticStyle:{margin:"-5px 0",width:"150px"},attrs:{type:"number"},on:{change:function(t){return e.handleChangeTable(r)}},model:{value:r.returnMoney,callback:function(t){e.$set(r,"returnMoney",t)},expression:"record.returnMoney"}}):[e._v("\n        "+e._s(t)+"\n      ")]]}},{key:"returnMechanism",fn:function(t,r){return[r.editable?n("a-input",{staticStyle:{margin:"-5px 0",width:"150px"},on:{change:function(t){return e.handleChangeTable(r)}},model:{value:r.returnMechanism,callback:function(t){e.$set(r,"returnMechanism",t)},expression:"record.returnMechanism"}}):[n("span",{attrs:{title:r.returnMechanism}},[e._v(" "+e._s(t))])]]}},{key:"returnBank",fn:function(t,r){return[r.editable?n("a-input",{staticStyle:{margin:"-5px 0",width:"150px"},on:{change:function(t){return e.handleChangeTable(r)}},model:{value:r.returnBank,callback:function(t){e.$set(r,"returnBank",t)},expression:"record.returnBank"}}):[e._v("\n        "+e._s(t)+"\n      ")]]}},{key:"returnNo",fn:function(t,r){return[r.editable?n("a-input",{staticStyle:{margin:"-5px 0",width:"100px"},on:{change:function(t){return e.handleChangeTable(r)}},model:{value:r.returnNo,callback:function(t){e.$set(r,"returnNo",t)},expression:"record.returnNo"}}):[n("span",{attrs:{title:t}},[e._v(" "+e._s(t))])]]}},{key:"enclosureName",fn:function(t,r,i){return[r.editable&&!t?n("a-button",{staticStyle:{margin:"-5px 0",width:"150px"},on:{click:function(t){return e.clickUploadRowFile(r,i)}}},[e._v("上传附件")]):[n("a",{staticClass:"uploadFiles",attrs:{title:t},on:{click:function(t){return t.stopPropagation(),e.previewFiles(r)}}},[e._v(" "+e._s(t))])]]}}])}),n("a-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitRegister}},[e._v("\n    提交\n  ")]),n("imagePreviews",{ref:"imagePre"})],2)},i=[],a=n("4c58"),o=n.n(a),s=n("caaf"),c=n.n(s),u=(n("6eb7"),n("0fea")),l=n("1e5e");function f(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){f(a,r,i,o,s,"next",e)}function s(e){f(a,r,i,o,s,"throw",e)}o(void 0)}))}}function h(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))}var p={name:"ServiceReturnList",components:{imagePreviews:l["default"]},data:function(){return{isFlag:!1,fileName:[],submitLoading:!1,clickRecord:{},Uploadloading:!1,ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",clickItem:{},moment:c.a,dateFormat:"YYYY-MM-DD",dataSource:[],loading:!1,columns:[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(e,t,n){return parseInt(n)+1}},{title:"回款方",align:"center",dataIndex:"returnMechanism",ellipsis:!0,scopedSlots:{customRender:"returnMechanism"}},{title:"金额（元）",align:"center",dataIndex:"returnMoney",scopedSlots:{customRender:"returnMoney"}},{title:"回款日期",align:"center",dataIndex:"returnTime",scopedSlots:{customRender:"returnTime"}},{title:"回款银行",align:"center",ellipsis:!0,dataIndex:"returnBank",scopedSlots:{customRender:"returnBank"}},{title:"附件",align:"center",dataIndex:"enclosureName",scopedSlots:{customRender:"enclosureName"}},{title:"回款单号",align:"center",dataIndex:"returnNo",scopedSlots:{customRender:"returnNo"}},{title:"操作",dataIndex:"action",align:"center",width:147,scopedSlots:{customRender:"action"}}],previewImage:"",uploadList:[],fileList:[]}},computed:{},methods:{clickUploadRowFile:function(e,t){document.getElementById("insert_files").click()},fileInsert:function(e){var t=this,n=e.target.files[0],r=n.size/1024/1024<2;if(!r)return this.$message.error("图片大小超出限制，请修改后重新上传"),!1;var i=new FormData;i.append("file",n),i.append("biz","receipt"),Object(u["l"])("/sys/common/upload",i).then((function(e){e.success&&(t.clickRecord.enclosureName=e.result,t.clickRecord.enclosurePath=e.message,t.clickRecord.editable=!0,t.$set(t.dataSource,0,t.clickRecord),document.getElementById("insert_files").value="")})).catch((function(e){}))},delRows:function(e,t){var n=this;this.$confirm({title:"提示",content:"您确定删除么？",onOk:function(){n.dataSource.splice(t,1),n.isFlag=!1},onCancel:function(){}})},submitRegister:function(){var e=this;if(this.isFlag)return this.$message.error("请完成上个编辑状态！"),!1;if(!this.dataSource.length)return this.$message.error("请添加回款单"),!1;this.submitLoading=!0;var t={serviceReturns:this.dataSource};Object(u["i"])("/receipt/serviceReturnRegister/add",t).then((function(t){t.success&&(e.$message.success("提交成功！"),e.$router.go(-1))})).finally((function(){e.submitLoading=!1}))},changeTimes:function(e){this.clickRecord.returnTime=this.formatDateTime(e._d)},previewFiles:function(e){this.previewImage=this.ImagesUrl+e.enclosurePath,this.$refs.imagePre.isOpen(this.previewImage)},clickStart:function(){var e=this;if(this.isFlag)return this.$message.error("请完成上个编辑状态！"),!1;if(!this.uploadList.length)return this.$message.error("请添加回款单"),!1;this.Uploadloading=!0;var t={file:this.uploadList.toString(),fileName:this.fileName.toString()};Object(u["j"])("/receipt/serviceReturnRegister/read",t).then((function(t){t.success?(e.dataSource=e.dataSource.concat(t.result),e.isFlag=!1,e.dataSource.length&&e.dataSource.forEach((function(e,t){e.editable=!1})),e.Uploadloading=!1):(e.Uploadloading=!1,e.$message.error(t.message))})).finally((function(){}))},removeFile:function(e,t){var n=this.fileList,r=this.uploadList;n.forEach((function(t,i){t===e&&(n.splice(i,1),r.splice(i,1))})),this.fileList=n},downloadFilesCustomRequest:function(e){},beforeUpload:function(e,t){var n=this,r=e.size/1024/1024<2;if(!r)return this.$message.error("图片大小超出限制，请修改后重新上传"),!1;var i="/sys/common/upload",a=new FormData;a.append("biz","receipt"),a.append("file",e),Object(u["l"])(i,a).then((function(e){if(e.success){n.uploadList.push(e.message),n.fileName.push(e.result);var t=n.fileList.length;n.fileList.push({uid:t+1,name:e.result,status:"done",url:n.ImagesUrl+e.message})}})).finally((function(){}))},handleChangeUpload:function(e){e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))},onClickRow:function(e){var t=this;return{on:{click:function(){var n=[];n.push(e.id),t.selectedRowKeys=n}}}},changeTime:function(e){},addRow:function(){if(this.isFlag)return this.$message.error("请完成上个编辑状态！"),!1;this.isFlag=!0,this.dataSource.unshift({editable:!0,returnTime:this.getCurrDate()})},subitable:function(e,t){e.returnMechanism?e.returnMoney?null!==e.returnTime?e.enclosureName?(this.clickRecord.editable=!1,this.$set(this.dataSource,t,this.clickRecord),this.isFlag=!1):this.$message.error("请添加附件"):this.$message.error("请添加回款日期"):this.$message.error("请添加金额"):this.$message.error("请添加回款方")},edittable:function(e,t){if(this.isFlag)return this.$message.error("请完成上个编辑状态！"),!1;this.isFlag=!0;var n=e;n.editable=!n.editable,this.clickRecord=e,this.$set(this.dataSource,t,n)},handleChangeTable:function(e){this.clickRecord=e},handlePreview:function(){var e=d(o.a.mark((function e(t){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,h(t.originFileObj);case 3:t.preview=e.sent;case 4:this.previewImage=t.url||t.preview,this.$refs.imagePre.isOpen(this.previewImage);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleChange:function(e){var t=e.fileList;this.fileList=t},formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),r=t.getMonth()+1;r=r<10?"0"+r:r;var i=t.getDate();i=i<10?"0"+i:i;var a=t.getHours();a=a<10?"0"+a:a;var o=t.getMinutes(),s=t.getSeconds();return o=o<10?"0"+o:o,s=s<10?"0"+s:s,n+"-"+r+"-"+i},getCurrDate:function(){var e=new Date,t="-",n=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();r<=9&&(r="0"+r),i<=9&&(i="0"+i);var a=n+t+r+t+i;return a}}},m=p,g=(n("4880"),n("cba8")),v=Object(g["a"])(m,r,i,!1,null,"2e56f721",null);t["default"]=v.exports},"1e5e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{visible:e.previewVisible,footer:null,width:"40%"},on:{cancel:e.handleCancel}},[n("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])},i=[],a={name:"addSelect",props:{},watch:{},data:function(){return{previewVisible:!1,previewImage:""}},mounted:function(){},methods:{handleCancel:function(){this.previewVisible=!1},isOpen:function(e){this.previewVisible=!0,this.previewImage=e}}},o=a,s=n("cba8"),c=Object(s["a"])(o,r,i,!1,null,"6a8ddd32",null);t["default"]=c.exports},4880:function(e,t,n){"use strict";n("dfad")},"4c58":function(e,t,n){e.exports=n("e186")},"6eb7":function(e,t,n){},dfad:function(e,t,n){},e186:function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(j){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),o=new $(r||[]);return a._invoke=S(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(j){return{type:"throw",arg:j}}}e.wrap=u;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",m={};function g(){}function v(){}function y(){}var w={};c(w,a,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(E([])));x&&x!==n&&r.call(x,a)&&(w=x);var k=y.prototype=g.prototype=Object.create(w);function _(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(i,a,o,s){var c=l(e[i],e,a);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(f).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;function a(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}this._invoke=a}function S(e,t,n){var r=f;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return C()}n.method=i,n.arg=a;while(1){var o=n.delegate;if(o){var s=R(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}function R(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,R(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function E(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){while(++i<e.length)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:C}}function C(){return{value:t,done:!0}}return v.prototype=y,c(k,"constructor",y),c(y,"constructor",v),v.displayName=c(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},_(L.prototype),c(L.prototype,o,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new L(u(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:E(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=r}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}}]);