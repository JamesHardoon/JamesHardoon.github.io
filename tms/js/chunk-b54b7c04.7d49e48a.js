(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b54b7c04","chunk-2d0de953","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953"],{"098a":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager");function t(){n.add("contextmenu",(function(){}))}t()})()},"27a7":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager");function t(){n.add("colorpicker",(function(){}))}t()})()},"27e2":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.util.VK"),e=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},r=function(n){return function(t){return e(t)===n}},o=function(n){return function(t){return typeof t===n}},i=function(n){return function(t){return n===t}},u=r("string"),a=r("array"),c=i(null),s=o("boolean"),l=o("function"),f=function(n){var t=n.getParam("link_assume_external_targets",!1);return s(t)&&t?1:!u(t)||"http"!==t&&"https"!==t?0:t},d=function(n){return n.getParam("link_context_toolbar",!1,"boolean")},m=function(n){return n.getParam("link_list")},g=function(n){return n.getParam("default_link_target")},p=function(n){return n.getParam("target_list",!0)},h=function(n){return n.getParam("rel_list",[],"array")},v=function(n){return n.getParam("link_class_list",[],"array")},b=function(n){return n.getParam("link_title",!0,"boolean")},y=function(n){return n.getParam("allow_unsafe_link_target",!1,"boolean")},w=function(n){return n.getParam("link_quicklink",!1,"boolean")},x=function(n){return n.getParam("link_default_protocol","http","string")},S=function(){},C=function(n){return function(){return n}},k=C(!1),O=C(!0),T=function(){return D},D=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:k,isSome:k,isNone:O,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:C(null),getOrUndefined:C(void 0),or:e,orThunk:t,map:T,each:S,bind:T,exists:k,forall:O,filter:T,equals:n,equals_:n,toArray:function(){return[]},toString:C("none()")};return r}(),E=function(n){var t=C(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:O,isNone:k,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return E(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:D},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(k,(function(t){return e(n,t)}))}};return o},_=function(n){return null===n||void 0===n?D:E(n)},A={some:E,none:T,from:_},R=Array.prototype.indexOf,B=Array.prototype.push,M=function(n,t){return R.call(n,t)},I=function(n,t){return M(n,t)>-1},N=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},F=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},P=function(n,t,e){return F(n,(function(n){e=t(e,n)})),e},L=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!a(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);B.apply(t,n[e])}return t},z=function(n,t){return L(N(n,t))},j=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return A.none()},H=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},V=function(n,t){return n?A.some(t):A.none()},U=tinymce.util.Tools.resolve("tinymce.util.Tools"),W=function(n){return u(n.value)?n.value:""},G=function(n){return u(n.text)?n.text:u(n.title)?n.title:""},q=function(n,t){var e=[];return U.each(n,(function(n){var r=G(n);if(void 0!==n.menu){var o=q(n.menu,t);e.push({text:r,items:o})}else{var i=t(n);e.push({text:r,value:i})}})),e},$=function(n){return void 0===n&&(n=W),function(t){return A.from(t).map((function(t){return q(t,n)}))}},X=function(n){return $(W)(n)},K=function(n,t){return function(e){return{name:n,type:"listbox",label:t,items:e}}},Y={sanitize:X,sanitizeWith:$,createUi:K,getValue:W},J=function(){return J=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},J.apply(this,arguments)},Q=Object.keys,Z=Object.hasOwnProperty,nn=function(n,t){for(var e=Q(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},tn=function(n){return function(t,e){n[e]=t}},en=function(n,t,e,r){var o={};return nn(n,(function(n,o){(t(n,o)?e:r)(n,o)})),o},rn=function(n,t){var e={};return en(n,t,tn(e),S),e},on=function(n,t){return Z.call(n,t)},un=function(n,t){return on(n,t)&&void 0!==n[t]&&null!==n[t]},an=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),cn=function(n){return n&&"a"===n.nodeName.toLowerCase()},sn=function(n){return cn(n)&&!!dn(n)},ln=function(n,t){if(n.collapsed)return[];var e=n.cloneContents(),r=new an(e.firstChild,e),o=[],i=e.firstChild;do{t(i)&&o.push(i)}while(i=r.next());return o},fn=function(n){return/^\w+:/i.test(n)},dn=function(n){var t=n.getAttribute("data-mce-href");return t||n.getAttribute("href")},mn=function(n,t){var e=["noopener"],r=n?n.split(/\s+/):[],o=function(n){return U.trim(n.sort().join(" "))},i=function(n){return n=u(n),n.length>0?n.concat(e):e},u=function(n){return n.filter((function(n){return-1===U.inArray(e,n)}))},a=t?i(r):u(r);return a.length>0?o(a):""},gn=function(n){return n.replace(/\uFEFF/g,"")},pn=function(n,t){return t=t||n.selection.getNode(),wn(t)?n.dom.select("a[href]",t)[0]:n.dom.getParent(t,"a[href]")},hn=function(n,t){var e=t?t.innerText||t.textContent:n.getContent({format:"text"});return gn(e)},vn=function(n){return U.grep(n,sn).length>0},bn=function(n){return ln(n,sn).length>0},yn=function(n){var t=n.schema.getTextInlineElements(),e=function(n){return 1===n.nodeType&&!cn(n)&&!on(t,n.nodeName.toLowerCase())},r=ln(n.selection.getRng(),e);return 0===r.length},wn=function(n){return n&&"FIGURE"===n.nodeName&&/\bimage\b/i.test(n.className)},xn=function(n){return P(["title","rel","class","target"],(function(t,e){return n[e].each((function(n){t[e]=n.length>0?n:null})),t}),{href:n.href})},Sn=function(n,t){return"http"!==t&&"https"!==t||fn(n)?n:t+"://"+n},Cn=function(n,t){var e=J({},t);if(!(h(n).length>0)&&!1===y(n)){var r=mn(e.rel,"_blank"===e.target);e.rel=r||null}return A.from(e.target).isNone()&&!1===p(n)&&(e.target=g(n)),e.href=Sn(e.href,f(n)),e},kn=function(n,t,e,r){e.each((function(n){t.hasOwnProperty("innerText")?t.innerText=n:t.textContent=n})),n.dom.setAttribs(t,r),n.selection.select(t)},On=function(n,t,e,r){wn(t)?Mn(n,t,r):e.fold((function(){n.execCommand("mceInsertLink",!1,r)}),(function(t){n.insertContent(n.dom.createHTML("a",r,n.dom.encode(t)))}))},Tn=function(n,t,e){var r=n.selection.getNode(),o=pn(n,r),i=Cn(n,xn(e));n.undoManager.transact((function(){e.href===t.href&&t.attach(),o?(n.focus(),kn(n,o,e.text,i)):On(n,r,e.text,i)}))},Dn=function(n){var t=n.dom,e=n.selection,r=e.getBookmark(),o=e.getRng().cloneRange(),i=t.getParent(o.startContainer,"a[href]",n.getBody()),u=t.getParent(o.endContainer,"a[href]",n.getBody());i&&o.setStartBefore(i),u&&o.setEndAfter(u),e.setRng(o),n.execCommand("unlink"),e.moveToBookmark(r)},En=function(n){n.undoManager.transact((function(){var t=n.selection.getNode();wn(t)?Bn(n,t):Dn(n),n.focus()}))},_n=function(n){var t=n.class,e=n.href,r=n.rel,o=n.target,i=n.text,u=n.title;return rn({class:t.getOrNull(),href:e,rel:r.getOrNull(),target:o.getOrNull(),text:i.getOrNull(),title:u.getOrNull()},(function(n,t){return!1===c(n)}))},An=function(n,t,e){n.hasPlugin("rtc",!0)?n.execCommand("createlink",!1,_n(e)):Tn(n,t,e)},Rn=function(n){n.hasPlugin("rtc",!0)?n.execCommand("unlink"):En(n)},Bn=function(n,t){var e=n.dom.select("img",t)[0];if(e){var r=n.dom.getParents(e,"a[href]",t)[0];r&&(r.parentNode.insertBefore(e,r),n.dom.remove(r))}},Mn=function(n,t,e){var r=n.dom.select("img",t)[0];if(r){var o=n.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}},In=function(n){return un(n,"items")},Nn=function(n,t){return j(t,(function(t){return In(t)?Nn(n,t.items):V(t.value===n,t)}))},Fn=function(n,t,e,r){var o=r[t],i=n.length>0;return void 0!==o?Nn(o,e).map((function(t){return{url:{value:t.value,meta:{text:i?n:t.text,attach:S}},text:i?n:t.text}})):A.none()},Pn=function(n,t){return"link"===t?n.link:"anchor"===t?n.anchor:A.none()},Ln=function(n,t){var e={text:n.text,title:n.title},r=function(n){return V(e.title.length<=0,A.from(n.meta.title).getOr(""))},o=function(n){return V(e.text.length<=0,A.from(n.meta.text).getOr(n.value))},i=function(n){var t=o(n.url),e=r(n.url);return t.isSome()||e.isSome()?A.some(J(J({},t.map((function(n){return{text:n}})).getOr({})),e.map((function(n){return{title:n}})).getOr({}))):A.none()},u=function(n,r){var o=Pn(t,r.name).getOr([]);return Fn(e.text,r.name,o,n)},a=function(n,t){var r=t.name;return"url"===r?i(n()):I(["anchor","link"],r)?u(n(),t):"text"===r||"title"===r?(e[r]=n()[r],A.none()):A.none()};return{onChange:a}},zn={init:Ln,getDelta:Fn},jn=tinymce.util.Tools.resolve("tinymce.util.Delay"),Hn=tinymce.util.Tools.resolve("tinymce.util.Promise"),Vn=function(n,t,e){var r=n.selection.getRng();jn.setEditorTimeout(n,(function(){n.windowManager.confirm(t,(function(t){n.selection.setRng(r),e(t)}))}))},Un=function(n){var t=n.href,e=t.indexOf("@")>0&&-1===t.indexOf("/")&&-1===t.indexOf("mailto:");return e?A.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(n){return J(J({},n),{href:"mailto:"+t})}}):A.none()},Wn=function(n,t){return function(e){var r=e.href,o=1===n&&!fn(r)||0===n&&/^\s*www(\.|\d\.)/i.test(r);return o?A.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+t+":// prefix?",preprocess:function(n){return J(J({},n),{href:t+"://"+r})}}):A.none()}},Gn=function(n,t){return j([Un,Wn(f(n),x(n))],(function(n){return n(t)})).fold((function(){return Hn.resolve(t)}),(function(e){return new Hn((function(r){Vn(n,e.message,(function(n){r(n?e.preprocess(t):t)}))}))}))},qn={preprocess:Gn},$n=function(n){var t=n.dom.select("a:not([href])"),e=z(t,(function(n){var t=n.name||n.id;return t?[{text:t,value:"#"+t}]:[]}));return e.length>0?A.some([{text:"None",value:""}].concat(e)):A.none()},Xn={getAnchors:$n},Kn=function(n){var t=v(n);return t.length>0?Y.sanitize(t):A.none()},Yn={getClasses:Kn},Jn=tinymce.util.Tools.resolve("tinymce.util.XHR"),Qn=function(n){try{return A.some(JSON.parse(n))}catch(t){return A.none()}},Zn=function(n){var t=function(t){return n.convertURL(t.value||t.url,"href")},e=m(n);return new Hn((function(n){u(e)?Jn.send({url:e,success:function(t){return n(Qn(t))},error:function(t){return n(A.none())}}):l(e)?e((function(t){return n(A.some(t))})):n(A.from(e))})).then((function(n){return n.bind(Y.sanitizeWith(t)).map((function(n){if(n.length>0){var t=[{text:"None",value:""}];return t.concat(n)}return n}))}))},nt={getLinks:Zn},tt=function(n,t){var e=h(n);if(e.length>0){var r=t.is("_blank"),o=!1===y(n),i=function(n){return mn(Y.getValue(n),r)},u=o?Y.sanitizeWith(i):Y.sanitize;return u(e)}return A.none()},et={getRels:tt},rt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],ot=function(n){var t=p(n);return a(t)?Y.sanitize(t).orThunk((function(){return A.some(rt)})):!1===t?A.none():A.some(rt)},it={getTargets:ot},ut=function(n,t,e){var r=n.getAttrib(t,e);return null!==r&&r.length>0?A.some(r):A.none()},at=function(n,t){var e=n.dom,r=yn(n),o=r?A.some(hn(n.selection,t)):A.none(),i=t?A.some(e.getAttrib(t,"href")):A.none(),u=t?A.from(e.getAttrib(t,"target")):A.none(),a=ut(e,t,"rel"),c=ut(e,t,"class"),s=ut(e,t,"title");return{url:i,text:o,title:s,target:u,rel:a,linkClass:c}},ct=function(n,t){return nt.getLinks(n).then((function(e){var r=at(n,t);return{anchor:r,catalogs:{targets:it.getTargets(n),rels:et.getRels(n,r.target),classes:Yn.getClasses(n),anchor:Xn.getAnchors(n),link:e},optNode:A.from(t),flags:{titleEnabled:b(n)}}}))},st={collect:ct},lt=function(n,t){return function(e){var r=e.getData();if(!r.url.value)return Rn(n),void e.close();var o=function(n){return A.from(r[n]).filter((function(e){return!t.anchor[n].is(e)}))},i={href:r.url.value,text:o("text"),target:o("target"),rel:o("rel"),class:o("linkClass"),title:o("title")},u={href:r.url.value,attach:void 0!==r.url.meta&&r.url.meta.attach?r.url.meta.attach:S};qn.preprocess(n,i).then((function(t){An(n,u,t)})),e.close()}},ft=function(n){var t=pn(n);return st.collect(n,t)},dt=function(n,t){var e=n.anchor,r=e.url.getOr("");return{url:{value:r,meta:{original:{value:r}}},text:e.text.getOr(""),title:e.title.getOr(""),anchor:r,link:r,rel:e.rel.getOr(""),target:e.target.or(t).getOr(""),linkClass:e.linkClass.getOr("")}},mt=function(n,t,e){var r=[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],o=n.anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),i=n.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],u=A.from(g(e)),a=dt(n,u),c=n.catalogs,s=zn.init(a,c),l={type:"panel",items:L([r,o,i,H([c.anchor.map(Y.createUi("anchor","Anchors")),c.rels.map(Y.createUi("rel","Rel")),c.targets.map(Y.createUi("target","Open link in...")),c.link.map(Y.createUi("link","Link list")),c.classes.map(Y.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onChange:function(n,t){var e=t.name;s.onChange(n.getData,{name:e}).each((function(t){n.setData(t)}))},onSubmit:t}},gt=function(n){var t=ft(n);t.then((function(t){var e=lt(n,t);return mt(t,e,n)})).then((function(t){n.windowManager.open(t)}))},pt=function(n,t){document.body.appendChild(n),n.dispatchEvent(t),document.body.removeChild(n)},ht=function(n){var t=document.createElement("a");t.target="_blank",t.href=n,t.rel="noreferrer noopener";var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),pt(t,e)},vt=function(n,t){return n.dom.getParent(t,"a[href]")},bt=function(n){return vt(n,n.selection.getStart())},yt=function(n){return!0===n.altKey&&!1===n.shiftKey&&!1===n.ctrlKey&&!1===n.metaKey},wt=function(n,t){if(t){var e=dn(t);if(/^#/.test(e)){var r=n.$(e);r.length&&n.selection.scrollIntoView(r[0],!0)}else ht(t.href)}},xt=function(n){return function(){gt(n)}},St=function(n){return function(){wt(n,bt(n))}},Ct=function(n){n.on("click",(function(e){var r=vt(n,e.target);r&&t.metaKeyPressed(e)&&(e.preventDefault(),wt(n,r))})),n.on("keydown",(function(t){var e=bt(n);e&&13===t.keyCode&&yt(t)&&(t.preventDefault(),wt(n,e))}))},kt=function(n,t){return n.on("NodeChange",t),function(){return n.off("NodeChange",t)}},Ot=function(n){return function(t){return kt(n,(function(){t.setActive(!n.mode.isReadOnly()&&null!==pn(n,n.selection.getNode()))}))}},Tt=function(n){return function(t){var e=function(){return t.setDisabled(null===pn(n,n.selection.getNode()))};return e(),kt(n,e)}},Dt=function(n){return function(t){var e=function(t){return vn(t)||bn(n.selection.getRng())},r=n.dom.getParents(n.selection.getStart());return t.setDisabled(!e(r)),kt(n,(function(n){return t.setDisabled(!e(n.parents))}))}},Et=function(n){n.addCommand("mceLink",(function(){w(n)?n.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):xt(n)()}))},_t=function(n){n.addShortcut("Meta+K","",(function(){n.execCommand("mceLink")}))},At=function(n){n.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:xt(n),onSetup:Ot(n)}),n.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:St(n),onSetup:Tt(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return Rn(n)},onSetup:Dt(n)})},Rt=function(n){n.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:St(n),onSetup:Tt(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:xt(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return Rn(n)},onSetup:Dt(n)})},Bt=function(n){var t="link unlink openlink",e="link";n.ui.registry.addContextMenu("link",{update:function(r){return vn(n.dom.getParents(r,"a"))?t:e}})},Mt=function(n){var t=function(n){n.selection.collapse(!1)},e=function(t){var e=n.selection.getNode();return t.setDisabled(!pn(n,e)),S};n.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Ot(n)},label:"Link",predicate:function(t){return!!pn(n,t)&&d(n)},initValue:function(){var t=pn(n);return t?dn(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var e=n.selection.getNode();return t.setActive(!!pn(n,e)),Ot(n)(t)},onAction:function(e){var r=pn(n),o=e.getValue();if(r)n.undoManager.transact((function(){n.dom.setAttrib(r,"href",o),t(n),e.hide()}));else{var i={href:o,attach:S},u=yn(n),a=u?A.some(hn(n.selection,r)).filter((function(n){return n.length>0})).or(A.from(o)):A.none();An(n,i,{href:o,text:a,title:A.none(),rel:A.none(),target:A.none(),class:A.none()}),e.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:e,onAction:function(t){Rn(n),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:e,onAction:function(t){St(n)(),t.hide()}}]})};function It(){n.add("link",(function(n){At(n),Rt(n),Bt(n),Mt(n),Ct(n),Et(n),_t(n)}))}It()})()},"2a84":function(n,t,e){e("27e2")},"2dab":function(n,t,e){"use strict";e.r(t);var r=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("a-date-picker",{attrs:{disabled:n.disabled||n.readOnly,placeholder:n.placeholder,value:n.momVal,showTime:n.showTime,format:n.dateFormat,getCalendarContainer:n.getCalendarContainer},on:{change:n.handleDateChange}})},o=[],i=e("caaf"),u=e.n(i),a={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(n){return n.parentNode}}},data:function(){var n=this.value;return{decorator:"",momVal:n?u()(n,this.dateFormat):null}},watch:{value:function(n){this.momVal=n?u()(n,this.dateFormat):null}},methods:{moment:u.a,handleDateChange:function(n,t){this.$emit("change",t)}},model:{prop:"value",event:"change"}},c=a,s=e("cba8"),l=Object(s["a"])(c,r,o,!1,null,null,null);t["default"]=l.exports},"2f2c":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(){return t=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},t.apply(this,arguments)},e=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},r=function(n){return function(t){return e(t)===n}},o=r("string"),i=r("object"),u=r("array"),a=function(n){return null===n||void 0===n},c=function(n){return!a(n)},s=function(){},l=function(n){return function(){return n}},f=l(!1),d=l(!0),m=function(){return g},g=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:f,isSome:f,isNone:d,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:l(null),getOrUndefined:l(void 0),or:e,orThunk:t,map:m,each:s,bind:m,exists:f,forall:d,filter:m,equals:n,equals_:n,toArray:function(){return[]},toString:l("none()")};return r}(),p=function(n){var t=l(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:d,isNone:f,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return p(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:g},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(f,(function(t){return e(n,t)}))}};return o},h=function(n){return null===n||void 0===n?g:p(n)},v={some:p,none:m,from:h},b=Array.prototype.push,y=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},w=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!u(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);b.apply(t,n[e])}return t},x=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},S=Object.keys,C=Object.hasOwnProperty,k=function(n,t){for(var e=S(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},O=function(n,t){return T(n,t)?v.from(n[t]):v.none()},T=function(n,t){return C.call(n,t)},D=function(n){return n.getParam("media_scripts")},E=function(n){return n.getParam("audio_template_callback")},_=function(n){return n.getParam("video_template_callback")},A=function(n){return n.getParam("media_live_embeds",!0)},R=function(n){return n.getParam("media_filter_html",!0)},B=function(n){return n.getParam("media_url_resolver")},M=function(n){return n.getParam("media_alt_source",!0)},I=function(n){return n.getParam("media_poster",!0)},N=function(n){return n.getParam("media_dimensions",!0)},F=tinymce.util.Tools.resolve("tinymce.util.Tools"),P=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),L=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),z=function(n,t){if(n)for(var e=0;e<n.length;e++)if(-1!==t.indexOf(n[e].filter))return n[e]},j=P.DOM,H=function(n){return n.replace(/px$/,"")},V=function(n){var t=n.map.style,e=t?j.parseStyle(t):{};return{type:"ephox-embed-iri",source:n.map["data-ephox-embed-iri"],altsource:"",poster:"",width:O(e,"max-width").map(H).getOr(""),height:O(e,"max-height").map(H).getOr("")}},U=function(n,t){var e=x(!1),r={};return L({validate:!1,allow_conditional_comments:!0,start:function(t,o){if(e.get());else if(T(o.map,"data-ephox-embed-iri"))e.set(!0),r=V(o);else{if(r.source||"param"!==t||(r.source=o.map.movie),"iframe"!==t&&"object"!==t&&"embed"!==t&&"video"!==t&&"audio"!==t||(r.type||(r.type=t),r=F.extend(o.map,r)),"script"===t){var i=z(n,o.map.src);if(!i)return;r={type:"script",source:o.map.src,width:String(i.width),height:String(i.height)}}"source"===t&&(r.source?r.altsource||(r.altsource=o.map.src):r.source=o.map.src),"img"!==t||r.poster||(r.poster=o.map.src)}}}).parse(t),r.source=r.source||r.src||r.data,r.altsource=r.altsource||"",r.poster=r.poster||"",r},W=function(n){var t={mp3:"audio/mpeg",m4a:"audio/x-m4a",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},e=n.toLowerCase().split(".").pop(),r=t[e];return r||""},G=tinymce.util.Tools.resolve("tinymce.html.Schema"),q=tinymce.util.Tools.resolve("tinymce.html.Writer"),$=P.DOM,X=function(n){return/^[0-9.]+$/.test(n)?n+"px":n},K=function(n,t){k(t,(function(t,e){var r=""+t;if(n.map[e]){var o=n.length;while(o--){var i=n[o];i.name===e&&(r?(n.map[e]=r,i.value=r):(delete n.map[e],n.splice(o,1)))}}else r&&(n.push({name:e,value:r}),n.map[e]=r)}))},Y=function(n,t){var e=t.map.style,r=e?$.parseStyle(e):{};r["max-width"]=X(n.width),r["max-height"]=X(n.height),K(t,{style:$.serializeStyle(r)})},J=["source","altsource"],Q=function(n,t,e){var r,o=q(),i=x(!1),u=0;return L({validate:!1,allow_conditional_comments:!0,comment:function(n){o.comment(n)},cdata:function(n){o.cdata(n)},text:function(n,t){o.text(n,t)},start:function(n,a,c){if(i.get());else if(T(a.map,"data-ephox-embed-iri"))i.set(!0),Y(t,a);else{switch(n){case"video":case"object":case"embed":case"img":case"iframe":void 0!==t.height&&void 0!==t.width&&K(a,{width:t.width,height:t.height});break}if(e)switch(n){case"video":K(a,{poster:t.poster,src:""}),t.altsource&&K(a,{src:""});break;case"iframe":K(a,{src:t.source});break;case"source":if(u<2&&(K(a,{src:t[J[u]],type:t[J[u]+"mime"]}),!t[J[u]]))return;u++;break;case"img":if(!t.poster)return;r=!0;break}}o.start(n,a,c)},end:function(n){if(!i.get()){if("video"===n&&e)for(var a=0;a<2;a++)if(t[J[a]]){var c=[];c.map={},u<=a&&(K(c,{src:t[J[a]],type:t[J[a]+"mime"]}),o.start("source",c,!0))}if(t.poster&&"object"===n&&e&&!r){var s=[];s.map={},K(s,{src:t.poster,width:t.width,height:t.height}),o.start("img",s,!0)}}o.end(n)}},G({})).parse(n),o.getContent()},Z=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],nn=function(n){var t=n.match(/^(https?:\/\/|www\.)(.+)$/i);return t&&t.length>1?"www."===t[1]?"https://":t[1]:"https://"},tn=function(n,t){for(var e=nn(t),r=n.regex.exec(t),o=e+n.url,i=function(n){o=o.replace("$"+n,(function(){return r[n]?r[n]:""}))},u=0;u<r.length;u++)i(u);return o.replace(/\?$/,"")},en=function(n){var t=Z.filter((function(t){return t.regex.test(n)}));return t.length>0?F.extend({},t[0],{url:tn(t[0],n)}):null},rn=function(n){var t=n.allowfullscreen?' allowFullscreen="1"':"";return'<iframe src="'+n.source+'" width="'+n.width+'" height="'+n.height+'"'+t+"></iframe>"},on=function(n){var t='<object data="'+n.source+'" width="'+n.width+'" height="'+n.height+'" type="application/x-shockwave-flash">';return n.poster&&(t+='<img src="'+n.poster+'" width="'+n.width+'" height="'+n.height+'" />'),t+="</object>",t},un=function(n,t){return t?t(n):'<audio controls="controls" src="'+n.source+'">'+(n.altsource?'\n<source src="'+n.altsource+'"'+(n.altsourcemime?' type="'+n.altsourcemime+'"':"")+" />\n":"")+"</audio>"},an=function(n,t){return t?t(n):'<video width="'+n.width+'" height="'+n.height+'"'+(n.poster?' poster="'+n.poster+'"':"")+' controls="controls">\n<source src="'+n.source+'"'+(n.sourcemime?' type="'+n.sourcemime+'"':"")+" />\n"+(n.altsource?'<source src="'+n.altsource+'"'+(n.altsourcemime?' type="'+n.altsourcemime+'"':"")+" />\n":"")+"</video>"},cn=function(n){return'<script src="'+n.source+'"><\/script>'},sn=function(n,t){var e=F.extend({},t);if(!e.source&&(F.extend(e,U(D(n),e.embed)),!e.source))return"";e.altsource||(e.altsource=""),e.poster||(e.poster=""),e.source=n.convertURL(e.source,"source"),e.altsource=n.convertURL(e.altsource,"source"),e.sourcemime=W(e.source),e.altsourcemime=W(e.altsource),e.poster=n.convertURL(e.poster,"poster");var r=en(e.source);if(r&&(e.source=r.url,e.type=r.type,e.allowfullscreen=r.allowFullscreen,e.width=e.width||String(r.w),e.height=e.height||String(r.h)),e.embed)return Q(e.embed,e,!0);var o=z(D(n),e.source);o&&(e.type="script",e.width=String(o.width),e.height=String(o.height));var i=E(n),u=_(n);return e.width=e.width||"300",e.height=e.height||"150",F.each(e,(function(t,r){e[r]=n.dom.encode(""+t)})),"iframe"===e.type?rn(e):"application/x-shockwave-flash"===e.sourcemime?on(e):-1!==e.sourcemime.indexOf("audio")?un(e,i):"script"===e.type?cn(e):an(e,u)},ln=tinymce.util.Tools.resolve("tinymce.util.Promise"),fn={},dn=function(n,t,e){return new ln((function(r,o){var i=function(e){return e.html&&(fn[n.source]=e),r({url:n.source,html:e.html?e.html:t(n)})};fn[n.source]?i(fn[n.source]):e({url:n.source},i,o)}))},mn=function(n,t){return new ln((function(e){e({html:t(n),url:n.source})}))},gn=function(n){return function(t){return sn(n,t)}},pn=function(n,t){var e=B(n);return e?dn(t,gn(n),e):mn(t,gn(n))},hn=function(n){return fn.hasOwnProperty(n)},vn=function(n,t){return O(t,n).bind((function(n){return O(n,"meta")}))},bn=function(n,t,e){return function(r){var o,u=function(){return O(n,r)},a=function(){return O(t,r)},c=function(n){return O(n,"value").bind((function(n){return n.length>0?v.some(n):v.none()}))},s=function(){return u().bind((function(n){return i(n)?c(n).orThunk(a):a().orThunk((function(){return v.from(n)}))}))},l=function(){return a().orThunk((function(){return u().bind((function(n){return i(n)?c(n):v.from(n)}))}))};return o={},o[r]=(r===e?s():l()).getOr(""),o}},yn=function(n,t){var e={};return O(n,"dimensions").each((function(n){y(["width","height"],(function(r){O(t,r).orThunk((function(){return O(n,r)})).each((function(n){return e[r]=n}))}))})),e},wn=function(n,e){var r=e?vn(e,n).getOr({}):{},o=bn(n,r,e);return t(t(t(t(t({},o("source")),o("altsource")),o("poster")),o("embed")),yn(n,r))},xn=function(n){var e=t(t({},n),{source:{value:O(n,"source").getOr("")},altsource:{value:O(n,"altsource").getOr("")},poster:{value:O(n,"poster").getOr("")}});return y(["width","height"],(function(t){O(n,t).each((function(n){var r=e.dimensions||{};r[t]=n,e.dimensions=r}))})),e},Sn=function(n){return function(t){var e=t&&t.msg?"Media embed handler error: "+t.msg:"Media embed handler threw unknown error.";n.notificationManager.open({type:"error",text:e})}},Cn=function(n,t){return U(D(n),t)},kn=function(n){return n.getAttribute("data-mce-object")||n.getAttribute("data-ephox-embed-iri")},On=function(n){var e=n.selection.getNode(),r=kn(e)?n.serializer.serialize(e,{selection:!0}):"";return t({embed:r},U(D(n),r))},Tn=function(n,e){return function(r){if(o(r.url)&&r.url.trim().length>0){var i=r.html,u=Cn(e,i),a=t(t({},u),{source:r.url,embed:i});n.setData(xn(a))}}},Dn=function(n,t){for(var e=n.dom.select("*[data-mce-object]"),r=0;r<t.length;r++)for(var o=e.length-1;o>=0;o--)t[r]===e[o]&&e.splice(o,1);n.selection.select(e[0])},En=function(n,t){var e=n.dom.select("*[data-mce-object]");n.insertContent(t),Dn(n,e),n.nodeChanged()},_n=function(n,t,e){t.embed=Q(t.embed,t),t.embed&&(n.source===t.source||hn(t.source))?En(e,t.embed):pn(e,t).then((function(n){En(e,n.html)})).catch(Sn(e))},An=function(n){var e=On(n),r=x(e),o=xn(e),i=function(t,e){var r=wn(e.getData(),"source");t.source!==r.source&&(Tn(v,n)({url:r.source,html:""}),pn(n,r).then(Tn(v,n)).catch(Sn(n)))},u=function(t){var e=wn(t.getData()),r=Cn(n,e.embed);t.setData(xn(r))},a=function(e,r){var o=wn(e.getData(),r),i=sn(n,o);e.setData(xn(t(t({},o),{embed:i})))},c=[{name:"source",type:"urlinput",filetype:"media",label:"Source"}],s=N(n)?[{type:"sizeinput",name:"dimensions",label:"Constrain proportions",constrain:!0}]:[],l={title:"General",name:"general",items:w([c,s])},f={type:"textarea",name:"embed",label:"Paste your embed code below:"},d={title:"Embed",items:[f]},m=[];M(n)&&m.push({name:"altsource",type:"urlinput",filetype:"media",label:"Alternative source URL"}),I(n)&&m.push({name:"poster",type:"urlinput",filetype:"image",label:"Media poster (Image URL)"});var g={title:"Advanced",name:"advanced",items:m},p=[l,d];m.length>0&&p.push(g);var h={type:"tabpanel",tabs:p},v=n.windowManager.open({title:"Insert/Edit Media",size:"normal",body:h,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(t){var e=wn(t.getData());_n(r.get(),e,n),t.close()},onChange:function(n,t){switch(t.name){case"source":i(r.get(),n);break;case"embed":u(n);break;case"dimensions":case"altsource":case"poster":a(n,t.name);break}r.set(wn(n.getData()))},initialData:o})},Rn=function(n){var t=function(){An(n)};return{showDialog:t}},Bn=function(n){var t=function(){An(n)};n.addCommand("mceMedia",t)},Mn=tinymce.util.Tools.resolve("tinymce.html.Node"),In=tinymce.util.Tools.resolve("tinymce.Env"),Nn=tinymce.util.Tools.resolve("tinymce.html.DomParser"),Fn=function(n,t){if(!1===R(n))return t;var e,r=q();return L({validate:!1,allow_conditional_comments:!1,comment:function(n){e||r.comment(n)},cdata:function(n){e||r.cdata(n)},text:function(n,t){e||r.text(n,t)},start:function(t,o,i){if(e=!0,"script"!==t&&"noscript"!==t&&"svg"!==t){for(var u=o.length-1;u>=0;u--){var a=o[u].name;0===a.indexOf("on")&&(delete o.map[a],o.splice(u,1)),"style"===a&&(o[u].value=n.dom.serializeStyle(n.dom.parseStyle(o[u].value),t))}r.start(t,o,i),e=!1}},end:function(n){e||r.end(n)}},G({})).parse(t),r.getContent()},Pn=function(n){var t=n.name;return"iframe"===t||"video"===t||"audio"===t},Ln=function(n,t,e,r){void 0===r&&(r=null);var o=n.attr(e);return c(o)?o:T(t,e)?null:r},zn=function(n,t,e){var r="img"===t.name||"video"===n.name,o=r?"300":null,i="audio"===n.name?"30":"150",u=r?i:null;t.attr({width:Ln(n,e,"width",o),height:Ln(n,e,"height",u)})},jn=function(n,t,e,r){var o=Nn({forced_root_block:!1,validate:!1},n.schema).parse(r,{context:t});while(o.firstChild)e.append(o.firstChild)},Hn=function(n,t){var e=t.name,r=new Mn("img",1);return r.shortEnded=!0,Un(n,t,r),zn(t,r,{}),r.attr({style:t.attr("style"),src:In.transparentSrc,"data-mce-object":e,class:"mce-object mce-object-"+e}),r},Vn=function(n,t){var e=t.name,r=new Mn("span",1);r.attr({contentEditable:"false",style:t.attr("style"),"data-mce-object":e,class:"mce-preview-object mce-object-"+e}),Un(n,t,r);var o=n.dom.parseStyle(t.attr("style")),i=new Mn(e,1);if(zn(t,i,o),i.attr({src:t.attr("src"),style:t.attr("style"),class:t.attr("class")}),"iframe"===e)i.attr({allowfullscreen:t.attr("allowfullscreen"),frameborder:"0"});else{var u=["controls","crossorigin","currentTime","loop","muted","poster","preload"];y(u,(function(n){i.attr(n,t.attr(n))}));var a=r.attr("data-mce-html");c(a)&&jn(n,e,i,a)}var s=new Mn("span",1);return s.attr("class","mce-shim"),r.append(i),r.append(s),r},Un=function(n,t,e){var r=t.attributes,o=r.length;while(o--){var i=r[o].name,u=r[o].value;"width"!==i&&"height"!==i&&"style"!==i&&("data"!==i&&"src"!==i||(u=n.convertURL(u,i)),e.attr("data-mce-p-"+i,u))}var a=t.firstChild&&t.firstChild.value;a&&(e.attr("data-mce-html",escape(Fn(n,a))),e.firstChild=null)},Wn=function(n){var t=n.attr("class");return t&&/\btiny-pageembed\b/.test(t)},Gn=function(n){while(n=n.parent)if(n.attr("data-ephox-embed-iri")||Wn(n))return!0;return!1},qn=function(n){return function(t){var e,r,o=t.length;while(o--)e=t[o],e.parent&&(e.parent.attr("data-mce-object")||("script"!==e.name||(r=z(D(n),e.attr("src")),r))&&(r&&(r.width&&e.attr("width",r.width.toString()),r.height&&e.attr("height",r.height.toString())),Pn(e)&&A(n)&&In.ceFalse?Gn(e)||e.replace(Vn(n,e)):Gn(e)||e.replace(Hn(n,e))))}},$n=function(n){n.on("preInit",(function(){var t=n.schema.getSpecialElements();F.each("video audio iframe object".split(" "),(function(n){t[n]=new RegExp("</"+n+"[^>]*>","gi")}));var e=n.schema.getBoolAttrs();F.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),(function(n){e[n]={}})),n.parser.addNodeFilter("iframe,video,audio,object,embed,script",qn(n)),n.serializer.addAttributeFilter("data-mce-object",(function(t,e){var r,o,i,u,a,c,s,l,f=t.length;while(f--)if(r=t[f],r.parent){s=r.attr(e),o=new Mn(s,1),"audio"!==s&&"script"!==s&&(l=r.attr("class"),l&&-1!==l.indexOf("mce-preview-object")?o.attr({width:r.firstChild.attr("width"),height:r.firstChild.attr("height")}):o.attr({width:r.attr("width"),height:r.attr("height")})),o.attr({style:r.attr("style")}),u=r.attributes,i=u.length;while(i--){var d=u[i].name;0===d.indexOf("data-mce-p-")&&o.attr(d.substr(11),u[i].value)}"script"===s&&o.attr("type","text/javascript"),a=r.attr("data-mce-html"),a&&(c=new Mn("#text",3),c.raw=!0,c.value=Fn(n,unescape(a)),o.append(c)),r.replace(o)}}))})),n.on("SetContent",(function(){n.$("span.mce-preview-object").each((function(t,e){var r=n.$(e);0===r.find("span.mce-shim").length&&r.append('<span class="mce-shim"></span>')}))}))},Xn=function(n){n.on("ResolveName",(function(n){var t;1===n.target.nodeType&&(t=n.target.getAttribute("data-mce-object"))&&(n.name=t)}))},Kn=function(n){n.on("click keyup touchend",(function(){var t=n.selection.getNode();t&&n.dom.hasClass(t,"mce-preview-object")&&n.dom.getAttrib(t,"data-mce-selected")&&t.setAttribute("data-mce-selected","2")})),n.on("ObjectSelected",(function(n){var t=n.target.getAttribute("data-mce-object");"script"===t&&n.preventDefault()})),n.on("ObjectResized",(function(n){var t,e=n.target;e.getAttribute("data-mce-object")&&(t=e.getAttribute("data-mce-html"),t&&(t=unescape(t),e.setAttribute("data-mce-html",escape(Q(t,{width:String(n.width),height:String(n.height)})))))}))},Yn=function(n,t){return function(e){return n.selection.selectorChangedWithUnbind(t.join(","),e.setActive).unbind}},Jn=function(n){n.ui.registry.addToggleButton("media",{tooltip:"Insert/edit media",icon:"embed",onAction:function(){n.execCommand("mceMedia")},onSetup:Yn(n,["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"])}),n.ui.registry.addMenuItem("media",{icon:"embed",text:"Media...",onAction:function(){n.execCommand("mceMedia")}})};function Qn(){n.add("media",(function(n){return Bn(n),Jn(n),Xn(n),$n(n),Kn(n),Rn(n)}))}Qn()})()},"30c1":function(n,t,e){e("cd32")},"3a36":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(){return t=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},t.apply(this,arguments)},e=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},r=function(n){return function(t){return e(t)===n}},o=function(n){return function(t){return typeof t===n}},i=function(n){return function(t){return n===t}},u=r("string"),a=r("object"),c=r("array"),s=i(null),l=o("boolean"),f=function(n){return null===n||void 0===n},d=function(n){return!f(n)},m=o("number"),g=function(){},p=function(n){return function(){return n}},h=p(!1),v=p(!0),b=function(){return y},y=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:h,isSome:h,isNone:v,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:p(null),getOrUndefined:p(void 0),or:e,orThunk:t,map:b,each:g,bind:b,exists:h,forall:v,filter:b,equals:n,equals_:n,toArray:function(){return[]},toString:p("none()")};return r}(),w=function(n){var t=p(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:v,isNone:h,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return w(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:y},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(h,(function(t){return e(n,t)}))}};return o},x=function(n){return null===n||void 0===n?y:w(n)},S={some:w,none:b,from:x},C=Object.keys,k=Object.hasOwnProperty,O=function(n,t){for(var e=C(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},T=function(n){return function(t,e){n[e]=t}},D=function(n,t,e,r){var o={};return O(n,(function(n,o){(t(n,o)?e:r)(n,o)})),o},E=function(n,t){var e={};return D(n,t,T(e),g),e},_=function(n,t){return k.call(n,t)},A=function(n,t){return _(n,t)&&void 0!==n[t]&&null!==n[t]},R=Array.prototype.push,B=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!c(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);R.apply(t,n[e])}return t},M=function(n,t){return t>=0&&t<n.length?S.some(n[t]):S.none()},I=function(n){return M(n,0)},N=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return S.none()},F=("undefined"!==typeof window?window:Function("return this;")(),function(n,t,e){if(!(u(e)||l(e)||m(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")}),P=function(n,t,e){F(n.dom,t,e)},L=function(n,t){n.dom.removeAttribute(t)},z=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw new Error("HTML must have a single root node");return V(r.childNodes[0])},j=function(n,t){var e=t||document,r=e.createElement(n);return V(r)},H=function(n,t){var e=t||document,r=e.createTextNode(n);return V(r)},V=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},U=function(n,t,e){return S.from(n.dom.elementFromPoint(t,e)).map(V)},W={fromHtml:z,fromTag:j,fromText:H,fromDom:V,fromPoint:U},G=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),q=tinymce.util.Tools.resolve("tinymce.util.Promise"),$=tinymce.util.Tools.resolve("tinymce.util.XHR"),X=function(n){return n.getParam("image_dimensions",!0,"boolean")},K=function(n){return n.getParam("image_advtab",!1,"boolean")},Y=function(n){return n.getParam("image_uploadtab",!0,"boolean")},J=function(n){return n.getParam("image_prepend_url","","string")},Q=function(n){return n.getParam("image_class_list")},Z=function(n){return n.getParam("image_description",!0,"boolean")},nn=function(n){return n.getParam("image_title",!1,"boolean")},tn=function(n){return n.getParam("image_caption",!1,"boolean")},en=function(n){return n.getParam("image_list",!1)},rn=function(n){return d(n.getParam("images_upload_url"))},on=function(n){return d(n.getParam("images_upload_handler"))},un=function(n){return n.getParam("a11y_advanced_options",!1,"boolean")},an=function(n){return n.getParam("automatic_uploads",!0,"boolean")},cn=function(n,t){return Math.max(parseInt(n,10),parseInt(t,10))},sn=function(n){return new q((function(t){var e=document.createElement("img"),r=function(n){e.parentNode&&e.parentNode.removeChild(e),t(n)};e.onload=function(){var n=cn(e.width,e.clientWidth),t=cn(e.height,e.clientHeight),o={width:n,height:t};r(q.resolve(o))},e.onerror=function(){r(q.reject("Failed to get image dimensions for: "+n))};var o=e.style;o.visibility="hidden",o.position="fixed",o.bottom=o.left="0px",o.width=o.height="auto",document.body.appendChild(e),e.src=n}))},ln=function(n){return n&&(n=n.replace(/px$/,"")),n},fn=function(n){return n.length>0&&/^[0-9]+$/.test(n)&&(n+="px"),n},dn=function(n){if(n.margin){var t=String(n.margin).split(" ");switch(t.length){case 1:n["margin-top"]=n["margin-top"]||t[0],n["margin-right"]=n["margin-right"]||t[0],n["margin-bottom"]=n["margin-bottom"]||t[0],n["margin-left"]=n["margin-left"]||t[0];break;case 2:n["margin-top"]=n["margin-top"]||t[0],n["margin-right"]=n["margin-right"]||t[1],n["margin-bottom"]=n["margin-bottom"]||t[0],n["margin-left"]=n["margin-left"]||t[1];break;case 3:n["margin-top"]=n["margin-top"]||t[0],n["margin-right"]=n["margin-right"]||t[1],n["margin-bottom"]=n["margin-bottom"]||t[2],n["margin-left"]=n["margin-left"]||t[1];break;case 4:n["margin-top"]=n["margin-top"]||t[0],n["margin-right"]=n["margin-right"]||t[1],n["margin-bottom"]=n["margin-bottom"]||t[2],n["margin-left"]=n["margin-left"]||t[3]}delete n.margin}return n},mn=function(n,t){var e=en(n);"string"===typeof e?$.send({url:e,success:function(n){t(JSON.parse(n))}}):"function"===typeof e?e(t):t(e)},gn=function(n,t,e){var r=function(){e.onload=e.onerror=null,n.selection&&(n.selection.select(e),n.nodeChanged())};e.onload=function(){t.width||t.height||!X(n)||n.dom.setAttribs(e,{width:String(e.clientWidth),height:String(e.clientHeight)}),r()},e.onerror=r},pn=function(n){return new q((function(t,e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){e(r.error.message)},r.readAsDataURL(n)}))},hn=function(n){return"IMG"===n.nodeName&&(n.hasAttribute("data-mce-object")||n.hasAttribute("data-mce-placeholder"))},vn=G.DOM,bn=function(n){return n.style.marginLeft&&n.style.marginRight&&n.style.marginLeft===n.style.marginRight?ln(n.style.marginLeft):""},yn=function(n){return n.style.marginTop&&n.style.marginBottom&&n.style.marginTop===n.style.marginBottom?ln(n.style.marginTop):""},wn=function(n){return n.style.borderWidth?ln(n.style.borderWidth):""},xn=function(n,t){return n.hasAttribute(t)?n.getAttribute(t):""},Sn=function(n,t){return n.style[t]?n.style[t]:""},Cn=function(n){return null!==n.parentNode&&"FIGURE"===n.parentNode.nodeName},kn=function(n,t,e){""===e?n.removeAttribute(t):n.setAttribute(t,e)},On=function(n){var t=vn.create("figure",{class:"image"});vn.insertAfter(t,n),t.appendChild(n),t.appendChild(vn.create("figcaption",{contentEditable:"true"},"Caption")),t.contentEditable="false"},Tn=function(n){var t=n.parentNode;vn.insertAfter(n,t),vn.remove(t)},Dn=function(n){Cn(n)?Tn(n):On(n)},En=function(n,t){var e=n.getAttribute("style"),r=t(null!==e?e:"");r.length>0?(n.setAttribute("style",r),n.setAttribute("data-mce-style",r)):n.removeAttribute("style")},_n=function(n,t){return function(n,e,r){n.style[e]?(n.style[e]=fn(r),En(n,t)):kn(n,e,r)}},An=function(n,t){return n.style[t]?ln(n.style[t]):xn(n,t)},Rn=function(n,t){var e=fn(t);n.style.marginLeft=e,n.style.marginRight=e},Bn=function(n,t){var e=fn(t);n.style.marginTop=e,n.style.marginBottom=e},Mn=function(n,t){var e=fn(t);n.style.borderWidth=e},In=function(n,t){n.style.borderStyle=t},Nn=function(n){return Sn(n,"borderStyle")},Fn=function(n){return"FIGURE"===n.nodeName},Pn=function(n){return"IMG"===n.nodeName},Ln=function(n){return 0===vn.getAttrib(n,"alt").length&&"presentation"===vn.getAttrib(n,"role")},zn=function(n){return Ln(n)?"":xn(n,"alt")},jn=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}},Hn=function(n,t){var e=document.createElement("img");return kn(e,"style",t.style),(bn(e)||""!==t.hspace)&&Rn(e,t.hspace),(yn(e)||""!==t.vspace)&&Bn(e,t.vspace),(wn(e)||""!==t.border)&&Mn(e,t.border),(Nn(e)||""!==t.borderStyle)&&In(e,t.borderStyle),n(e.getAttribute("style"))},Vn=function(n,e){var r=document.createElement("img");if(Xn(n,t(t({},e),{caption:!1}),r),Gn(r,e.alt,e.isDecorative),e.caption){var o=vn.create("figure",{class:"image"});return o.appendChild(r),o.appendChild(vn.create("figcaption",{contentEditable:"true"},"Caption")),o.contentEditable="false",o}return r},Un=function(n,t){return{src:xn(t,"src"),alt:zn(t),title:xn(t,"title"),width:An(t,"width"),height:An(t,"height"),class:xn(t,"class"),style:n(xn(t,"style")),caption:Cn(t),hspace:bn(t),vspace:yn(t),border:wn(t),borderStyle:Sn(t,"borderStyle"),isDecorative:Ln(t)}},Wn=function(n,t,e,r,o){e[r]!==t[r]&&o(n,r,e[r])},Gn=function(n,t,e){if(e){vn.setAttrib(n,"role","presentation");var r=W.fromDom(n);P(r,"alt","")}else{if(s(t)){r=W.fromDom(n);L(r,"alt")}else{r=W.fromDom(n);P(r,"alt",t)}"presentation"===vn.getAttrib(n,"role")&&vn.setAttrib(n,"role","")}},qn=function(n,t,e){e.alt===t.alt&&e.isDecorative===t.isDecorative||Gn(n,e.alt,e.isDecorative)},$n=function(n,t){return function(e,r,o){n(e,o),En(e,t)}},Xn=function(n,t,e){var r=Un(n,e);Wn(e,r,t,"caption",(function(n,t,e){return Dn(n)})),Wn(e,r,t,"src",kn),Wn(e,r,t,"title",kn),Wn(e,r,t,"width",_n("width",n)),Wn(e,r,t,"height",_n("height",n)),Wn(e,r,t,"class",kn),Wn(e,r,t,"style",$n((function(n,t){return kn(n,"style",t)}),n)),Wn(e,r,t,"hspace",$n(Rn,n)),Wn(e,r,t,"vspace",$n(Bn,n)),Wn(e,r,t,"border",$n(Mn,n)),Wn(e,r,t,"borderStyle",$n(In,n)),qn(e,r,t)},Kn=function(n,t){var e=n.dom.styles.parse(t),r=dn(e),o=n.dom.styles.parse(n.dom.styles.serialize(r));return n.dom.styles.serialize(o)},Yn=function(n){var t=n.selection.getNode(),e=n.dom.getParent(t,"figure.image");return e?n.dom.select("img",e)[0]:t&&("IMG"!==t.nodeName||hn(t))?null:t},Jn=function(n,t){var e=n.dom,r=E(n.schema.getTextBlockElements(),(function(t,e){return!n.schema.isValidChild(e,"figure")})),o=e.getParent(t.parentNode,(function(n){return A(r,n.nodeName)}),n.getBody());return o?e.split(o,t):t},Qn=function(n){var t=Yn(n);return t?Un((function(t){return Kn(n,t)}),t):jn()},Zn=function(n,t){var e=Vn((function(t){return Kn(n,t)}),t);n.dom.setAttrib(e,"data-mce-id","__mcenew"),n.focus(),n.selection.setContent(e.outerHTML);var r=n.dom.select('*[data-mce-id="__mcenew"]')[0];if(n.dom.setAttrib(r,"data-mce-id",null),Fn(r)){var o=Jn(n,r);n.selection.select(o)}else n.selection.select(r)},nt=function(n,t){n.dom.setAttrib(t,"src",t.getAttribute("src"))},tt=function(n,t){if(t){var e=n.dom.is(t.parentNode,"figure.image")?t.parentNode:t;n.dom.remove(e),n.focus(),n.nodeChanged(),n.dom.isEmpty(n.getBody())&&(n.setContent(""),n.selection.setCursorLocation())}},et=function(n,t){var e=Yn(n);if(Xn((function(t){return Kn(n,t)}),t,e),nt(n,e),Fn(e.parentNode)){var r=e.parentNode;Jn(n,r),n.selection.select(e.parentNode)}else n.selection.select(e),gn(n,t,e)},rt=function(n,e){var r=Yn(n);if(r){var o=Un((function(t){return Kn(n,t)}),r),i=t(t({},o),e);i.src?et(n,i):tt(n,r)}else e.src&&Zn(n,t(t({},jn()),e))},ot=Object.prototype.hasOwnProperty,it=function(n,t){var e=a(n)&&a(t);return e?at(n,t):t},ut=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)ot.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}},at=ut(it),ct=function(n){return n.length>0},st=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),lt=tinymce.util.Tools.resolve("tinymce.util.Tools"),ft=function(n){return u(n.value)?n.value:""},dt=function(n){return u(n.text)?n.text:u(n.title)?n.title:""},mt=function(n,t){var e=[];return lt.each(n,(function(n){var r=dt(n);if(void 0!==n.menu){var o=mt(n.menu,t);e.push({text:r,items:o})}else{var i=t(n);e.push({text:r,value:i})}})),e},gt=function(n){return void 0===n&&(n=ft),function(t){return t?S.from(t).map((function(t){return mt(t,n)})):S.none()}},pt=function(n){return gt(ft)(n)},ht=function(n){return Object.prototype.hasOwnProperty.call(n,"items")},vt=function(n,t){return N(n,(function(n){return ht(n)?vt(n.items,t):n.value===t?S.some(n):S.none()}))},bt=function(n,t){return n.bind((function(n){return vt(n,t)}))},yt={sanitizer:gt,sanitize:pt,findEntry:bt},wt=function(n){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},xt={makeTab:wt},St=function(n){var t=yt.sanitizer((function(t){return n.convertURL(t.value||t.url,"src")})),e=new q((function(e){mn(n,(function(n){e(t(n).map((function(n){return B([[{text:"None",value:""}],n])})))}))})),r=yt.sanitize(Q(n)),o=K(n),i=Y(n),a=rn(n),c=on(n),s=Qn(n),l=Z(n),f=nn(n),d=X(n),m=tn(n),g=un(n),p=an(n),h=S.some(J(n)).filter((function(n){return u(n)&&n.length>0}));return e.then((function(n){return{image:s,imageList:n,classList:r,hasAdvTab:o,hasUploadTab:i,hasUploadUrl:a,hasUploadHandler:c,hasDescription:l,hasImageTitle:f,hasDimensions:d,hasImageCaption:m,prependURL:h,hasAccessibilityOptions:g,automaticUploads:p}}))},Ct=function(n){var e={name:"src",type:"urlinput",filetype:"image",label:"Source"},r=n.imageList.map((function(n){return{name:"images",type:"listbox",label:"Image list",items:n}})),o={name:"alt",type:"input",label:"Alternative description",disabled:n.hasAccessibilityOptions&&n.image.isDecorative},i={name:"title",type:"input",label:"Image title"},u={name:"dimensions",type:"sizeinput"},a={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},c=n.classList.map((function(n){return{name:"classes",type:"listbox",label:"Class",items:n}})),s={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},l=function(n){return n?{type:"grid",columns:2}:{type:"panel"}};return B([[e],r.toArray(),n.hasAccessibilityOptions&&n.hasDescription?[a]:[],n.hasDescription?[o]:[],n.hasImageTitle?[i]:[],n.hasDimensions?[u]:[],[t(t({},l(n.classList.isSome()&&n.hasImageCaption)),{items:B([c.toArray(),n.hasImageCaption?[s]:[]])})]])},kt=function(n){return{title:"General",name:"general",items:Ct(n)}},Ot={makeTab:kt,makeItems:Ct},Tt=function(n){var t=[{type:"dropzone",name:"fileinput"}];return{title:"Upload",name:"upload",items:t}},Dt={makeTab:Tt},Et=function(n){return{prevImage:yt.findEntry(n.imageList,n.image.src),prevAlt:n.image.alt,open:!0}},_t=function(n){return{src:{value:n.src,meta:{}},images:n.src,alt:n.alt,title:n.title,dimensions:{width:n.width,height:n.height},classes:n.class,caption:n.caption,style:n.style,vspace:n.vspace,border:n.border,hspace:n.hspace,borderstyle:n.borderStyle,fileinput:[],isDecorative:n.isDecorative}},At=function(n,t){return{src:n.src.value,alt:0===n.alt.length&&t?null:n.alt,title:n.title,width:n.dimensions.width,height:n.dimensions.height,class:n.classes,style:n.style,caption:n.caption,hspace:n.hspace,vspace:n.vspace,border:n.border,borderStyle:n.borderstyle,isDecorative:n.isDecorative}},Rt=function(n,t){return/^(?:[a-zA-Z]+:)?\/\//.test(t)?S.none():n.prependURL.bind((function(n){return t.substring(0,n.length)!==n?S.some(n+t):S.none()}))},Bt=function(n,t){var e=t.getData();Rt(n,e.src.value).each((function(n){t.setData({src:{value:n,meta:e.src.meta}})}))},Mt=function(n,t,e){n.hasDescription&&u(e.alt)&&(t.alt=e.alt),n.hasAccessibilityOptions&&(t.isDecorative=e.isDecorative||t.isDecorative||!1),n.hasImageTitle&&u(e.title)&&(t.title=e.title),n.hasDimensions&&(u(e.width)&&(t.dimensions.width=e.width),u(e.height)&&(t.dimensions.height=e.height)),u(e.class)&&yt.findEntry(n.classList,e.class).each((function(n){t.classes=n.value})),n.hasImageCaption&&l(e.caption)&&(t.caption=e.caption),n.hasAdvTab&&(u(e.style)&&(t.style=e.style),u(e.vspace)&&(t.vspace=e.vspace),u(e.border)&&(t.border=e.border),u(e.hspace)&&(t.hspace=e.hspace),u(e.borderstyle)&&(t.borderstyle=e.borderstyle))},It=function(n,t){var e=t.getData(),r=e.src.meta;if(void 0!==r){var o=at({},e);Mt(n,o,r),t.setData(o)}},Nt=function(n,t,e,r){var o=r.getData(),i=o.src.value,u=o.src.meta||{};u.width||u.height||!t.hasDimensions||(ct(i)?n.imageSize(i).then((function(n){e.open&&r.setData({dimensions:n})})).catch((function(n){})):r.setData({dimensions:{width:"",height:""}}))},Ft=function(n,t,e){var r=e.getData(),o=yt.findEntry(n.imageList,r.src.value);t.prevImage=o,e.setData({images:o.map((function(n){return n.value})).getOr("")})},Pt=function(n,t,e,r){Bt(t,r),It(t,r),Nt(n,t,e,r),Ft(t,e,r)},Lt=function(n,t,e,r){var o=r.getData(),i=yt.findEntry(t.imageList,o.images);i.each((function(n){var t=""===o.alt||e.prevImage.map((function(n){return n.text===o.alt})).getOr(!1);t?""===n.value?r.setData({src:n,alt:e.prevAlt}):r.setData({src:n,alt:n.text}):r.setData({src:n})})),e.prevImage=i,Pt(n,t,e,r)},zt=function(n){var t=n["margin-top"]&&n["margin-bottom"]&&n["margin-top"]===n["margin-bottom"];return t?ln(String(n["margin-top"])):""},jt=function(n){var t=n["margin-right"]&&n["margin-left"]&&n["margin-right"]===n["margin-left"];return t?ln(String(n["margin-right"])):""},Ht=function(n){return n["border-width"]?ln(String(n["border-width"])):""},Vt=function(n){return n["border-style"]?String(n["border-style"]):""},Ut=function(n,t,e){return t(n(t(e)))},Wt=function(n,t,e){var r=dn(n(e.style)),o=at({},e);return o.vspace=zt(r),o.hspace=jt(r),o.border=Ht(r),o.borderstyle=Vt(r),o.style=Ut(n,t,r),o},Gt=function(n,t){var e=t.getData(),r=Wt(n.parseStyle,n.serializeStyle,e);t.setData(r)},qt=function(n,t,e){var r=at(_t(t.image),e.getData()),o=Hn(n.normalizeCss,At(r,!1));e.setData({style:o})},$t=function(n,t,e,r){var o=r.getData();r.block("Uploading image"),I(o.fileinput).fold((function(){r.unblock()}),(function(o){var i=URL.createObjectURL(o),u=function(){r.unblock(),URL.revokeObjectURL(i)},a=function(o){r.setData({src:{value:o,meta:{}}}),r.showTab("general"),Pt(n,t,e,r)};pn(o).then((function(e){var c=n.createBlobCache(o,i,e);t.automaticUploads?n.uploadImage(c).then((function(n){a(n.url),u()})).catch((function(t){u(),n.alertErr(t)})):(n.addToBlobCache(c),a(c.blobUri()),r.unblock())}))}))},Xt=function(n,t,e){return function(r,o){"src"===o.name?Pt(n,t,e,r):"images"===o.name?Lt(n,t,e,r):"alt"===o.name?e.prevAlt=r.getData().alt:"style"===o.name?Gt(n,r):"vspace"===o.name||"hspace"===o.name||"border"===o.name||"borderstyle"===o.name?qt(n,t,r):"fileinput"===o.name?$t(n,t,e,r):"isDecorative"===o.name&&(r.getData().isDecorative?r.disable("alt"):r.enable("alt"))}},Kt=function(n){return function(){n.open=!1}},Yt=function(n){if(n.hasAdvTab||n.hasUploadUrl||n.hasUploadHandler){var t={type:"tabpanel",tabs:B([[Ot.makeTab(n)],n.hasAdvTab?[xt.makeTab(n)]:[],n.hasUploadTab&&(n.hasUploadUrl||n.hasUploadHandler)?[Dt.makeTab(n)]:[]])};return t}var e={type:"panel",items:Ot.makeItems(n)};return e},Jt=function(n){return function(t){var e=Et(t);return{title:"Insert/Edit Image",size:"normal",body:Yt(t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:_t(t.image),onSubmit:n.onSubmit(t),onChange:Xt(n,t,e),onClose:Kt(e)}}},Qt=function(n){return function(t){return function(e){var r=at(_t(t.image),e.getData());n.execCommand("mceUpdateImage",!1,At(r,t.hasAccessibilityOptions)),n.editorUpload.uploadImagesAuto(),e.close()}}},Zt=function(n){return function(t){return sn(n.documentBaseURI.toAbsolute(t)).then((function(n){return{width:String(n.width),height:String(n.height)}}))}},ne=function(n){return function(t,e,r){return n.editorUpload.blobCache.create({blob:t,blobUri:e,name:t.name?t.name.replace(/\.[^\.]+$/,""):null,filename:t.name,base64:r.split(",")[1]})}},te=function(n){return function(t){n.editorUpload.blobCache.add(t)}},ee=function(n){return function(t){n.windowManager.alert(t)}},re=function(n){return function(t){return Kn(n,t)}},oe=function(n){return function(t){return n.dom.parseStyle(t)}},ie=function(n){return function(t,e){return n.dom.serializeStyle(t,e)}},ue=function(n){return function(t){return st(n).upload([t],!1).then((function(n){return 0===n.length?q.reject("Failed to upload image"):!1===n[0].status?q.reject(n[0].error.message):n[0]}))}},ae=function(n){var t={onSubmit:Qt(n),imageSize:Zt(n),addToBlobCache:te(n),createBlobCache:ne(n),alertErr:ee(n),normalizeCss:re(n),parseStyle:oe(n),serializeStyle:ie(n),uploadImage:ue(n)},e=function(){St(n).then(Jt(t)).then(n.windowManager.open)};return{open:e}},ce=function(n){n.addCommand("mceImage",ae(n).open),n.addCommand("mceUpdateImage",(function(t,e){n.undoManager.transact((function(){return rt(n,e)}))}))},se=function(n){var t=n.attr("class");return t&&/\bimage\b/.test(t)},le=function(n){return function(t){var e=t.length,r=function(t){t.attr("contenteditable",n?"true":null)};while(e--){var o=t[e];se(o)&&(o.attr("contenteditable",n?"false":null),lt.each(o.getAll("figcaption"),r))}}},fe=function(n){n.on("PreInit",(function(){n.parser.addNodeFilter("figure",le(!0)),n.serializer.addNodeFilter("figure",le(!1))}))},de=function(n){n.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:ae(n).open,onSetup:function(t){return n.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",t.setActive).unbind}}),n.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:ae(n).open}),n.ui.registry.addContextMenu("image",{update:function(n){return Fn(n)||Pn(n)&&!hn(n)?["image"]:[]}})};function me(){n.add("image",(function(n){fe(n),de(n),ce(n)}))}me()})()},"48c6":function(n,t,e){e("27a7")},5298:function(n,t){(function(){"use strict";var n=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(n){return{isFullscreen:function(){return null!==n.get()}}},r=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},o=function(n){return function(t){return r(t)===n}},i=function(n){return function(t){return typeof t===n}},u=o("string"),a=o("array"),c=i("boolean"),s=function(n){return null===n||void 0===n},l=function(n){return!s(n)},f=i("function"),d=i("number"),m=function(){},g=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},p=function(n,t){return function(e){return n(t(e))}},h=function(n){return function(){return n}};function v(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var b=h(!1),y=h(!0),w=function(){return x},x=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:b,isSome:b,isNone:y,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:e,orThunk:t,map:w,each:m,bind:w,exists:b,forall:y,filter:w,equals:n,equals_:n,toArray:function(){return[]},toString:h("none()")};return r}(),S=function(n){var t=h(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:y,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return S(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:x},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(b,(function(t){return e(n,t)}))}};return o},C=function(n){return null===n||void 0===n?x:S(n)},k={some:S,none:w,from:C},O=function(t){var e=n(k.none()),r=function(){return e.get().each(t)},o=function(){r(),e.set(k.none())},i=function(){return e.get().isSome()},u=function(n){r(),e.set(k.some(n))};return{clear:o,isSet:i,set:u}},T=function(){return O((function(n){return n.unbind()}))},D=function(){var t=n(k.none()),e=function(){return t.set(k.none())},r=function(n){return t.set(k.some(n))},o=function(){return t.get().isSome()},i=function(n){return t.get().each(n)};return{clear:e,set:r,isSet:o,on:i}},E=Array.prototype.push,_=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},A=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},R=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},B=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!a(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);E.apply(t,n[e])}return t},M=function(n,t){return B(_(n,t))},I=function(n,t){return t>=0&&t<n.length?k.some(n[t]):k.none()},N=function(n){return I(n,0)},F=Object.keys,P=function(n,t){for(var e=F(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},L=function(n){return void 0!==n.style&&f(n.style.getPropertyValue)},z=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw new Error("HTML must have a single root node");return V(r.childNodes[0])},j=function(n,t){var e=t||document,r=e.createElement(n);return V(r)},H=function(n,t){var e=t||document,r=e.createTextNode(n);return V(r)},V=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},U=function(n,t,e){return k.from(n.dom.elementFromPoint(t,e)).map(V)},W={fromHtml:z,fromTag:j,fromText:H,fromDom:V,fromPoint:U},G=("undefined"!==typeof window?window:Function("return this;")(),9),q=11,$=1,X=3,K=function(n){return n.dom.nodeType},Y=function(n){return function(t){return K(t)===n}},J=Y($),Q=Y(X),Z=Y(G),nn=Y(q),tn=function(n,t){var e=n.dom;if(e.nodeType!==$)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},en=function(n){return n.nodeType!==$&&n.nodeType!==G&&n.nodeType!==q||0===n.childElementCount},rn=function(n,t){var e=void 0===t?document:t.dom;return en(e)?[]:_(e.querySelectorAll(n),W.fromDom)},on=function(n,t){return n.dom===t.dom},un=function(n){return W.fromDom(n.dom.ownerDocument)},an=function(n){return Z(n)?n:un(n)},cn=function(n){return k.from(n.dom.parentNode).map(W.fromDom)},sn=function(n,t){var e=f(t)?t:b,r=n.dom,o=[];while(null!==r.parentNode&&void 0!==r.parentNode){var i=r.parentNode,u=W.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},ln=function(n){var t=function(t){return R(t,(function(t){return!on(n,t)}))};return cn(n).map(fn).map(t).getOr([])},fn=function(n){return _(n.dom.childNodes,W.fromDom)},dn=function(n){return nn(n)&&l(n.dom.host)},mn=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),gn=h(mn),pn=mn?function(n){return W.fromDom(n.dom.getRootNode())}:an,hn=function(n){var t=pn(n);return dn(t)?k.some(t):k.none()},vn=function(n){return W.fromDom(n.dom.host)},bn=function(n){if(gn()&&l(n.target)){var t=W.fromDom(n.target);if(J(t)&&yn(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return N(e)}}return k.from(n.target)},yn=function(n){return l(n.dom.shadowRoot)},wn=function(n){var t=Q(n)?n.dom.parentNode:n.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var e=t.ownerDocument;return hn(W.fromDom(t)).fold((function(){return e.body.contains(t)}),p(wn,vn))},xn=function(n){var t=n.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return W.fromDom(t)},Sn=function(n,t,e){if(!(u(e)||c(e)||d(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")},Cn=function(n,t,e){Sn(n.dom,t,e)},kn=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},On=function(n,t){n.dom.removeAttribute(t)},Tn=function(n,t,e){if(!u(e))throw new Error("CSS value must be a string: "+e);L(n)&&n.style.setProperty(t,e)},Dn=function(n,t){var e=n.dom;P(t,(function(n,t){Tn(e,t,n)}))},En=function(n,t){var e=n.dom,r=window.getComputedStyle(e),o=r.getPropertyValue(t);return""!==o||wn(n)?o:_n(e,t)},_n=function(n,t){return L(n)?n.style.getPropertyValue(t):""},An=function(n,t,e,r,o,i,u){return{target:n,x:t,y:e,stop:r,prevent:o,kill:i,raw:u}},Rn=function(n){var t=W.fromDom(bn(n).getOr(n.target)),e=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=g(r,e);return An(t,n.clientX,n.clientY,e,r,o,n)},Bn=function(n,t){return function(e){n(e)&&t(Rn(e))}},Mn=function(n,t,e,r,o){var i=Bn(e,r);return n.dom.addEventListener(t,i,o),{unbind:v(Nn,n,t,i,o)}},In=function(n,t,e,r){return Mn(n,t,e,r,!1)},Nn=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},Fn=y,Pn=function(n,t,e){return In(n,t,Fn,e)},Ln=function(n,t){var e=function(e,r){return Ln(n+e,t+r)};return{left:n,top:t,translate:e}},zn=Ln,jn=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return zn(e,r)},Hn=function(n){var t=void 0===n?window:n;return k.from(t["visualViewport"])},Vn=function(n,t,e,r){return{x:n,y:t,width:e,height:r,right:n+e,bottom:t+r}},Un=function(n){var t=void 0===n?window:n,e=t.document,r=jn(W.fromDom(e));return Hn(t).fold((function(){var n=t.document.documentElement,e=n.clientWidth,o=n.clientHeight;return Vn(r.left,r.top,e,o)}),(function(n){return Vn(Math.max(n.pageLeft,r.left),Math.max(n.pageTop,r.top),n.width,n.height)}))},Wn=function(n,t,e){return Hn(e).map((function(e){var r=function(n){return t(Rn(n))};return e.addEventListener(n,r),{unbind:function(){return e.removeEventListener(n,r)}}})).getOrThunk((function(){return{unbind:m}}))},Gn=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),qn=tinymce.util.Tools.resolve("tinymce.Env"),$n=tinymce.util.Tools.resolve("tinymce.util.Delay"),Xn=function(n,t){n.fire("FullscreenStateChanged",{state:t})},Kn=function(n){return n.getParam("fullscreen_native",!1,"boolean")},Yn=function(n){var t=W.fromDom(n.getElement());return hn(t).map(vn).getOrThunk((function(){return xn(un(t))}))},Jn=function(n){return void 0!==n.fullscreenElement?n.fullscreenElement:void 0!==n.msFullscreenElement?n.msFullscreenElement:void 0!==n.webkitFullscreenElement?n.webkitFullscreenElement:null},Qn=function(){return void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange"},Zn=function(n){var t=n.dom;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},nt=function(n){var t=n.dom;t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()},tt=function(n){return n.dom===Jn(un(n).dom)},et=function(n,t,e){return R(sn(n,e),t)},rt=function(n,t){return R(ln(n),t)},ot=function(n){return rn(n)},it=function(n,t,e){return et(n,(function(n){return tn(n,t)}),e)},ut=function(n,t){return rt(n,(function(n){return tn(n,t)}))},at="data-ephox-mobile-fullscreen-style",ct="display:none!important;",st="position:absolute!important;",lt="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",ft="background-color:rgb(255,255,255)!important;",dt=qn.os.isAndroid(),mt=function(n){var t=En(n,"background-color");return void 0!==t&&""!==t?"background-color:"+t+"!important":ft},gt=function(n,t,e){var r=function(n){return ut(n,"*:not(.tox-silver-sink)")},o=function(t){return function(e){var r=kn(e,"style"),o=void 0===r?"no-styles":r.trim();o!==t&&(Cn(e,at,o),Dn(e,n.parseStyle(t)))}},i=it(t,"*"),u=M(i,r),a=mt(e);A(u,o(ct)),A(i,o(st+lt+a));var c=!0===dt?"":st;o(c+lt+a)(t)},pt=function(n){var t=ot("["+at+"]");A(t,(function(t){var e=kn(t,at);"no-styles"!==e?Dn(t,n.parseStyle(e)):On(t,"style"),On(t,at)}))},ht=Gn.DOM,vt=function(){var n=Un(window);return{x:n.x,y:n.y}},bt=function(n){window.scrollTo(n.x,n.y)},yt=Hn().fold((function(){return{bind:m,unbind:m}}),(function(n){var t=D(),e=T(),r=T(),o=function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},i=function(){window.requestAnimationFrame((function(){t.on((function(t){return Dn(t,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})}))}))},u=$n.throttle((function(){o(),i()}),50),a=function(n){t.set(n),u(),e.set(Wn("resize",u)),r.set(Wn("scroll",u))},c=function(){t.on((function(){e.clear(),r.clear()})),t.clear()};return{bind:a,unbind:c}})),wt=function(n,t){var e=document.body,r=document.documentElement,o=n.getContainer(),i=W.fromDom(o),u=Yn(n),a=t.get(),c=W.fromDom(n.getBody()),s=qn.deviceType.isTouch(),l=o.style,f=n.iframeElement,d=f.style,m=function(n){n(e,"tox-fullscreen"),n(r,"tox-fullscreen"),n(o,"tox-fullscreen"),hn(i).map((function(n){return vn(n).dom})).each((function(t){n(t,"tox-fullscreen"),n(t,"tox-shadowhost")}))},g=function(){s&&pt(n.dom),m(ht.removeClass),yt.unbind(),k.from(t.get()).each((function(n){return n.fullscreenChangeHandler.unbind()}))};if(a)a.fullscreenChangeHandler.unbind(),Kn(n)&&tt(u)&&nt(un(u)),d.width=a.iframeWidth,d.height=a.iframeHeight,l.width=a.containerWidth,l.height=a.containerHeight,l.top=a.containerTop,l.left=a.containerLeft,bt(a.scrollPos),t.set(null),Xn(n,!1),g(),n.off("remove",g);else{var p=Pn(un(u),Qn(),(function(e){Kn(n)&&(tt(u)||null===t.get()||wt(n,t))})),h={scrollPos:vt(),containerWidth:l.width,containerHeight:l.height,containerTop:l.top,containerLeft:l.left,iframeWidth:d.width,iframeHeight:d.height,fullscreenChangeHandler:p};s&&gt(n.dom,i,c),d.width=d.height="100%",l.width=l.height="",m(ht.addClass),yt.bind(i),n.on("remove",g),t.set(h),Kn(n)&&Zn(u),Xn(n,!0)}},xt=function(n,t){n.addCommand("mceFullScreen",(function(){wt(n,t)}))},St=function(n,t){return function(e){e.setActive(null!==t.get());var r=function(n){return e.setActive(n.state)};return n.on("FullscreenStateChanged",r),function(){return n.off("FullscreenStateChanged",r)}}},Ct=function(n,t){n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:St(n,t)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:St(n,t)})};function kt(){t.add("fullscreen",(function(t){var r=n(null);return t.inline||(xt(t,r),Ct(t,r),t.addShortcut("Meta+Shift+F","","mceFullScreen")),e(r)}))}kt()})()},"5a13":function(n,t,e){e("098a")},"5d80":function(n,t,e){e("5298")},"5fba":function(n,t,e){e("7a54")},"7a54":function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager");function t(){n.add("textcolor",(function(){}))}t()})()},"85ee":function(n,t,e){(function(t){var e=1/0,r=9007199254740991,o="[object Arguments]",i="[object Function]",u="[object GeneratorFunction]",a="[object Symbol]",c="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,l=c||s||Function("return this")();function f(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}function d(n,t){var e=-1,r=n?n.length:0,o=Array(r);while(++e<r)o[e]=t(n[e],e,n);return o}function m(n,t){var e=-1,r=t.length,o=n.length;while(++e<r)n[o+e]=t[e];return n}var g=Object.prototype,p=g.hasOwnProperty,h=g.toString,v=l.Symbol,b=g.propertyIsEnumerable,y=v?v.isConcatSpreadable:void 0,w=Math.max;function x(n,t,e,r,o){var i=-1,u=n.length;e||(e=O),o||(o=[]);while(++i<u){var a=n[i];t>0&&e(a)?t>1?x(a,t-1,e,r,o):m(o,a):r||(o[o.length]=a)}return o}function S(n,t){return n=Object(n),C(n,t,(function(t,e){return e in n}))}function C(n,t,e){var r=-1,o=t.length,i={};while(++r<o){var u=t[r],a=n[u];e(a,u)&&(i[u]=a)}return i}function k(n,t){return t=w(void 0===t?n.length-1:t,0),function(){var e=arguments,r=-1,o=w(e.length-t,0),i=Array(o);while(++r<o)i[r]=e[t+r];r=-1;var u=Array(t+1);while(++r<t)u[r]=e[r];return u[t]=i,f(n,this,u)}}function O(n){return E(n)||D(n)||!!(y&&n&&n[y])}function T(n){if("string"==typeof n||N(n))return n;var t=n+"";return"0"==t&&1/n==-e?"-0":t}function D(n){return A(n)&&p.call(n,"callee")&&(!b.call(n,"callee")||h.call(n)==o)}var E=Array.isArray;function _(n){return null!=n&&B(n.length)&&!R(n)}function A(n){return I(n)&&_(n)}function R(n){var t=M(n)?h.call(n):"";return t==i||t==u}function B(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=r}function M(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function I(n){return!!n&&"object"==typeof n}function N(n){return"symbol"==typeof n||I(n)&&h.call(n)==a}var F=k((function(n,t){return null==n?{}:S(n,d(x(t,1),T))}));n.exports=F}).call(this,e("2409"))},"8b69":function(n,t){(function(){"use strict";var n=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},t=function(t){return function(e){return n(e)===t}},e=function(n){return function(t){return typeof t===n}},r=function(n){return function(t){return n===t}},o=t("string"),i=t("object"),u=t("array"),a=e("boolean"),c=r(void 0),s=function(n){return null===n||void 0===n},l=function(n){return!s(n)},f=e("function"),d=e("number"),m=function(){},g=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},p=function(n,t){return function(e){return n(t(e))}},h=function(n){return function(){return n}},v=function(n){return n};function b(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var y=function(n){return function(t){return!n(t)}},w=function(n){return function(){throw new Error(n)}},x=h(!1),S=h(!0),C=function(){return k},k=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:x,isSome:x,isNone:S,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:e,orThunk:t,map:C,each:m,bind:C,exists:x,forall:S,filter:C,equals:n,equals_:n,toArray:function(){return[]},toString:h("none()")};return r}(),O=function(n){var t=h(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:S,isNone:x,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return O(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:k},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(x,(function(t){return e(n,t)}))}};return o},T=function(n){return null===n||void 0===n?k:O(n)},D={some:O,none:C,from:T},E=Array.prototype.slice,_=Array.prototype.indexOf,A=Array.prototype.push,R=function(n,t){return _.call(n,t)},B=function(n,t){return R(n,t)>-1},M=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return!0}return!1},I=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},N=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},F=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},P=function(n,t){for(var e=n.length-1;e>=0;e--){var r=n[e];t(r,e)}},L=function(n,t){for(var e=[],r=[],o=0,i=n.length;o<i;o++){var u=n[o],a=t(u,o)?e:r;a.push(u)}return{pass:e,fail:r}},z=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},j=function(n,t,e){return P(n,(function(n){e=t(e,n)})),e},H=function(n,t,e){return F(n,(function(n){e=t(e,n)})),e},V=function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(t(i,r))return D.some(i);if(e(i,r))break}return D.none()},U=function(n,t){return V(n,t,x)},W=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return D.some(e)}return D.none()},G=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!u(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);A.apply(t,n[e])}return t},q=function(n,t){return G(N(n,t))},$=function(n,t){for(var e=0,r=n.length;e<r;++e){var o=n[e];if(!0!==t(o,e))return!1}return!0},X=function(n){var t=E.call(n,0);return t.reverse(),t},K=function(n,t){for(var e={},r=0,o=n.length;r<o;r++){var i=n[r];e[String(i)]=t(i,r)}return e},Y=function(n){return[n]},J=function(n,t){var e=E.call(n,0);return e.sort(t),e},Q=function(n,t){return t>=0&&t<n.length?D.some(n[t]):D.none()},Z=function(n){return Q(n,0)},nn=function(n){return Q(n,n.length-1)},tn=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return D.none()},en=function(){return en=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},en.apply(this,arguments)};function rn(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var on=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},un=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),s=i||u&&!c,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),f=!s&&!c&&!l;return{isiPad:h(o),isiPhone:h(i),isTablet:h(c),isPhone:h(s),isTouch:h(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:h(l),isDesktop:h(f)}},an=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}},cn=function(n,t){var e=an(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return fn(r(1),r(2))},sn=function(n,t){var e=String(t).toLowerCase();return 0===n.length?ln():cn(n,e)},ln=function(){return fn(0,0)},fn=function(n,t){return{major:n,minor:t}},dn={nu:fn,detect:sn,unknown:ln},mn=function(n,t){var e=String(t).toLowerCase();return U(n,(function(n){return n.search(e)}))},gn=function(n,t){return mn(n,t).map((function(n){var e=dn.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},pn=function(n,t){return mn(n,t).map((function(n){var e=dn.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},hn={detectBrowser:gn,detectOs:pn},vn=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},bn=function(n,t){return-1!==n.indexOf(t)},yn=function(n,t){return vn(n,t,0)},wn=function(n,t){return vn(n,t,n.length-t.length)},xn=function(n){return function(t){return t.replace(n,"")}},Sn=xn(/^\s+|\s+$/g),Cn=function(n){return n.length>0},kn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,On=function(n){return function(t){return bn(t,n)}},Tn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return bn(n,"edge/")&&bn(n,"chrome")&&bn(n,"safari")&&bn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,kn],search:function(n){return bn(n,"chrome")&&!bn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return bn(n,"msie")||bn(n,"trident")}},{name:"Opera",versionRegexes:[kn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:On("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:On("firefox")},{name:"Safari",versionRegexes:[kn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(bn(n,"safari")||bn(n,"mobile/"))&&bn(n,"applewebkit")}}],Dn=[{name:"Windows",search:On("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return bn(n,"iphone")||bn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:On("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:On("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:On("linux"),versionRegexes:[]},{name:"Solaris",search:On("sunos"),versionRegexes:[]},{name:"FreeBSD",search:On("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:On("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],En={browsers:h(Tn),oses:h(Dn)},_n="Edge",An="Chrome",Rn="IE",Bn="Opera",Mn="Firefox",In="Safari",Nn=function(){return Fn({current:void 0,version:dn.unknown()})},Fn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(_n),isChrome:r(An),isIE:r(Rn),isOpera:r(Bn),isFirefox:r(Mn),isSafari:r(In)}},Pn={unknown:Nn,nu:Fn,edge:h(_n),chrome:h(An),ie:h(Rn),opera:h(Bn),firefox:h(Mn),safari:h(In)},Ln="Windows",zn="iOS",jn="Android",Hn="Linux",Vn="OSX",Un="Solaris",Wn="FreeBSD",Gn="ChromeOS",qn=function(){return $n({current:void 0,version:dn.unknown()})},$n=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(Ln),isiOS:r(zn),isAndroid:r(jn),isOSX:r(Vn),isLinux:r(Hn),isSolaris:r(Un),isFreeBSD:r(Wn),isChromeOS:r(Gn)}},Xn={unknown:qn,nu:$n,windows:h(Ln),ios:h(zn),android:h(jn),linux:h(Hn),osx:h(Vn),solaris:h(Un),freebsd:h(Wn),chromeos:h(Gn)},Kn=function(n,t){var e=En.browsers(),r=En.oses(),o=hn.detectBrowser(e,n).fold(Pn.unknown,Pn.nu),i=hn.detectOs(r,n).fold(Xn.unknown,Xn.nu),u=un(i,o,n,t);return{browser:o,os:i,deviceType:u}},Yn={detect:Kn},Jn=function(n){return window.matchMedia(n).matches},Qn=on((function(){return Yn.detect(navigator.userAgent,Jn)})),Zn=function(){return Qn()},nt=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},tt=function(n,t){return nt(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},et=8,rt=9,ot=11,it=1,ut=3,at=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw new Error("HTML must have a single root node");return lt(r.childNodes[0])},ct=function(n,t){var e=t||document,r=e.createElement(n);return lt(r)},st=function(n,t){var e=t||document,r=e.createTextNode(n);return lt(r)},lt=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},ft=function(n,t,e){return D.from(n.dom.elementFromPoint(t,e)).map(lt)},dt={fromHtml:at,fromTag:ct,fromText:st,fromDom:lt,fromPoint:ft},mt=function(n,t){var e=n.dom;if(e.nodeType!==it)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},gt=function(n){return n.nodeType!==it&&n.nodeType!==rt&&n.nodeType!==ot||0===n.childElementCount},pt=function(n,t){var e=void 0===t?document:t.dom;return gt(e)?[]:N(e.querySelectorAll(n),dt.fromDom)},ht=function(n,t){var e=void 0===t?document:t.dom;return gt(e)?D.none():D.from(e.querySelector(n)).map(dt.fromDom)},vt=function(n,t){return n.dom===t.dom},bt=function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)},yt=function(n,t){return tt(n.dom,t.dom)},wt=function(n,t){return Zn().browser.isIE()?yt(n,t):bt(n,t)},xt=mt,St=Object.keys,Ct=Object.hasOwnProperty,kt=function(n,t){for(var e=St(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},Ot=function(n,t){return Tt(n,(function(n,e){return{k:e,v:t(n,e)}}))},Tt=function(n,t){var e={};return kt(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},Dt=function(n){return function(t,e){n[e]=t}},Et=function(n,t,e,r){var o={};return kt(n,(function(n,o){(t(n,o)?e:r)(n,o)})),o},_t=function(n,t){var e={};return Et(n,t,Dt(e),m),e},At=function(n,t){var e=[];return kt(n,(function(n,r){e.push(t(n,r))})),e},Rt=function(n){return At(n,(function(n){return n}))},Bt=function(n){return St(n).length},Mt=function(n,t){return It(n,t)?D.from(n[t]):D.none()},It=function(n,t){return Ct.call(n,t)},Nt=function(n,t){return It(n,t)&&void 0!==n[t]&&null!==n[t]},Ft=function(n){for(var t in n)if(Ct.call(n,t))return!1;return!0},Pt=["tfoot","thead","tbody","colgroup"],Lt=function(n){return B(Pt,n)},zt=function(n,t){return{rows:n,columns:t}},jt=function(n,t){return{row:n,column:t}},Ht=function(n,t,e){return{element:n,rowspan:t,colspan:e}},Vt=function(n,t,e,r){return{element:n,rowspan:t,colspan:e,isNew:r}},Ut=function(n,t,e,r,o,i){return{element:n,rowspan:t,colspan:e,row:r,column:o,isLocked:i}},Wt=function(n,t,e){return{element:n,cells:t,section:e}},Gt=function(n,t,e){return{element:n,isNew:t,isLocked:e}},qt=function(n,t,e,r){return{element:n,cells:t,section:e,isNew:r}},$t=function(n,t){return{cells:n,section:t}},Xt=function(n,t){return{details:n,section:t}},Kt=function(n,t,e,r){return{startRow:n,startCol:t,finishRow:e,finishCol:r}},Yt=function(n,t,e){return{element:n,colspan:t,column:e}},Jt=("undefined"!==typeof window?window:Function("return this;")(),function(n){var t=n.dom.nodeName;return t.toLowerCase()}),Qt=function(n){return n.dom.nodeType},Zt=function(n){return function(t){return Qt(t)===n}},ne=function(n){return Qt(n)===et||"#comment"===Jt(n)},te=Zt(it),ee=Zt(ut),re=Zt(rt),oe=Zt(ot),ie=function(n){return function(t){return te(t)&&Jt(t)===n}},ue=function(n){return dt.fromDom(n.dom.ownerDocument)},ae=function(n){return re(n)?n:ue(n)},ce=function(n){return dt.fromDom(ae(n).dom.defaultView)},se=function(n){return D.from(n.dom.parentNode).map(dt.fromDom)},le=function(n,t){var e=f(t)?t:x,r=n.dom,o=[];while(null!==r.parentNode&&void 0!==r.parentNode){var i=r.parentNode,u=dt.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},fe=function(n){return D.from(n.dom.offsetParent).map(dt.fromDom)},de=function(n){return D.from(n.dom.previousSibling).map(dt.fromDom)},me=function(n){return D.from(n.dom.nextSibling).map(dt.fromDom)},ge=function(n){return N(n.dom.childNodes,dt.fromDom)},pe=function(n,t){var e=n.dom.childNodes;return D.from(e[t]).map(dt.fromDom)},he=function(n){return pe(n,0)},ve=function(n){return oe(n)&&l(n.dom.host)},be=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),ye=h(be),we=be?function(n){return dt.fromDom(n.dom.getRootNode())}:ae,xe=function(n){var t=we(n);return ve(t)?D.some(t):D.none()},Se=function(n){return dt.fromDom(n.dom.host)},Ce=function(n){if(ye()&&l(n.target)){var t=dt.fromDom(n.target);if(te(t)&&ke(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return Z(e)}}return D.from(n.target)},ke=function(n){return l(n.dom.shadowRoot)},Oe=function(n){var t=ee(n)?n.dom.parentNode:n.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var e=t.ownerDocument;return xe(dt.fromDom(t)).fold((function(){return e.body.contains(t)}),p(Oe,Se))},Te=function(){return De(dt.fromDom(document))},De=function(n){var t=n.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return dt.fromDom(t)},Ee=function(n,t,e){return z(le(n,e),t)},_e=function(n,t){return z(ge(n),t)},Ae=function(n,t){var e=[];return F(ge(n),(function(n){t(n)&&(e=e.concat([n])),e=e.concat(Ae(n,t))})),e},Re=function(n,t,e){return Ee(n,(function(n){return mt(n,t)}),e)},Be=function(n,t){return _e(n,(function(n){return mt(n,t)}))},Me=function(n,t){return pt(t,n)};function Ie(n,t,e,r,o){return n(e,r)?D.some(e):f(o)&&o(e)?D.none():t(e,r,o)}var Ne=function(n,t,e){var r=n.dom,o=f(e)?e:x;while(r.parentNode){r=r.parentNode;var i=dt.fromDom(r);if(t(i))return D.some(i);if(o(i))break}return D.none()},Fe=function(n,t,e){var r=function(n,t){return t(n)};return Ie(r,Ne,n,t,e)},Pe=function(n,t){var e=function(n){return t(dt.fromDom(n))},r=U(n.dom.childNodes,e);return r.map(dt.fromDom)},Le=function(n,t){var e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=dt.fromDom(n.childNodes[r]);if(t(o))return D.some(o);var i=e(n.childNodes[r]);if(i.isSome())return i}return D.none()};return e(n.dom)},ze=function(n,t,e){return Ne(n,(function(n){return mt(n,t)}),e)},je=function(n,t){return Pe(n,(function(n){return mt(n,t)}))},He=function(n,t){return ht(t,n)},Ve=function(n,t,e){var r=function(n,t){return mt(n,t)};return Ie(r,ze,n,t,e)},Ue=function(n,t,e){if(!(o(e)||a(e)||d(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")},We=function(n,t,e){Ue(n.dom,t,e)},Ge=function(n,t){var e=n.dom;kt(t,(function(n,t){Ue(e,t,n)}))},qe=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},$e=function(n,t){return D.from(qe(n,t))},Xe=function(n,t){n.dom.removeAttribute(t)},Ke=function(n){return H(n.dom.attributes,(function(n,t){return n[t.name]=t.value,n}),{})},Ye=function(n){return void 0!==n.style&&f(n.style.getPropertyValue)},Je=function(n,t,e){if(!o(e))throw new Error("CSS value must be a string: "+e);Ye(n)&&n.style.setProperty(t,e)},Qe=function(n,t){Ye(n)&&n.style.removeProperty(t)},Ze=function(n,t,e){var r=n.dom;Je(r,t,e)},nr=function(n,t){var e=n.dom;kt(t,(function(n,t){Je(e,t,n)}))},tr=function(n,t){var e=n.dom,r=window.getComputedStyle(e),o=r.getPropertyValue(t);return""!==o||Oe(n)?o:er(e,t)},er=function(n,t){return Ye(n)?n.style.getPropertyValue(t):""},rr=function(n,t){var e=n.dom,r=er(e,t);return D.from(r).filter((function(n){return n.length>0}))},or=function(n,t){var e=n.dom;Qe(e,t),$e(n,"style").map(Sn).is("")&&Xe(n,"style")},ir=function(n,t){var e=n.dom,r=t.dom;Ye(e)&&Ye(r)&&(r.style.cssText=e.style.cssText)},ur=function(n,t,e){return void 0===e&&(e=0),$e(n,t).map((function(n){return parseInt(n,10)})).getOr(e)},ar=function(n,t){return ur(n,t,1)},cr=function(n){return ar(n,"colspan")>1},sr=function(n){return ar(n,"rowspan")>1},lr=function(n,t){return parseInt(tr(n,t),10)},fr=h(10),dr=h(10),mr=function(n,t){return gr(n,t,S)},gr=function(n,t,e){return q(ge(n),(function(n){return mt(n,t)?e(n)?[n]:[]:gr(n,t,e)}))},pr=function(n,t,e){if(void 0===e&&(e=x),e(t))return D.none();if(B(n,Jt(t)))return D.some(t);var r=function(n){return mt(n,"table")||e(n)};return ze(t,n.join(","),r)},hr=function(n,t){return pr(["td","th"],n,t)},vr=function(n){return mr(n,"th,td")},br=function(n){return mt(n,"colgroup")?Be(n,"col"):q(xr(n),(function(n){return Be(n,"col")}))},yr=function(n,t){return Ve(n,"table",t)},wr=function(n){return mr(n,"tr")},xr=function(n){return yr(n).fold(h([]),(function(n){return Be(n,"colgroup")}))},Sr=function(n,t){return N(n,(function(n){if("colgroup"===Jt(n)){var e=N(br(n),(function(n){var t=ur(n,"span",1);return Ht(n,1,t)}));return Wt(n,e,"colgroup")}e=N(vr(n),(function(n){var t=ur(n,"rowspan",1),e=ur(n,"colspan",1);return Ht(n,t,e)}));return Wt(n,e,t(n))}))},Cr=function(n){return se(n).map((function(n){var t=Jt(n);return Lt(t)?t:"tbody"})).getOr("tbody")},kr=function(n){var t=wr(n),e=xr(n),r=rn(e,t);return Sr(r,Cr)},Or=function(n,t){return Sr(n,(function(){return t}))},Tr=function(n,t,e){var r=n.cells,o=r.slice(0,t),i=r.slice(t),u=o.concat(e).concat(i);return _r(n,u)},Dr=function(n,t,e){return Tr(n,t,[e])},Er=function(n,t,e){var r=n.cells;r[t]=e},_r=function(n,t){return $t(t,n.section)},Ar=function(n,t){var e=n.cells,r=N(e,t);return $t(r,n.section)},Rr=function(n,t){return n.cells[t]},Br=function(n,t){return Rr(n,t).element},Mr=function(n){return n.cells.length},Ir=function(n){var t=L(n,(function(n){return"colgroup"===n.section}));return{rows:t.fail,cols:t.pass}},Nr="data-snooker-locked-cols",Fr=function(n){return $e(n,Nr).bind((function(n){return D.from(n.match(/\d+/g))})).map((function(n){return K(n,S)}))},Pr=function(n){var t=H(Ir(n).rows,(function(n,t){return F(t.cells,(function(t,e){t.isLocked&&(n[e]=!0)})),n}),{}),e=At(t,(function(n,t){return parseInt(t,10)}));return J(e)},Lr=function(n,t){return n+","+t},zr=function(n,t,e){var r=n.access[Lr(t,e)];return void 0!==r?D.some(r):D.none()},jr=function(n,t,e){var r=Hr(n,(function(n){return e(t,n.element)}));return r.length>0?D.some(r[0]):D.none()},Hr=function(n,t){var e=q(n.all,(function(n){return n.cells}));return z(e,t)},Vr=function(n){var t={},e=0;return F(n.cells,(function(n){var r=n.colspan;I(r,(function(o){var i=e+o;t[i]=Yt(n.element,r,i)})),e+=r})),t},Ur=function(n){var t={},e=[],r={},o=Z(n).map((function(n){return n.element})).bind(yr),i=o.bind(Fr).getOr({}),u=0,a=0,c=0;F(n,(function(n){if("colgroup"===n.section)r=Vr(n);else{var o=[];F(n.cells,(function(n){var e=0;while(void 0!==t[Lr(c,e)])e++;for(var r=Nt(i,e.toString()),u=Ut(n.element,n.rowspan,n.colspan,c,e,r),s=0;s<n.colspan;s++)for(var l=0;l<n.rowspan;l++){var f=c+l,d=e+s,m=Lr(f,d);t[m]=u,a=Math.max(a,d+1)}o.push(u)})),u++,e.push(Wt(n.element,o,n.section)),c++}}));var s=zt(u,a);return{grid:s,access:t,all:e,columns:r}},Wr=function(n){var t=kr(n);return Ur(t)},Gr=function(n){return q(n.all,(function(n){return n.cells}))},qr=function(n){return Rt(n.columns)},$r=function(n){return St(n.columns).length>0},Xr=function(n,t){return D.from(n.columns[t])},Kr={fromTable:Wr,generate:Ur,getAt:zr,findItem:jr,filterItems:Hr,justCells:Gr,justColumns:qr,hasColumns:$r,getColumnAt:Xr},Yr=function(n,t){var e=t.column,r=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return e<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&i>=n.startRow},Jr=function(n,t){return t.column>=n.startCol&&t.column+t.colspan-1<=n.finishCol&&t.row>=n.startRow&&t.row+t.rowspan-1<=n.finishRow},Qr=function(n,t){for(var e=!0,r=b(Jr,t),o=t.startRow;o<=t.finishRow;o++)for(var i=t.startCol;i<=t.finishCol;i++)e=e&&Kr.getAt(n,o,i).exists(r);return e?D.some(t):D.none()},Zr=function(n,t){return Kt(Math.min(n.row,t.row),Math.min(n.column,t.column),Math.max(n.row+n.rowspan-1,t.row+t.rowspan-1),Math.max(n.column+n.colspan-1,t.column+t.colspan-1))},no=function(n,t,e){var r=Kr.findItem(n,t,vt),o=Kr.findItem(n,e,vt);return r.bind((function(n){return o.map((function(t){return Zr(n,t)}))}))},to=function(n,t,e){return no(n,t,e).bind((function(t){return Qr(n,t)}))},eo=function(n,t,e,r){return Kr.findItem(n,t,vt).bind((function(t){var o=e>0?t.row+t.rowspan-1:t.row,i=r>0?t.column+t.colspan-1:t.column,u=Kr.getAt(n,o+e,i+r);return u.map((function(n){return n.element}))}))},ro=function(n,t,e){return no(n,t,e).map((function(t){var e=Kr.filterItems(n,b(Yr,t));return N(e,(function(n){return n.element}))}))},oo=function(n,t){var e=function(n,t){return wt(t,n)};return Kr.findItem(n,t,e).map((function(n){return n.element}))},io=function(n,t,e){return yr(n).bind((function(r){var o=so(r);return eo(o,n,t,e)}))},uo=function(n,t,e){var r=so(n);return ro(r,t,e)},ao=function(n,t,e,r,o){var i=so(n),u=vt(n,e)?D.some(t):oo(i,t),a=vt(n,o)?D.some(r):oo(i,r);return u.bind((function(n){return a.bind((function(t){return ro(i,n,t)}))}))},co=function(n,t,e){var r=so(n);return to(r,t,e)},so=Kr.fromTable,lo=function(n,t){var e=se(n);e.each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},fo=function(n,t){var e=me(n);e.fold((function(){var e=se(n);e.each((function(n){go(n,t)}))}),(function(n){lo(n,t)}))},mo=function(n,t){var e=he(n);e.fold((function(){go(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},go=function(n,t){n.dom.appendChild(t.dom)},po=function(n,t){lo(n,t),go(t,n)},ho=function(n,t){F(t,(function(t){lo(n,t)}))},vo=function(n,t){F(t,(function(e,r){var o=0===r?n:t[r-1];fo(o,e)}))},bo=function(n,t){F(t,(function(t){go(n,t)}))},yo=function(n){n.dom.textContent="",F(ge(n),(function(n){wo(n)}))},wo=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},xo=function(n){var t=ge(n);t.length>0&&ho(n,t),wo(n)},So=function(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return r(e).getOr("")},r=function(t){return n(t)?D.from(t.dom.nodeValue):D.none()},o=function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom.nodeValue=r};return{get:e,getOption:r,set:o}},Co=So(ee,"text"),ko=function(n){return Co.get(n)},Oo=function(n){return Co.getOption(n)},To=function(n,t){return Co.set(n,t)},Do=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Eo(){var n=function(n){return dt.fromDom(n.dom.cloneNode(!1))},t=function(n){return ae(n).dom},e=function(n){return!!te(n)&&("body"===Jt(n)||B(Do,Jt(n)))},r=function(n){return!!te(n)&&B(["br","img","hr","input"],Jt(n))},o=function(n){return te(n)&&"false"===qe(n,"contenteditable")},i=function(n,t){return n.dom.compareDocumentPosition(t.dom)},u=function(n,t){var e=Ke(n);Ge(t,e)},a=function(n){var t=Jt(n);return B(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)};return{up:h({selector:ze,closest:Ve,predicate:Ne,all:le}),down:h({selector:Me,predicate:Ae}),styles:h({get:tr,getRaw:rr,set:Ze,remove:or}),attrs:h({get:qe,set:We,remove:Xe,copyTo:u}),insert:h({before:lo,after:fo,afterAll:vo,append:go,appendAll:bo,prepend:mo,wrap:po}),remove:h({unwrap:xo,remove:wo}),create:h({nu:dt.fromTag,clone:n,text:dt.fromText}),query:h({comparePosition:i,prevSibling:de,nextSibling:me}),property:h({children:ge,name:Jt,parent:se,document:t,isText:ee,isComment:ne,isElement:te,isSpecial:a,getText:ko,setText:To,isBoundary:e,isEmptyTag:r,isNonEditable:o}),eq:vt,is:xt}}var _o=function(n,t,e,r){var o=e[0],i=e.slice(1);return r(n,t,o,i)},Ao=function(n,t,e){return e.length>0?_o(n,t,e,Ro):D.none()},Ro=function(n,t,e,r){var o=t(n,e);return j(r,(function(e,r){var o=t(n,r);return Bo(n,e,o)}),o)},Bo=function(n,t,e){return t.bind((function(t){return e.filter(b(n.eq,t))}))},Mo=function(n,t){return b(n.eq,t)},Io=function(n,t,e,r){void 0===r&&(r=x);var o=[t].concat(n.up().all(t)),i=[e].concat(n.up().all(e)),u=function(n){var t=W(n,r);return t.fold((function(){return n}),(function(t){return n.slice(0,t+1)}))},a=u(o),c=u(i),s=U(a,(function(t){return M(c,Mo(n,t))}));return{firstpath:a,secondpath:c,shared:s}},No=Ao,Fo=Io,Po=Eo(),Lo=function(n,t){return No(Po,(function(t,e){return n(e)}),t)},zo=function(n,t,e){return Fo(Po,n,t,e)},jo=function(n){return ze(n,"table")},Ho=function(n,t,e){var r=function(n){return function(t){return void 0!==e&&e(t)||vt(t,n)}};return vt(n,t)?D.some({boxes:D.some([n]),start:n,finish:t}):jo(n).bind((function(o){return jo(t).bind((function(i){if(vt(o,i))return D.some({boxes:uo(o,n,t),start:n,finish:t});if(wt(o,i)){var u=Re(t,"td,th",r(o)),a=u.length>0?u[u.length-1]:t;return D.some({boxes:ao(o,n,o,t,i),start:n,finish:a})}if(wt(i,o)){u=Re(n,"td,th",r(i));var c=u.length>0?u[u.length-1]:n;return D.some({boxes:ao(i,n,o,t,i),start:n,finish:c})}return zo(n,t).shared.bind((function(u){return Ve(u,"table",e).bind((function(e){var u=Re(t,"td,th",r(e)),a=u.length>0?u[u.length-1]:t,c=Re(n,"td,th",r(e)),s=c.length>0?c[c.length-1]:n;return D.some({boxes:ao(e,n,o,t,i),start:s,finish:a})}))}))}))}))},Vo=function(n,t){var e=Me(n,t);return e.length>0?D.some(e):D.none()},Uo=function(n,t){return U(n,(function(n){return mt(n,t)}))},Wo=function(n,t,e){return He(n,t).bind((function(t){return He(n,e).bind((function(n){return Lo(jo,[t,n]).map((function(e){return{first:t,last:n,table:e}}))}))}))},Go=function(n,t){return ze(n,"table").bind((function(e){return He(e,t).bind((function(t){return Ho(t,n).bind((function(n){return n.boxes.map((function(t){return{boxes:t,start:n.start,finish:n.finish}}))}))}))}))},qo=function(n,t,e,r,o){return Uo(n,o).bind((function(n){return io(n,t,e).bind((function(n){return Go(n,r)}))}))},$o=function(n,t){return Vo(n,t)},Xo=function(n,t,e){return Wo(n,t,e).bind((function(t){var e=function(t){return vt(n,t)},r="thead,tfoot,tbody,table",o=ze(t.first,r,e),i=ze(t.last,r,e);return o.bind((function(n){return i.bind((function(e){return vt(n,e)?co(t.table,t.first,t.last):D.none()}))}))}))},Ko=function(n){if(!u(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return F(n,(function(r,o){var i=St(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==e[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!u(c))throw new Error("case arguments must be an array");t.push(a),e[a]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(n){var r=St(n);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var o=$(t,(function(n){return B(r,n)}));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return n[a].apply(null,e)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var i=t[o];return i.apply(null,e)},match:u,log:function(n){}}}})),e},Yo={generate:Ko},Jo=Yo.generate([{none:[]},{multiple:["elements"]},{single:["element"]}]),Qo=function(n,t,e,r){return n.fold(t,e,r)},Zo=Jo.none,ni=Jo.multiple,ti=Jo.single,ei=function(n,t,e){var r=function(){return $o(n(),e).fold((function(){return t().map(ti).getOrThunk(Zo)}),(function(n){return ni(n)}))};return{get:r}},ri=tinymce.util.Tools.resolve("tinymce.PluginManager"),oi=function(n,t){return dt.fromDom(n.dom.cloneNode(t))},ii=function(n){return oi(n,!1)},ui=function(n){return oi(n,!0)},ai=function(n,t){var e=dt.fromTag(t),r=Ke(n);return Ge(e,r),e},ci=function(n,t){var e=ai(n,t),r=ge(ui(n));return bo(e,r),e},si=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},li=function(n,t,e){return n.isSome()&&t.isSome()?D.some(e(n.getOrDie(),t.getOrDie())):D.none()},fi=function(n,t){return void 0!==n&&null!==n?t(n):D.none()},di=function(n,t){return n?D.some(t):D.none()},mi=function(n,t){var e=function(t,e){if(!d(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;Ye(r)&&(r.style[n]=e+"px")},r=function(e){var r=t(e);if(r<=0||null===r){var o=tr(e,n);return parseFloat(o)||0}return r},o=r,i=function(n,t){return H(t,(function(t,e){var r=tr(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)},u=function(n,t,e){var r=i(n,e),o=t>r?t-r:0;return o};return{set:e,get:r,getOuter:o,aggregate:i,max:u}},gi=mi("width",(function(n){return n.dom.offsetWidth})),pi=function(n){return gi.get(n)},hi=function(n){return gi.getOuter(n)},vi=function(n,t){void 0===t&&(t=S);var e=n.grid,r=I(e.columns,v),o=I(e.rows,v);return N(r,(function(e){var r=function(){return q(o,(function(t){return Kr.getAt(n,t,e).filter((function(n){return n.column===e})).toArray()}))},i=function(n){return 1===n.colspan&&t(n.element)},u=function(){return Kr.getAt(n,0,e)};return bi(r,i,u)}))},bi=function(n,t,e){var r=n(),o=U(r,t),i=o.orThunk((function(){return D.from(r[0]).orThunk(e)}));return i.map((function(n){return n.element}))},yi=function(n){var t=n.grid,e=I(t.rows,v),r=I(t.columns,v);return N(e,(function(t){var e=function(){return q(r,(function(e){return Kr.getAt(n,t,e).filter((function(n){return n.row===t})).fold(h([]),(function(n){return[n]}))}))},o=function(n){return 1===n.rowspan},i=function(){return Kr.getAt(n,t,0)};return bi(e,o,i)}))},wi=function(n,t){if(t<0||t>=n.length-1)return D.none();var e=n[t].fold((function(){var e=X(n.slice(0,t));return tn(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return D.some({value:n,delta:0})})),r=n[t+1].fold((function(){var e=n.slice(t+1);return tn(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return D.some({value:n,delta:1})}));return e.bind((function(n){return r.map((function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e}))}))},xi=function(n,t){return function(e){return"rtl"===Si(e)?t:n}},Si=function(n){return"rtl"===tr(n,"direction")?"rtl":"ltr"},Ci=mi("height",(function(n){var t=n.dom;return Oe(n)?t.getBoundingClientRect().height:t.offsetHeight})),ki=function(n){return Ci.get(n)},Oi=function(n){return Ci.getOuter(n)},Ti=function(n,t){var e=function(e,r){return Ti(n+e,t+r)};return{left:n,top:t,translate:e}},Di=Ti,Ei=function(n){var t=n.getBoundingClientRect();return Di(t.left,t.top)},_i=function(n,t){return void 0!==n?n:void 0!==t?t:0},Ai=function(n){var t=n.dom.ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom)return Di(e.offsetLeft,e.offsetTop);var i=_i(null===r||void 0===r?void 0:r.pageYOffset,o.scrollTop),u=_i(null===r||void 0===r?void 0:r.pageXOffset,o.scrollLeft),a=_i(o.clientTop,e.clientTop),c=_i(o.clientLeft,e.clientLeft);return Ri(n).translate(u-c,i-a)},Ri=function(n){var t=n.dom,e=t.ownerDocument,r=e.body;return r===t?Di(r.offsetLeft,r.offsetTop):Oe(n)?Ei(t):Di(0,0)},Bi=function(n,t){return{row:n,y:t}},Mi=function(n,t){return{col:n,x:t}},Ii=function(n){var t=Ai(n);return t.left+hi(n)},Ni=function(n){return Ai(n).left},Fi=function(n,t){return Mi(n,Ni(t))},Pi=function(n,t){return Mi(n,Ii(t))},Li=function(n){return Ai(n).top},zi=function(n,t){return Bi(n,Li(t))},ji=function(n,t){return Bi(n,Li(t)+Oi(t))},Hi=function(n,t,e){if(0===e.length)return[];var r=N(e.slice(1),(function(t,e){return t.map((function(t){return n(e,t)}))})),o=e[e.length-1].map((function(n){return t(e.length-1,n)}));return r.concat([o])},Vi=function(n){return-n},Ui={delta:v,positions:function(n){return Hi(zi,ji,n)},edge:Li},Wi={delta:v,edge:Ni,positions:function(n){return Hi(Fi,Pi,n)}},Gi={delta:Vi,edge:Ii,positions:function(n){return Hi(Pi,Fi,n)}},qi=xi(Wi,Gi),$i={delta:function(n,t){return qi(t).delta(n,t)},positions:function(n,t){return qi(t).positions(n,t)},edge:function(n){return qi(n).edge(n)}},Xi={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Ki=function(){var n="[0-9]+",t="[+-]?"+n,e="[eE]"+t,r="\\.",o=function(n){return"(?:"+n+")?"},i=["Infinity",n+r+o(n)+o(e),r+n+o(e),n+o(e)].join("|"),u="[+-]?(?:"+i+")";return new RegExp("^("+u+")(.*)$")}(),Yi=function(n,t){return M(t,(function(t){return M(Xi[t],(function(t){return n===t}))}))},Ji=function(n,t){var e=D.from(Ki.exec(n));return e.bind((function(n){var e=Number(n[1]),r=n[2];return Yi(r,t)?D.some({value:e,unit:r}):D.none()}))},Qi=function(){var n=Zn().browser;return n.isIE()||n.isEdge()},Zi=function(n,t){var e=parseFloat(n);return isNaN(e)?t:e},nu=function(n,t,e){return Zi(tr(n,t),e)},tu=function(n){var t=n.dom.getBoundingClientRect().height,e=tr(n,"box-sizing");if("border-box"===e)return t;var r=nu(n,"padding-top",0),o=nu(n,"padding-bottom",0),i=nu(n,"border-top-width",0),u=nu(n,"border-bottom-width",0),a=i+u;return t-r-o-a},eu=function(n){var t=n.dom.getBoundingClientRect().width,e=tr(n,"box-sizing");if("border-box"===e)return t;var r=nu(n,"padding-left",0),o=nu(n,"padding-right",0),i=nu(n,"border-left-width",0),u=nu(n,"border-right-width",0),a=i+u;return t-r-o-a},ru=function(n){return Qi()?tu(n):nu(n,"height",ki(n))},ou=function(n){return Qi()?eu(n):nu(n,"width",pi(n))},iu=/(\d+(\.\d+)?)%/,uu=/(\d+(\.\d+)?)px|em/,au=function(n,t){var e=fe(n).getOr(De(ue(n)));return t(n)/t(e)*100},cu=function(n,t){Ze(n,"width",t+"px")},su=function(n,t){Ze(n,"width",t+"%")},lu=function(n,t){Ze(n,"height",t+"px")},fu=function(n){return rr(n,"height").getOrThunk((function(){return ru(n)+"px"}))},du=function(n,t,e,r){var o=yr(n).map((function(n){var r=e(n);return Math.floor(t/100*r)})).getOr(t);return r(n,o),o},mu=function(n,t,e,r){var o=parseInt(n,10);return wn(n,"%")&&"table"!==Jt(t)?du(t,o,e,r):o},gu=function(n){var t=fu(n);return t?mu(t,n,ki,lu):ki(n)},pu=function(n,t,e){var r=e(n),o=ar(n,t);return r/o},hu=function(n){var t=rr(n,"width");return t.fold((function(){return D.from(qe(n,"width"))}),(function(n){return D.some(n)}))},vu=function(n,t){return n/t.pixelWidth()*100},bu=function(n,t,e){var r=iu.exec(t);if(null!==r)return parseFloat(r[1]);var o=ou(n);return vu(o,e)},yu=function(n,t){var e=hu(n);return e.fold((function(){var e=pi(n);return vu(e,t)}),(function(e){return bu(n,e,t)}))},wu=function(n,t){return n/100*t.pixelWidth()},xu=function(n,t,e){var r=uu.exec(t);if(null!==r)return parseInt(r[1],10);var o=iu.exec(t);if(null!==o){var i=parseFloat(o[1]);return wu(i,e)}return ou(n)},Su=function(n,t){var e=hu(n);return e.fold((function(){return ou(n)}),(function(e){return xu(n,e,t)}))},Cu=function(n){return pu(n,"rowspan",gu)},ku=function(n){var t=hu(n);return t.bind((function(n){return Ji(n,["fixed","relative","empty"])}))},Ou=function(n,t,e){Ze(n,"width",t+e)},Tu=function(n){return pi(n)+"px"},Du=function(n){return au(n,pi)+"%"},Eu=function(n){return hu(n).exists((function(n){return iu.test(n)}))},_u=function(n){return hu(n).exists((function(n){return uu.test(n)}))},Au=function(n){return hu(n).isNone()},Ru=h(iu),Bu=h(uu),Mu=ie("col"),Iu=function(n,t,e){return rr(n,t).fold((function(){return e(n)+"px"}),(function(n){return n}))},Nu=function(n,t){var e=function(n){return Mu(n)?pi(n):Su(n,t)};return Iu(n,"width",e)},Fu=function(n){return Iu(n,"height",Cu)},Pu=function(n){return N(Kr.justColumns(n),(function(n){return D.from(n.element)}))},Lu=function(n,t){return rr(n,t).isSome()},zu=function(n){return!Mu(n)||Lu(n,"width")},ju=function(n,t,e,r,o,i){return n.filter(r).fold((function(){return i(wi(e,t))}),(function(n){return o(n)}))},Hu=function(n,t,e,r,o){var i=vi(n,(function(n){return Lu(n,"width")})),u=Kr.hasColumns(n)?Pu(n):i,a=[D.some($i.edge(t))].concat(N($i.positions(i,t),(function(n){return n.map((function(n){return n.x}))}))),c=y(cr);return N(u,(function(n,t){return ju(n,t,a,c,(function(n){if(zu(n))return e(n,o);var u=fi(i[t],v);return ju(u,t,a,c,(function(n){return r(D.some(pi(n)))}),r)}),r)}))},Vu=function(n){return n.map((function(n){return n+"px"})).getOr("")},Uu=function(n,t,e){return Hu(n,t,Nu,Vu,e)},Wu=function(n,t,e){return Hu(n,t,yu,(function(n){return n.fold((function(){return e.minCellWidth()}),(function(n){return n/e.pixelWidth()*100}))}),e)},Gu=function(n,t,e){return Hu(n,t,Su,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},qu=function(n,t,e,r,o){var i=yi(n),u=[D.some(e.edge(t))].concat(N(e.positions(i,t),(function(n){return n.map((function(n){return n.y}))})));return N(i,(function(n,t){return ju(n,t,u,y(sr),r,o)}))},$u=function(n,t,e){return qu(n,t,e,Cu,(function(n){return n.getOrThunk(dr)}))},Xu=function(n,t,e){return qu(n,t,e,Fu,Vu)},Ku=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},Yu=function(n){var t=function(){return pi(n)},e=h(0),r=function(t,e){return Gu(t,n,e)};return{width:t,pixelWidth:t,getWidths:r,getCellDelta:e,singleColumnWidth:h([0]),minCellWidth:e,setElementWidth:m,adjustTableWidth:m,isRelative:!0,label:"none"}},Ju=function(n,t){var e=Ku(parseFloat(n)),r=Ku(pi(t)),o=function(n){return n/r.get()*100},i=function(n,t){return[100-n]},u=function(){return fr()/r.get()*100},a=function(n){var o=e.get(),i=n/100*o,u=o+i;su(t,u),e.set(u),r.set(pi(t))},c=function(n,e){return Wu(n,t,e)};return{width:e.get,pixelWidth:r.get,getWidths:c,getCellDelta:o,singleColumnWidth:i,minCellWidth:u,setElementWidth:su,adjustTableWidth:a,isRelative:!0,label:"percent"}},Qu=function(n,t){var e=Ku(n),r=e.get,o=v,i=function(n,t){var e=Math.max(fr(),n+t);return[e-n]},u=function(n){var o=r()+n;cu(t,o),e.set(o)},a=function(n,e){return Gu(n,t,e)};return{width:r,pixelWidth:r,getWidths:a,getCellDelta:o,singleColumnWidth:i,minCellWidth:fr,setElementWidth:cu,adjustTableWidth:u,isRelative:!1,label:"pixel"}},Zu=function(n,t){var e=Ru().exec(t);if(null!==e)return Ju(e[1],n);var r=Bu().exec(t);if(null!==r){var o=parseInt(r[1],10);return Qu(o,n)}var i=pi(n);return Qu(i,n)},na=function(n){var t=hu(n);return t.fold((function(){return Yu(n)}),(function(t){return Zu(n,t)}))},ta={getTableSize:na,pixelSize:Qu,percentageSize:Ju,noneSize:Yu},ea=function(n,t,e,r,o,i){return{minRow:n,minCol:t,maxRow:e,maxCol:r,allCells:o,selectedCells:i}},ra=function(n,t){var e=n.grid.columns,r=n.grid.rows,o=r,i=e,u=0,a=0,c=[],s=[];return kt(n.access,(function(n){if(c.push(n),t(n)){s.push(n);var e=n.row,r=e+n.rowspan-1,l=n.column,f=l+n.colspan-1;e<o?o=e:r>u&&(u=r),l<i?i=l:f>a&&(a=f)}})),ea(o,i,u,a,c,s)},oa=function(n,t,e){var r=n[e].element,o=dt.fromTag("td");go(o,dt.fromTag("br"));var i=t?go:mo;i(r,o)},ia=function(n,t,e,r){for(var o=t.grid.columns,i=t.grid.rows,u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<e.minRow||u>e.maxRow||c<e.minCol||c>e.maxCol)){var s=Kr.getAt(t,u,c).filter(r).isNone();s?oa(n,a,u):a=!0}},ua=function(n,t,e,r){kt(e.columns,(function(n){(n.column<t.minCol||n.column>t.maxCol)&&wo(n.element)}));var o=z(mr(n,"tr"),(function(n){return 0===n.dom.childElementCount}));F(o,wo),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||F(mr(n,"th,td"),(function(n){Xe(n,"rowspan"),Xe(n,"colspan")})),Xe(n,Nr),Xe(n,"data-snooker-col-series");var i=ta.getTableSize(n);i.adjustTableWidth(r)},aa=function(n,t,e,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=Gu(t,n,e),i=H(o,(function(n,t){return n+t}),0),u=H(o.slice(r.minCol,r.maxCol+1),(function(n,t){return n+t}),0),a=u/i*e.pixelWidth(),c=a-e.pixelWidth();return e.getCellDelta(c)},ca=function(n,t){var e=function(n){return mt(n.element,t)},r=ui(n),o=kr(r),i=ta.getTableSize(n),u=Kr.generate(o),a=ra(u,e),c="th:not("+t+"),td:not("+t+")",s=gr(r,"th,td",(function(n){return mt(n,c)}));F(s,wo),ia(o,u,a,e);var l=Kr.fromTable(n),f=aa(n,l,i,a);return ua(r,a,u,f),r},sa="",la=function(n){return"img"===Jt(n)?1:Oo(n).fold((function(){return ge(n).length}),(function(n){return n.length}))},fa=function(n){return Oo(n).filter((function(n){return 0!==n.trim().length||n.indexOf(sa)>-1})).isSome()},da=["img","br"],ma=function(n){var t=fa(n);return t||B(da,Jt(n))},ga=function(n){return Le(n,ma)},pa=function(n){return ha(n,ma)},ha=function(n,t){var e=function(n){for(var r=ge(n),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return D.some(i);var u=e(i);if(u.isSome())return u}return D.none()};return e(n)},va={scope:["row","col"]},ba=function(){var n=dt.fromTag("td");return go(n,dt.fromTag("br")),n},ya=function(){return dt.fromTag("col")},wa=function(){return dt.fromTag("colgroup")},xa=function(n,t,e){var r=ci(n,t);return kt(e,(function(n,t){null===n?Xe(r,t):We(r,t,n)})),r},Sa=function(n){return n},Ca=function(n){return function(){return dt.fromTag("tr",n.dom)}},ka=function(n,t,e){var r=ga(n);return r.map((function(r){var o=e.join(","),i=Re(r,o,(function(t){return vt(t,n)}));return j(i,(function(n,t){var e=ii(t);return Xe(e,"contenteditable"),go(n,e),e}),t)})).getOr(t)},Oa=function(n,t){kt(va,(function(e,r){return $e(n,r).filter((function(n){return B(e,n)})).each((function(n){return We(t,r,n)}))}))},Ta=function(n,t,e){var r=function(n,t){ir(n.element,t),or(t,"height"),1!==n.colspan&&or(t,"width")},o=function(t){var o=ue(t.element),i=dt.fromTag(Jt(t.element),o.dom),u=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=u.length>0?ka(t.element,i,u):i;return go(a,dt.fromTag("br")),r(t,i),Oa(t.element,i),n(t.element,i),i},i=function(t){var e=ue(t.element),o=dt.fromTag(Jt(t.element),e.dom);return r(t,o),n(t.element,o),o};return{col:i,colgroup:wa,row:Ca(t),cell:o,replace:xa,gap:ba}},Da=function(n){return{col:ya,colgroup:wa,row:Ca(n),cell:ba,replace:Sa,gap:ba}},Ea=function(n,t){var e=t||document,r=e.createElement("div");return r.innerHTML=n,ge(dt.fromDom(r))},_a=function(n){return N(n,dt.fromDom)},Aa=function(n){return n.nodeName.toLowerCase()},Ra=function(n){return dt.fromDom(n.getBody())},Ba=function(n){return n.getBoundingClientRect().width},Ma=function(n){return n.getBoundingClientRect().height},Ia=function(n){return function(t){return vt(t,Ra(n))}},Na=function(n){return n?n.replace(/px$/,""):""},Fa=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Pa=function(n){Xe(n,"data-mce-style");var t=function(n){return Xe(n,"data-mce-style")};F(vr(n),t),F(br(n),t)},La=function(n,t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return D.from(e).filter(Cn)},za=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},ja=function(n){return/^(\d+(\.\d+)?)px$/.test(n)},Ha=function(n){return dt.fromDom(n.selection.getStart())},Va=function(n){return Qo(n.get(),h([]),v,Y)},Ua=function(n){var t=function(n,t){return $e(n,t).exists((function(n){return parseInt(n,10)>1}))},e=function(n){return t(n,"rowspan")||t(n,"colspan")},r=Va(n);return r.length>0&&$(r,e)?D.some(r):D.none()},Wa=function(n,t,e){return Qo(t.get(),D.none,(function(t){return t.length<=1?D.none():Xo(n,e.firstSelectedSelector,e.lastSelectedSelector).map((function(n){return{bounds:n,cells:t}}))}),D.none)},Ga="data-mce-selected",qa="td["+Ga+"],th["+Ga+"]",$a="["+Ga+"]",Xa="data-mce-first-selected",Ka="td["+Xa+"],th["+Xa+"]",Ya="data-mce-last-selected",Ja="td["+Ya+"],th["+Ya+"]",Qa=$a,Za={selected:Ga,selectedSelector:qa,firstSelected:Xa,firstSelectedSelector:Ka,lastSelected:Ya,lastSelectedSelector:Ja},nc=function(n){return{element:n,mergable:D.none(),unmergable:D.none(),selection:[n]}},tc=function(n,t,e){return{element:e,mergable:Wa(t,n,Za),unmergable:Ua(n),selection:Va(n)}},ec=function(n,t,e){return{element:n,clipboard:t,generators:e}},rc=function(n,t,e,r){return{selection:Va(n),clipboard:e,generators:r}},oc=function(n){return yr(n[0]).map((function(n){var t=ca(n,Qa);return Pa(t),[t]}))},ic=function(n,t){return N(t,(function(t){return n.selection.serializer.serialize(t.dom,{})})).join("")},uc=function(n){return N(n,(function(n){return n.dom.innerText})).join("")},ac=function(n,t,e,r){n.on("BeforeGetContent",(function(e){var r=function(t){e.preventDefault(),oc(t).each((function(t){e.content="text"===e.format?uc(t):ic(n,t)}))};!0===e.selection&&Qo(t.get(),m,r,m)})),n.on("BeforeSetContent",(function(t){if(!0===t.selection&&!0===t.paste){var o=D.from(n.dom.getParent(n.selection.getStart(),"th,td"));o.each((function(o){var i=dt.fromDom(o);yr(i).each((function(o){var u=z(Ea(t.content),(function(n){return"meta"!==Jt(n)})),a=function(n){return"table"===Jt(n)};if(1===u.length&&a(u[0])){t.preventDefault();var c=dt.fromDom(n.getDoc()),s=Da(c),l=ec(i,u[0],s);e.pasteCells(o,l).each((function(t){n.selection.setRng(t.rng),n.focus(),r.clear(o)}))}}))}))}}))},cc=Yo.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),sc=en({},cc),lc=function(n,t){return 0===n.length?sc.none():1===n.length?sc.only(0):0===t?sc.left(0,1):t===n.length-1?sc.right(t-1,t):t>0&&t<n.length-1?sc.middle(t-1,t,t+1):sc.none()},fc=function(n,t,e,r,o){var i=n.slice(0),u=lc(n,t),a=h(N(i,h(0))),c=function(n){return r.singleColumnWidth(i[n],e)},s=function(n,t){return o.calcLeftEdgeDeltas(i,n,t,e,r.minCellWidth(),r.isRelative)},l=function(n,t,u){return o.calcMiddleDeltas(i,n,t,u,e,r.minCellWidth(),r.isRelative)},f=function(n,t){return o.calcRightEdgeDeltas(i,n,t,e,r.minCellWidth(),r.isRelative)};return u.fold(a,c,s,l,f)},dc=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},mc=function(n,t){var e=Kr.justCells(n);return N(e,(function(n){var e=dc(n.column,n.column+n.colspan,t);return{element:n.element,width:e,colspan:n.colspan}}))},gc=function(n,t){var e=Kr.justColumns(n);return N(e,(function(n,e){return{element:n.element,width:t[e],colspan:n.colspan}}))},pc=function(n,t){var e=Kr.justCells(n);return N(e,(function(n){var e=dc(n.row,n.row+n.rowspan,t);return{element:n.element,height:e,rowspan:n.rowspan}}))},hc=function(n,t){return N(n.all,(function(n,e){return{element:n.element,height:t[e]}}))},vc=function(n){return j(n,(function(n,t){return n+t}),0)},bc=function(n,t){return Kr.hasColumns(n)?gc(n,t):mc(n,t)},yc=function(n,t,e){var r=bc(n,t);F(r,(function(n){e.setElementWidth(n.element,n.width)}))},wc=function(n,t,e,r,o){var i=Kr.fromTable(n),u=o.getCellDelta(t),a=o.getWidths(i,o),c=e===i.grid.columns-1,s=r.clampTableDelta(a,e,u,o.minCellWidth(),c),l=fc(a,e,s,o,r),f=N(l,(function(n,t){return n+a[t]}));yc(i,f,o),r.resizeTable(o.adjustTableWidth,s,c)},xc=function(n,t,e,r){var o=Kr.fromTable(n),i=$u(o,n,r),u=N(i,(function(n,r){return e===r?Math.max(t+n,dr()):n})),a=pc(o,u),c=hc(o,u);F(c,(function(n){lu(n.element,n.height)})),F(a,(function(n){lu(n.element,n.height)}));var s=vc(u);lu(n,s)},Sc=function(n,t,e,r,o){var i=Kr.generate(t),u=r.getWidths(i,r),a=r.pixelWidth(),c=o.calcRedestributedWidths(u,a,e.pixelDelta,r.isRelative),s=c.newSizes,l=c.delta;yc(i,s,r),r.adjustTableWidth(l)},Cc=function(n,t,e,r){var o=Kr.generate(t),i=r.getWidths(o,r);yc(o,i,r)},kc=function(n){return N(n,h(0))},Oc=function(n,t,e,r,o){return o(n.slice(0,t)).concat(r).concat(o(n.slice(e)))},Tc=function(n){return function(t,e,r,o){if(n(r)){var i=Math.max(o,t[e]-Math.abs(r)),u=Math.abs(i-t[e]);return r>=0?u:-u}return r}},Dc=Tc((function(n){return n<0})),Ec=Tc(S),_c=function(){var n=function(n,t,e,r,o){var i=Dc(n,t,r,o);return Oc(n,t,e+1,[i,0],kc)},t=function(n,t,e,r){var o=(100+e)/100,i=Math.max(r,(n[t]+e)/o);return N(n,(function(n,e){var r=e===t?i:n/o;return r-n}))},e=function(e,r,o,i,u,a){return a?t(e,r,i,u):n(e,r,o,i,u)},r=function(n,t,r,o,i,u,a){return e(n,r,o,i,u,a)},o=function(n,t){return n(t)},i=function(n,e,r,o,i,u){if(u)return t(n,r,o,i);var a=Dc(n,r,o,i);return kc(n.slice(0,r)).concat([a])},u=function(n,t,e,r){if(r){var o=t+e,i=o/t,u=N(n,(function(n){return n/i}));return{delta:100*i-100,newSizes:u}}return{delta:e,newSizes:n}};return{resizeTable:o,clampTableDelta:Dc,calcLeftEdgeDeltas:e,calcMiddleDeltas:r,calcRightEdgeDeltas:i,calcRedestributedWidths:u}},Ac=function(){var n=function(n,t,e,r,o){var i=r>=0?e:t,u=Ec(n,i,r,o);return Oc(n,t,e+1,[u,-u],kc)},t=function(t,e,r,o,i,u){return n(t,r,o,i,u)},e=function(n,t,e){e&&n(t)},r=function(n,t,e,r,o,i){if(i)return kc(n);var u=r/n.length;return N(n,h(u))},o=function(n,t,e,r,o){if(o){if(e>=0)return e;var i=H(n,(function(n,t){return n+t-r}),0);return Math.max(-i,e)}return Dc(n,t,e,r)},i=function(n,t,e,r){return{delta:0,newSizes:n}};return{resizeTable:e,clampTableDelta:o,calcLeftEdgeDeltas:n,calcMiddleDeltas:t,calcRightEdgeDeltas:r,calcRedestributedWidths:i}},Rc=function(n,t){var e=D.from(n.dom.documentElement).map(dt.fromDom).getOr(n);return{parent:h(e),view:h(n),origin:h(Di(0,0)),isResizable:t}},Bc=function(n,t,e){var r=function(){return Ai(t)};return{parent:h(t),view:h(n),origin:r,isResizable:e}},Mc=function(n,t,e){return{parent:h(t),view:h(n),origin:h(Di(0,0)),isResizable:e}},Ic={only:Rc,detached:Bc,body:Mc},Nc=Yo.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Fc=function(n,t,e){var r=e.substring(0,e.length-n.length),o=parseFloat(r);return r===o.toString()?t(o):Nc.invalid(e)},Pc=function(n){return wn(n,"%")?Fc("%",Nc.percent,n):wn(n,"px")?Fc("px",Nc.pixels,n):Nc.invalid(n)},Lc=en(en({},Nc),{from:Pc}),zc=function(n,t){return N(n,(function(n){var e=Lc.from(n);return e.fold((function(){return n}),(function(n){var e=n/t*100;return e+"%"}),(function(n){return n+"%"}))}))},jc=function(n,t,e){var r=e/t;return N(n,(function(n){var t=Lc.from(n);return t.fold((function(){return n}),(function(n){return n*r+"px"}),(function(n){return n/100*e+"px"}))}))},Hc=function(n,t){var e=n.fold((function(){return h("")}),(function(n){var e=n/t;return h(e+"px")}),(function(){var n=100/t;return h(n+"%")}));return I(t,e)},Vc=function(n,t,e){return n.fold((function(){return t}),(function(n){return jc(t,e,n)}),(function(n){return zc(t,e)}))},Uc=function(n,t,e){var r=Lc.from(e),o=$(n,(function(n){return"0px"===n}))?Hc(r,n.length):Vc(r,n,t);return $c(o)},Wc=function(n,t){return 0===n.length?t:j(n,(function(n,t){return Lc.from(t).fold(h(0),v,v)+n}),0)},Gc=function(n,t){var e=Math.floor(n);return{value:e+t,remainder:n-e}},qc=function(n,t){return Lc.from(n).fold(h(n),(function(n){return n+t+"px"}),(function(n){return n+t+"%"}))},$c=function(n){if(0===n.length)return n;var t=j(n,(function(n,t){var e=Lc.from(t).fold((function(){return{value:t,remainder:0}}),(function(n){return Gc(n,"px")}),(function(n){return{value:n+"%",remainder:0}}));return{output:[e.value].concat(n.output),remainder:n.remainder+e.remainder}}),{output:[],remainder:0}),e=t.output;return e.slice(0,e.length-1).concat([qc(e[e.length-1],Math.round(t.remainder))])},Xc=Lc.from,Kc=function(n,t,e){F(t,(function(t){var r=n.slice(t.column,t.colspan+t.column),o=Wc(r,fr());Ze(t.element,"width",o+e)}))},Yc=function(n,t,e){F(t,(function(t,r){var o=Wc([n[r]],fr());Ze(t.element,"width",o+e)}))},Jc=function(n,t,e,r){F(e,(function(t){var e=n.slice(t.row,t.rowspan+t.row),o=Wc(e,dr());Ze(t.element,"height",o+r)})),F(t,(function(t,e){Ze(t.element,"height",n[e])}))},Qc=function(n){return Xc(n).fold(h("px"),h("px"),h("%"))},Zc=function(n,t,e,r){var o=Kr.fromTable(n),i=o.all,u=Kr.justCells(o),a=Kr.justColumns(o);t.each((function(t){var e=Qc(t),i=pi(n),c=Uu(o,n,r),s=Uc(c,i,t);Kr.hasColumns(o)?Yc(s,a,e):Kc(s,u,e),Ze(n,"width",t)})),e.each((function(t){var e=Qc(t),r=ki(n),a=Xu(o,n,Ui),c=Uc(a,r,t);Jc(c,i,u,e),Ze(n,"height",t)}))},ns=Eu,ts=_u,es=Au,rs=Du,os=function(n){var t=Kr.fromTable(n);return t.grid},is=function(n){var t=[],e=function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");t.push(n)},r=function(n){t=z(t,(function(t){return t!==n}))},o=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o={};F(n,(function(n,t){o[n]=e[t]})),F(t,(function(n){n(o)}))};return{bind:e,unbind:r,trigger:o}},us=function(n){var t=Ot(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),e=Ot(n,(function(n){return n.trigger}));return{registry:t,trigger:e}},as=function(n,t){var e=null,r=function(){null!==e&&(clearTimeout(e),e=null)},o=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,r),e=null}),t)};return{cancel:r,throttle:o}},cs=function(n){return n.slice(0).sort()},ss=function(n,t){throw new Error("All required keys ("+cs(n).join(", ")+") were not specified. Specified keys were: "+cs(t).join(", ")+".")},ls=function(n){throw new Error("Unsupported keys for object: "+cs(n).join(", "))},fs=function(n,t){if(!u(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");F(t,(function(t){if(!o(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))},ds=function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+cs(n).join(", ")+") were not.")},ms=function(n){var t=cs(n),e=U(t,(function(n,e){return e<t.length-1&&n===t[e+1]}));e.each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))},gs=function(n,t){return ps(n,t,{validate:f,label:"function"})},ps=function(n,t,e){if(0===t.length)throw new Error("You must specify at least one required field.");return fs("required",t),ms(t),function(r){var o=St(r),i=$(t,(function(n){return B(o,n)}));i||ss(t,o),n(t,o);var u=z(t,(function(n){return!e.validate(r[n],n)}));return u.length>0&&ds(u,e.label),r}},hs=function(n,t){var e=z(t,(function(t){return!B(n,t)}));e.length>0&&ls(e)},vs=function(n){return gs(hs,n)},bs=vs(["compare","extract","mutate","sink"]),ys=vs(["element","start","stop","destroy"]),ws=vs(["forceDrop","drop","move","delayDrop"]),xs=function(){var n=D.none(),t=function(){n=D.none()},e=function(t,e){var r=n.map((function(n){return t.compare(n,e)}));return n=D.some(e),r},r=function(n,t){var r=t.extract(n);r.each((function(n){var r=e(t,n);r.each((function(n){o.trigger.move(n)}))}))},o=us({move:is(["info"])});return{onEvent:r,reset:t,events:o.registry}},Ss=function(){var n=us({move:is(["info"])});return{onEvent:m,reset:m,events:n.registry}},Cs=function(){var n=Ss(),t=xs(),e=n,r=function(){e.reset(),e=t},o=function(){e.reset(),e=n},i=function(n,t){e.onEvent(n,t)},u=function(){return e===t};return{on:r,off:o,isOn:u,onEvent:i,events:t.events}},ks=function(n,t,e){var r=!1,o=us({start:is([]),stop:is([])}),i=Cs(),u=function(){m.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=as(u,200),c=function(n){m.start(n),i.on(),o.trigger.start()},s=function(n){a.cancel(),i.onEvent(n,t)};i.events.move.bind((function(e){t.mutate(n,e.info)}));var l=function(){r=!0},f=function(){r=!1},d=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r&&n.apply(null,t)}},m=t.sink(ws({forceDrop:u,drop:d(u),move:d(s),delayDrop:d(a.throttle)}),e),g=function(){m.destroy()};return{element:m.element,go:c,on:l,off:f,destroy:g,events:o.registry}},Os=function(n,t,e,r,o,i,u){return{target:n,x:t,y:e,stop:r,prevent:o,kill:i,raw:u}},Ts=function(n){var t=dt.fromDom(Ce(n).getOr(n.target)),e=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=g(r,e);return Os(t,n.clientX,n.clientY,e,r,o,n)},Ds=function(n,t){return function(e){n(e)&&t(Ts(e))}},Es=function(n,t,e,r,o){var i=Ds(e,r);return n.dom.addEventListener(t,i,o),{unbind:b(As,n,t,i,o)}},_s=function(n,t,e,r){return Es(n,t,e,r,!1)},As=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},Rs=S,Bs=function(n,t,e){return _s(n,t,Rs,e)},Ms=Ts,Is=function(n,t){var e=qe(n,t);return void 0===e||""===e?[]:e.split(" ")},Ns=function(n,t,e){var r=Is(n,t),o=r.concat([e]);return We(n,t,o.join(" ")),!0},Fs=function(n,t,e){var r=z(Is(n,t),(function(n){return n!==e}));return r.length>0?We(n,t,r.join(" ")):Xe(n,t),!1},Ps=function(n){return void 0!==n.dom.classList},Ls=function(n){return Is(n,"class")},zs=function(n,t){return Ns(n,"class",t)},js=function(n,t){return Fs(n,"class",t)},Hs=function(n,t){Ps(n)?n.dom.classList.add(t):zs(n,t)},Vs=function(n){var t=Ps(n)?n.dom.classList:Ls(n);0===t.length&&Xe(n,"class")},Us=function(n,t){if(Ps(n)){var e=n.dom.classList;e.remove(t)}else js(n,t);Vs(n)},Ws=function(n,t){return Ps(n)&&n.dom.classList.contains(t)},Gs=function(n){var t=n.replace(/\./g,"-"),e=function(n){return t+"-"+n};return{resolve:e}},qs=Gs("ephox-dragster"),$s=qs.resolve,Xs=function(n){var t=en({layerClass:$s("blocker")},n),e=dt.fromTag("div");We(e,"role","presentation"),nr(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Hs(e,$s("blocker")),Hs(e,t.layerClass);var r=function(){return e},o=function(){wo(e)};return{element:r,destroy:o}},Ks=function(n,t){return Di(t.left-n.left,t.top-n.top)},Ys=function(n){return D.some(Di(n.x,n.y))},Js=function(n,t){n.mutate(t.left,t.top)},Qs=function(n,t){var e=Xs(t),r=Bs(e.element(),"mousedown",n.forceDrop),o=Bs(e.element(),"mouseup",n.drop),i=Bs(e.element(),"mousemove",n.move),u=Bs(e.element(),"mouseout",n.delayDrop),a=function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(n){go(n,e.element())},s=function(){wo(e.element())};return ys({element:e.element,start:c,stop:s,destroy:a})},Zs=bs({compare:Ks,extract:Ys,sink:Qs,mutate:Js}),nl=function(n,t){void 0===t&&(t={});var e=void 0!==t.mode?t.mode:Zs;return ks(n,e,t)},tl=function(n){return"true"===qe(n,"contenteditable")},el=function(n,t){return Ve(n,"[contenteditable]",t)},rl=Gs("ephox-snooker"),ol=rl.resolve,il=function(){var n=us({drag:is(["xDelta","yDelta"])}),t=function(t,e){n.trigger.drag(t,e)};return{mutate:t,events:n.registry}},ul=function(){var n=us({drag:is(["xDelta","yDelta","target"])}),t=D.none(),e=il();e.events.drag.bind((function(e){t.each((function(t){n.trigger.drag(e.xDelta,e.yDelta,t)}))}));var r=function(n){t=D.some(n)},o=function(){return t};return{assign:r,get:o,mutate:e.mutate,events:n.registry}},al=function(n,t,e,r,o){var i=dt.fromTag("div");return nr(i,{position:"absolute",left:t-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),Ge(i,{"data-column":n,role:"presentation"}),i},cl=function(n,t,e,r,o){var i=dt.fromTag("div");return nr(i,{position:"absolute",left:t+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),Ge(i,{"data-row":n,role:"presentation"}),i},sl=ol("resizer-bar"),ll=ol("resizer-rows"),fl=ol("resizer-cols"),dl=7,ml=function(n,t){return q(n.all,(function(n,e){return t(n.element)?[e]:[]}))},gl=function(n,t){var e=[];return I(n.grid.columns,(function(r){var o=Kr.getColumnAt(n,r).map((function(n){return n.element}));o.forall(t)&&e.push(r)})),z(e,(function(e){var r=Kr.filterItems(n,(function(n){return n.column===e}));return $(r,(function(n){return t(n.element)}))}))},pl=function(n){var t=Me(n.parent(),"."+sl);F(t,wo)},hl=function(n,t,e){var r=n.origin();F(t,(function(t){t.each((function(t){var o=e(r,t);Hs(o,sl),go(n.parent(),o)}))}))},vl=function(n,t,e,r){hl(n,t,(function(n,t){var o=al(t.col,t.x-n.left,e.top-n.top,dl,r);return Hs(o,fl),o}))},bl=function(n,t,e,r){hl(n,t,(function(n,t){var o=cl(t.row,e.left-n.left,t.y-n.top,r,dl);return Hs(o,ll),o}))},yl=function(n,t,e,r,o){var i=Ai(e),u=t.isResizable,a=r.length>0?Ui.positions(r,e):[],c=a.length>0?ml(n,u):[],s=z(a,(function(n,t){return M(c,(function(n){return t===n}))}));bl(t,s,i,hi(e));var l=o.length>0?$i.positions(o,e):[],f=l.length>0?gl(n,u):[],d=z(l,(function(n,t){return M(f,(function(n){return t===n}))}));vl(t,d,i,Oi(e))},wl=function(n,t){if(pl(n),n.isResizable(t)){var e=Kr.fromTable(t),r=yi(e),o=vi(e);yl(e,n,t,r,o)}},xl=function(n,t){var e=Me(n.parent(),"."+sl);F(e,t)},Sl=function(n){xl(n,(function(n){Ze(n,"display","none")}))},Cl=function(n){xl(n,(function(n){Ze(n,"display","block")}))},kl=function(n){return Ws(n,ll)},Ol=function(n){return Ws(n,fl)},Tl=ol("resizer-bar-dragging"),Dl=function(n){var t=ul(),e=nl(t,{}),r=D.none(),o=function(n,t){return D.from(qe(n,t))};t.events.drag.bind((function(n){o(n.target,"data-row").each((function(t){var e=lr(n.target,"top");Ze(n.target,"top",e+n.yDelta+"px")})),o(n.target,"data-column").each((function(t){var e=lr(n.target,"left");Ze(n.target,"left",e+n.xDelta+"px")}))}));var i=function(n,t){var e=lr(n,t),r=ur(n,"data-initial-"+t,0);return e-r};e.events.stop.bind((function(){t.get().each((function(t){r.each((function(e){o(t,"data-row").each((function(n){var r=i(t,"top");Xe(t,"data-initial-top"),m.trigger.adjustHeight(e,r,parseInt(n,10))})),o(t,"data-column").each((function(n){var r=i(t,"left");Xe(t,"data-initial-left"),m.trigger.adjustWidth(e,r,parseInt(n,10))})),wl(n,e)}))}))}));var u=function(r,o){m.trigger.startAdjust(),t.assign(r),We(r,"data-initial-"+o,lr(r,o)),Hs(r,Tl),Ze(r,"opacity","0.2"),e.go(n.parent())},a=Bs(n.parent(),"mousedown",(function(n){kl(n.target)&&u(n.target,"top"),Ol(n.target)&&u(n.target,"left")})),c=function(t){return vt(t,n.view())},s=function(n){return Ve(n,"table",c).filter((function(n){return el(n,c).exists(tl)}))},l=Bs(n.view(),"mouseover",(function(t){s(t.target).fold((function(){Oe(t.target)&&pl(n)}),(function(t){r=D.some(t),wl(n,t)}))})),f=function(){a.unbind(),l.unbind(),e.destroy(),pl(n)},d=function(t){wl(n,t)},m=us({adjustHeight:is(["table","delta","row"]),adjustWidth:is(["table","delta","column"]),startAdjust:is([])});return{destroy:f,refresh:d,on:e.on,off:e.off,hideBars:b(Sl,n),showBars:b(Cl,n),events:m.registry}},El=function(n,t,e){var r=Ui,o=$i,i=Dl(n),u=us({beforeResize:is(["table","type"]),afterResize:is(["table","type"]),startDrag:is([])});return i.events.adjustHeight.bind((function(n){var t=n.table;u.trigger.beforeResize(t,"row");var e=r.delta(n.delta,t);xc(t,e,n.row,r),u.trigger.afterResize(t,"row")})),i.events.startAdjust.bind((function(n){u.trigger.startDrag()})),i.events.adjustWidth.bind((function(n){var r=n.table;u.trigger.beforeResize(r,"col");var i=o.delta(n.delta,r),a=e(r);wc(r,i,n.column,t,a),u.trigger.afterResize(r,"col")})),{on:i.on,off:i.off,hideBars:i.hideBars,showBars:i.showBars,destroy:i.destroy,events:u.registry}},_l={create:El},Al=function(n,t){return n.fire("newrow",{node:t})},Rl=function(n,t){return n.fire("newcell",{node:t})},Bl=function(n,t,e,r,o){n.fire("ObjectResizeStart",{target:t,width:e,height:r,origin:o})},Ml=function(n,t,e,r,o){n.fire("ObjectResized",{target:t,width:e,height:r,origin:o})},Il=function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})},Nl=function(n){n.fire("TableSelectionClear")},Fl=function(n,t,e){n.fire("TableModified",en(en({},e),{table:t}))},Pl={structure:!1,style:!0},Ll={structure:!0,style:!1},zl="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",jl={"border-collapse":"collapse",width:"100%"},Hl=function(n){if(af(n)){var t=n.getBody().offsetWidth;return en(en({},jl),{width:t+"px"})}return cf(n)?_t(jl,(function(n,t){return"width"!==t})):jl},Vl={border:"1"},Ul="preservetable",Wl=function(n){return n.getParam("table_sizing_mode","auto")},Gl=function(n){return n.getParam("table_responsive_width")},ql=function(n){return n.getParam("table_default_attributes",Vl,"object")},$l=function(n){return n.getParam("table_default_styles",Hl(n),"object")},Xl=function(n){return n.getParam("table_resize_bars",!0,"boolean")},Kl=function(n){return n.getParam("table_tab_navigation",!0,"boolean")},Yl=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},Jl=function(n){return n.getParam("table_row_advtab",!0,"boolean")},Ql=function(n){return n.getParam("table_advtab",!0,"boolean")},Zl=function(n){return n.getParam("table_appearance_options",!0,"boolean")},nf=function(n){return n.getParam("table_grid",!0,"boolean")},tf=function(n){return n.getParam("table_style_by_css",!1,"boolean")},ef=function(n){return n.getParam("table_cell_class_list",[],"array")},rf=function(n){return n.getParam("table_row_class_list",[],"array")},of=function(n){return n.getParam("table_class_list",[],"array")},uf=function(n){return"relative"===Wl(n)||!0===Gl(n)},af=function(n){return"fixed"===Wl(n)||!1===Gl(n)},cf=function(n){return"responsive"===Wl(n)},sf=function(n){return n.getParam("table_toolbar",zl)},lf=function(n){return n.getParam("table_use_colgroups",!1,"boolean")},ff=function(n){var t="section",e=n.getParam("table_header_type",t,"string"),r=["section","cells","sectionCells","auto"];return B(r,e)?e:t},df=function(n){var t=["preservetable","resizetable"],e=n.getParam("table_column_resizing",Ul,"string");return U(t,(function(n){return n===e})).getOr(Ul)},mf=function(n){return"preservetable"===df(n)},gf=function(n){return"resizetable"===df(n)},pf=function(n){var t=n.getParam("table_clone_elements");return o(t)?D.some(t.split(/[ ,]/)):Array.isArray(t)?D.some(t):D.none()},hf=function(n){var t=n.getParam("object_resizing",!0);return o(t)?"table"===t:t},vf=function(n,t){if(uf(n)){var e=La(n,t.dom).filter(za).getOrThunk((function(){return rs(t)}));return ta.percentageSize(e,t)}return af(n)?ta.pixelSize(pi(t),t):ta.getTableSize(t)},bf=function(n){Xe(n,"width")},yf=function(n,t){var e=Du(n);Zc(n,D.some(e),D.none(),t),bf(n)},wf=function(n,t){var e=Tu(n);Zc(n,D.some(e),D.none(),t),bf(n)},xf=function(n){or(n,"width");var t=br(n),e=t.length>0?t:vr(n);F(e,(function(n){or(n,"width"),bf(n)})),bf(n)},Sf=function(n,t){var e=vf(n,t);yf(t,e)},Cf=function(n,t){var e=vf(n,t);wf(t,e)},kf=xf,Of=function(n){var t=Kr.fromTable(n);Kr.hasColumns(t)||F(vr(n),(function(n){var t=tr(n,"width");Ze(n,"width",t),Xe(n,"width")}))},Tf=function(){var n=dt.fromTag("div");return nr(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),go(Te(),n),n},Df=function(n,t){return n.inline?Ic.body(Ra(n),Tf(),t):Ic.only(dt.fromDom(n.getDoc()),t)},Ef=function(n,t){n.inline&&wo(t.parent())},_f="bar-",Af=function(n){return"false"!==qe(n,"data-mce-resize")},Rf=function(n){var t,e,r=D.none(),o=D.none(),i=D.none(),u=function(n){return"TABLE"===n.nodeName},a=function(){return o},c=function(){return i.getOr(Ic.only(dt.fromDom(n.getBody()),Af))},s=function(t){return vf(n,t)},l=function(){return mf(n)?Ac():_c()},f=function(n){return os(n).columns},d=function(r,o,i){var u=wn(o,"e");if(""===e&&Sf(n,r),i!==t&&""!==e){Ze(r,"width",e);var a=l(),c=s(r),d=mf(n)||u?f(r)-1:0;wc(r,i-t,d,a,c)}else if(za(e)){var m=parseFloat(e.replace("%","")),g=i*m/t;Ze(r,"width",g+"%")}ja(e)&&Of(r)},m=function(){o.each((function(n){n.destroy()})),i.each((function(t){Ef(n,t)}))};return n.on("init",(function(){var t=Df(n,Af);if(i=D.some(t),hf(n)&&Xl(n)){var e=l(),u=_l.create(t,e,s);u.on(),u.events.startDrag.bind((function(t){r=D.some(n.selection.getRng())})),u.events.beforeResize.bind((function(t){var e=t.table.dom;Bl(n,e,Ba(e),Ma(e),_f+t.type)})),u.events.afterResize.bind((function(t){var e=t.table,o=e.dom;Pa(e),r.each((function(t){n.selection.setRng(t),n.focus()})),Ml(n,o,Ba(o),Ma(o),_f+t.type),n.undoManager.add()})),o=D.some(u)}})),n.on("ObjectResizeStart",(function(r){var o=r.target;if(u(o)){var i=dt.fromDom(o);F(n.dom.select(".mce-clonedresizable"),(function(t){n.dom.addClass(t,"mce-"+df(n)+"-columns")})),!ts(i)&&af(n)?Cf(n,i):!ns(i)&&uf(n)&&Sf(n,i),es(i)&&yn(r.origin,_f)&&Sf(n,i),t=r.width,e=cf(n)?"":La(n,o).getOr("")}})),n.on("ObjectResized",(function(t){var e=t.target;if(u(e)){var r=dt.fromDom(e),o=t.origin;yn(o,"corner-")&&d(r,o,t.width),Pa(r),Fl(n,r.dom,Pl)}})),n.on("SwitchMode",(function(){a().each((function(t){n.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:a,lazyWire:c,destroy:m}},Bf=function(n,t){return{element:n,offset:t}},Mf=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind((function(t){return Mf(n,t,e).orThunk((function(){return D.some(t)}))})):D.none()},If=function(n,t){if(n.property().isText(t))return n.property().getText(t).length;var e=n.property().children(t);return e.length},Nf=function(n,t){var e=Mf(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return Bf(e,If(n,e));var r=n.property().children(e);return r.length>0?Nf(n,r[r.length-1]):Bf(e,If(n,e))},Ff=Nf,Pf=Eo(),Lf=function(n){return Ff(Pf,n)},zf=function(n,t){var e=ar(n,"colspan");if(1===e){var r=ku(n);r.each((function(e){var r=e.value/2;Ou(n,r,e.unit),Ou(t,r,e.unit)}))}},jf=function(n,t,e,r){e===r?Xe(n,t):We(n,t,e)},Hf=function(n,t,e){nn(Be(n,t)).fold((function(){return mo(n,e)}),(function(n){return fo(n,e)}))},Vf=function(n,t){var e=je(n,t).getOrThunk((function(){var e=dt.fromTag(t,ue(n).dom);return"thead"===t?Hf(n,"caption,colgroup",e):"colgroup"===t?Hf(n,"caption",e):go(n,e),e}));return yo(e),e},Uf=function(n,t){var e=[],r=[],o=function(n){return N(n,(function(n){n.isNew&&e.push(n.element);var t=n.element;return yo(t),F(n.cells,(function(n){n.isNew&&r.push(n.element),jf(n.element,"colspan",n.colspan,1),jf(n.element,"rowspan",n.rowspan,1),go(t,n.element)})),t}))},i=function(n){return q(n,(function(n){return N(n.cells,(function(n){return jf(n.element,"span",n.colspan,1),n.element}))}))},u=function(t,e){var r=Vf(n,e),u="colgroup"===e?i:o,a=u(t);bo(r,a)},a=function(t){je(n,t).each(wo)},c=function(n,t){n.length>0?u(n,t):a(t)},s=[],l=[],f=[],d=[];return F(t,(function(n){switch(n.section){case"thead":s.push(n);break;case"tbody":l.push(n);break;case"tfoot":f.push(n);break;case"colgroup":d.push(n);break}})),c(d,"colgroup"),c(s,"thead"),c(l,"tbody"),c(f,"tfoot"),{newRows:e,newCells:r}},Wf=function(n){return N(n,(function(n){var t=ii(n.element);return F(n.cells,(function(n){var e=ui(n.element);jf(e,"colspan",n.colspan,1),jf(e,"rowspan",n.rowspan,1),go(t,e)})),t}))},Gf=function(n,t){return N(n,(function(n){return Rr(n,t)}))},qf=function(n,t){return n[t]},$f=function(n,t){if(0===n.length)return 0;var e=n[0],r=W(n,(function(n){return!t(e.element,n.element)}));return r.fold((function(){return n.length}),(function(n){return n}))},Xf=function(n,t,e,r){var o=qf(n,t).cells.slice(e),i=$f(o,r),u=Gf(n,e).slice(t),a=$f(u,r);return{colspan:i,rowspan:a}},Kf=function(n,t){var e=N(n,(function(n){return N(n.cells,x)})),r=function(n,t,r,o){for(var i=n;i<n+r;i++)for(var u=t;u<t+o;u++)e[i][u]=!0};return N(n,(function(o,i){var u=q(o.cells,(function(o,u){if(!1===e[i][u]){var a=Xf(n,i,u,t);return r(i,u,a.rowspan,a.colspan),[Vt(o.element,a.rowspan,a.colspan,o.isNew)]}return[]}));return Xt(u,o.section)}))},Yf=function(n,t,e){var r=[];if(Kr.hasColumns(n)){var o=N(Kr.justColumns(n),(function(n){return Gt(n.element,e,!1)}));r.push($t(o,"colgroup"))}for(var i=0;i<n.grid.rows;i++){for(var u=[],a=0;a<n.grid.columns;a++){var c=Kr.getAt(n,i,a).map((function(n){return Gt(n.element,e,n.isLocked)})).getOrThunk((function(){return Gt(t.gap(),!0,!1)}));u.push(c)}var s=$t(u,n.all[i].section);r.push(s)}return r},Jf=function(n,t){return Yf(n,t,!1)},Qf=function(n,t){var e=function(n){var e=tn(n,(function(n){return se(n.element).map((function(n){var t=se(n).isNone();return Gt(n,t,!1)}))}));return e.getOrThunk((function(){return Gt(t.row(),!0,!1)}))};return N(n,(function(n){var t=e(n.details);return qt(t.element,n.details,n.section,t.isNew)}))},Zf=function(n,t){var e=Kf(n,vt);return Qf(e,t)},nd=function(n,t){return tn(n.all,(function(n){return U(n.cells,(function(n){return vt(t,n.element)}))}))},td=function(n,t,e){var r=N(t.selection,(function(t){return hr(t).bind((function(t){return nd(n,t)})).filter(e)})),o=si(r);return di(o.length>0,o)},ed=function(n,t,e,r,o){return function(i,u,a,c,s,l){var f=Kr.fromTable(u),d=t(f,a).map((function(t){var e=Jf(f,c),r=n(e,t,vt,o(c)),i=Pr(r.grid),u=Zf(r.grid,c);return{info:t,grid:u,cursor:r.cursor,lockedColumns:i}}));return d.bind((function(n){var t=Uf(u,n.grid),o=D.from(s).getOrThunk((function(){return ta.getTableSize(u)})),a=D.from(l).getOrThunk(Ac);return e(u,n.grid,n.info,o,a),r(u),wl(i,u),Xe(u,Nr),n.lockedColumns.length>0&&We(u,Nr,n.lockedColumns.join(",")),D.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})}))}},rd=function(n,t){return hr(t.element).bind((function(t){return nd(n,t)}))},od=function(n,t){return hr(t.element).bind((function(e){return nd(n,e).map((function(n){var e=en(en({},n),{generators:t.generators,clipboard:t.clipboard});return e}))}))},id=function(n,t){return td(n,t,S).map((function(n){return{cells:n,generators:t.generators,clipboard:t.clipboard}}))},ud=function(n,t){return t.mergable},ad=function(n,t){return t.unmergable},cd=function(n,t){return td(n,t,S)},sd=function(n,t){return rd(n,t).filter((function(n){return!n.isLocked}))},ld=function(n,t){return td(n,t,(function(n){return!n.isLocked}))},fd=function(n,t){return nd(n,t).exists((function(n){return!n.isLocked}))},dd=function(n,t){return $(t,(function(t){return fd(n,t)}))},md=function(n,t){return ud(n,t).filter((function(t){return dd(n,t.cells)}))},gd=function(n,t){return ad(n,t).filter((function(t){return dd(n,t)}))},pd=function(n,t,e,r){var o=Ir(n).rows;if(0===o.length)return n;for(var i=t.startRow;i<=t.finishRow;i++)for(var u=t.startCol;u<=t.finishCol;u++){var a=o[i],c=Rr(a,u).isLocked;Er(a,u,Gt(r(),!1,c))}return n},hd=function(n,t,e,r){for(var o=Ir(n).rows,i=!0,u=0;u<o.length;u++)for(var a=0;a<Mr(o[0]);a++){var c=o[u],s=Rr(c,a),l=s.element,f=e(l,t);!0===f&&!1===i?Er(c,a,Gt(r(),!0,s.isLocked)):!0===f&&(i=!1)}return n},vd=function(n,t){return H(n,(function(n,e){return M(n,(function(n){return t(n.element,e.element)}))?n:n.concat([e])}),[])},bd=function(n,t,e,r){return t>0&&t<n[0].cells.length&&F(n,(function(n){var o=n.cells[t-1],i=n.cells[t],u=e(i.element,o.element);u&&Er(n,t,Gt(r(),!0,i.isLocked))})),n},yd=function(n,t,e,r){var o=Ir(n).rows;if(t>0&&t<o.length){var i=o[t-1].cells,u=vd(i,e);F(u,(function(n){for(var i=D.none(),u=t;u<o.length;u++)for(var a=function(t){var a=o[u],c=Rr(a,t),s=e(c.element,n.element);s&&(i.isNone()&&(i=D.some(r())),i.each((function(n){Er(a,t,Gt(n,!0,c.isLocked))})))},c=0;c<Mr(o[0]);c++)a(c)}))}return n},wd=function(n){var t=function(t){return n===t},e=function(t){return wd(n)},r=function(t){return wd(n)},o=function(t){return wd(t(n))},i=function(t){return wd(n)},u=function(t){t(n)},a=function(t){return t(n)},c=function(t,e){return e(n)},s=function(t){return t(n)},l=function(t){return t(n)},f=function(){return D.some(n)};return{is:t,isValue:S,isError:x,getOr:h(n),getOrThunk:h(n),getOrDie:h(n),or:e,orThunk:r,fold:c,map:o,mapError:i,each:u,bind:a,exists:s,forall:l,toOptional:f}},xd=function(n){var t=function(n){return n()},e=function(){return w(String(n))()},r=function(n){return n},o=function(n){return n()},i=function(t){return xd(n)},u=function(t){return xd(t(n))},a=function(t){return xd(n)},c=function(t,e){return t(n)};return{is:x,isValue:x,isError:S,getOr:v,getOrThunk:t,getOrDie:e,or:r,orThunk:o,fold:c,map:i,mapError:u,each:m,bind:a,exists:x,forall:S,toOptional:D.none}},Sd=function(n,t){return n.fold((function(){return xd(t)}),wd)},Cd={value:wd,error:xd,fromOption:Sd},kd=function(n,t,e){if(n.row>=t.length||n.column>Mr(t[0]))return Cd.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=t.slice(n.row),o=r[0].cells.slice(n.column),i=Mr(e[0]),u=e.length;return Cd.value({rowDelta:r.length-u,colDelta:o.length-i})},Od=function(n,t){var e=Mr(n[0]),r=Mr(t[0]);return{rowDelta:0,colDelta:e-r}},Td=function(n,t){var e=n.length,r=t.length;return{rowDelta:e-r,colDelta:0}},Dd=function(n,t,e,r){var o="colgroup"===t.section?e.col:e.cell;return I(n,(function(n){return Gt(o(),!0,r(n))}))},Ed=function(n,t,e,r){return n.concat(I(t,(function(){var t=n[n.length-1],o=Dd(t.cells.length,t,e,(function(n){return It(r,n.toString())}));return _r(t,o)})))},_d=function(n,t,e,r){return N(n,(function(n){var o=Dd(t,n,e,x);return Tr(n,r,o)}))},Ad=function(n,t,e){return N(n,(function(n){return H(e,(function(e,r){var o=Dd(1,n,t,S)[0];return Dr(e,r,o)}),n)}))},Rd=function(n,t,e){var r=t.colDelta<0?_d:v,o=t.rowDelta<0?Ed:v,i=Pr(n),u=Mr(n[0]),a=M(i,(function(n){return n===u-1})),c=r(n,Math.abs(t.colDelta),e,a?u-1:u),s=Pr(c);return o(c,Math.abs(t.rowDelta),e,K(s,S))},Bd=function(n,t,e,r){var o=Rr(n[t],e),i=b(r,o.element),u=n[t];return n.length>1&&Mr(u)>1&&(e>0&&i(Br(u,e-1))||e<u.cells.length-1&&i(Br(u,e+1))||t>0&&i(Br(n[t-1],e))||t<n.length-1&&i(Br(n[t+1],e)))},Md=function(n,t,e,r,o,i){for(var u=n.row,a=n.column,c=e.length,s=Mr(e[0]),l=u+c,f=a+s+i.length,d=K(i,S),m=u;m<l;m++)for(var g=0,p=a;p<f;p++)if(d[p])g++;else{Bd(t,m,p,o)&&hd(t,Br(t[m],p),o,r.cell);var h=p-a-g,v=Rr(e[m-u],h),b=v.element,y=r.replace(b);Er(t[m],p,Gt(y,!0,v.isLocked))}return t},Id=function(n,t,e){var r=Mr(t[0]),o=Ir(t).cols.length+n.row,i=I(r-n.column,(function(t){return t+n.column})),u=U(i,(function(n){return $(e,(function(t){return t!==n}))})).getOr(r-1);return{row:o,column:u}},Nd=function(n,t,e){return z(e,(function(e){return e>=n.column&&e<=Mr(t[0])+n.column}))},Fd=function(n,t,e,r,o){var i=Pr(t),u=Id(n,t,i),a=Ir(e).rows,c=Nd(u,a,i),s=kd(u,t,a);return s.map((function(n){var e=en(en({},n),{colDelta:n.colDelta-c.length}),i=Rd(t,e,r),s=Pr(i),l=Nd(u,a,s);return Md(u,i,a,r,o,l)}))},Pd=function(n,t,e,r,o){bd(t,n,o,r.cell);var i=Td(e,t),u=Rd(e,i,r),a=Td(t,u),c=Rd(t,a,r);return N(c,(function(t,e){return Tr(t,n,u[e].cells)}))},Ld=function(n,t,e,r,o){yd(t,n,o,r.cell);var i=Pr(t),u=Od(t,e),a=en(en({},u),{colDelta:u.colDelta-i.length}),c=Rd(t,a,r),s=Ir(c),l=s.cols,f=s.rows,d=Pr(c),m=Od(e,t),g=en(en({},m),{colDelta:m.colDelta+d.length}),p=Ad(e,r,d),h=Rd(p,g,r);return l.concat(f.slice(0,n)).concat(h).concat(f.slice(n,f.length))},zd=function(n,t,e,r,o){var i=Ir(n),u=i.rows,a=i.cols,c=u.slice(0,t),s=u.slice(t),l=Ar(u[e],(function(n,e){var i=t>0&&t<u.length&&r(Br(u[t-1],e),Br(u[t],e)),a=i?Rr(u[t],e):Gt(o(n.element,r),!0,n.isLocked);return a}));return a.concat(c).concat([l]).concat(s)},jd=function(n,t,e,r,o,i,u){if("colgroup"!==e&&r)return Rr(n,t);var a=Rr(n,o);return Gt(u(a.element,i),!0,!1)},Hd=function(n,t,e,r,o){return N(n,(function(n){var i=t>0&&t<Mr(n)&&r(Br(n,t-1),Br(n,t)),u=jd(n,t,n.section,i,e,r,o);return Dr(n,t,u)}))},Vd=function(n,t){return q(n,(function(n){var e=n.cells,r=j(t,(function(n,t){return t>=0&&t<n.length?n.slice(0,t).concat(n.slice(t+1)):n}),e);return r.length>0?[$t(r,n.section)]:[]}))},Ud=function(n,t,e){var r=Ir(n),o=r.rows,i=r.cols;return i.concat(o.slice(0,t)).concat(o.slice(e+1))},Wd=function(n,t,e,r){var o=function(n){return M(t,(function(t){return e(n.element,t.element)}))};return N(n,(function(n){return Ar(n,(function(n){return o(n)?Gt(r(n.element,e),!0,n.isLocked):n}))}))},Gd=function(n,t,e,r){return void 0!==Br(n[t],e)&&t>0&&r(Br(n[t-1],e),Br(n[t],e))},qd=function(n,t,e){return t>0&&e(Br(n,t-1),Br(n,t))},$d=function(n,t,e,r){var o=Ir(n).rows,i=q(o,(function(r,o){var i=Gd(n,o,t,e)||qd(r,t,e);return i?[]:[Rr(r,t)]}));return Wd(n,i,e,r)},Xd=function(n,t,e,r){var o=Ir(n).rows,i=o[t],u=q(i.cells,(function(n,r){var u=Gd(o,t,r,e)||qd(i,r,e);return u?[]:[n]}));return Wd(n,u,e,r)},Kd=function(n){var t=function(n,t){var e=M(n,(function(n){return n.column===t.column}));return e?n:n.concat([t])};return H(n,t,[]).sort((function(n,t){return n.column-t.column}))},Yd=function(n){var t=ur(n,"colspan",1),e=ur(n,"rowspan",1);return{element:n,colspan:t,rowspan:e}},Jd=function(n,t){void 0===t&&(t=Yd);var e=Ku(D.none()),r=function(t){switch(Jt(t.element)){case"col":return n.col(t);default:return n.cell(t)}},o=function(n){var e=t(n);return r(e)},i=function(n){var t=o(n);return e.get().isNone()&&e.set(D.some(t)),u=D.some({item:n,replacement:t}),t},u=D.none(),a=function(n,t){return u.fold((function(){return i(n)}),(function(e){return t(n,e.item)?e.replacement:i(n)}))};return{getOrInit:a,cursor:e.get}},Qd=function(n,t){return function(e){var r=Ku(D.none()),o=[],i=function(n,t){return U(o,(function(e){return t(e.item,n)}))},u=function(i){var u={scope:n},a=e.replace(i,t,u);return o.push({item:i,sub:a}),r.get().isNone()&&r.set(D.some(a)),a},a=function(n,t){return"col"===Jt(n)?n:i(n,t).fold((function(){return u(n)}),(function(e){return t(n,e.item)?e.sub:u(n)}))};return{replaceOrInit:a,cursor:r.get}}},Zd=function(n){return $e(n,"scope").map((function(n){return n.substr(0,3)}))},nm=function(n){var t=Ku(D.none()),e=function(e){t.get().isNone()&&t.set(D.some(e));var r=Zd(e);return r.each((function(n){return We(e,"scope",n)})),function(){var t=n.cell({element:e,colspan:1,rowspan:1});return or(t,"width"),or(e,"width"),r.each((function(n){return We(t,"scope",n)})),t}},r=function(n){var t=function(){var t=si(N(n,Zd));if(0===t.length)return D.none();var e=t[0],r=["row","col"],o=M(t,(function(n){return n!==e&&B(r,n)}));return o?D.none():D.from(e)};return or(n[0],"width"),t().fold((function(){return Xe(n[0],"scope")}),(function(t){return We(n[0],"scope",t+"group")})),h(n[0])};return{unmerge:e,merge:r,cursor:t.get}},tm={modification:Jd,transform:Qd,merging:nm},em=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],rm=function(n,t){var e=n.property().name(t);return B(["ol","ul"],e)},om=function(n,t){var e=n.property().name(t);return B(em,e)},im=function(n,t){return B(["br","img","hr","input"],n.property().name(t))},um=Eo(),am=function(n){return om(um,n)},cm=function(n){return rm(um,n)},sm=function(n){return im(um,n)},lm=function(n){var t=function(n){return"br"===Jt(n)},e=function(n){return $(n,(function(n){return t(n)||ee(n)&&0===ko(n).trim().length}))},r=function(n){return"li"===Jt(n)||Ne(n,cm).isSome()},o=function(n){return me(n).map((function(n){return!!am(n)||!!sm(n)&&"img"!==Jt(n)})).getOr(!1)},i=function(n){return pa(n).bind((function(e){var i=o(e);return se(e).map((function(o){return!0===i||r(o)||t(e)||am(o)&&!vt(n,o)?[]:[dt.fromTag("br")]}))})).getOr([])},u=function(){var t=q(n,(function(n){var t=ge(n);return e(t)?[]:t.concat(i(n))}));return 0===t.length?[dt.fromTag("br")]:t},a=u();yo(n[0]),bo(n[0],a)},fm=function(n){var t=vr(n);0===t.length&&wo(n)},dm=function(n,t){return{grid:n,cursor:t}},mm=function(n,t,e){var r=Ir(n).rows;return gm(r,t,e).orThunk((function(){return gm(r,0,0)}))},gm=function(n,t,e){return D.from(n[t]).bind((function(n){return D.from(n.cells[e]).bind((function(n){return D.from(n.element)}))}))},pm=function(n,t,e){var r=Ir(n).rows;return dm(n,gm(r,t,e))},hm=function(n){var t=function(n,t){var e=M(n,(function(n){return n.row===t.row}));return e?n:n.concat([t])};return H(n,t,[]).sort((function(n,t){return n.row-t.row}))},vm=function(n,t,e,r){var o=t[0].row,i=hm(t),u=j(i,(function(n,t){var i=zd(n.grid,o,t.row+n.delta,e,r.getOrInit);return{grid:i,delta:n.delta+1}}),{grid:n,delta:0}).grid;return pm(u,o,t[0].column)},bm=function(n,t,e,r){var o=hm(t),i=o[o.length-1],u=i.row+i.rowspan,a=j(o,(function(n,t){return zd(n,u,t.row,e,r.getOrInit)}),n);return pm(a,u,t[0].column)},ym=function(n,t,e,r){var o=t.details,i=Kd(o),u=i[0].column,a=j(i,(function(n,t){var o=Hd(n.grid,u,t.column+n.delta,e,r.getOrInit);return{grid:o,delta:n.delta+1}}),{grid:n,delta:0}).grid;return pm(a,o[0].row,u)},wm=function(n,t,e,r){var o=t.details,i=o[o.length-1],u=i.column+i.colspan,a=Kd(o),c=j(a,(function(n,t){return Hd(n,u,t.column,e,r.getOrInit)}),n);return pm(c,o[0].row,u)},xm=function(n,t,e,r){var o=Xd(n,t.row,e,r.replaceOrInit);return pm(o,t.row,t.column)},Sm=function(n,t,e,r){var o=hm(t),i=function(n,t){return Xd(n,t.row,e,r.replaceOrInit)},u=H(o,i,n);return pm(u,t[0].row,t[0].column)},Cm=function(n,t,e,r){var o=$d(n,t.column,e,r.replaceOrInit);return pm(o,t.row,t.column)},km=function(n,t,e,r){var o=Kd(t),i=function(n,t){return $d(n,t.column,e,r.replaceOrInit)},u=H(o,i,n);return pm(u,t[0].row,t[0].column)},Om=function(n,t,e,r){var o=Xd(n,t.row,e,r.replaceOrInit);return pm(o,t.row,t.column)},Tm=function(n,t,e,r){var o=hm(t),i=function(n,t){return Xd(n,t.row,e,r.replaceOrInit)},u=H(o,i,n);return pm(u,t[0].row,t[0].column)},Dm=function(n,t,e,r){var o=$d(n,t.column,e,r.replaceOrInit);return pm(o,t.row,t.column)},Em=function(n,t,e,r){var o=Kd(t),i=function(n,t){return $d(n,t.column,e,r.replaceOrInit)},u=H(o,i,n);return pm(u,t[0].row,t[0].column)},_m=function(n,t,e,r){var o=Kd(t.details),i=Vd(n,N(o,(function(n){return n.column}))),u=mm(i,o[0].row,o[0].column);return dm(i,u)},Am=function(n,t,e,r){var o=hm(t),i=Ud(n,o[0].row,o[o.length-1].row),u=mm(i,t[0].row,t[0].column);return dm(i,u)},Rm=function(n,t,e,r){var o=t.cells;lm(o);var i=pd(n,t.bounds,e,r.merge(o));return dm(i,D.from(o[0]))},Bm=function(n,t,e,r){var o=function(n,t){return hd(n,t,e,r.unmerge(t))},i=j(t,o,n);return dm(i,D.from(t[0]))},Mm=function(n,t,e,r){var o=function(n,t){var e=Kr.fromTable(n);return Yf(e,t,!0)},i=o(t.clipboard,t.generators),u=jt(t.row,t.column),a=Fd(u,n,i,t.generators,e);return a.fold((function(){return dm(n,D.some(t.element))}),(function(n){var e=mm(n,t.row,t.column);return dm(n,e)}))},Im=function(n,t,e){var r=Or(n,e.section),o=Kr.generate(r);return Yf(o,t,!0)},Nm=function(n,t,e,r){var o=Ir(n).rows,i=t.cells[0].column,u=o[t.cells[0].row],a=Im(t.clipboard,t.generators,u),c=Pd(i,n,a,t.generators,e),s=mm(c,t.cells[0].row,t.cells[0].column);return dm(c,s)},Fm=function(n,t,e,r){var o=Ir(n).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,u=o[t.cells[0].row],a=Im(t.clipboard,t.generators,u),c=Pd(i,n,a,t.generators,e),s=mm(c,t.cells[0].row,t.cells[0].column);return dm(c,s)},Pm=function(n,t,e,r){var o=Ir(n).rows,i=t.cells[0].row,u=o[i],a=Im(t.clipboard,t.generators,u),c=Ld(i,n,a,t.generators,e),s=mm(c,t.cells[0].row,t.cells[0].column);return dm(c,s)},Lm=function(n,t,e,r){var o=Ir(n).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,u=o[t.cells[0].row],a=Im(t.clipboard,t.generators,u),c=Ld(i,n,a,t.generators,e),s=mm(c,t.cells[0].row,t.cells[0].column);return dm(c,s)},zm=function(n,t){var e=Kr.fromTable(n),r=cd(e,t);return r.bind((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan,i=G(N(e.all,(function(n){return z(n.cells,(function(n){return n.column>=r&&n.column<o}))})));return jm(i,(function(n){return"th"===Jt(n.element)}))})).getOr("")},jm=function(n,t){var e=z(n,t);return 0===e.length?D.some("td"):e.length===n.length?D.some("th"):D.none()},Hm=Cc,Vm=Sc,Um=function(n,t){return M(t,(function(n){return 0===n.column&&n.isLocked}))},Wm=function(n,t){return M(t,(function(t){return t.column+t.colspan>=n.grid.columns&&t.isLocked}))},Gm=function(n,t){var e=vi(n),r=Kd(t);return H(r,(function(n,t){var r=e[t.column],o=r.map(hi).getOr(0);return n+o}),0)},qm=function(n){return function(t,e){return cd(t,e).filter((function(e){var r=n?Um:Wm;return!r(t,e)})).map((function(n){return{details:n,pixelDelta:Gm(t,n)}}))}},$m=function(n,t){return ld(n,t).map((function(t){return{details:t,pixelDelta:-Gm(n,t)}}))},Xm=function(n){return function(t,e){return id(t,e).filter((function(e){var r=n?Um:Wm;return!r(t,e.cells)}))}},Km=ed(vm,cd,m,m,tm.modification),Ym=ed(bm,cd,m,m,tm.modification),Jm=ed(ym,qm(!0),Vm,m,tm.modification),Qm=ed(wm,qm(!1),Vm,m,tm.modification),Zm=ed(_m,$m,Vm,fm,tm.modification),ng=ed(Am,cd,m,fm,tm.modification),tg=(ed(Cm,sd,m,m,tm.transform("row","th")),ed(km,ld,m,m,tm.transform("row","th"))),eg=(ed(Dm,sd,m,m,tm.transform(null,"td")),ed(Em,ld,m,m,tm.transform(null,"td"))),rg=(ed(xm,rd,m,m,tm.transform("col","th")),ed(Sm,cd,m,m,tm.transform("col","th")),ed(Om,rd,m,m,tm.transform(null,"td")),ed(Tm,cd,m,m,tm.transform(null,"td")),ed(Rm,md,Hm,m,tm.merging)),og=ed(Bm,gd,Hm,m,tm.merging),ig=ed(Mm,od,Hm,m,tm.modification),ug=ed(Nm,Xm(!0),m,m,tm.modification),ag=ed(Fm,Xm(!1),m,m,tm.modification),cg=ed(Pm,id,m,m,tm.modification),sg=ed(Lm,id,m,m,tm.modification),lg=zm,fg=function(n){return Aa(n.parentNode)},dg=function(n){return"thead"===n?"header":"tfoot"===n?"footer":"body"},mg=function(n,t){var e="thead"===fg(t),r=!M(t.cells,(function(n){return"th"!==Aa(n)}));return e||r?D.some({thead:e,ths:r}):D.none()},gg=function(n,t){return dg(mg(n,t).fold((function(){return fg(t)}),(function(n){return"thead"})))},pg=function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,i=Aa(o);if(e!==i){var u=n.select(e,r)[0];if(!u){u=n.create(e);var a=r.firstChild;"thead"===e?nn(Be(dt.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(u,a)}),(function(t){return n.insertAfter(u,t.dom)})):r.appendChild(u)}"tbody"===e&&"thead"===i&&u.firstChild?u.insertBefore(t,u.firstChild):u.appendChild(t),o.hasChildNodes()||n.remove(o)}},hg=function(n,t,e){if(l(e)&&Aa(t)!==e){var r=n.dom.rename(t,e);return Rl(n,r),r}return t},vg=function(n,t,e,r){var o=n.dom,i=hg(n,t,e);return c(r)||o.setAttrib(i,"scope",r),i},bg=function(n,t,e,r){return F(t,(function(t){return vg(n,t,e,r)}))},yg=function(n,t,e){var r=function(){var e=yr(dt.fromDom(t.cells[0])).map((function(n){return wr(n)})).getOr([]);return tn(e,(function(t){return mg(n,t.dom)})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")},o=n.dom;if("header"===e){var i=ff(n),u="auto"===i?r():i;bg(n,t.cells,"section"===u?"td":"th","col"),pg(o,t,"cells"===u?"tbody":"thead")}else bg(n,t.cells,"td",null),pg(o,t,"footer"===e?"tfoot":"tbody")},wg=function(n){return yr(n).bind((function(n){return $o(n,Za.firstSelectedSelector)})).fold((function(){return n}),(function(n){return n[0]}))},xg=function(n){return function(t,e){var r=Jt(t),o="col"===r||"colgroup"===r?wg(t):t;return Ve(o,n,e)}},Sg=xg("th,td"),Cg=xg("th,td,caption"),kg=function(n,t,e){return Sg(n,e).map((function(n){return Va(t)})).getOr([])},Og=function(n,t){var e=Sg(n),r=e.bind((function(n){return yr(n)})).map((function(n){return wr(n)}));return li(e,r,(function(n,e){return z(e,(function(e){return M(_a(e.dom.cells),(function(e){return"1"===qe(e,t)||vt(e,n)}))}))})).getOr([])},Tg=function(n,t,e){var r=function(n){return"table"===Jt(Ra(n))},o=function(t){return!1===r(n)||os(t).rows>1},i=function(t){return!1===r(n)||os(t).columns>1},u=pf(n),a=gf(n)?m:zf,c=function(t,e,r,o,i){return function(a,c){Pa(a);var s=o(),l=dt.fromDom(n.getDoc()),f=Ta(r,l,u),d=vf(n,a),m=gf(n)?_c():Ac();return e(a)?t(s,a,c,f,d,m).bind((function(t){return F(t.newRows,(function(t){Al(n,t.dom)})),F(t.newCells,(function(t){Rl(n,t.dom)})),t.cursor.map((function(t){var e=Lf(t),r=n.dom.createRng();return r.setStart(e.element.dom,e.offset),r.setEnd(e.element.dom,e.offset),{rng:r,effect:i}}))})):D.none()}},s=c(ng,o,m,t,Ll),l=c(Zm,i,m,t,Ll),f=c(Km,S,m,t,Ll),d=c(Ym,S,m,t,Ll),g=c(Jm,S,a,t,Ll),p=c(Qm,S,a,t,Ll),h=c(rg,S,m,t,Ll),v=c(og,S,m,t,Ll),b=c(ug,S,m,t,Ll),y=c(ag,S,m,t,Ll),w=c(cg,S,m,t,Ll),x=c(sg,S,m,t,Ll),C=c(ig,S,m,t,Ll),k=function(n,t){return Mt(n,"type").filter((function(n){return B(t,n)}))},O=function(n,t){return k(t,["td","th"]).each((function(t){var r=N(kg(Ha(n),e),(function(n){return n.dom}));bg(n,r,t,null)}))},T=function(n,t){return k(t,["header","body","footer"]).each((function(t){N(Og(Ha(n),Za.selected),(function(e){return yg(n,e.dom,t)}))}))},E=c(tg,S,m,t,Ll),_=c(eg,S,m,t,Ll),A=function(n){var t=Og(Ha(n),Za.selected);if(t.length>0){var e=N(t,(function(t){return gg(n,t.dom)})),r=B(e,"header"),o=B(e,"footer");if(r||o){var i=B(e,"body");return!r||i||o?r||i||!o?"":"footer":"header"}return"body"}},R=function(n){return jm(kg(Ha(n),e),(function(n){return"th"===Jt(n)})).getOr("")},M=lg;return{deleteRow:s,deleteColumn:l,insertRowsBefore:f,insertRowsAfter:d,insertColumnsBefore:g,insertColumnsAfter:p,mergeCells:h,unmergeCells:v,pasteColsBefore:b,pasteColsAfter:y,pasteRowsBefore:w,pasteRowsAfter:x,pasteCells:C,setTableCellType:O,setTableRowType:T,makeColumnsHeader:E,unmakeColumnsHeader:_,getTableRowType:A,getTableCellType:R,getTableColType:M}},Dg={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Eg=function(){return dt.fromTag("th")},_g=function(){return dt.fromTag("td")},Ag=function(){return dt.fromTag("col")},Rg=function(n,t,e,r){for(var o=dt.fromTag("tr"),i=0;i<n;i++){var u=r<t||i<e?Eg():_g();i<e&&We(u,"scope","row"),r<t&&We(u,"scope","col"),go(u,dt.fromTag("br")),go(o,u)}return o},Bg=function(n){var t=dt.fromTag("colgroup");return I(n,(function(){return go(t,Ag())})),t},Mg=function(n,t,e,r){return I(n,(function(n){return Rg(t,e,r,n)}))},Ig=function(n,t,e,r,o,i){void 0===i&&(i=Dg);var u=dt.fromTag("table"),a="cells"!==o;nr(u,i.styles),Ge(u,i.attributes),i.colGroups&&go(u,Bg(t));var c=Math.min(n,e);if(a&&e>0){var s=dt.fromTag("thead");go(u,s);var l="sectionCells"===o?c:0,f=Mg(e,t,l,r);bo(s,f)}var d=dt.fromTag("tbody");go(u,d);var m=a?n-c:n,g=a?0:e,p=Mg(m,t,g,r);return bo(d,p),u},Ng=function(n){return n.dom.innerHTML},Fg=function(n){var t=dt.fromTag("div"),e=dt.fromDom(n.dom.cloneNode(!0));return go(t,e),Ng(t)},Pg=function(n,t){n.selection.select(t.dom,!0),n.selection.collapse(!0)},Lg=function(n,t){He(t,"td,th").each(b(Pg,n))},zg=function(n,t){F(Me(t,"tr"),(function(t){Al(n,t.dom),F(Me(t,"th,td"),(function(t){Rl(n,t.dom)}))}))},jg=function(n){return o(n)&&-1!==n.indexOf("%")},Hg=function(n,t,e,r,o){var i=$l(n),u={styles:i,attributes:ql(n),colGroups:lf(n)};return n.undoManager.ignore((function(){var i=Ig(e,t,o,r,ff(n),u);We(i,"data-mce-id","__mce");var a=Fg(i);n.insertContent(a),n.addVisual()})),He(Ra(n),'table[data-mce-id="__mce"]').map((function(t){return af(n)?Cf(n,t):cf(n)?kf(t):(uf(n)||jg(i.width))&&Sf(n,t),Pa(t),Xe(t,"data-mce-id"),zg(n,t),Lg(n,t),t.dom})).getOr(null)},Vg=function(n,t,e,r,o){void 0===r&&(r={});var i=function(n){return d(n)&&n>0};if(i(t)&&i(e)){var u=r.headerRows||0,a=r.headerColumns||0;return Hg(n,e,t,a,u)}return null},Ug=function(n){return function(){return n().fold((function(){return[]}),(function(n){return N(n,(function(n){return n.dom}))}))}},Wg=function(n){return function(t){var e=t.length>0?D.some(_a(t)):D.none();n(e)}},Gg=function(n){return function(t,e,r){void 0===r&&(r={});var o=Vg(n,e,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return n.undoManager.add(),o}},qg=function(n,t,e,r){return{insertTable:Gg(n),setClipboardRows:Wg(t.setRows),getClipboardRows:Ug(t.getRows),setClipboardCols:Wg(t.setColumns),getClipboardCols:Ug(t.getColumns),resizeHandler:e,selectionTargets:r}},$g=function(n,t,e){var r=ur(n,t,1);1===e||r<=1?Xe(n,t):We(n,t,Math.min(e,r))},Xg=function(n,t,e){if(Kr.hasColumns(n)){var r=z(Kr.justColumns(n),(function(n){return n.column>=t&&n.column<e})),o=N(r,(function(n){var r=ui(n.element);return $g(r,"span",e-t),r})),i=dt.fromTag("colgroup");return bo(i,o),[i]}return[]},Kg=function(n,t,e){return N(n.all,(function(n){var r=z(n.cells,(function(n){return n.column>=t&&n.column<e})),o=N(r,(function(n){var r=ui(n.element);return $g(r,"colspan",e-t),r})),i=dt.fromTag("tr");return bo(i,o),i}))},Yg=function(n,t){var e=Kr.fromTable(n),r=ld(e,t);return r.map((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan,i=Xg(e,r,o),u=Kg(e,r,o);return rn(i,u)}))},Jg=function(n,t,e){var r=Kr.fromTable(n),o=cd(r,t);return o.bind((function(n){var t=Yf(r,e,!1),o=Ir(t).rows,i=o.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),u=q(i,(function(n){var t=z(n.cells,(function(n){return!n.isLocked}));return t.length>0?[en(en({},n),{cells:t})]:[]})),a=Zf(u,e);return di(a.length>0,a)})).map((function(n){return Wf(n)}))},Qg=tinymce.util.Tools.resolve("tinymce.util.Tools"),Zg=function(n,t,e){var r,o=n.select("td,th",t),i=function(t,r){for(var o=0;o<r.length;o++){var i=n.getStyle(r[o],e);if("undefined"===typeof t&&(t=i),t!==i)return""}return t};return i(r,o)},np=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},tp=function(n,t,e){e&&n.formatter.apply("valign"+e,{},t)},ep=function(n,t){Qg.each("left center right".split(" "),(function(e){n.formatter.remove("align"+e,{},t)}))},rp=function(n,t){Qg.each("top middle bottom".split(" "),(function(e){n.formatter.remove("valign"+e,{},t)}))},op=function(n){return Nt(n,"menu")},ip=function(n,t){var e=function(n,t){return t.concat(N(n,(function(n){var t=n.text||n.title;return op(n)?{text:t,items:ip(n.menu)}:{text:t,value:n.value}})))};return e(n,t||[])},up=function(n){return function(t){return yn(t,"rgb")?n.toHex(t):t}},ap=function(n,t){var e=dt.fromDom(t);return{borderwidth:rr(e,"border-width").getOr(""),borderstyle:rr(e,"border-style").getOr(""),bordercolor:rr(e,"border-color").map(up(n)).getOr(""),backgroundcolor:rr(e,"background-color").map(up(n)).getOr("")}},cp=function(n){var t=n[0],e=n.slice(1);return F(e,(function(n){F(St(t),(function(e){kt(n,(function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")}))}))})),t},sp=function(n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],e={name:"borderwidth",type:"input",label:"Border width"},r="cell"===n?[e].concat(t):t;return{title:"Advanced",name:"advanced",items:r}},lp=function(n,t,e,r){return U(n,(function(n){return e.formatter.matchNode(r,t+n)})).getOr("")},fp=b(lp,["left","center","right"],"align"),dp=b(lp,["top","middle","bottom"],"valign"),mp=function(n,t){var e=$l(n),r=ql(n),o=function(n){return{borderstyle:Mt(e,"border-style").getOr(""),bordercolor:up(n)(Mt(e,"border-color").getOr("")),backgroundcolor:up(n)(Mt(e,"background-color").getOr(""))}},i={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},u=function(){var t=e["border-width"];return tf(n)&&t?{border:t}:Mt(r,"border").fold((function(){return{}}),(function(n){return{border:n}}))},a=t?o(n.dom):{},c=function(){var n=Mt(e,"border-spacing").or(Mt(r,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),t=Mt(e,"border-padding").or(Mt(r,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}}));return en(en({},n),t)},s=en(en(en(en(en(en({},i),e),r),a),u()),c());return s},gp=function(n,t,e){var r=function(t,e){var r=rr(dt.fromDom(e),"border-width");return tf(n)&&r.isSome()?r.getOr(""):t.getAttrib(e,"border")||Zg(n.dom,e,"border-width")||Zg(n.dom,e,"border")},o=n.dom;return en({width:o.getStyle(t,"width")||o.getAttrib(t,"width"),height:o.getStyle(t,"height")||o.getAttrib(t,"height"),cellspacing:o.getStyle(t,"border-spacing")||o.getAttrib(t,"cellspacing"),cellpadding:o.getAttrib(t,"cellpadding")||Zg(n.dom,t,"padding"),border:r(o,t),caption:!!o.select("caption",t)[0],class:o.getAttrib(t,"class",""),align:fp(n,t)},e?ap(o,t):{})},pp=function(n,t,e){var r=n.dom;return en({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),class:r.getAttrib(t,"class",""),type:gg(n,t),align:fp(n,t)},e?ap(r,t):{})},hp=function(n,t,e,r){var o=n.dom,i=r.getOr(t),u=function(n,t){return o.getStyle(n,t)||o.getAttrib(n,t)};return en({width:u(i,"width"),height:u(t,"height"),scope:o.getAttrib(t,"scope"),celltype:Aa(t),class:o.getAttrib(t,"class",""),halign:fp(n,t),valign:dp(n,t)},e?ap(o,t):{})},vp=function(n){var t=ip(ef(n));return t.length>0?D.some({name:"class",type:"listbox",label:"Class",items:t}):D.none()},bp=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],yp=function(n){return bp.concat(vp(n).toArray())},wp=function(n){return function(t,e){var r=t.dom,o=function(t,o){n&&!o||r.setAttrib(e,t,o)},i=function(t,o){n&&!o||r.setStyle(e,t,o)},u=function(r,o){n&&!o||(""===o?t.formatter.remove(r,{value:null},e,!0):t.formatter.apply(r,{value:o},e))};return{setAttrib:o,setStyle:i,setFormat:u}}},xp={normal:wp(!1),ifTruthy:wp(!0)},Sp=function(n){return yr(n[0]).map((function(t){var e=Kr.fromTable(t),r=Kr.justCells(e),o=z(r,(function(t){return M(n,(function(n){return vt(t.element,n)}))}));return N(o,(function(n){return{element:n.element.dom,column:Kr.getColumnAt(e,n.column).map((function(n){return n.element.dom}))}}))}))},Cp=function(n,t,e){n.setAttrib("scope",e.scope),n.setAttrib("class",e.class),n.setStyle("height",Fa(e.height)),t.setStyle("width",Fa(e.width))},kp=function(n,t){n.setFormat("tablecellbackgroundcolor",t.backgroundcolor),n.setFormat("tablecellbordercolor",t.bordercolor),n.setFormat("tablecellborderstyle",t.borderstyle),n.setFormat("tablecellborderwidth",Fa(t.borderwidth))},Op=function(n,t,e,r){var o=1===t.length,i=_t(r,(function(n,t){return e[t]!==n}));if(Bt(i)>0&&t.length>=1){var u=yr(t[0]);Sp(t).each((function(t){F(t,(function(t){var e=vg(n,t.element,r.celltype),i=o?xp.normal(n,e):xp.ifTruthy(n,e),u=t.column.map((function(t){return o?xp.normal(n,t):xp.ifTruthy(n,t)})).getOr(i);Cp(i,u,r),Yl(n)&&kp(i,r),o&&(ep(n,e),rp(n,e)),r.halign&&np(n,e,r.halign),r.valign&&tp(n,e,r.valign)}))}));var a=Bt(_t(i,(function(n,t){return"scope"!==t&&"celltype"!==t})))>0;u.each((function(t){return Fl(n,t.dom,{structure:It(i,"celltype"),style:a})}))}},Tp=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){Op(n,t,e,o),n.focus()}))},Dp=function(n,t){var e=Sp(t).map((function(t){return N(t,(function(t){return hp(n,t.element,Yl(n),t.column)}))}));return cp(e.getOrDie())},Ep=function(n,t){var e=kg(Ha(n),t);if(0!==e.length){var r=Dp(n,e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:yp(n)},sp("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:yp(n)}]};n.windowManager.open({title:"Cell Properties",size:"normal",body:Yl(n)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:b(Tp,n,e,r)})}},_p=function(n){var t=ip(rf(n));return t.length>0?D.some({name:"class",type:"listbox",label:"Class",items:t}):D.none()},Ap=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Rp=function(n){return Ap.concat(_p(n).toArray())},Bp=function(n,t){n.setAttrib("class",t.class),n.setStyle("height",Fa(t.height))},Mp=function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle)},Ip=function(n,t,e,r){var o=1===t.length,i=_t(r,(function(n,t){return e[t]!==n}));if(Bt(i)>0){F(t,(function(t){r.type!==Aa(t.parentNode)&&yg(n,t,r.type);var i=o?xp.normal(n,t):xp.ifTruthy(n,t);Bp(i,r),Jl(n)&&Mp(i,r),r.align!==e.align&&(ep(n,t),np(n,t,r.align))}));var u=It(i,"type"),a=!u||Bt(i)>1;yr(dt.fromDom(t[0])).each((function(t){return Fl(n,t.dom,{structure:u,style:a})}))}},Np=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){Ip(n,t,e,o),n.focus()}))},Fp=function(n){var t=Og(Ha(n),Za.selected);if(0!==t.length){var e=N(t,(function(t){return pp(n,t.dom,Jl(n))})),r=cp(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Rp(n)},sp("row")]},i={type:"panel",items:[{type:"grid",columns:2,items:Rp(n)}]};n.windowManager.open({title:"Row Properties",size:"normal",body:Jl(n)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:b(Np,n,N(t,(function(n){return n.dom})),r)})}},Pp=tinymce.util.Tools.resolve("tinymce.Env"),Lp=function(n,t,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],i=Zl(n)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],a=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat(o).concat(i).concat(u).concat(a)},zp=function(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)o(e)?n.setStyle(t,e,r):n.setStyle(t,e);else if(t.children)for(var i=0;i<t.children.length;i++)zp(n,t.children[i],e,r)},jp=function(n,t,e){var r=n.dom,o={},i={};if(o.class=e.class,i.height=Fa(e.height),r.getAttrib(t,"width")&&!tf(n)?o.width=Na(e.width):i.width=Fa(e.width),tf(n)?(i["border-width"]=Fa(e.border),i["border-spacing"]=Fa(e.cellspacing)):(o.border=e.border,o.cellpadding=e.cellpadding,o.cellspacing=e.cellspacing),tf(n)&&t.children)for(var u=0;u<t.children.length;u++)zp(r,t.children[u],{"border-width":Fa(e.border),padding:Fa(e.cellpadding)}),Ql(n)&&zp(r,t.children[u],{"border-color":e.bordercolor});Ql(n)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),o.style=r.serializeStyle(en(en({},$l(n)),i)),r.setAttribs(t,en(en({},ql(n)),o))},Hp=function(n,t,e,r){var o,i=n.dom,u=r.getData(),a=_t(u,(function(n,t){return e[t]!==n}));r.close(),""===u.class&&delete u.class,n.undoManager.transact((function(){if(!t){var e=parseInt(u.cols,10)||1,r=parseInt(u.rows,10)||1;t=Hg(n,e,r,0,0)}if(Bt(a)>0&&(jp(n,t,u),o=i.select("caption",t)[0],o&&!u.caption&&i.remove(o),!o&&u.caption&&(o=i.create("caption"),o.innerHTML=Pp.ie?sa:'<br data-mce-bogus="1"/>',t.insertBefore(o,t.firstChild)),""===u.align?ep(n,t):np(n,t,u.align)),n.focus(),n.addVisual(),Bt(a)>0){var c=It(a,"caption"),s=!c||Bt(a)>1;Fl(n,t,{structure:c,style:s})}}))},Vp=function(n,t){var e,r=n.dom,o=mp(n,Ql(n));!1===t?(e=r.getParent(n.selection.getStart(),"table",n.getBody()),e?o=gp(n,e,Ql(n)):Ql(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor="")):(o.cols="1",o.rows="1",Ql(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=ip(of(n));i.length>0&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var u={type:"grid",columns:2,items:Lp(n,i,t)},a=function(){return{type:"panel",items:[u]}},c=function(){return{type:"tabpanel",tabs:[{title:"General",name:"general",items:[u]},sp("table")]}},s=Ql(n)?c():a();n.windowManager.open({title:"Table Properties",size:"normal",body:s,onSubmit:b(Hp,n,e,o),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Up=function(n){return Cg(Ha(n),Ia(n))},Wp=function(n){return Sg(Ha(n),Ia(n))},Gp=function(n,t,e,r,u){var a=Ia(n),c=function(){return Up(n).each((function(t){yr(t,a).filter(y(a)).each((function(t){var e=dt.fromText("");if(fo(t,e),wo(t),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{var r=n.dom.createRng();r.setStart(e.dom,0),r.setEnd(e.dom,0),n.selection.setRng(r),n.nodeChanged()}}))}))},s=function(t){return Up(n).each((function(e){var r=cf(n)||af(n)||uf(n);r||yr(e,a).each((function(e){"relative"!==t||ns(e)?"fixed"!==t||ts(e)?"responsive"!==t||es(e)||kf(e):Cf(n,e):Sf(n,e),Pa(e),Fl(n,e.dom,Ll)}))}))},l=function(n){return yr(n,a)},f=function(t){return function(r){n.selection.setRng(r.rng),n.focus(),e.clear(t),Pa(t),Fl(n,t.dom,r.effect)}},d=function(t){return Wp(n).each((function(n){l(n).each((function(e){var o=tc(r,e,n);t(e,o).each(f(e))}))}))},g=function(){return Wp(n).map((function(t){return l(t).bind((function(e){var o=tc(r,e,t),i=Ta(m,dt.fromDom(n.getDoc()),D.none());return Jg(e,o,i)}))}))},p=function(){return Wp(n).map((function(n){return l(n).bind((function(t){var e=tc(r,t,n);return Yg(t,e)}))}))},h=function(t,e){return e().each((function(e){var o=N(e,(function(n){return ui(n)}));Wp(n).each((function(e){return l(e).each((function(i){var u=Da(dt.fromDom(n.getDoc())),a=rc(r,e,o,u);t(i,a).each(f(i))}))}))}))};kt({mceTableSplitCells:function(){return d(t.unmergeCells)},mceTableMergeCells:function(){return d(t.mergeCells)},mceTableInsertRowBefore:function(){return d(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return d(t.insertRowsAfter)},mceTableInsertColBefore:function(){return d(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return d(t.insertColumnsAfter)},mceTableDeleteCol:function(){return d(t.deleteColumn)},mceTableDeleteRow:function(){return d(t.deleteRow)},mceTableCutCol:function(n){return p().each((function(n){u.setColumns(n),d(t.deleteColumn)}))},mceTableCutRow:function(n){return g().each((function(n){u.setRows(n),d(t.deleteRow)}))},mceTableCopyCol:function(n){return p().each((function(n){return u.setColumns(n)}))},mceTableCopyRow:function(n){return g().each((function(n){return u.setRows(n)}))},mceTablePasteColBefore:function(n){return h(t.pasteColsBefore,u.getColumns)},mceTablePasteColAfter:function(n){return h(t.pasteColsAfter,u.getColumns)},mceTablePasteRowBefore:function(n){return h(t.pasteRowsBefore,u.getRows)},mceTablePasteRowAfter:function(n){return h(t.pasteRowsAfter,u.getRows)},mceTableDelete:c,mceTableSizingMode:function(n,t){return s(t)}},(function(t,e){return n.addCommand(e,t)}));var v=function(n,t){t.each((function(t){Fl(n,t.dom,Ll)}))};kt({mceTableCellType:function(e,r){var o=yr(Ha(n),a);t.setTableCellType(n,r),v(n,o)},mceTableRowType:function(e,r){var o=yr(Ha(n),a);t.setTableRowType(n,r),v(n,o)}},(function(t,e){return n.addCommand(e,t)})),n.addCommand("mceTableColType",(function(n,e){return Mt(e,"type").each((function(n){return d("th"===n?t.makeColumnsHeader:t.unmakeColumnsHeader)}))})),kt({mceTableProps:b(Vp,n,!1),mceTableRowProps:b(Fp,n),mceTableCellProps:b(Ep,n,r)},(function(t,e){return n.addCommand(e,(function(){return t()}))})),n.addCommand("mceInsertTable",(function(t,e){i(e)&&St(e).length>0?Vg(n,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Vp(n,!0)})),n.addCommand("mceTableApplyCellStyle",(function(t,e){var u=function(n){return"tablecell"+n.toLowerCase().replace("-","")};if(i(e)){var c=kg(Ha(n),r,a);if(0!==c.length){var s=_t(e,(function(t,e){return n.formatter.has(u(e))&&o(t)}));Ft(s)||(kt(s,(function(t,e){F(c,(function(r){xp.normal(n,r.dom).setFormat(u(e),t)}))})),l(c[0]).each((function(t){return Fl(n,t.dom,Pl)})))}}}))},qp=function(n,t,e){var r=Ia(n),o=function(n){return yr(n,r)};kt({mceTableRowType:function(){return t.getTableRowType(n)},mceTableCellType:function(){return t.getTableCellType(n)},mceTableColType:function(){return Sg(Ha(n)).bind((function(n){return o(n).map((function(r){var o=tc(e,r,n);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,e){return n.addQueryValueHandler(e,t)}))},$p=function(){var n=Ku(D.none()),t=Ku(D.none()),e=function(n){n.set(D.none())};return{getRows:n.get,setRows:function(r){n.set(r),e(t)},clearRows:function(){return e(n)},getColumns:t.get,setColumns:function(r){t.set(r),e(n)},clearColumns:function(){return e(t)}}},Xp={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Kp=function(n){n.formatter.register(Xp)},Yp=Yo.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Jp=function(n){return void 0===n&&(n=void 0),Yp.none(n)},Qp=en(en({},Yp),{none:Jp}),Zp=function(n,t){return yr(n,t).bind((function(t){var e=vr(t),r=W(e,(function(t){return vt(n,t)}));return r.map((function(n){return{index:n,all:e}}))}))},nh=function(n,t){var e=Zp(n,t);return e.fold((function(){return Qp.none(n)}),(function(t){return t.index+1<t.all.length?Qp.middle(n,t.all[t.index+1]):Qp.last(n)}))},th=function(n,t){var e=Zp(n,t);return e.fold((function(){return Qp.none()}),(function(t){return t.index-1>=0?Qp.middle(n,t.all[t.index-1]):Qp.first(n)}))},eh=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},rh={create:eh},oh=Yo.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ih=function(n,t,e,r){return n.fold(t,e,r)},uh=function(n){return n.fold(v,v,v)},ah=oh.before,ch=oh.on,sh=oh.after,lh={before:ah,on:ch,after:sh,cata:ih,getStart:uh},fh=Yo.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),dh=function(n){return fh.exact(n.start,n.soffset,n.finish,n.foffset)},mh=function(n){return n.match({domRange:function(n){return dt.fromDom(n.startContainer)},relative:function(n,t){return lh.getStart(n)},exact:function(n,t,e,r){return n}})},gh=fh.domRange,ph=fh.relative,hh=fh.exact,vh=function(n){var t=mh(n);return ce(t)},bh=rh.create,yh={domRange:gh,relative:ph,exact:hh,exactFromRange:dh,getWin:vh,range:bh},wh=function(n,t){var e=n.document.createRange();return xh(e,t),e},xh=function(n,t){return n.selectNodeContents(t.dom)},Sh=function(n,t){t.fold((function(t){n.setStartBefore(t.dom)}),(function(t,e){n.setStart(t.dom,e)}),(function(t){n.setStartAfter(t.dom)}))},Ch=function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))},kh=function(n,t,e){var r=n.document.createRange();return Sh(r,t),Ch(r,e),r},Oh=function(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},Th=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Dh=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?D.some(e).map(Th):D.none()},Eh=Yo.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),_h=function(n,t,e){return t(dt.fromDom(e.startContainer),e.startOffset,dt.fromDom(e.endContainer),e.endOffset)},Ah=function(n,t){return t.match({domRange:function(n){return{ltr:h(n),rtl:D.none}},relative:function(t,e){return{ltr:on((function(){return kh(n,t,e)})),rtl:on((function(){return D.some(kh(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:on((function(){return Oh(n,t,e,r,o)})),rtl:on((function(){return D.some(Oh(n,r,o,t,e))}))}}})},Rh=function(n,t){var e=t.ltr();if(e.collapsed){var r=t.rtl().filter((function(n){return!1===n.collapsed}));return r.map((function(n){return Eh.rtl(dt.fromDom(n.endContainer),n.endOffset,dt.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return _h(n,Eh.ltr,e)}))}return _h(n,Eh.ltr,e)},Bh=function(n,t){var e=Ah(n,t);return Rh(n,e)},Mh=function(n,t){var e=Bh(n,t);return e.match({ltr:function(t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},rtl:function(t,e,r,o){var i=n.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,e),i}})},Ih=(Eh.ltr,Eh.rtl,function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=n(u),c=Math.abs(t-a.left);if(e<=a.bottom){if(e<a.top||c>i)return u-1;i=c}}return 0}),Nh=function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom},Fh=function(n,t,e,r,o){var i=function(e){var r=n.dom.createRange();return r.setStart(t.dom,e),r.collapse(!0),r},u=function(n){var t=i(n);return t.getBoundingClientRect()},a=ko(t).length,c=Ih(u,e,r,o.right,a);return i(c)},Ph=function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects(),u=tn(i,(function(n){return Nh(n,e,r)?D.some(n):D.none()}));return u.map((function(o){return Fh(n,t,e,r,o)}))},Lh=function(n,t,e,r){var o=n.dom.createRange(),i=ge(t);return tn(i,(function(t){return o.selectNode(t.dom),Nh(o.getBoundingClientRect(),e,r)?zh(n,t,e,r):D.none()}))},zh=function(n,t,e,r){return ee(t)?Ph(n,t,e,r):Lh(n,t,e,r)},jh=function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return zh(n,t,u,a)},Hh=!0,Vh=!1,Uh=function(n,t){return t-n.left<n.right-t?Hh:Vh},Wh=function(n,t,e){var r=n.dom.createRange();return r.selectNode(t.dom),r.collapse(e),r},Gh=function(n,t,e){var r=n.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=Uh(o,e),u=i===Hh?ga:pa;return u(t).map((function(t){return Wh(n,t,i)}))},qh=function(n,t,e){var r=t.dom.getBoundingClientRect(),o=Uh(r,e);return D.some(Wh(n,t,o))},$h=function(n,t,e){var r=0===ge(t).length?qh:Gh;return r(n,t,e)},Xh=function(n,t,e){return D.from(n.dom.caretPositionFromPoint(t,e)).bind((function(t){if(null===t.offsetNode)return D.none();var e=n.dom.createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),D.some(e)}))},Kh=function(n,t,e){return D.from(n.dom.caretRangeFromPoint(t,e))},Yh=function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return jh(n,t,u,a)},Jh=function(n,t,e){return dt.fromPoint(n,t,e).bind((function(r){var o=function(){return $h(n,r,t)};return 0===ge(r).length?o():Yh(n,r,t,e).orThunk(o)}))},Qh=function(){return document.caretPositionFromPoint?Xh:document.caretRangeFromPoint?Kh:Jh}(),Zh=function(n,t,e){var r=dt.fromDom(n.document);return Qh(r,t,e).map((function(n){return rh.create(dt.fromDom(n.startContainer),n.startOffset,dt.fromDom(n.endContainer),n.endOffset)}))},nv=function(n,t){var e=Jt(n);return"input"===e?lh.after(n):B(["br","img"],e)?0===t?lh.before(n):lh.after(n):lh.on(n,t)},tv=function(n,t){var e=n.fold(lh.before,nv,lh.after),r=t.fold(lh.before,nv,lh.after);return yh.relative(e,r)},ev=function(n,t,e,r){var o=nv(n,t),i=nv(e,r);return yh.relative(o,i)},rv=function(n){return n.match({domRange:function(n){var t=dt.fromDom(n.startContainer),e=dt.fromDom(n.endContainer);return ev(t,n.startOffset,e,n.endOffset)},relative:tv,exact:ev})},ov=function(n,t,e,r){var o=ue(n),i=o.dom.createRange();return i.setStart(n.dom,t),i.setEnd(e.dom,r),i},iv=function(n,t,e,r){var o=ov(n,t,e,r),i=vt(n,e)&&t===r;return o.collapsed&&!i},uv=function(n){return D.from(n.getSelection())},av=function(n,t){uv(n).each((function(n){n.removeAllRanges(),n.addRange(t)}))},cv=function(n,t,e,r,o){var i=Oh(n,t,e,r,o);av(n,i)},sv=function(n,t,e,r,o,i){t.collapse(e.dom,r),t.extend(o.dom,i)},lv=function(n,t){return Bh(n,t).match({ltr:function(t,e,r,o){cv(n,t,e,r,o)},rtl:function(t,e,r,o){uv(n).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,e,r.dom,o);else if(i.extend)try{sv(n,i,t,e,r,o)}catch(u){cv(n,r,o,t,e)}else cv(n,r,o,t,e)}))}})},fv=function(n,t,e,r,o){var i=ev(t,e,r,o);lv(n,i)},dv=function(n,t,e){var r=tv(t,e);lv(n,r)},mv=function(n){var t=yh.getWin(n).dom,e=function(n,e,r,o){return Oh(t,n,e,r,o)},r=rv(n);return Bh(t,r).match({ltr:e,rtl:e})},gv=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return D.some(rh.create(dt.fromDom(t.startContainer),t.startOffset,dt.fromDom(e.endContainer),e.endOffset))}return D.none()},pv=function(n){if(null===n.anchorNode||null===n.focusNode)return gv(n);var t=dt.fromDom(n.anchorNode),e=dt.fromDom(n.focusNode);return iv(t,n.anchorOffset,e,n.focusOffset)?D.some(rh.create(t,n.anchorOffset,e,n.focusOffset)):gv(n)},hv=function(n,t){var e=wh(n,t);av(n,e)},vv=function(n){return uv(n).filter((function(n){return n.rangeCount>0})).bind(pv)},bv=function(n){return vv(n).map((function(n){return yh.exact(n.start,n.soffset,n.finish,n.foffset)}))},yv=function(n,t){var e=Mh(n,t);return Dh(e)},wv=function(n,t,e){return Zh(n,t,e)},xv=function(n){uv(n).each((function(n){return n.removeAllRanges()}))},Sv=tinymce.util.Tools.resolve("tinymce.util.VK"),Cv=function(n,t,e){return Dv(n,t,nh(e))},kv=function(n,t,e){return Dv(n,t,th(e))},Ov=function(n,t){var e=yh.exact(t,0,t,0);return mv(e)},Tv=function(n,t){var e=Me(t,"tr");return nn(e).bind((function(t){return He(t,"td,th").map((function(t){return Ov(n,t)}))}))},Dv=function(n,t,e){return e.fold(D.none,D.none,(function(t,e){return ga(e).map((function(t){return Ov(n,t)}))}),(function(e){return yr(e,t).bind((function(t){return n.execCommand("mceTableInsertRowAfter"),Tv(n,t)}))}))},Ev=["table","li","dl"],_v=function(n,t,e){if(n.keyCode===Sv.TAB){var r=Ra(t),o=function(n){var t=Jt(n);return vt(n,r)||B(Ev,t)},i=t.selection.getRng(),u=dt.fromDom(n.shiftKey?i.startContainer:i.endContainer);hr(u,o).each((function(r){n.preventDefault(),yr(r,o).each(e.clear),t.selection.collapse(n.shiftKey);var i=n.shiftKey?kv:Cv,u=i(t,o,r);u.each((function(n){t.selection.setRng(n)}))}))}},Av=function(n,t){return{selection:n,kill:t}},Rv={create:Av},Bv=function(n,t,e,r){return{start:lh.on(n,t),finish:lh.on(e,r)}},Mv={create:Bv},Iv=function(n,t){var e=Mh(n,t);return rh.create(dt.fromDom(e.startContainer),e.startOffset,dt.fromDom(e.endContainer),e.endOffset)},Nv=Mv.create,Fv=function(n,t,e,r,o,i,u){return vt(e,o)&&r===i?D.none():Ve(e,"td,th",t).bind((function(e){return Ve(o,"td,th",t).bind((function(r){return Pv(n,t,e,r,u)}))}))},Pv=function(n,t,e,r,o){return vt(e,r)?D.none():Ho(e,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>0?(o(n,r,t.start,t.finish),D.some(Rv.create(D.some(Nv(e,0,e,la(e))),!0))):D.none()}))},Lv=function(n,t,e,r,o){var i=function(n){return o.clearBeforeUpdate(e),o.selectRange(e,n.boxes,n.start,n.finish),n.boxes};return qo(r,n,t,o.firstSelectedSelector,o.lastSelectedSelector).map(i)},zv=function(n,t){return{item:n,mode:t}},jv=function(n,t,e,r){return void 0===r&&(r=Hv),n.property().parent(t).map((function(n){return zv(n,r)}))},Hv=function(n,t,e,r){return void 0===r&&(r=Vv),e.sibling(n,t).map((function(n){return zv(n,r)}))},Vv=function(n,t,e,r){void 0===r&&(r=Vv);var o=n.property().children(t),i=e.first(o);return i.map((function(n){return zv(n,r)}))},Uv=[{current:jv,next:Hv,fallback:D.none()},{current:Hv,next:Vv,fallback:D.some(jv)},{current:Vv,next:Vv,fallback:D.some(Hv)}],Wv=function(n,t,e,r,o){void 0===o&&(o=Uv);var i=U(o,(function(n){return n.current===e}));return i.bind((function(e){return e.current(n,t,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Wv(n,t,e,r)}))}))}))},Gv=function(){var n=function(n,t){return n.query().prevSibling(t)},t=function(n){return n.length>0?D.some(n[n.length-1]):D.none()};return{sibling:n,first:t}},qv=function(){var n=function(n,t){return n.query().nextSibling(t)},t=function(n){return n.length>0?D.some(n[0]):D.none()};return{sibling:n,first:t}},$v={left:Gv,right:qv},Xv=function(n,t,e,r,o,i){var u=Wv(n,t,r,o);return u.bind((function(t){return i(t.item)?D.none():e(t.item)?D.some(t.item):Xv(n,t.item,e,t.mode,o,i)}))},Kv=function(n,t,e,r){return Xv(n,t,e,Hv,$v.left(),r)},Yv=function(n,t,e,r){return Xv(n,t,e,Hv,$v.right(),r)},Jv=function(n){return function(t){return 0===n.property().children(t).length}},Qv=function(n,t,e){return nb(n,t,Jv(n),e)},Zv=function(n,t,e){return tb(n,t,Jv(n),e)},nb=Kv,tb=Yv,eb=Eo(),rb=function(n,t){return Qv(eb,n,t)},ob=function(n,t){return Zv(eb,n,t)},ib=function(n,t,e){return nb(eb,n,t,e)},ub=function(n,t,e){return tb(eb,n,t,e)},ab=function(n,t,e){return Ne(n,t,e).isSome()},cb=Yo.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),sb=function(n,t,e){var r=n.getRect(t),o=n.getRect(e);return o.right>r.left&&o.left<r.right},lb=function(n){return Ve(n,"tr")},fb=function(n,t,e,r,o,i,u){return Ve(r,"td,th",u).bind((function(e){return Ve(t,"td,th",u).map((function(t){return vt(e,t)?vt(r,e)&&la(e)===o?i(t):cb.none("in same cell"):Lo(lb,[e,t]).fold((function(){return sb(n,t,e)?cb.success():i(t)}),(function(n){return i(t)}))}))})).getOr(cb.none("default"))},db=function(n,t,e,r,o){return n.fold(t,e,r,o)},mb=en(en({},cb),{verify:fb,cata:db}),gb=function(n,t,e,r){return{parent:n,children:t,element:e,index:r}},pb=function(n){return se(n).bind((function(t){var e=ge(t);return hb(e,n).map((function(r){return gb(t,e,n,r)}))}))},hb=function(n,t){return W(n,b(vt,t))},vb=function(n){return"br"===Jt(n)},bb=function(n,t,e){return t(n,e).bind((function(n){return ee(n)&&0===ko(n).trim().length?bb(n,t,e):D.some(n)}))},yb=function(n,t,e){return e.traverse(t).orThunk((function(){return bb(t,e.gather,n)})).map(e.relative)},wb=function(n,t){return pe(n,t).filter(vb).orThunk((function(){return pe(n,t-1).filter(vb)}))},xb=function(n,t,e,r){return wb(t,e).bind((function(t){return r.traverse(t).fold((function(){return bb(t,r.gather,n).map(r.relative)}),(function(n){return pb(n).map((function(n){return lh.on(n.parent,n.index)}))}))}))},Sb=function(n,t,e,r){var o=vb(t)?yb(n,t,r):xb(n,t,e,r);return o.map((function(n){return{start:n,finish:n}}))},Cb=function(n){return mb.cata(n,(function(n){return D.none()}),(function(){return D.none()}),(function(n){return D.some(Bf(n,0))}),(function(n){return D.some(Bf(n,la(n)))}))},kb=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},Ob=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},Tb=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},Db=function(n){return n.top},Eb=function(n){return n.bottom},_b=function(n,t,e){return e>=0&&e<la(t)?n.getRangedRect(t,e,t,e+1):e>0?n.getRangedRect(t,e-1,t,e):D.none()},Ab=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},Rb=function(n,t){return D.some(n.getRect(t))},Bb=function(n,t,e){return te(t)?Rb(n,t).map(Ab):ee(t)?_b(n,t,e).map(Ab):D.none()},Mb=function(n,t){return te(t)?Rb(n,t).map(Ab):ee(t)?n.getRangedRect(t,0,t,la(t)).map(Ab):D.none()},Ib=5,Nb=100,Fb=Yo.generate([{none:[]},{retry:["caret"]}]),Pb=function(n,t){return n.left<t.left||Math.abs(t.right-n.left)<1||n.left>t.right},Lb=function(n,t,e){return Fe(t,am).fold(x,(function(t){return Mb(n,t).exists((function(n){return Pb(e,n)}))}))},zb=function(n,t,e,r,o){var i=kb(o,Ib);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?Fb.retry(i):e.top===o.bottom?Fb.retry(kb(o,1)):Lb(n,t,o)?Fb.retry(Tb(i,Ib,0)):Fb.none()},jb=function(n,t,e,r,o){var i=Ob(o,Ib);return Math.abs(e.top-r.top)<1||e.bottom<o.top?Fb.retry(i):e.bottom===o.top?Fb.retry(Ob(o,1)):Lb(n,t,o)?Fb.retry(Tb(i,Ib,0)):Fb.none()},Hb={point:Db,adjuster:jb,move:Ob,gather:rb},Vb={point:Eb,adjuster:zb,move:kb,gather:ob},Ub=function(n,t,e){return n.elementFromPoint(t,e).filter((function(n){return"table"===Jt(n)})).isSome()},Wb=function(n,t,e,r,o){return Gb(n,t,e,t.move(r,Ib),o)},Gb=function(n,t,e,r,o){return 0===o?D.some(r):Ub(n,r.left,t.point(r))?Wb(n,t,e,r,o-1):n.situsFromPoint(r.left,t.point(r)).bind((function(i){return i.start.fold(D.none,(function(i){return Mb(n,i).bind((function(u){return t.adjuster(n,i,u,e,r).fold(D.none,(function(r){return Gb(n,t,e,r,o-1)}))})).orThunk((function(){return D.some(r)}))}),D.none)}))},qb=function(n,t){return n.situsFromPoint(t.left,t.bottom+Ib)},$b=function(n,t){return n.situsFromPoint(t.left,t.top-Ib)},Xb=function(n,t,e){return n.point(t)>e.getInnerHeight()?D.some(n.point(t)-e.getInnerHeight()):n.point(t)<0?D.some(-n.point(t)):D.none()},Kb=function(n,t,e){var r=n.move(e,Ib),o=Gb(t,n,e,r,Nb).getOr(r);return Xb(n,o,t).fold((function(){return t.situsFromPoint(o.left,n.point(o))}),(function(e){return t.scrollBy(0,e),t.situsFromPoint(o.left,n.point(o)-e)}))},Yb={tryUp:b(Kb,Hb),tryDown:b(Kb,Vb),ieTryUp:$b,ieTryDown:qb,getJumpSize:h(Ib)},Jb=20,Qb=function(n,t,e){return n.getSelection().bind((function(r){return Sb(t,r.finish,r.foffset,e).fold((function(){return D.some(Bf(r.finish,r.foffset))}),(function(o){var i=n.fromSitus(o),u=mb.verify(n,r.finish,r.foffset,i.finish,i.foffset,e.failure,t);return Cb(u)}))}))},Zb=function(n,t,e,r,o,i){return 0===i?D.none():ey(n,t,e,r,o).bind((function(u){var a=n.fromSitus(u),c=mb.verify(n,e,r,a.finish,a.foffset,o.failure,t);return mb.cata(c,(function(){return D.none()}),(function(){return D.some(u)}),(function(u){return vt(e,u)&&0===r?ny(n,e,r,Ob,o):Zb(n,t,u,0,o,i-1)}),(function(u){return vt(e,u)&&r===la(u)?ny(n,e,r,kb,o):Zb(n,t,u,la(u),o,i-1)}))}))},ny=function(n,t,e,r,o){return Bb(n,t,e).bind((function(t){return ty(n,o,r(t,Yb.getJumpSize()))}))},ty=function(n,t,e){var r=Zn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):D.none()},ey=function(n,t,e,r,o){return Bb(n,e,r).bind((function(t){return ty(n,o,t)}))},ry=function(n,t,e){return Qb(n,t,e).bind((function(r){return Zb(n,t,r.element,r.offset,e,Jb).map(n.fromSitus)}))},oy=function(n,t){return ab(n,(function(n){return se(n).exists((function(n){return vt(n,t)}))}))},iy=function(n,t,e,r,o){return Ve(r,"td,th",t).bind((function(r){return Ve(r,"table",t).bind((function(i){return oy(o,i)?ry(n,t,e).bind((function(n){return Ve(n.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:n}}))})):D.none()}))}))},uy=function(n,t,e,r,o,i){return Zn().browser.isIE()?D.none():i(r,t).orThunk((function(){return iy(n,t,e,r,o).map((function(n){var t=n.range;return Rv.create(D.some(Nv(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},ay=function(n,t){return Ve(n,"tr",t).bind((function(n){return Ve(n,"table",t).bind((function(e){var r=Me(e,"tr");return vt(n,r[0])?ib(e,(function(n){return pa(n).isSome()}),t).map((function(n){var t=la(n);return Rv.create(D.some(Nv(n,t,n,t)),!0)})):D.none()}))}))},cy=function(n,t){return Ve(n,"tr",t).bind((function(n){return Ve(n,"table",t).bind((function(e){var r=Me(e,"tr");return vt(n,r[r.length-1])?ub(e,(function(n){return ga(n).isSome()}),t).map((function(n){return Rv.create(D.some(Nv(n,0,n,0)),!0)})):D.none()}))}))},sy=function(n,t,e,r,o,i,u){return iy(n,e,r,o,i).bind((function(n){return Pv(t,e,n.start,n.finish,u)}))},ly=function(){var n=Ku(D.none()),t=function(){return n.set(D.none())},e=function(t){return n.set(D.some(t))},r=function(){return n.get().isSome()},o=function(t){return n.get().each(t)};return{clear:t,set:e,isSet:r,on:o}},fy=function(n,t){return Ve(n,"td,th",t)},dy=function(n,t,e,r){var o=ly(),i=o.clear,u=function(i){o.on((function(o){r.clearBeforeUpdate(t),fy(i.target,e).each((function(i){Ho(o,i,e).each((function(e){var u=e.boxes.getOr([]);(u.length>1||1===u.length&&!vt(o,i))&&(r.selectRange(t,u,e.start,e.finish),n.selectContents(i))}))}))}))},a=function(n){r.clear(t),fy(n.target,e).each(o.set)},c=function(n){u(n)},s=function(n){u(n),i()};return{clearstate:i,mousedown:a,mouseover:c,mouseup:s}},my={traverse:me,gather:ob,relative:lh.before,otherRetry:Yb.tryDown,ieRetry:Yb.ieTryDown,failure:mb.failedDown},gy={traverse:de,gather:rb,relative:lh.before,otherRetry:Yb.tryUp,ieRetry:Yb.ieTryUp,failure:mb.failedUp},py=function(n){return function(t){return t===n}},hy=py(38),vy=py(40),by=function(n){return n>=37&&n<=40},yy={isBackward:py(37),isForward:py(39)},wy={isBackward:py(39),isForward:py(37)},xy=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Di(e,r)},Sy=function(n,t,e){var r=void 0!==e?e.dom:document,o=r.defaultView;o&&o.scrollBy(n,t)},Cy=function(n){var t=function(t,e){return dt.fromPoint(dt.fromDom(n.document),t,e)},e=function(n){return n.dom.getBoundingClientRect()},r=function(t,e,r,o){var i=yh.exact(t,e,r,o);return yv(n,i)},o=function(){return bv(n).map((function(t){return Iv(n,t)}))},i=function(t){var e=yh.relative(t.start,t.finish);return Iv(n,e)},u=function(t,e){return wv(n,t,e).map((function(n){return Mv.create(n.start,n.soffset,n.finish,n.foffset)}))},a=function(){xv(n)},c=function(t){void 0===t&&(t=!1),bv(n).each((function(e){return e.fold((function(n){return n.collapse(t)}),(function(e,r){var o=t?e:r;dv(n,o,o)}),(function(e,r,o,i){var u=t?e:o,a=t?r:i;fv(n,u,a,u,a)}))}))},s=function(t){hv(n,t)},l=function(t){fv(n,t.start,t.soffset,t.finish,t.foffset)},f=function(t,e){dv(n,t,e)},d=function(){return n.innerHeight},m=function(){var t=xy(dt.fromDom(n.document));return t.top},g=function(t,e){Sy(t,e,dt.fromDom(n.document))};return{elementFromPoint:t,getRect:e,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,collapseSelection:c,setSelection:l,setRelativeSelection:f,selectContents:s,getInnerHeight:d,getScrollY:m,scrollBy:g}},ky=function(n,t){return{rows:n,cols:t}},Oy=function(n,t,e,r){var o=Cy(n),i=dy(o,t,e,r);return{clearstate:i.clearstate,mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},Ty=function(n,t,e,r){var o=Cy(n),i=function(){return r.clear(t),D.none()},u=function(n,u,a,c,s,l){var f=n.raw,d=f.which,m=!0===f.shiftKey,g=Vo(t,r.selectedSelector).fold((function(){return vy(d)&&m?b(sy,o,t,e,my,c,u,r.selectRange):hy(d)&&m?b(sy,o,t,e,gy,c,u,r.selectRange):vy(d)?b(uy,o,e,my,c,u,cy):hy(d)?b(uy,o,e,gy,c,u,ay):D.none}),(function(n){var e=function(e){return function(){var i=tn(e,(function(e){return Lv(e.rows,e.cols,t,n,r)}));return i.fold((function(){return Wo(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(n){var e=vy(d)||l.isForward(d)?lh.after:lh.before;return o.setRelativeSelection(lh.on(n.first,0),e(n.table)),r.clear(t),Rv.create(D.none(),!0)}))}),(function(n){return D.some(Rv.create(D.none(),!0))}))}};return vy(d)&&m?e([ky(1,0)]):hy(d)&&m?e([ky(-1,0)]):l.isBackward(d)&&m?e([ky(0,-1),ky(-1,0)]):l.isForward(d)&&m?e([ky(0,1),ky(1,0)]):by(d)&&!1===m?i:D.none}));return g()},a=function(n,o,i,u,a){return Vo(t,r.selectedSelector).fold((function(){var c=n.raw,s=c.which,l=!0===c.shiftKey;return!1===l?D.none():by(s)?Fv(t,e,o,i,u,a,r.selectRange):D.none()}),D.none)};return{keydown:u,keyup:a}},Dy=function(n,t,e,r){var o=Cy(n);return function(n,i){r.clearBeforeUpdate(t),Ho(n,i,e).each((function(n){var e=n.boxes.getOr([]);r.selectRange(t,e,n.start,n.finish),o.selectContents(i),o.collapseSelection()}))}},Ey=function(n,t){F(t,(function(t){Us(n,t)}))},_y=function(n){return function(t){Hs(t,n)}},Ay=function(n){return function(t){Ey(t,n)}},Ry=function(n){var t=_y(n.selected),e=Ay([n.selected,n.lastSelected,n.firstSelected]),r=function(t){var r=Me(t,n.selectedSelector);F(r,e)},o=function(e,o,i,u){r(e),F(o,t),Hs(i,n.firstSelected),Hs(u,n.lastSelected)};return{clearBeforeUpdate:r,clear:r,selectRange:o,selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},By=function(n,t,e){var r=function(t){Xe(t,n.selected),Xe(t,n.firstSelected),Xe(t,n.lastSelected)},o=function(t){We(t,n.selected,"1")},i=function(n){u(n),e()},u=function(t){var e=Me(t,n.selectedSelector);F(e,r)},a=function(e,r,u,a){i(e),F(r,o),We(u,n.firstSelected,"1"),We(a,n.lastSelected,"1"),t(r,u,a)};return{clearBeforeUpdate:u,clear:i,selectRange:a,selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},My={byClass:Ry,byAttr:By},Iy=function(n,t,e){var r=n.slice(0,t[t.length-1].row+1),o=Zf(r,e);return q(o,(function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return N(e,(function(n){return n.element}))}))},Ny=function(n,t,e){var r=n.slice(t[0].row+t[0].rowspan-1,n.length),o=Zf(r,e);return q(o,(function(n){var e=n.cells.slice(t[0].column+t[0].colspan-1,n.cells.length);return N(e,(function(n){return n.element}))}))},Fy=function(n,t,e){var r=Kr.fromTable(n),o=cd(r,t);return o.map((function(n){var t=Yf(r,e,!1),o=Iy(t,n,e),i=Ny(t,n,e);return{upOrLeftCells:o,downOrRightCells:i}}))},Py=function(n){return!1===Ws(dt.fromDom(n.target),"ephox-snooker-resizer-bar")};function Ly(n,t,e){var r=function(t,r,o){e.targets().each((function(e){var i=yr(r);i.each((function(i){var u=pf(n),a=Ta(m,dt.fromDom(n.getDoc()),u),c=Fy(i,e,a);Il(n,t,r,o,c)}))}))},o=function(){return Nl(n)},i=My.byAttr(Za,r,o);return n.on("init",(function(e){var r=n.getWin(),o=Ra(n),u=Ia(n),a=function(){var t=n.selection,e=dt.fromDom(t.getStart()),r=dt.fromDom(t.getEnd()),u=Lo(yr,[e,r]);u.fold((function(){return i.clear(o)}),m)},c=Oy(r,o,u,i),s=Ty(r,o,u,i),l=Dy(r,o,u,i),f=function(n){return!0===n.raw.shiftKey};n.on("TableSelectorChange",(function(n){return l(n.start,n.finish)}));var d=function(t,e){f(t)&&(e.kill&&t.kill(),e.selection.each((function(t){var e=yh.relative(t.start,t.finish),o=Mh(r,e);n.selection.setRng(o)})))},g=function(t){var e=Ms(t);if(e.raw.shiftKey&&by(e.raw.which)){var r=n.selection.getRng(),o=dt.fromDom(r.startContainer),i=dt.fromDom(r.endContainer);s.keyup(e,o,r.startOffset,i,r.endOffset).each((function(n){d(e,n)}))}},p=function(e){var r=Ms(e);t().each((function(n){return n.hideBars()}));var o=n.selection.getRng(),i=dt.fromDom(o.startContainer),u=dt.fromDom(o.endContainer),a=xi(yy,wy)(dt.fromDom(n.selection.getStart()));s.keydown(r,i,o.startOffset,u,o.endOffset,a).each((function(n){d(r,n)})),t().each((function(n){return n.showBars()}))},h=function(n){return 0===n.button},v=function(n){return void 0===n.buttons||(!(!Pp.browser.isEdge()||0!==n.buttons)||0!==(1&n.buttons))},b=function(n){c.clearstate()},y=function(n){h(n)&&Py(n)&&c.mousedown(Ms(n))},w=function(n){v(n)&&Py(n)&&c.mouseover(Ms(n))},x=function(n){h(n)&&Py(n)&&c.mouseup(Ms(n))},S=function(){var n=Ku(dt.fromDom(o)),t=Ku(0),e=function(e){var r=dt.fromDom(e.target);if("td"===Jt(r)||"th"===Jt(r)){var o=n.get(),i=t.get();vt(o,r)&&e.timeStamp-i<300&&(e.preventDefault(),l(r,r))}n.set(r),t.set(e.timeStamp)};return{touchEnd:e}},C=S();n.on("dragstart",b),n.on("mousedown",y),n.on("mouseover",w),n.on("mouseup",x),n.on("touchend",C.touchEnd),n.on("keyup",g),n.on("keydown",p),n.on("NodeChange",a)})),{clear:i.clear}}var zy=function(n,t){var e=Ku(D.none()),r=Ku([]),o=D.none(),i=ie("caption"),u=function(n){return o.forall((function(t){return!t[n]}))},a=function(){return Cg(Ha(n),Ia(n)).bind((function(n){var e=yr(n);return e.map((function(e){return i(n)?nc(n):tc(t,e,n)}))}))},c=function(n){var t=yr(n.element);return t.map((function(t){var e=Kr.fromTable(t),r=cd(e,n).getOr([]),o=H(r,(function(n,t){return t.isLocked&&(n.onAny=!0,0===t.column?n.onFirst=!0:t.column+t.colspan>=e.grid.columns&&(n.onLast=!0)),n}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:md(e,n).isSome(),unmergeable:gd(e,n).isSome(),locked:o}}))},s=function(){e.set(on(a)()),o=e.get().bind(c),F(r.get(),(function(n){return n()}))},l=function(n,t){var o=function(){return e.get().fold((function(){n.setDisabled(!0)}),(function(e){n.setDisabled(t(e))}))};return o(),r.set(r.get().concat([o])),function(){r.set(z(r.get(),(function(n){return n!==o})))}},f=function(n){return o.exists((function(t){return t.locked[n]}))},d=function(n){return l(n,(function(n){return!1}))},m=function(n){return l(n,(function(n){return i(n.element)}))},g=function(n){return function(t){return l(t,(function(t){return i(t.element)||f(n)}))}},p=function(n){return function(t){return l(t,(function(t){return i(t.element)||n().isNone()}))}},h=function(n,t){return function(e){return l(e,(function(e){return i(e.element)||n().isNone()||f(t)}))}},v=function(n){return l(n,(function(n){return u("mergeable")}))},b=function(n){return l(n,(function(n){return u("unmergeable")}))};return n.on("NodeChange ExecCommand TableSelectorChange",s),{onSetupTable:d,onSetupCellOrRow:m,onSetupColumn:g,onSetupPasteable:p,onSetupPasteableColumn:h,onSetupMergeable:v,onSetupUnmergeable:b,resetTargets:s,targets:function(){return e.get()}}},jy=function(n,t,e){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})},Hy=function(n){var t=function(t){return n.dom.is(t,"table")&&n.getBody().contains(t)},e=sf(n);e.length>0&&n.ui.registry.addContextToolbar("table",{predicate:t,items:e,scope:"node",position:"node"})},Vy=function(n,t,e){var r=function(t){return function(){return n.execCommand(t)}},o=function(t){n.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},i={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},u={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)});var a={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}};n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")});var c={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}};n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});var s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}};!1===nf(n)?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",i),n.ui.registry.addMenuItem("deletetable",u),n.ui.registry.addNestedMenuItem("row",a),n.ui.registry.addNestedMenuItem("column",c),n.ui.registry.addNestedMenuItem("cell",s),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(n){return"caption"===Jt(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})},Uy=function(n){var t=ei((function(){return Ra(n)}),(function(){return Cg(Ha(n))}),Za.selectedSelector),e=zy(n,t),r=Rf(n),o=Ly(n,r.lazyResize,e),i=Tg(n,r.lazyWire,t),u=$p();return Gp(n,i,o,t,u),qp(n,i,t),ac(n,t,i,o),Vy(n,e,u),jy(n,e,u),Hy(n),n.on("PreInit",(function(){n.serializer.addTempAttr(Za.firstSelected),n.serializer.addTempAttr(Za.lastSelected),Kp(n)})),Kl(n)&&n.on("keydown",(function(t){_v(t,n,o)})),n.on("remove",(function(){r.destroy()})),qg(n,u,r,e)};function Wy(){ri.add("table",Uy)}Wy()})()},"9dbe":function(n,t,e){"use strict";(function(n){e.d(t,"a",(function(){return o}));var r=function(){return"undefined"!==typeof window?window:n},o=function(){var n=r();return n&&n.tinymce?n.tinymce:null}}).call(this,e("2409"))},"9df6":function(n,t,e){e("e391")},a061:function(n,t,e){"use strict";e.r(t);var r=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"tinymce-editor"},[e("editor",{attrs:{init:n.init,disabled:n.disabled},on:{onClick:n.onClick},model:{value:n.myValue,callback:function(t){n.myValue=t},expression:"myValue"}})],1)},o=[],i=e("d7dc"),u=e.n(i),a=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],c=function(n){return-1!==a.indexOf(n)},s=function(n,t,e){Object.keys(t).filter(c).forEach((function(r){var o=t[r];"function"===typeof o&&("onInit"===r?o(n,e):e.on(r.substring(2),(function(n){return o(n,e)})))}))},l=function(n,t){var e,r=n.$props.modelEvents?n.$props.modelEvents:null,o=Array.isArray(r)?r.join(" "):r;n.$watch("value",(function(n,r){t&&"string"===typeof n&&n!==e&&n!==r&&(t.setContent(n),e=n)})),t.on(o||"change keyup undo redo",(function(){e=t.getContent(),n.$emit("input",e)}))},f=function(n,t,e){var r=t.$props.value?t.$props.value:"",o=t.$props.initialValue?t.$props.initialValue:"";e.setContent(r||o),t.$listeners.input&&l(t,e),s(n,t.$listeners,e)},d=0,m=function(n){var t=Date.now(),e=Math.floor(1e9*Math.random());return d++,n+"_"+e+d+String(t)},g=function(n){return null!==n&&"textarea"===n.tagName.toLowerCase()},p=function(n){return"undefined"===typeof n||""===n?[]:Array.isArray(n)?n:n.split(" ")},h=function(n,t){return p(n).concat(p(t))},v=function(n,t,e,r){var o=t.createElement("script");o.type="application/javascript",o.id=n,o.addEventListener("load",r),o.src=e,t.head&&t.head.appendChild(o)},b=function(){return{listeners:[],scriptId:m("tiny-script"),scriptLoaded:!1}},y=function(n,t,e,r){n.scriptLoaded?r():(n.listeners.push(r),t.getElementById(n.scriptId)||v(n.scriptId,t,e,(function(){n.listeners.forEach((function(n){return n()})),n.scriptLoaded=!0})))},w=e("9dbe"),x={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean},S=function(){return S=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},S.apply(this,arguments)},C=b(),k=function(n,t,e){return n(e||"div",{attrs:{id:t}})},O=function(n,t){return n("textarea",{attrs:{id:t},style:{visibility:"hidden"}})},T=function(n){return function(){var t=S({},n.$props.init,{readonly:n.$props.disabled,selector:"#"+n.elementId,plugins:h(n.$props.init&&n.$props.init.plugins,n.$props.plugins),toolbar:n.$props.toolbar||n.$props.init&&n.$props.init.toolbar,inline:n.inlineEditor,setup:function(t){n.editor=t,t.on("init",(function(e){return f(e,n,t)})),n.$props.init&&"function"===typeof n.$props.init.setup&&n.$props.init.setup(t)}});g(n.element)&&(n.element.style.visibility=""),Object(w["a"])().init(t)}},D={props:x,created:function(){this.elementId=this.$props.id||m("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(w["a"])())T(this)();else if(this.element&&this.element.ownerDocument){var n=this.element.ownerDocument,t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key";y(C,n,"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js",T(this))}},beforeDestroy:function(){null!==Object(w["a"])()&&Object(w["a"])().remove(this.editor)},render:function(n){return this.inlineEditor?k(n,this.elementId,this.$props.tagName):O(n,this.elementId)}},E=D,_=(e("ca4d"),e("e8c4e"),e("2a84"),e("ac03"),e("cde2"),e("30c1"),e("5a13"),e("9df6"),e("48c6"),e("5fba"),e("5d80"),e("0fea")),A={components:{Editor:E},props:{value:{type:String,required:!1},triggerChange:{type:Boolean,default:!1,required:!1},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:"lists image link media table textcolor wordcount contextmenu fullscreen"},toolbar:{type:[String,Array],default:"undo redo |  formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists link unlink image media table | removeformat | fullscreen",branding:!1}},data:function(){return{init:{language_url:"/tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"/tinymce/skins/lightgray",height:300,plugins:this.plugins,toolbar:this.toolbar,branding:!1,menubar:!1,toolbar_drawer:!1,images_upload_handler:function(n,t){var e=new FormData;e.append("file",n.blob(),n.filename()),e.append("biz","jeditor"),e.append("jeditor","1"),Object(_["l"])(window._CONFIG["domianURL"]+"/sys/common/upload",e).then((function(e){if(e.success)if("local"==e.message){var r="data:image/jpeg;base64,"+n.base64();t(r)}else{var o=Object(_["d"])(e.message);t(o)}}))}},myValue:this.value}},mounted:function(){u.a.init({})},methods:{onClick:function(n){this.$emit("onClick",n,u.a)},clear:function(){this.myValue=""}},watch:{value:function(n){this.myValue=null==n?"":n},myValue:function(n){this.triggerChange?this.$emit("change",n):this.$emit("input",n)}}},R=A,B=e("cba8"),M=Object(B["a"])(R,r,o,!1,null,"5b88dcb9",null);t["default"]=M.exports},ac03:function(n,t,e){e("2f2c")},ca4d:function(n,t,e){(function(n){(function(){"use strict";var t=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},e=function(n){return function(e){return t(e)===n}},r=function(n){return function(t){return typeof t===n}},o=function(n){return function(t){return n===t}},i=e("string"),u=e("object"),a=e("array"),c=r("boolean"),s=o(void 0),l=function(n){return null===n||void 0===n},f=function(n){return!l(n)},d=r("function"),m=r("number"),g=function(n,t){if(a(n)){for(var e=0,r=n.length;e<r;++e)if(!t(n[e]))return!1;return!0}return!1},p=function(){},h=function(n){return function(){return n()}},v=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},b=function(n,t){return function(e){return n(t(e))}},y=function(n){return function(){return n}},w=function(n){return n};function x(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var S=function(n){return function(t){return!n(t)}},C=function(n){return function(){throw new Error(n)}},k=y(!1),O=y(!0),T=tinymce.util.Tools.resolve("tinymce.ThemeManager"),D=function(){return D=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},D.apply(this,arguments)};function E(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function _(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var A,R=function(){return B},B=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:k,isSome:k,isNone:O,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:e,orThunk:t,map:R,each:p,bind:R,exists:k,forall:O,filter:R,equals:n,equals_:n,toArray:function(){return[]},toString:y("none()")};return r}(),M=function(n){var t=y(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:O,isNone:k,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return M(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:B},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(k,(function(t){return e(n,t)}))}};return o},I=function(n){return null===n||void 0===n?B:M(n)},N={some:M,none:R,from:I},F=Array.prototype.slice,P=Array.prototype.indexOf,L=Array.prototype.push,z=function(n,t){return P.call(n,t)},j=function(n,t){var e=z(n,t);return-1===e?N.none():N.some(e)},H=function(n,t){return z(n,t)>-1},V=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return!0}return!1},U=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},W=function(n,t){for(var e=[],r=0;r<n.length;r+=t){var o=F.call(n,r,r+t);e.push(o)}return e},G=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},q=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},$=function(n,t){for(var e=n.length-1;e>=0;e--){var r=n[e];t(r,e)}},X=function(n,t){for(var e=[],r=[],o=0,i=n.length;o<i;o++){var u=n[o],a=t(u,o)?e:r;a.push(u)}return{pass:e,fail:r}},K=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},Y=function(n,t,e){return $(n,(function(n){e=t(e,n)})),e},J=function(n,t,e){return q(n,(function(n){e=t(e,n)})),e},Q=function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(t(i,r))return N.some(i);if(e(i,r))break}return N.none()},Z=function(n,t){return Q(n,t,k)},nn=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return N.some(e)}return N.none()},tn=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!a(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);L.apply(t,n[e])}return t},en=function(n,t){return tn(G(n,t))},rn=function(n,t){for(var e=0,r=n.length;e<r;++e){var o=n[e];if(!0!==t(o,e))return!1}return!0},on=function(n){var t=F.call(n,0);return t.reverse(),t},un=function(n,t){return K(n,(function(n){return!H(t,n)}))},an=function(n,t){for(var e={},r=0,o=n.length;r<o;r++){var i=n[r];e[String(i)]=t(i,r)}return e},cn=function(n,t){var e=F.call(n,0);return e.sort(t),e},sn=function(n,t){return t>=0&&t<n.length?N.some(n[t]):N.none()},ln=function(n){return sn(n,0)},fn=function(n){return sn(n,n.length-1)},dn=d(Array.from)?Array.from:function(n){return F.call(n)},mn=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return N.none()},gn=function(n){var t=function(t){return n===t},e=function(t){return gn(n)},r=function(t){return gn(n)},o=function(t){return gn(t(n))},i=function(t){return gn(n)},u=function(t){t(n)},a=function(t){return t(n)},c=function(t,e){return e(n)},s=function(t){return t(n)},l=function(t){return t(n)},f=function(){return N.some(n)};return{is:t,isValue:O,isError:k,getOr:y(n),getOrThunk:y(n),getOrDie:y(n),or:e,orThunk:r,fold:c,map:o,mapError:i,each:u,bind:a,exists:s,forall:l,toOptional:f}},pn=function(n){var t=function(n){return n()},e=function(){return C(String(n))()},r=function(n){return n},o=function(n){return n()},i=function(t){return pn(n)},u=function(t){return pn(t(n))},a=function(t){return pn(n)},c=function(t,e){return t(n)};return{is:k,isValue:k,isError:O,getOr:w,getOrThunk:t,getOrDie:e,or:r,orThunk:o,fold:c,map:i,mapError:u,each:p,bind:a,exists:k,forall:O,toOptional:N.none}},hn=function(n,t){return n.fold((function(){return pn(t)}),gn)},vn={value:gn,error:pn,fromOption:hn};(function(n){n[n["Error"]=0]="Error",n[n["Value"]=1]="Value"})(A||(A={}));var bn=function(n,t,e){return n.stype===A.Error?t(n.serror):e(n.svalue)},yn=function(n){var t=[],e=[];return q(n,(function(n){bn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},wn=function(n,t){return n.stype===A.Error?{stype:A.Error,serror:t(n.serror)}:n},xn=function(n,t){return n.stype===A.Value?{stype:A.Value,svalue:t(n.svalue)}:n},Sn=function(n,t){return n.stype===A.Value?t(n.svalue):n},Cn=function(n,t){return n.stype===A.Error?t(n.serror):n},kn=function(n){return{stype:A.Value,svalue:n}},On=function(n){return{stype:A.Error,serror:n}},Tn=function(n){return bn(n,vn.error,vn.value)},Dn=function(n){return n.fold(On,kn)},En={fromResult:Dn,toResult:Tn,svalue:kn,partition:yn,serror:On,bind:Sn,bindError:Cn,map:xn,mapError:wn,fold:bn},_n=Object.keys,An=Object.hasOwnProperty,Rn=function(n,t){for(var e=_n(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},Bn=function(n,t){return Mn(n,(function(n,e){return{k:e,v:t(n,e)}}))},Mn=function(n,t){var e={};return Rn(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},In=function(n){return function(t,e){n[e]=t}},Nn=function(n,t,e,r){var o={};return Rn(n,(function(n,o){(t(n,o)?e:r)(n,o)})),o},Fn=function(n,t){var e={};return Nn(n,t,In(e),p),e},Pn=function(n,t){var e=[];return Rn(n,(function(n,r){e.push(t(n,r))})),e},Ln=function(n,t){for(var e=_n(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];if(t(u,i,n))return N.some(u)}return N.none()},zn=function(n){return Pn(n,(function(n){return n}))},jn=function(n,t){return Hn(n,t)?N.from(n[t]):N.none()},Hn=function(n,t){return An.call(n,t)},Vn=function(n,t){return Hn(n,t)&&void 0!==n[t]&&null!==n[t]},Un=function(n){if(!a(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return q(n,(function(r,o){var i=_n(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=r[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!a(c))throw new Error("case arguments must be an array");t.push(u),e[u]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);var a=function(n){var r=_n(n);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var o=rn(t,(function(n){return H(r,n)}));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return n[u].apply(null,e)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var i=t[o];return i.apply(null,e)},match:a,log:function(n){}}}})),e},Wn={generate:Un},Gn=Object.prototype.hasOwnProperty,qn=function(n,t){return t},$n=function(n,t){var e=u(n)&&u(t);return e?Kn(n,t):t},Xn=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)Gn.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}},Kn=Xn($n),Yn=Xn(qn),Jn=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},Qn=Wn.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Zn=function(n){return Qn.defaultedThunk(y(n))},nt=function(n){return Qn.mergeWithThunk(y(n))},tt=Qn.strict,et=Qn.asOption,rt=Qn.defaultedThunk,ot=(Qn.asDefaultedOptionThunk,Qn.mergeWithThunk),it=(Wn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var t=[],e=[];return q(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}),ut=function(n,t){var e={};return Rn(n,(function(n,r){H(t,r)||(e[r]=n)})),e},at=function(n,t){var e;return e={},e[n]=t,e},ct=function(n){var t={};return q(n,(function(n){t[n.key]=n.value})),t},st=function(n,t){return ut(n,t)},lt=function(n,t){return at(n,t)},ft=function(n){return ct(n)},dt=function(n,t){return 0===n.length?vn.value(t):vn.value(Kn(t,Yn.apply(void 0,n)))},mt=function(n){return vn.error(tn(n))},gt=function(n,t){var e=it(n);return e.errors.length>0?mt(e.errors):dt(e.values,t)},pt=function(n,t){return n.length>0?En.svalue(Kn(t,Yn.apply(void 0,n))):En.svalue(t)},ht=function(n){return v(En.serror,tn)(n)},vt=function(n,t){var e=En.partition(n);return e.errors.length>0?ht(e.errors):pt(e.values,t)},bt=function(n){var t=En.partition(n);return t.errors.length>0?ht(t.errors):En.svalue(t.values)},yt={consolidateObj:vt,consolidateArr:bt},wt=function(n){return u(n)&&_n(n).length>100?" removed due to size":JSON.stringify(n,null,2)},xt=function(n){var t=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return G(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))},St=function(n,t){return En.serror([{path:n,getErrorInfo:t}])},Ct=function(n,t,e){return St(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+wt(e)}))},kt=function(n,t){return St(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))},Ot=function(n,t,e){return St(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+wt(t)}))},Tt=function(n,t){return St(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},Dt=function(n,t){return St(n,(function(){return t}))},Et=Wn.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),_t=function(n,t,e){return jn(t,e).fold((function(){return Ct(n,e,t)}),En.svalue)},At=function(n,t,e){var r=jn(n,t).fold((function(){return e(n)}),w);return En.svalue(r)},Rt=function(n,t){return En.svalue(jn(n,t))},Bt=function(n,t,e){var r=jn(n,t).map((function(t){return!0===t?e(n):t}));return En.svalue(r)},Mt=function(n,t,e,r){return e.fold((function(e,o,i,u){var a=function(t){var i=u.extract(n.concat([e]),r,t);return En.map(i,(function(n){return at(o,r(n))}))},c=function(t){return t.fold((function(){var n=at(o,r(N.none()));return En.svalue(n)}),(function(t){var i=u.extract(n.concat([e]),r,t);return En.map(i,(function(n){return at(o,r(N.some(n)))}))}))};return function(){return i.fold((function(){return En.bind(_t(n,t,e),a)}),(function(n){return En.bind(At(t,e,n),a)}),(function(){return En.bind(Rt(t,e),c)}),(function(n){return En.bind(Bt(t,e,n),c)}),(function(n){var r=n(t),o=En.map(At(t,e,y({})),(function(n){return Kn(r,n)}));return En.bind(o,a)}))}()}),(function(n,e){var o=e(t);return En.svalue(at(n,r(o)))}))},It=function(n,t,e,r){var o=G(e,(function(e){return Mt(n,t,e,r)}));return yt.consolidateObj(o,{})},Nt=function(n){var t=function(t,e,r){return n().extract(t,e,r)},e=function(){return n().toString()};return{extract:t,toString:e}},Ft=function(n){var t=function(t,e,r){return En.bindError(n(r,e),(function(n){return Dt(t,n)}))},e=function(){return"val"};return{extract:t,toString:e}},Pt=function(n){return _n(Fn(n,(function(n){return void 0!==n&&null!==n})))},Lt=function(n){var t=zt(n),e=Y(n,(function(n,t){return t.fold((function(t){return Kn(n,lt(t,!0))}),y(n))}),{}),r=function(n,r,o){var i=c(o)?[]:Pt(o),u=K(i,(function(n){return!Vn(e,n)}));return 0===u.length?t.extract(n,r,o):Tt(n,u)};return{extract:r,toString:t.toString}},zt=function(n){var t=function(t,e,r){return It(t,r,n,e)},e=function(){var t=G(n,(function(n){return n.fold((function(n,t,e,r){return n+" -> "+r.toString()}),(function(n,t){return"state("+n+")"}))}));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:e}},jt=function(n){var t=function(t,e,r){var o=G(r,(function(r,o){return n.extract(t.concat(["["+o+"]"]),e,r)}));return yt.consolidateArr(o)},e=function(){return"array("+n.toString()+")"};return{extract:t,toString:e}},Ht=function(n){var t=function(t,e,r){for(var o=[],i=0,u=n;i<u.length;i++){var a=u[i],c=a.extract(t,e,r);if(c.stype===A.Value)return c;o.push(c)}return yt.consolidateArr(o)},e=function(){return"oneOf("+G(n,(function(n){return n.toString()})).join(", ")+")"};return{extract:t,toString:e}},Vt=function(n,t){var e=function(t,e){return jt(Ft(n)).extract(t,w,e)},r=function(n,r,o){var i=_n(o),u=e(n,i);return En.bind(u,(function(e){var i=G(e,(function(n){return Et.field(n,n,tt(),t)}));return zt(i).extract(n,r,o)}))},o=function(){return"setOf("+t.toString()+")"};return{extract:r,toString:o}},Ut=function(n,t){var e=Jn((function(){return t()})),r=function(n,t,r){return e().extract(n,t,r)},o=function(){return e().toString()};return{extract:r,toString:o}},Wt=y(Ft(En.svalue)),Gt=v(jt,zt),qt=Et.state,$t=Et.field,Xt=function(n,t,e,r,o){var i=jn(r,o);return i.fold((function(){return Ot(n,r,o)}),(function(r){return r.extract(n.concat(["branch: "+o]),t,e)}))},Kt=function(n,t){var e=function(e,r,o){var i=jn(o,n);return i.fold((function(){return kt(e,n)}),(function(n){return Xt(e,r,o,t,n)}))},r=function(){return"chooseOn("+n+"). Possible values: "+_n(t)};return{extract:e,toString:r}},Yt=Ft(En.svalue),Jt=function(n){return Gt(n)},Qt=function(){return jt(Yt)},Zt=Nt,ne=function(n){return Ft((function(t){return n(t).fold(En.serror,En.svalue)}))},te=function(n,t){return Vt((function(t){return En.fromResult(n(t))}),t)},ee=function(n,t,e,r){var o=t.extract([n],e,r);return En.mapError(o,(function(n){return{input:r,errors:n}}))},re=function(n,t,e){return En.toResult(ee(n,t,w,e))},oe=function(n){return n.fold((function(n){throw new Error(ue(n))}),w)},ie=function(n,t,e){return oe(re(n,t,e))},ue=function(n){return"Errors: \n"+xt(n.errors).join("\n")+"\n\nInput object: "+wt(n.input)},ae=function(n,t){return Kt(n,t)},ce=function(n,t){return Kt(n,Bn(t,zt))},se=function(n,t){return Ut(n,t)},le=y(Yt),fe=function(n,t){return Ft((function(e){var r=typeof e;return n(e)?En.svalue(e):En.serror("Expected type: "+t+" but got: "+r)}))},de=fe(m,"number"),me=fe(i,"string"),ge=fe(c,"boolean"),pe=fe(d,"function"),he=function(n){var t=function(n,t){var e=n.next();while(!e.done){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return he(n[t])}));case"Map":return t(n.keys(),he)&&t(n.values(),he);case"Set":return t(n.keys(),he);default:return!1}},ve=Ft((function(n){return he(n)?En.svalue(n):En.serror("Expected value to be acceptable for sending via postMessage")})),be=function(n){return ne((function(t){return H(n,t)?vn.value(t):vn.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},ye=function(n){return $t(n,n,tt(),Wt())},we=function(n,t){return $t(n,n,tt(),t)},xe=function(n){return we(n,de)},Se=function(n){return we(n,me)},Ce=function(n,t){return $t(n,n,tt(),be(t))},ke=function(n){return we(n,ge)},Oe=function(n){return we(n,pe)},Te=function(n,t){return $t(n,n,et(),Ft((function(e){return En.serror("The field: "+n+" is forbidden. "+t)})))},De=function(n,t){return $t(n,n,tt(),zt(t))},Ee=function(n,t){return $t(n,n,tt(),Gt(t))},_e=function(n,t){return $t(n,n,tt(),jt(t))},Ae=function(n){return $t(n,n,et(),Wt())},Re=function(n,t){return $t(n,n,et(),t)},Be=function(n){return Re(n,de)},Me=function(n){return Re(n,me)},Ie=function(n){return Re(n,pe)},Ne=function(n,t){return Re(n,jt(t))},Fe=function(n,t){return Re(n,zt(t))},Pe=function(n,t){return Re(n,Lt(t))},Le=function(n,t){return $t(n,n,Zn(t),Wt())},ze=function(n,t,e){return $t(n,n,Zn(t),e)},je=function(n,t){return ze(n,t,de)},He=function(n,t){return ze(n,t,me)},Ve=function(n,t,e){return ze(n,t,be(e))},Ue=function(n,t){return ze(n,t,ge)},We=function(n,t){return ze(n,t,pe)},Ge=function(n,t){return ze(n,t,ve)},qe=function(n,t,e){return ze(n,t,jt(e))},$e=function(n,t,e){return ze(n,t,zt(e))},Xe=function(n,t){return qt(n,t)},Ke=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},Ye=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw new Error("HTML must have a single root node");return Ze(r.childNodes[0])},Je=function(n,t){var e=t||document,r=e.createElement(n);return Ze(r)},Qe=function(n,t){var e=t||document,r=e.createTextNode(n);return Ze(r)},Ze=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},nr=function(n,t,e){return N.from(n.dom.elementFromPoint(t,e)).map(Ze)},tr={fromHtml:Ye,fromTag:Je,fromText:Qe,fromDom:Ze,fromPoint:nr},er=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),s=i||u&&!c,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),f=!s&&!c&&!l;return{isiPad:y(o),isiPhone:y(i),isTablet:y(c),isPhone:y(s),isTouch:y(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:y(l),isDesktop:y(f)}},rr=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}},or=function(n,t){var e=rr(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return ar(r(1),r(2))},ir=function(n,t){var e=String(t).toLowerCase();return 0===n.length?ur():or(n,e)},ur=function(){return ar(0,0)},ar=function(n,t){return{major:n,minor:t}},cr={nu:ar,detect:ir,unknown:ur},sr=function(n,t){var e=String(t).toLowerCase();return Z(n,(function(n){return n.search(e)}))},lr=function(n,t){return sr(n,t).map((function(n){var e=cr.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},fr=function(n,t){return sr(n,t).map((function(n){var e=cr.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},dr={detectBrowser:lr,detectOs:fr},mr=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},gr=function(n,t){return-1!==n.indexOf(t)},pr=function(n,t){return mr(n,t,n.length-t.length)},hr=function(n){return function(t){return t.replace(n,"")}},vr=hr(/^\s+|\s+$/g),br=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,yr=function(n){return function(t){return gr(t,n)}},wr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return gr(n,"edge/")&&gr(n,"chrome")&&gr(n,"safari")&&gr(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,br],search:function(n){return gr(n,"chrome")&&!gr(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return gr(n,"msie")||gr(n,"trident")}},{name:"Opera",versionRegexes:[br,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:yr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:yr("firefox")},{name:"Safari",versionRegexes:[br,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(gr(n,"safari")||gr(n,"mobile/"))&&gr(n,"applewebkit")}}],xr=[{name:"Windows",search:yr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return gr(n,"iphone")||gr(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:yr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:yr("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:yr("linux"),versionRegexes:[]},{name:"Solaris",search:yr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:yr("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:yr("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Sr={browsers:y(wr),oses:y(xr)},Cr="Edge",kr="Chrome",Or="IE",Tr="Opera",Dr="Firefox",Er="Safari",_r=function(){return Ar({current:void 0,version:cr.unknown()})},Ar=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(Cr),isChrome:r(kr),isIE:r(Or),isOpera:r(Tr),isFirefox:r(Dr),isSafari:r(Er)}},Rr={unknown:_r,nu:Ar,edge:y(Cr),chrome:y(kr),ie:y(Or),opera:y(Tr),firefox:y(Dr),safari:y(Er)},Br="Windows",Mr="iOS",Ir="Android",Nr="Linux",Fr="OSX",Pr="Solaris",Lr="FreeBSD",zr="ChromeOS",jr=function(){return Hr({current:void 0,version:cr.unknown()})},Hr=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(Br),isiOS:r(Mr),isAndroid:r(Ir),isOSX:r(Fr),isLinux:r(Nr),isSolaris:r(Pr),isFreeBSD:r(Lr),isChromeOS:r(zr)}},Vr={unknown:jr,nu:Hr,windows:y(Br),ios:y(Mr),android:y(Ir),linux:y(Nr),osx:y(Fr),solaris:y(Pr),freebsd:y(Lr),chromeos:y(zr)},Ur=function(n,t){var e=Sr.browsers(),r=Sr.oses(),o=dr.detectBrowser(e,n).fold(Rr.unknown,Rr.nu),i=dr.detectOs(r,n).fold(Vr.unknown,Vr.nu),u=er(i,o,n,t);return{browser:o,os:i,deviceType:u}},Wr={detect:Ur},Gr=function(n){return window.matchMedia(n).matches},qr=Jn((function(){return Wr.detect(navigator.userAgent,Gr)})),$r=function(){return qr()},Xr=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},Kr=function(n,t){return Xr(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},Yr=9,Jr=11,Qr=1,Zr=3,no=function(n,t){var e=n.dom;if(e.nodeType!==Qr)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},to=function(n){return n.nodeType!==Qr&&n.nodeType!==Yr&&n.nodeType!==Jr||0===n.childElementCount},eo=function(n,t){var e=void 0===t?document:t.dom;return to(e)?[]:G(e.querySelectorAll(n),tr.fromDom)},ro=function(n,t){var e=void 0===t?document:t.dom;return to(e)?N.none():N.from(e.querySelector(n)).map(tr.fromDom)},oo=function(n,t){return n.dom===t.dom},io=function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)},uo=function(n,t){return Kr(n.dom,t.dom)},ao=function(n,t){return $r().browser.isIE()?uo(n,t):io(n,t)},co=function(n){return d(n)?n:k},so=function(n,t,e){var r=n.dom,o=co(e);while(r.parentNode){r=r.parentNode;var i=tr.fromDom(r),u=t(i);if(u.isSome())return u;if(o(i))break}return N.none()},lo=function(n,t,e){var r=t(n),o=co(e);return r.orThunk((function(){return o(n)?N.none():so(n,t,o)}))},fo=function(n,t){return oo(n.element,t.event.target)},mo=function(n){if(!Vn(n,"can")&&!Vn(n,"abort")&&!Vn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return ie("Extracting event.handler",Lt([Le("can",O),Le("abort",k),Le("run",p)]),n)},go=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return J(n,(function(n,r){return n&&t(r).apply(void 0,e)}),!0)}},po=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return J(n,(function(n,r){return n||t(r).apply(void 0,e)}),!1)}},ho=function(n){return d(n)?{can:O,abort:k,run:n}:n},vo=function(n){var t=go(n,(function(n){return n.can})),e=po(n,(function(n){return n.abort})),r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];q(n,(function(n){n.run.apply(void 0,t)}))};return mo({can:t,abort:e,run:r})},bo=y,yo=bo("touchstart"),wo=bo("touchmove"),xo=bo("touchend"),So=bo("touchcancel"),Co=bo("mousedown"),ko=bo("mousemove"),Oo=bo("mouseout"),To=bo("mouseup"),Do=bo("mouseover"),Eo=bo("focusin"),_o=bo("focusout"),Ao=bo("keydown"),Ro=bo("keyup"),Bo=bo("input"),Mo=bo("change"),Io=bo("click"),No=bo("transitionend"),Fo=bo("selectstart"),Po=function(n){return y("alloy."+n)},Lo={tap:Po("tap")},zo=Po("focus"),jo=Po("blur.post"),Ho=Po("paste.post"),Vo=Po("receive"),Uo=Po("execute"),Wo=Po("focus.item"),Go=Lo.tap,qo=Po("longpress"),$o=Po("sandbox.close"),Xo=Po("typeahead.cancel"),Ko=Po("system.init"),Yo=Po("system.touchmove"),Jo=Po("system.touchend"),Qo=Po("system.scroll"),Zo=Po("system.resize"),ni=Po("system.attached"),ti=Po("system.detached"),ei=Po("system.dismissRequested"),ri=Po("system.repositionRequested"),oi=Po("focusmanager.shifted"),ii=Po("slotcontainer.visibility"),ui=Po("change.tab"),ai=Po("dismiss.tab"),ci=Po("highlight"),si=Po("dehighlight"),li=function(n,t){gi(n,n.element,t,{})},fi=function(n,t,e){gi(n,n.element,t,e)},di=function(n){li(n,Uo())},mi=function(n,t,e){gi(n,t,e,{})},gi=function(n,t,e,r){var o=D({target:t},r);n.getSystem().triggerEvent(e,t,o)},pi=function(n,t,e,r){n.getSystem().triggerEvent(e,t,r.event)},hi=function(n){return ft(n)},vi=function(n,t){return{key:n,value:mo({abort:t})}},bi=function(n,t){return{key:n,value:mo({can:t})}},yi=function(n){return{key:n,value:mo({run:function(n,t){t.event.prevent()}})}},wi=function(n,t){return{key:n,value:mo({run:t})}},xi=function(n,t,e){return{key:n,value:mo({run:function(n,r){t.apply(void 0,[n,r].concat(e))}})}},Si=function(n){return function(t){return wi(n,t)}},Ci=function(n){return function(t){return{key:n,value:mo({run:function(n,e){fo(n,e)&&t(n,e)}})}}},ki=function(n,t){return wi(n,(function(e,r){e.getSystem().getByUid(t).each((function(t){pi(t,t.element,n,r)}))}))},Oi=function(n,t,e){var r=t.partUids[e];return ki(n,r)},Ti=function(n,t){return wi(n,(function(n,e){var r=e.event,o=n.getSystem().getByDom(r.target).fold((function(){var t=lo(r.target,(function(t){return n.getSystem().getByDom(t).toOptional()}),k);return t.getOr(n)}),(function(n){return n}));t(n,o,e)}))},Di=function(n){return wi(n,(function(n,t){t.cut()}))},Ei=function(n){return wi(n,(function(n,t){t.stop()}))},_i=function(n,t){return Ci(n)(t)},Ai=Ci(ni()),Ri=Ci(ti()),Bi=Ci(Ko()),Mi=Si(Uo()),Ii=("undefined"!==typeof window?window:Function("return this;")(),function(n){var t=n.dom.nodeName;return t.toLowerCase()}),Ni=function(n){return n.dom.nodeType},Fi=function(n){return function(t){return Ni(t)===n}},Pi=Fi(Qr),Li=Fi(Zr),zi=Fi(Yr),ji=Fi(Jr),Hi=function(n){return tr.fromDom(n.dom.ownerDocument)},Vi=function(n){return zi(n)?n:Hi(n)},Ui=function(n){return tr.fromDom(Vi(n).dom.documentElement)},Wi=function(n){return tr.fromDom(Vi(n).dom.defaultView)},Gi=function(n){return N.from(n.dom.parentNode).map(tr.fromDom)},qi=function(n){return Gi(n)},$i=function(n){return N.from(n.dom.offsetParent).map(tr.fromDom)},Xi=function(n){return N.from(n.dom.nextSibling).map(tr.fromDom)},Ki=function(n){return G(n.dom.childNodes,tr.fromDom)},Yi=function(n,t){var e=n.dom.childNodes;return N.from(e[t]).map(tr.fromDom)},Ji=function(n){return Yi(n,0)},Qi=function(n){return ji(n)&&f(n.dom.host)},Zi=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),nu=y(Zi),tu=Zi?function(n){return tr.fromDom(n.dom.getRootNode())}:Vi,eu=function(n){return Qi(n)?n:tr.fromDom(Vi(n).dom.body)},ru=function(n){return ou(n).isSome()},ou=function(n){var t=tu(n);return Qi(t)?N.some(t):N.none()},iu=function(n){return tr.fromDom(n.dom.host)},uu=function(n){if(nu()&&f(n.target)){var t=tr.fromDom(n.target);if(Pi(t)&&au(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return ln(e)}}return N.from(n.target)},au=function(n){return f(n.dom.shadowRoot)},cu=function(n,t){var e=Gi(n);e.each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},su=function(n,t){var e=Xi(n);e.fold((function(){var e=Gi(n);e.each((function(n){fu(n,t)}))}),(function(n){cu(n,t)}))},lu=function(n,t){var e=Ji(n);e.fold((function(){fu(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},fu=function(n,t){n.dom.appendChild(t.dom)},du=function(n,t,e){Yi(n,e).fold((function(){fu(n,t)}),(function(n){cu(n,t)}))},mu=function(n,t){q(t,(function(t){cu(n,t)}))},gu=function(n,t){q(t,(function(t){fu(n,t)}))},pu=function(n){n.dom.textContent="",q(Ki(n),(function(n){hu(n)}))},hu=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},vu=function(n){var t=Ki(n);t.length>0&&mu(n,t),hu(n)},bu=function(n,t){var e=t||document,r=e.createElement("div");return r.innerHTML=n,Ki(tr.fromDom(r))},yu=function(n){return n.dom.innerHTML},wu=function(n,t){var e=Hi(n),r=e.dom,o=tr.fromDom(r.createDocumentFragment()),i=bu(t,r);gu(o,i),pu(n),fu(n,o)},xu=function(n){var t=tr.fromTag("div"),e=tr.fromDom(n.dom.cloneNode(!0));return fu(t,e),yu(t)},Su=function(n,t,e){if(!(i(e)||c(e)||m(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")},Cu=function(n,t,e){Su(n.dom,t,e)},ku=function(n,t){var e=n.dom;Rn(t,(function(n,t){Su(e,t,n)}))},Ou=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},Tu=function(n,t){return N.from(Ou(n,t))},Du=function(n,t){var e=n.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},Eu=function(n,t){n.dom.removeAttribute(t)},_u=function(n,t){return tr.fromDom(n.dom.cloneNode(t))},Au=function(n){return _u(n,!1)},Ru=function(n){if(Qi(n))return"#shadow-root";var t=Au(n);return xu(t)},Bu=function(n){return Ru(n)},Mu=function(n,t,e){return oo(t,n.element)&&!oo(t,e)},Iu=hi([bi(zo(),(function(n,t){var e=t.event,r=e.originator,o=e.target;return!Mu(n,r,o)}))]),Nu=Object.freeze({__proto__:null,events:Iu}),Fu=0,Pu=function(n){var t=new Date,e=t.getTime(),r=Math.floor(1e9*Math.random());return Fu++,n+"_"+r+Fu+String(e)},Lu=y("alloy-id-"),zu=y("data-alloy-id"),ju=Lu(),Hu=zu(),Vu=function(n,t){var e=Pu(ju+n);return Uu(t,e),e},Uu=function(n,t){Object.defineProperty(n.dom,Hu,{value:t,writable:!0})},Wu=function(n){var t=Pi(n)?n.dom[Hu]:null;return N.from(t)},Gu=function(n){return Pu(n)},qu=w,$u=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Bu(n().element)+" is not in context.":""))}};return{debugInfo:y("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:k}},Xu=$u(),Ku=function(n,t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Yu(u.slice(0,1).concat(u.slice(3)))}},n},Yu=function(n){return G(n,(function(n){return pr(n,"/*")?n.substring(0,n.length-"/*".length):n}))},Ju=function(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Yu(i)}},n},Qu=function(n,t){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Yu(i.slice(1))}},n},Zu=Pu("alloy-premade"),na=function(n){return lt(Zu,n)},ta=function(n){return jn(n,Zu)},ea=function(n){return Qu((function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return n.apply(void 0,_([t.getApis(),t],e))}),n)},ra={init:function(){return oa({readState:function(){return"No State required"}})}},oa=function(n){return n},ia=function(n,t){var e=G(t,(function(n){return Fe(n.name(),[ye("config"),Le("state",ra)])})),r=re("component.behaviours",zt(e),n.behaviours).fold((function(t){throw new Error(ue(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:Bn(r,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}},ua=function(n){return n.list},aa=function(n){return n.data},ca=function(n,t){var e={};return Rn(n,(function(n,r){Rn(n,(function(n,o){var i=jn(e,o).getOr([]);e[o]=i.concat([t(r,n)])}))})),e},sa=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},la=function(n,t){return D(D({},n),{attributes:D(D({},n.attributes),t.attributes),styles:D(D({},n.styles),t.styles),classes:n.classes.concat(t.classes)})},fa=function(n,t,e,r){var o=D({},t);q(e,(function(t){o[t.name()]=t.exhibit(n,r)}));var i=ca(o,(function(n,t){return{name:n,modification:t}})),u=function(n){return Y(n,(function(n,t){return D(D({},t.modification),n)}),{})},a=Y(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles);return sa({classes:a,attributes:c,styles:s})},da=function(n,t,e,r){try{var o=cn(e,(function(e,o){var i=e[t],u=o[t],a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0}));return vn.value(o)}catch(i){return vn.error([i])}},ma=function(n,t){return{handler:n,purpose:t}},ga=function(n,t){return{cHandler:n,purpose:t}},pa=function(n,t){return ga(x.apply(void 0,[n.handler].concat(t)),n.purpose)},ha=function(n){return n.cHandler},va=function(n,t){return{name:n,handler:t}},ba=function(n,t){var e={};return q(n,(function(n){e[n.name()]=n.handlers(t)})),e},ya=function(n,t,e){var r=D(D({},e),ba(t,n));return ca(r,va)},wa=function(n,t,e,r){var o=ya(n,e,r);return ka(o,t)},xa=function(n){var t=ho(n);return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,e].concat(r);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},Sa=function(n,t){return vn.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(G(t,(function(n){return n.name})),null,2)])},Ca=function(n,t,e){var r=t[e];return r?da("Event: "+e,"name",n,r).map((function(n){var t=G(n,(function(n){return n.handler}));return vo(t)})):Sa(e,n)},ka=function(n,t){var e=Pn(n,(function(n,e){var r=1===n.length?vn.value(n[0].handler):Ca(n,t,e);return r.map((function(r){var o=xa(r),i=n.length>1?K(t[e],(function(t){return V(n,(function(n){return n.name===t}))})).join(" > "):n[0].name;return lt(e,ma(o,i))}))}));return gt(e,{})},Oa="alloy.base.behaviour",Ta=function(n){var t;return re("custom.definition",zt([$t("dom","dom",tt(),zt([ye("tag"),Le("styles",{}),Le("classes",[]),Le("attributes",{}),Ae("value"),Ae("innerHtml")])),ye("components"),ye("uid"),Le("events",{}),Le("apis",{}),$t("eventOrder","eventOrder",nt((t={},t[Uo()]=["disabling",Oa,"toggling","typeaheadevents"],t[zo()]=[Oa,"focusing","keying"],t[Ko()]=[Oa,"disabling","toggling","representing"],t[Bo()]=[Oa,"representing","streaming","invalidating"],t[ti()]=[Oa,"representing","item-events","tooltipping"],t[Co()]=["focusing",Oa,"item-type-events"],t[yo()]=["focusing",Oa,"item-type-events"],t[Do()]=["item-type-events","tooltipping"],t[Vo()]=["receiving","reflecting","tooltipping"],t)),le()),Ae("domModification")]),n)},Da=function(n){return D(D({},n.dom),{uid:n.uid,domChildren:G(n.components,(function(n){return n.element}))})},Ea=function(n){return n.domModification.fold((function(){return sa({})}),sa)},_a=function(n){return n.events},Aa=function(n,t){var e=Ou(n,t);return void 0===e||""===e?[]:e.split(" ")},Ra=function(n,t,e){var r=Aa(n,t),o=r.concat([e]);return Cu(n,t,o.join(" ")),!0},Ba=function(n,t,e){var r=K(Aa(n,t),(function(n){return n!==e}));return r.length>0?Cu(n,t,r.join(" ")):Eu(n,t),!1},Ma=function(n){return void 0!==n.dom.classList},Ia=function(n){return Aa(n,"class")},Na=function(n,t){return Ra(n,"class",t)},Fa=function(n,t){return Ba(n,"class",t)},Pa=function(n,t){Ma(n)?n.dom.classList.add(t):Na(n,t)},La=function(n){var t=Ma(n)?n.dom.classList:Ia(n);0===t.length&&Eu(n,"class")},za=function(n,t){if(Ma(n)){var e=n.dom.classList;e.remove(t)}else Fa(n,t);La(n)},ja=function(n,t){return Ma(n)&&n.dom.classList.contains(t)},Ha=function(n,t){q(t,(function(t){Pa(n,t)}))},Va=function(n,t){q(t,(function(t){za(n,t)}))},Ua=function(n){return void 0!==n.style&&d(n.style.getPropertyValue)},Wa=function(n){var t=Li(n)?n.dom.parentNode:n.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var e=t.ownerDocument;return ou(tr.fromDom(t)).fold((function(){return e.body.contains(t)}),b(Wa,iu))},Ga=function(){return qa(tr.fromDom(document))},qa=function(n){var t=n.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return tr.fromDom(t)},$a=function(n,t,e){if(!i(e))throw new Error("CSS value must be a string: "+e);Ua(n)&&n.style.setProperty(t,e)},Xa=function(n,t){Ua(n)&&n.style.removeProperty(t)},Ka=function(n,t,e){var r=n.dom;$a(r,t,e)},Ya=function(n,t){var e=n.dom;Rn(t,(function(n,t){$a(e,t,n)}))},Ja=function(n,t){var e=n.dom;Rn(t,(function(n,t){n.fold((function(){Xa(e,t)}),(function(n){$a(e,t,n)}))}))},Qa=function(n,t){var e=n.dom,r=window.getComputedStyle(e),o=r.getPropertyValue(t);return""!==o||Wa(n)?o:Za(e,t)},Za=function(n,t){return Ua(n)?n.style.getPropertyValue(t):""},nc=function(n,t){var e=n.dom,r=Za(e,t);return N.from(r).filter((function(n){return n.length>0}))},tc=function(n){var t={},e=n.dom;if(Ua(e))for(var r=0;r<e.style.length;r++){var o=e.style.item(r);t[o]=e.style[o]}return t},ec=function(n,t,e){var r=tr.fromTag(n);Ka(r,t,e);var o=nc(r,t);return o.isSome()},rc=function(n,t){var e=n.dom;Xa(e,t),Tu(n,"style").map(vr).is("")&&Eu(n,"style")},oc=function(n){return n.dom.offsetWidth},ic=function(n){return n.dom.value},uc=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom.value=t},ac=function(n){var t=tr.fromTag(n.tag);ku(t,n.attributes),Ha(t,n.classes),Ya(t,n.styles),n.innerHtml.each((function(n){return wu(t,n)}));var e=n.domChildren;return gu(t,e),n.value.each((function(n){uc(t,n)})),n.uid,Uu(t,n.uid),t},cc=function(n){var t=jn(n,"behaviours").getOr({}),e=K(_n(t),(function(n){return void 0!==t[n]}));return G(e,(function(n){return t[n].me}))},sc=function(n,t){return ia(n,t)},lc=function(n){var t=cc(n);return sc(n,t)},fc=function(n,t,e){var r=Da(n),o=Ea(n),i={"alloy.base.modification":o},u=t.length>0?fa(e,i,t,r):o;return la(r,u)},dc=function(n,t,e){var r={"alloy.base.behaviour":_a(n)};return wa(e,n.eventOrder,t,r).getOrDie()},mc=function(n){var t=function(){return y},e=Ke(Xu),r=oe(Ta(n)),o=lc(n),i=ua(o),u=aa(o),a=fc(r,i,u),c=ac(a),s=dc(r,i,u),l=Ke(r.components),f=function(n){e.set(n)},m=function(){e.set($u(t))},g=function(){var n=Ki(c),t=en(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));l.set(t)},p=function(t){var e=u,r=d(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))};return r()},h=function(n){return d(u[n.name()])},v=function(){return r.apis},b=function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},y={getSystem:e.get,config:p,hasConfigured:h,spec:n,readState:b,getApis:v,connect:f,disconnect:m,element:c,syncComponents:g,components:l.get,events:s};return y},gc=function(n){var t=jn(n,"components").getOr([]);return G(t,yc)},pc=function(n){var t=qu(n),e=t.events,r=E(t,["events"]),o=gc(r),i=D(D({},r),{events:D(D({},Nu),e),components:o});return vn.value(mc(i))},hc=function(n){var t=tr.fromText(n);return vc({element:t})},vc=function(n){var t=ie("external.component",Lt([ye("element"),Ae("uid")]),n),e=Ke($u()),r=function(n){e.set(n)},o=function(){e.set($u((function(){return i})))};t.uid.each((function(n){Uu(t.element,n)}));var i={getSystem:e.get,config:N.none,hasConfigured:k,connect:r,disconnect:o,getApis:function(){return{}},element:t.element,spec:n,readState:y("No state"),syncComponents:p,components:y([]),events:{}};return na(i)},bc=Gu,yc=function(n){return ta(n).fold((function(){var t=n.hasOwnProperty("uid")?n:D({uid:bc("")},n);return pc(t).getOrDie()}),(function(n){return n}))},wc=na,xc=function(n,t){var e=function(t,e){if(!m(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;Ua(r)&&(r.style[n]=e+"px")},r=function(e){var r=t(e);if(r<=0||null===r){var o=Qa(e,n);return parseFloat(o)||0}return r},o=r,i=function(n,t){return J(t,(function(t,e){var r=Qa(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)},u=function(n,t,e){var r=i(n,e),o=t>r?t-r:0;return o};return{set:e,get:r,getOuter:o,aggregate:i,max:u}},Sc=xc("height",(function(n){var t=n.dom;return Wa(n)?t.getBoundingClientRect().height:t.offsetHeight})),Cc=function(n){return Sc.get(n)},kc=function(n){return Sc.getOuter(n)},Oc=function(n,t){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=Sc.max(n,t,e);Ka(n,"max-height",r+"px")},Tc=function(n,t){var e=function(e,r){return Tc(n+e,t+r)};return{left:n,top:t,translate:e}},Dc=Tc,Ec=function(n){var t=n.getBoundingClientRect();return Dc(t.left,t.top)},_c=function(n,t){return void 0!==n?n:void 0!==t?t:0},Ac=function(n){var t=n.dom.ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom)return Dc(e.offsetLeft,e.offsetTop);var i=_c(null===r||void 0===r?void 0:r.pageYOffset,o.scrollTop),u=_c(null===r||void 0===r?void 0:r.pageXOffset,o.scrollLeft),a=_c(o.clientTop,e.clientTop),c=_c(o.clientLeft,e.clientLeft);return Rc(n).translate(u-c,i-a)},Rc=function(n){var t=n.dom,e=t.ownerDocument,r=e.body;return r===t?Dc(r.offsetLeft,r.offsetTop):Wa(n)?Ec(t):Dc(0,0)},Bc=xc("width",(function(n){return n.dom.offsetWidth})),Mc=function(n,t){return Bc.set(n,t)},Ic=function(n){return Bc.get(n)},Nc=function(n){return Bc.getOuter(n)},Fc=function(n,t){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=Bc.max(n,t,e);Ka(n,"max-width",r+"px")},Pc=function(n,t,e,r,o,i,u){return{target:n,x:t,y:e,stop:r,prevent:o,kill:i,raw:u}},Lc=function(n){var t=tr.fromDom(uu(n).getOr(n.target)),e=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=v(r,e);return Pc(t,n.clientX,n.clientY,e,r,o,n)},zc=function(n,t){return function(e){n(e)&&t(Lc(e))}},jc=function(n,t,e,r,o){var i=zc(e,r);return n.dom.addEventListener(t,i,o),{unbind:x(Uc,n,t,i,o)}},Hc=function(n,t,e,r){return jc(n,t,e,r,!1)},Vc=function(n,t,e,r){return jc(n,t,e,r,!0)},Uc=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},Wc=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Dc(e,r)},Gc=function(n,t,e){var r=void 0!==e?e.dom:document,o=r.defaultView;o&&o.scrollTo(n,t)},qc=function(n){var t=void 0===n?window:n;return N.from(t["visualViewport"])},$c=function(n,t,e,r){return{x:n,y:t,width:e,height:r,right:n+e,bottom:t+r}},Xc=function(n){var t=void 0===n?window:n,e=t.document,r=Wc(tr.fromDom(e));return qc(t).fold((function(){var n=t.document.documentElement,e=n.clientWidth,o=n.clientHeight;return $c(r.left,r.top,e,o)}),(function(n){return $c(Math.max(n.pageLeft,r.left),Math.max(n.pageTop,r.top),n.width,n.height)}))},Kc=function(n,t){var e=n.view(t);return e.fold(y([]),(function(t){var e=n.owner(t),r=Kc(n,e);return[t].concat(r)}))},Yc=function(n,t){var e=t.owner(n),r=Kc(t,e);return N.some(r)},Jc=function(n){var t,e=n.dom===document?N.none():N.from(null===(t=n.dom.defaultView)||void 0===t?void 0:t.frameElement);return e.map(tr.fromDom)},Qc=function(n){return Hi(n)},Zc=Object.freeze({__proto__:null,view:Jc,owner:Qc}),ns=function(n){var t=tr.fromDom(document),e=Wc(t),r=Yc(n,Zc);return r.fold(x(Ac,n),(function(t){var r=Rc(n),o=Y(t,(function(n,t){var e=Rc(t);return{left:n.left+e.left,top:n.top+e.top}}),{left:0,top:0});return Dc(o.left+r.left+e.left,o.top+r.top+e.top)}))},ts=function(n,t,e){return{point:n,width:t,height:e}},es=function(n,t,e,r){return{x:n,y:t,width:e,height:r}},rs=function(n,t,e,r){return{x:n,y:t,width:e,height:r,right:n+e,bottom:t+r}},os=function(n){var t=Ac(n),e=Nc(n),r=kc(n);return rs(t.left,t.top,e,r)},is=function(n){var t=ns(n),e=Nc(n),r=kc(n);return rs(t.left,t.top,e,r)},us=function(){return Xc(window)};function as(n,t,e,r,o){return n(e,r)?N.some(e):d(o)&&o(e)?N.none():t(e,r,o)}var cs,ss=function(n,t,e){var r=n.dom,o=d(e)?e:k;while(r.parentNode){r=r.parentNode;var i=tr.fromDom(r);if(t(i))return N.some(i);if(o(i))break}return N.none()},ls=function(n,t,e){var r=function(n,t){return t(n)};return as(r,ss,n,t,e)},fs=function(n,t){var e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=tr.fromDom(n.childNodes[r]);if(t(o))return N.some(o);var i=e(n.childNodes[r]);if(i.isSome())return i}return N.none()};return e(n.dom)},ds=function(n,t,e){return ls(n,t,e).isSome()},ms=function(n,t,e){return ss(n,(function(n){return no(n,t)}),e)},gs=function(n,t){return ro(t,n)},ps=function(n,t,e){var r=function(n,t){return no(n,t)};return as(r,ms,n,t,e)},hs=function(n){var t=ls(n,(function(n){if(!Pi(n))return!1;var t=Ou(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1}));return t.bind((function(n){var t=Ou(n,"id"),e=tu(n);return gs(e,'[aria-owns="'+t+'"]')}))},vs=function(){var n=Pu("aria-owns"),t=function(t){Cu(t,"aria-owns",n)},e=function(n){Eu(n,"aria-owns")};return{id:n,link:t,unlink:e}},bs=function(n,t){return hs(t).exists((function(t){return ys(n,t)}))},ys=function(n,t){return ds(t,(function(t){return oo(t,n.element)}),k)||bs(n,t)},ws="unknown";(function(n){n[n["STOP"]=0]="STOP",n[n["NORMAL"]=1]="NORMAL",n[n["LOGGING"]=2]="LOGGING"})(cs||(cs={}));var xs,Ss=Ke({}),Cs=function(n,t){var e=[];(new Date).getTime();return{logEventCut:function(n,t,r){e.push({outcome:"cut",target:t,purpose:r})},logEventStopped:function(n,t,r){e.push({outcome:"stopped",target:t,purpose:r})},logNoParent:function(n,t,r){e.push({outcome:"no-parent",target:t,purpose:r})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,r){e.push({outcome:"response",purpose:r,target:t})},write:function(){(new Date).getTime();H(["mousemove","mouseover","mouseout",Ko()],n)}}},ks=function(n,t,e){var r=jn(Ss.get(),n).orThunk((function(){var t=_n(Ss.get());return mn(t,(function(t){return n.indexOf(t)>-1?N.some(Ss.get()[t]):N.none()}))})).getOr(cs.NORMAL);switch(r){case cs.NORMAL:return e(_s());case cs.LOGGING:var o=Cs(n,t),i=e(o);return o.write(),i;case cs.STOP:return!0}},Os=["alloy/data/Fields","alloy/debugging/Debugging"],Ts=function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return Z(t,(function(n){return n.indexOf("alloy")>0&&!V(Os,(function(t){return n.indexOf(t)>-1}))})).getOr(ws)}return ws},Ds={logEventCut:p,logEventStopped:p,logNoParent:p,logEventNoHandlers:p,logEventResponse:p,write:p},Es=function(n,t,e){return ks(n,t,e)},_s=y(Ds),As=y([ye("menu"),ye("selectedMenu")]),Rs=y([ye("item"),ye("selectedItem")]),Bs=(y(zt(Rs().concat(As()))),y(zt(Rs()))),Ms=De("initSize",[ye("numColumns"),ye("numRows")]),Is=function(){return we("markers",Bs())},Ns=function(){return De("markers",[ye("backgroundMenu")].concat(As()).concat(Rs()))},Fs=function(n){return De("markers",G(n,ye))},Ps=function(n,t,e){Ts();return $t(t,t,e,ne((function(n){return vn.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},Ls=function(n){return Ps("onHandler",n,Zn(p))},zs=function(n){return Ps("onKeyboardHandler",n,Zn(N.none))},js=function(n){return Ps("onHandler",n,tt())},Hs=function(n){return Ps("onKeyboardHandler",n,tt())},Vs=function(n,t){return Xe(n,y(t))},Us=function(n){return Xe(n,w)},Ws=y(Ms),Gs=function(n,t,e,r,o,i){return{x:n,y:t,bubble:e,direction:r,boundsRestriction:o,label:i}},qs=Wn.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),$s=function(n,t,e,r,o,i,u,a,c){return n.fold(t,e,r,o,i,u,a,c)},Xs=function(n,t,e,r){return n.fold(t,t,r,r,t,r,e,e)},Ks=function(n,t,e,r){return n.fold(t,r,t,r,e,e,t,r)},Ys=qs.southeast,Js=qs.southwest,Qs=qs.northeast,Zs=qs.northwest,nl=qs.south,tl=qs.north,el=qs.east,rl=qs.west,ol=function(n,t){switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}},il=function(n,t){return an(["left","right","top","bottom"],(function(e){return jn(t,e).map((function(t){return ol(n,t)}))}))},ul=function(n,t,e){var r=function(n,r){var o="top"===n||"bottom"===n?e.top:e.left;return jn(t,n).bind(w).bind((function(t){return"left"===n||"top"===n?t>=r?N.some(t):N.none():t<=r?N.some(t):N.none()})).map((function(n){return n+o})).getOr(r)},o=r("left",n.x),i=r("top",n.y),u=r("right",n.right),a=r("bottom",n.bottom);return rs(o,i,u-o,a-i)},al=function(n){return n.x},cl=function(n,t){return n.x+n.width/2-t.width/2},sl=function(n,t){return n.x+n.width-t.width},ll=function(n,t){return n.y-t.height},fl=function(n){return n.y+n.height},dl=function(n,t){return n.y+n.height/2-t.height/2},ml=function(n){return n.x+n.width},gl=function(n,t){return n.x-t.width},pl=function(n,t,e){return Gs(al(n),fl(n),e.southeast(),Ys(),il(n,{left:1,top:3}),"layout-se")},hl=function(n,t,e){return Gs(sl(n,t),fl(n),e.southwest(),Js(),il(n,{right:0,top:3}),"layout-sw")},vl=function(n,t,e){return Gs(al(n),ll(n,t),e.northeast(),Qs(),il(n,{left:1,bottom:2}),"layout-ne")},bl=function(n,t,e){return Gs(sl(n,t),ll(n,t),e.northwest(),Zs(),il(n,{right:0,bottom:2}),"layout-nw")},yl=function(n,t,e){return Gs(cl(n,t),ll(n,t),e.north(),tl(),il(n,{bottom:2}),"layout-n")},wl=function(n,t,e){return Gs(cl(n,t),fl(n),e.south(),nl(),il(n,{top:3}),"layout-s")},xl=function(n,t,e){return Gs(ml(n),dl(n,t),e.east(),el(),il(n,{left:0}),"layout-e")},Sl=function(n,t,e){return Gs(gl(n,t),dl(n,t),e.west(),rl(),il(n,{right:1}),"layout-w")},Cl=function(){return[pl,hl,vl,bl,wl,yl,xl,Sl]},kl=function(){return[hl,pl,bl,vl,wl,yl,xl,Sl]},Ol=function(){return[vl,bl,pl,hl,yl,wl]},Tl=function(){return[bl,vl,hl,pl,yl,wl]},Dl=function(){return[pl,hl,vl,bl,wl,yl]},El=function(){return[hl,pl,bl,vl,wl,yl]},_l=function(n,t){return t.universal?n:K(n,(function(n){return H(t.channels,n)}))},Al=function(n){return hi([wi(Vo(),(function(t,e){var r=n.channels,o=_n(r),i=e,u=_l(o,i);q(u,(function(n){var e=r[n],o=e.schema,u=ie("channel["+n+"] data\nReceiver: "+Bu(t.element),o,i.data);e.onReceive(t,u)}))}))])},Rl=Object.freeze({__proto__:null,events:Al}),Bl=[we("channels",te(vn.value,Lt([js("onReceive"),Le("schema",le())])))],Ml=function(n,t,e){return Mi((function(r){e(r,n,t)}))},Il=function(n,t,e){return Bi((function(r,o){e(r,n,t)}))},Nl=function(n,t,e,r,o,i){var u=Lt(n),a=Fe(t,[Pe("config",n)]);return zl(u,a,t,e,r,o,i)},Fl=function(n,t,e,r,o,i){var u=n,a=Fe(t,[Re("config",n)]);return zl(u,a,t,e,r,o,i)},Pl=function(n,t,e){var r=function(r){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[r].concat(o);return r.config({name:y(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(u,1);return t.apply(void 0,[r,n.config,n.state].concat(e))}))};return Ku(r,e,t)},Ll=function(n){return{key:n,value:void 0}},zl=function(n,t,e,r,o,i,u){var a=function(n){return Vn(n,e)?n[e]():N.none()},c=Bn(o,(function(n,t){return Pl(e,n,t)})),s=Bn(i,(function(n,t){return Ju(n,t)})),l=D(D(D({},s),c),{revoke:x(Ll,e),config:function(t){var r=ie(e+"-config",n,t);return{key:e,value:{config:r,me:l,configAsRaw:Jn((function(){return ie(e+"-config",n,t)})),initialConfig:t,state:u}}},schema:y(t),exhibit:function(n,t){return a(n).bind((function(n){return jn(r,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(sa({}))},name:y(e),handlers:function(n){return a(n).map((function(n){var t=jn(r,"events").getOr((function(){return{}}));return t(n.config,n.state)})).getOr({})}});return l},jl=function(n){return ft(n)},Hl=Lt([ye("fields"),ye("name"),Le("active",{}),Le("apis",{}),Le("state",ra),Le("extra",{})]),Vl=function(n){var t=ie("Creating behaviour: "+n.name,Hl,n);return Nl(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Ul=Lt([ye("branchKey"),ye("branches"),ye("name"),Le("active",{}),Le("apis",{}),Le("state",ra),Le("extra",{})]),Wl=function(n){var t=ie("Creating behaviour: "+n.name,Ul,n);return Fl(ce(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Gl=y(void 0),ql=Vl({fields:Bl,name:"receiving",active:Rl}),$l=function(n,t){return sa({classes:[],styles:t.useFixed()?{}:{position:"relative"}})},Xl=Object.freeze({__proto__:null,exhibit:$l}),Kl=function(){return tr.fromDom(document)},Yl=function(n){return n.dom.focus()},Jl=function(n){return n.dom.blur()},Ql=function(n){var t=tu(n).dom;return n.dom===t.activeElement},Zl=function(n){return void 0===n&&(n=Kl()),N.from(n.dom.activeElement).map(tr.fromDom)},nf=function(n){return Zl(tu(n)).filter((function(t){return n.dom.contains(t.dom)}))},tf=function(n,t){var e=tu(t),r=Zl(e).bind((function(n){var e=function(t){return oo(n,t)};return e(t)?N.some(t):fs(t,e)})),o=n(t);return r.each((function(n){Zl(e).filter((function(t){return oo(t,n)})).fold((function(){Yl(n)}),p)})),o},ef=function(n,t,e,r,o){return{position:n,left:t,top:e,right:r,bottom:o}},rf=function(n,t){var e=function(n){return n+"px"};Ja(n,{position:N.some(t.position),left:t.left.map(e),top:t.top.map(e),right:t.right.map(e),bottom:t.bottom.map(e)})},of=Wn.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),uf=function(n,t,e,r,o,i){var u=t.x-e,a=t.y-r,c=t.width,s=t.height,l=o-(u+c),f=i-(a+s),d=N.some(u),m=N.some(a),g=N.some(l),p=N.some(f),h=N.none();return $s(t.direction,(function(){return ef(n,d,m,h,h)}),(function(){return ef(n,h,m,g,h)}),(function(){return ef(n,d,h,h,p)}),(function(){return ef(n,h,h,g,p)}),(function(){return ef(n,d,m,h,h)}),(function(){return ef(n,d,h,h,p)}),(function(){return ef(n,d,m,h,h)}),(function(){return ef(n,h,m,g,h)}))},af=function(n,t){return n.fold((function(){return ef("absolute",N.some(t.x),N.some(t.y),N.none(),N.none())}),(function(n,e,r,o){return uf("absolute",t,n,e,r,o)}),(function(n,e,r,o){return uf("fixed",t,n,e,r,o)}))},cf=function(n,t){var e=x(ns,t),r=n.fold(e,e,(function(){var n=Wc();return ns(t).translate(-n.left,-n.top)})),o=Nc(t),i=kc(t);return rs(r.left,r.top,o,i)},sf=function(n,t){return t.fold((function(){return n.fold(us,us,rs)}),(function(t){return n.fold(t,t,(function(){var e=t(),r=lf(n,e.x,e.y);return rs(r.left,r.top,e.width,e.height)}))}))},lf=function(n,t,e){var r=Dc(t,e),o=function(){var n=Wc();return r.translate(-n.left,-n.top)};return n.fold(y(r),y(r),o)},ff=function(n,t,e,r){return n.fold(t,e,r)},df=(of.none,of.relative),mf=of.fixed,gf=function(n,t){return{anchorBox:n,origin:t}},pf=function(n,t){return gf(n,t)},hf=function(n,t,e,r){var o=n+t;return o>r?e:o<e?r:o},vf=function(n,t,e){return Math.min(Math.max(n,t),e)},bf=Wn.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),yf=function(n,t,e,r,o){var i=o.x,u=o.y,a=o.width,c=o.height,s=n>=i,l=t>=u,f=s&&l,d=n+e<=i+a,m=t+r<=u+c,g=d&&m,p=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),h=Math.abs(Math.min(r,l?u+c-t:u-(t+r))),v=Math.max(o.x,o.right-e),b=Math.max(o.y,o.bottom-r),y=vf(n,o.x,v),w=vf(t,o.y,b);return{originInBounds:f,sizeInBounds:g,limitX:y,limitY:w,deltaW:p,deltaH:h}},wf=function(n,t,e,r){var o=n.x,i=n.y,u=n.bubble.offset,a=u.left,c=u.top,s=ul(r,n.boundsRestriction,u),l=s.y,f=s.bottom,d=s.x,m=s.right,g=o+a,p=i+c,h=yf(g,p,t,e,s),v=h.originInBounds,b=h.sizeInBounds,w=h.limitX,x=h.limitY,S=h.deltaW,C=h.deltaH,k=y(x+C-l),O=y(f-x),T=Xs(n.direction,O,O,k),D=y(w+S-d),E=y(m-w),_=Ks(n.direction,E,E,D),A={x:w,y:x,width:S,height:C,maxHeight:T,maxWidth:_,direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:p};return v&&b?bf.fit(A):bf.nofit(A,S,C)},xf=function(n,t,e,r,o){var i=e.width,u=e.height,a=function(n,a,c,s){var l=n(t,e,r),f=wf(l,i,u,o);return f.fold(bf.fit,(function(n,t,e){var r=e>s||t>c;return r?bf.nofit(n,t,e):bf.nofit(a,c,s)}))},c=J(n,(function(n,t){var e=x(a,t);return n.fold(bf.fit,e)}),bf.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:Ys(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1));return c.fold(w,w)},Sf=function(n){return{width:Nc(n),height:kc(n)}},Cf=function(n,t,e,r){rc(t,"max-height"),rc(t,"max-width");var o=Sf(t);return xf(r.preference,n,o,e,r.bounds)},kf=function(n,t){var e=t.classes;Va(n,e.off),Ha(n,e.on)},Of=function(n,t,e){var r=e.maxHeightFunction;r(n,t.maxHeight)},Tf=function(n,t,e){var r=e.maxWidthFunction;r(n,t.maxWidth)},Df=function(n,t,e){rf(n,af(e.origin,t))},Ef=function(n,t){Oc(n,Math.floor(t))},_f=y((function(n,t){Ef(n,t),Ya(n,{"overflow-x":"hidden","overflow-y":"auto"})})),Af=y((function(n,t){Ef(n,t)})),Rf=function(n,t,e){return void 0===n[t]?e:n[t]},Bf=function(n,t,e,r,o,i){var u=Rf(i,"maxHeightFunction",_f()),a=Rf(i,"maxWidthFunction",p),c=n.anchorBox,s=n.origin,l={bounds:sf(s,o),origin:s,preference:r,maxHeightFunction:u,maxWidthFunction:a};Mf(c,t,e,l)},Mf=function(n,t,e,r){var o=Cf(n,t,e,r);Df(t,o,r),kf(t,o),Of(t,o,r),Tf(t,o,r)},If=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Nf=function(n,t,e){var r=function(n){return jn(e,n).getOr([])},o=function(n,t,e){var o=un(If,e);return{offset:Dc(n,t),classesOn:en(e,r),classesOff:en(o,r)}};return{southeast:function(){return o(-n,t,["top","alignLeft"])},southwest:function(){return o(n,t,["top","alignRight"])},south:function(){return o(-n/2,t,["top","alignCentre"])},northeast:function(){return o(-n,-t,["bottom","alignLeft"])},northwest:function(){return o(n,-t,["bottom","alignRight"])},north:function(){return o(-n/2,-t,["bottom","alignCentre"])},east:function(){return o(n,-t/2,["valignCentre","left"])},west:function(){return o(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return o(-n,t,["top","alignRight"])},innerNortheast:function(){return o(n,t,["top","alignLeft"])},innerNorth:function(){return o(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return o(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return o(n,-t,["bottom","alignLeft"])},innerSouth:function(){return o(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return o(n,-t/2,["valignCentre","right"])},innerEast:function(){return o(-n,-t/2,["valignCentre","left"])}}},Ff=function(){return Nf(0,0,{})},Pf=function(n){return n},Lf=function(n,t){return function(e){return"rtl"===zf(e)?t:n}},zf=function(n){return"rtl"===Qa(n,"direction")?"rtl":"ltr"};(function(n){n["TopToBottom"]="toptobottom",n["BottomToTop"]="bottomtotop"})(xs||(xs={}));var jf,Hf="data-alloy-vertical-dir",Vf=function(n){return ds(n,(function(n){return Pi(n)&&Ou(n,"data-alloy-vertical-dir")===xs.BottomToTop}))},Uf=function(){return Fe("layouts",[ye("onLtr"),ye("onRtl"),Ae("onBottomLtr"),Ae("onBottomRtl")])},Wf=function(n,t,e,r,o,i,u){var a=u.map(Vf).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),l=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(o):c.getOr(e),f=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(r),d=Lf(l,f);return d(n)},Gf=function(n,t,e){var r=t.hotspot,o=cf(e,r.element),i=Wf(n.element,t,Dl(),El(),Ol(),Tl(),N.some(t.hotspot.element));return N.some(Pf({anchorBox:o,bubble:t.bubble.getOr(Ff()),overrides:t.overrides,layouts:i,placer:N.none()}))},qf=[ye("hotspot"),Ae("bubble"),Le("overrides",{}),Uf(),Vs("placement",Gf)],$f=function(n,t,e){var r=lf(e,t.x,t.y),o=rs(r.left,r.top,t.width,t.height),i=Wf(n.element,t,Cl(),kl(),Cl(),kl(),N.none());return N.some(Pf({anchorBox:o,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:N.none()}))},Xf=[ye("x"),ye("y"),Le("height",0),Le("width",0),Le("bubble",Ff()),Le("overrides",{}),Uf(),Vs("placement",$f)],Kf=Wn.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Yf=function(n){return n.fold(w,(function(n,t,e){return n.translate(-t,-e)}))},Jf=function(n){return n.fold(w,w)},Qf=function(n){return J(n,(function(n,t){return n.translate(t.left,t.top)}),Dc(0,0))},Zf=function(n){var t=G(n,Yf);return Qf(t)},nd=function(n){var t=G(n,Jf);return Qf(t)},td=Kf.screen,ed=Kf.absolute,rd=function(n,t,e){var r=Wi(e.root).dom,o=function(t){var e=Hi(t),r=Hi(n.element);return oo(e,r)};return N.from(r.frameElement).map(tr.fromDom).filter(o).map(Ac)},od=function(n,t,e){var r=Hi(n.element),o=Wc(r),i=rd(n,t,e).getOr(o);return ed(i,o.left,o.top)},id=function(n,t,e,r){var o=n,i=t,u=e,a=r;n<0&&(o=0,u=e+n),t<0&&(i=0,a=r+t);var c=td(Dc(o,i));return N.some(ts(c,u,a))},ud=function(n,t,e,r,o){return n.map((function(n){var i=[t,n.point],u=ff(r,(function(){return nd(i)}),(function(){return nd(i)}),(function(){return Zf(i)})),a=es(u.left,u.top,n.width,n.height),c=e.showAbove?Ol():Dl(),s=e.showAbove?Tl():El(),l=Wf(o,e,c,s,c,s,N.none());return Pf({anchorBox:a,bubble:e.bubble.getOr(Ff()),overrides:e.overrides,layouts:l,placer:N.none()})}))},ad=function(n,t,e){var r=od(n,e,t);return t.node.filter(Wa).bind((function(o){var i=o.dom.getBoundingClientRect(),u=id(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element);return ud(u,r,t,e,a)}))},cd=[ye("node"),ye("root"),Ae("bubble"),Uf(),Le("overrides",{}),Le("showAbove",!1),Vs("placement",ad)],sd="\ufeff",ld="",fd=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},dd={create:fd},md=Wn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gd=function(n,t,e,r){return n.fold(t,e,r)},pd=function(n){return n.fold(w,w,w)},hd=md.before,vd=md.on,bd=md.after,yd={before:hd,on:vd,after:bd,cata:gd,getStart:pd},wd=Wn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),xd=function(n){return wd.exact(n.start,n.soffset,n.finish,n.foffset)},Sd=function(n){return n.match({domRange:function(n){return tr.fromDom(n.startContainer)},relative:function(n,t){return yd.getStart(n)},exact:function(n,t,e,r){return n}})},Cd=wd.domRange,kd=wd.relative,Od=wd.exact,Td=function(n){var t=Sd(n);return Wi(t)},Dd=dd.create,Ed={domRange:Cd,relative:kd,exact:Od,exactFromRange:xd,getWin:Td,range:Dd},_d=function(n,t){t.fold((function(t){n.setStartBefore(t.dom)}),(function(t,e){n.setStart(t.dom,e)}),(function(t){n.setStartAfter(t.dom)}))},Ad=function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))},Rd=function(n,t,e){var r=n.document.createRange();return _d(r,t),Ad(r,e),r},Bd=function(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},Md=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Id=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?N.some(e).map(Md):N.none()},Nd=Wn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Fd=function(n,t,e){return t(tr.fromDom(e.startContainer),e.startOffset,tr.fromDom(e.endContainer),e.endOffset)},Pd=function(n,t){return t.match({domRange:function(n){return{ltr:y(n),rtl:N.none}},relative:function(t,e){return{ltr:Jn((function(){return Rd(n,t,e)})),rtl:Jn((function(){return N.some(Rd(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:Jn((function(){return Bd(n,t,e,r,o)})),rtl:Jn((function(){return N.some(Bd(n,r,o,t,e))}))}}})},Ld=function(n,t){var e=t.ltr();if(e.collapsed){var r=t.rtl().filter((function(n){return!1===n.collapsed}));return r.map((function(n){return Nd.rtl(tr.fromDom(n.endContainer),n.endOffset,tr.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Fd(n,Nd.ltr,e)}))}return Fd(n,Nd.ltr,e)},zd=function(n,t){var e=Pd(n,t);return Ld(n,e)},jd=function(n,t){var e=zd(n,t);return e.match({ltr:function(t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},rtl:function(t,e,r,o){var i=n.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,e),i}})},Hd=(Nd.ltr,Nd.rtl,function(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return r(e).getOr("")},r=function(t){return n(t)?N.from(t.dom.nodeValue):N.none()},o=function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom.nodeValue=r};return{get:e,getOption:r,set:o}}),Vd=Hd(Li,"text"),Ud=function(n){return Vd.get(n)},Wd=function(n){return Vd.getOption(n)},Gd=function(n){return"img"===Ii(n)?1:Wd(n).fold((function(){return Ki(n).length}),(function(n){return n.length}))},qd=function(n){return Wd(n).filter((function(n){return 0!==n.trim().length||n.indexOf(ld)>-1})).isSome()},$d=["img","br"],Xd=function(n){var t=qd(n);return t||H($d,Ii(n))},Kd=function(n){return Yd(n,Xd)},Yd=function(n,t){var e=function(n){for(var r=Ki(n),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return N.some(i);var u=e(i);if(u.isSome())return u}return N.none()};return e(n)},Jd=function(n,t){return eo(t,n)},Qd=function(n,t,e,r){var o=Hi(n),i=o.dom.createRange();return i.setStart(n.dom,t),i.setEnd(e.dom,r),i},Zd=function(n,t,e,r){var o=Qd(n,t,e,r),i=oo(n,e)&&t===r;return o.collapsed&&!i},nm=function(n){return N.from(n.getSelection())},tm=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return N.some(dd.create(tr.fromDom(t.startContainer),t.startOffset,tr.fromDom(e.endContainer),e.endOffset))}return N.none()},em=function(n){if(null===n.anchorNode||null===n.focusNode)return tm(n);var t=tr.fromDom(n.anchorNode),e=tr.fromDom(n.focusNode);return Zd(t,n.anchorOffset,e,n.focusOffset)?N.some(dd.create(t,n.anchorOffset,e,n.focusOffset)):tm(n)},rm=function(n){return nm(n).filter((function(n){return n.rangeCount>0})).bind(em)},om=function(n,t){var e=jd(n,t);return Id(e)},im=function(n,t){return{element:n,offset:t}},um=function(n,t){var e=Ki(n);if(0===e.length)return im(n,t);if(t<e.length)return im(e[t],0);var r=e[e.length-1],o=Li(r)?Ud(r).length:Ki(r).length;return im(r,o)},am=function(n,t){return Li(n)?im(n,t):um(n,t)},cm=function(n,t){var e=t.getSelection.getOrThunk((function(){return function(){return rm(n)}}));return e().map((function(n){var t=am(n.start,n.soffset),e=am(n.finish,n.foffset);return Ed.range(t.element,t.offset,e.element,e.offset)}))},sm=function(n,t,e){var r=Wi(t.root).dom,o=od(n,e,t),i=cm(r,t).bind((function(n){var t=om(r,Ed.exactFromRange(n)).orThunk((function(){var t=tr.fromText(sd);return cu(n.start,t),om(r,Ed.exact(t,0,t,1)).map((function(n){return hu(t),n}))}));return t.bind((function(n){return id(n.left,n.top,n.width,n.height)}))})),u=cm(r,t).bind((function(n){return Pi(n.start)?N.some(n.start):qi(n.start)})),a=u.getOr(n.element);return ud(i,o,t,e,a)},lm=[Ae("getSelection"),ye("root"),Ae("bubble"),Uf(),Le("overrides",{}),Le("showAbove",!1),Vs("placement",sm)],fm=function(n){return n.x+n.width},dm=function(n,t){return n.x-t.width},mm=function(n,t){return n.y-t.height+n.height},gm=function(n){return n.y},pm=function(n,t,e){return Gs(fm(n),gm(n),e.southeast(),Ys(),il(n,{left:0,top:2}),"link-layout-se")},hm=function(n,t,e){return Gs(dm(n,t),gm(n),e.southwest(),Js(),il(n,{right:1,top:2}),"link-layout-sw")},vm=function(n,t,e){return Gs(fm(n),mm(n,t),e.northeast(),Qs(),il(n,{left:0,bottom:3}),"link-layout-ne")},bm=function(n,t,e){return Gs(dm(n,t),mm(n,t),e.northwest(),Zs(),il(n,{right:1,bottom:3}),"link-layout-nw")},ym=function(){return[pm,hm,vm,bm]},wm=function(){return[hm,pm,bm,vm]},xm=function(n,t,e){var r=cf(e,t.item.element),o=Wf(n.element,t,ym(),wm(),ym(),wm(),N.none());return N.some(Pf({anchorBox:r,bubble:Ff(),overrides:t.overrides,layouts:o,placer:N.none()}))},Sm=[ye("item"),Uf(),Le("overrides",{}),Vs("placement",xm)],Cm=ce("anchor",{selection:lm,node:cd,hotspot:qf,submenu:Sm,makeshift:Xf}),km=function(){var n=document.documentElement;return mf(0,0,n.clientWidth,n.clientHeight)},Om=function(n){var t=Ac(n.element),e=n.element.dom.getBoundingClientRect();return df(t.left,t.top,e.width,e.height)},Tm=function(n,t,e,r,o){var i=pf(e.anchorBox,t);Bf(i,o.element,e.bubble,e.layouts,r,e.overrides)},Dm=function(n,t,e,r,o){Em(n,t,e,r,o,N.none())},Em=function(n,t,e,r,o,i){var u=i.map(os);return _m(n,t,e,r,o,u)},_m=function(n,t,e,r,o,i){var u=ie("positioning anchor.info",Cm,r);tf((function(){Ka(o.element,"position","fixed");var e=nc(o.element,"visibility");Ka(o.element,"visibility","hidden");var r=t.useFixed()?km():Om(n),a=u.placement,c=i.map(y).or(t.getBounds);a(n,u,r).each((function(t){var e=t.placer.getOr(Tm);e(n,r,t,c,o)})),e.fold((function(){rc(o.element,"visibility")}),(function(n){Ka(o.element,"visibility",n)})),nc(o.element,"left").isNone()&&nc(o.element,"top").isNone()&&nc(o.element,"right").isNone()&&nc(o.element,"bottom").isNone()&&nc(o.element,"position").is("fixed")&&rc(o.element,"position")}),o.element)},Am=function(n,t,e){return t.useFixed()?"fixed":"absolute"},Rm=Object.freeze({__proto__:null,position:Dm,positionWithin:Em,positionWithinBounds:_m,getMode:Am}),Bm=[Le("useFixed",k),Ae("getBounds")],Mm=Vl({fields:Bm,name:"positioning",active:Xl,apis:Rm}),Im=function(n){li(n,ti());var t=n.components();q(t,Im)},Nm=function(n){var t=n.components();q(t,Nm),li(n,ni())},Fm=function(n,t){fu(n.element,t.element)},Pm=function(n){q(n.components(),(function(n){return hu(n.element)})),pu(n.element),n.syncComponents()},Lm=function(n,t){var e=n.components();Pm(n);var r=un(e,t);q(r,(function(t){Im(t),n.getSystem().removeFromWorld(t)})),q(t,(function(t){t.getSystem().isConnected()?Fm(n,t):(n.getSystem().addToWorld(t),Fm(n,t),Wa(n.element)&&Nm(t)),n.syncComponents()}))},zm=function(n,t){jm(n,t,fu)},jm=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),Wa(n.element)&&Nm(t),n.syncComponents()},Hm=function(n){Im(n),hu(n.element),n.getSystem().removeFromWorld(n)},Vm=function(n){var t=Gi(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}));Hm(n),t.each((function(n){n.syncComponents()}))},Um=function(n){var t=n.components();q(t,Hm),pu(n.element),n.syncComponents()},Wm=function(n,t){qm(n,t,fu)},Gm=function(n,t){qm(n,t,su)},qm=function(n,t,e){e(n,t.element);var r=Ki(t.element);q(r,(function(n){t.getByDom(n).each(Nm)}))},$m=function(n){var t=Ki(n.element);q(t,(function(t){n.getByDom(t).each(Im)})),hu(n.element)},Xm=function(n,t,e,r){e.get().each((function(t){Um(n)}));var o=t.getAttachPoint(n);zm(o,n);var i=n.getSystem().build(r);return zm(n,i),e.set(i),i},Km=function(n,t,e,r){var o=Xm(n,t,e,r);return t.onOpen(n,o),o},Ym=function(n,t,e,r){return e.get().map((function(){return Xm(n,t,e,r)}))},Jm=function(n,t,e,r,o){og(n,t),Km(n,t,e,r),o(),ug(n,t)},Qm=function(n,t,e){e.get().each((function(r){Um(n),Vm(n),t.onClose(n,r),e.clear()}))},Zm=function(n,t,e){return e.isOpen()},ng=function(n,t,e,r){return Zm(n,t,e)&&e.get().exists((function(e){return t.isPartOf(n,e,r)}))},tg=function(n,t,e){return e.get()},eg=function(n,t,e,r){nc(n.element,t).fold((function(){Eu(n.element,e)}),(function(t){Cu(n.element,e,t)})),Ka(n.element,t,r)},rg=function(n,t,e){Tu(n.element,e).fold((function(){return rc(n.element,t)}),(function(e){return Ka(n.element,t,e)}))},og=function(n,t,e){var r=t.getAttachPoint(n);Ka(n.element,"position",Mm.getMode(r)),eg(n,"visibility",t.cloakVisibilityAttr,"hidden")},ig=function(n){return V(["top","left","right","bottom"],(function(t){return nc(n,t).isSome()}))},ug=function(n,t,e){ig(n.element)||rc(n.element,"position"),rg(n,"visibility",t.cloakVisibilityAttr)},ag=Object.freeze({__proto__:null,cloak:og,decloak:ug,open:Km,openWhileCloaked:Jm,close:Qm,isOpen:Zm,isPartOf:ng,getState:tg,setContent:Ym}),cg=function(n,t){return hi([wi($o(),(function(e,r){Qm(e,n,t)}))])},sg=Object.freeze({__proto__:null,events:cg}),lg=[Ls("onOpen"),Ls("onClose"),ye("isPartOf"),ye("getAttachPoint"),Le("cloakVisibilityAttr","data-precloak-visibility")],fg=function(){var n=Ke(N.none()),t=y("not-implemented"),e=function(){return n.get().isSome()},r=function(t){n.set(N.some(t))},o=function(){return n.get()},i=function(){n.set(N.none())};return oa({readState:t,isOpen:e,clear:i,set:r,get:o})},dg=Object.freeze({__proto__:null,init:fg}),mg=Vl({fields:lg,name:"sandboxing",active:sg,apis:ag,state:dg}),gg=y("dismiss.popups"),pg=y("reposition.popups"),hg=y("mouse.released"),vg=Lt([Le("isExtraPart",k),Fe("fireEventInstead",[Le("event",ei())])]),bg=function(n){var t,e=ie("Dismissal",vg,n);return t={},t[gg()]={schema:Lt([ye("target")]),onReceive:function(n,t){if(mg.isOpen(n)){var r=mg.isPartOf(n,t.target)||e.isExtraPart(n,t.target);r||e.fireEventInstead.fold((function(){return mg.close(n)}),(function(t){return li(n,t.event)}))}}},t},yg=Lt([Fe("fireEventInstead",[Le("event",ri())]),Oe("doReposition")]),wg=function(n){var t,e=ie("Reposition",yg,n);return t={},t[pg()]={onReceive:function(n){mg.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return li(n,t.event)}))}},t},xg=function(n,t,e){t.store.manager.onLoad(n,t,e)},Sg=function(n,t,e){t.store.manager.onUnload(n,t,e)},Cg=function(n,t,e,r){t.store.manager.setValue(n,t,e,r)},kg=function(n,t,e){return t.store.manager.getValue(n,t,e)},Og=function(n,t,e){return e},Tg=Object.freeze({__proto__:null,onLoad:xg,onUnload:Sg,setValue:Cg,getValue:kg,getState:Og}),Dg=function(n,t){var e=n.resetOnDom?[Ai((function(e,r){xg(e,n,t)})),Ri((function(e,r){Sg(e,n,t)}))]:[Il(n,t,xg)];return hi(e)},Eg=Object.freeze({__proto__:null,events:Dg}),_g=function(){var n=Ke(null),t=function(){return{mode:"memory",value:n.get()}},e=function(){return null===n.get()},r=function(){n.set(null)};return oa({set:n.set,get:n.get,isNotSet:e,clear:r,readState:t})},Ag=function(){var n=p;return oa({readState:n})},Rg=function(){var n=Ke({}),t=Ke({}),e=function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},r=function(){n.set({}),t.set({})},o=function(e){return jn(n.get(),e).orThunk((function(){return jn(t.get(),e)}))},i=function(e){var r=n.get(),o=t.get(),i={},u={};q(e,(function(n){i[n.value]=n,jn(n,"meta").each((function(t){jn(t,"text").each((function(t){u[t]=n}))}))})),n.set(D(D({},r),i)),t.set(D(D({},o),u))};return oa({readState:e,lookup:o,update:i,clear:r})},Bg=function(n){return n.store.manager.state(n)},Mg=Object.freeze({__proto__:null,memory:_g,dataset:Rg,manual:Ag,init:Bg}),Ig=function(n,t,e,r){var o=t.store;e.update([r]),o.setValue(n,r),t.onSetValue(n,r)},Ng=function(n,t,e){var r=t.store,o=r.getDataKey(n);return e.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(n){return n}))},Fg=function(n,t,e){var r=t.store;r.initialValue.each((function(r){Ig(n,t,e,r)}))},Pg=function(n,t,e){e.clear()},Lg=[Ae("initialValue"),ye("getFallbackEntry"),ye("getDataKey"),ye("setValue"),Vs("manager",{setValue:Ig,getValue:Ng,onLoad:Fg,onUnload:Pg,state:Rg})],zg=function(n,t,e){return t.store.getValue(n)},jg=function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},Hg=function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},Vg=[ye("getValue"),Le("setValue",p),Ae("initialValue"),Vs("manager",{setValue:jg,getValue:zg,onLoad:Hg,onUnload:p,state:ra.init})],Ug=function(n,t,e,r){e.set(r),t.onSetValue(n,r)},Wg=function(n,t,e){return e.get()},Gg=function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},qg=function(n,t,e){e.clear()},$g=[Ae("initialValue"),Vs("manager",{setValue:Ug,getValue:Wg,onLoad:Gg,onUnload:qg,state:_g})],Xg=[ze("store",{mode:"memory"},ce("mode",{memory:$g,manual:Vg,dataset:Lg})),Ls("onSetValue"),Le("resetOnDom",!1)],Kg=Vl({fields:Xg,name:"representing",active:Eg,apis:Tg,extra:{setValueFrom:function(n,t){var e=Kg.getValue(t);Kg.setValue(n,e)}},state:Mg}),Yg=function(n,t){return $e(n,{},G(t,(function(t){return Te(t.name(),"Cannot configure "+t.name()+" for "+n)})).concat([Xe("dump",w)]))},Jg=function(n){return n.dump},Qg=function(n,t){return D(D({},n.dump),jl(t))},Zg={field:Yg,augment:Qg,get:Jg},np="placeholder",tp=Wn.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ep=function(n){return Hn(n,"uiType")},rp=function(n,t,e,r){return n.exists((function(n){return n!==e.owner}))?tp.single(!0,y(e)):jn(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+_n(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))},op=function(n,t,e,r){return ep(e)&&e.uiType===np?rp(n,t,e,r):tp.single(!1,y(e))},ip=function(n,t,e,r){var o=op(n,t,e,r);return o.fold((function(o,i){var u=ep(e)?i(t,e.config,e.validated):i(t),a=jn(u,"components").getOr([]),c=en(a,(function(e){return ip(n,t,e,r)}));return[D(D({},u),{components:c})]}),(function(n,r){if(ep(e)){var o=r(t,e.config,e.validated),i=e.validated.preprocess.getOr(w);return i(o)}return r(t)}))},up=function(n,t,e,r){return en(e,(function(e){return ip(n,t,e,r)}))},ap=function(n,t){var e=!1,r=function(){return e},o=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t},i=function(){return t.fold((function(n,t){return n}),(function(n,t){return n}))};return{name:y(n),required:i,used:r,replace:o}},cp=function(n,t,e,r){var o=Bn(r,(function(n,t){return ap(t,n)})),i=up(n,t,e,o);return Rn(o,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),i},sp=tp.single,lp=tp.multiple,fp=y(np),dp=Wn.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),mp=Le("factory",{sketch:w}),gp=Le("schema",[]),pp=ye("name"),hp=$t("pname","pname",rt((function(n){return"<alloy."+Pu(n.name)+">"})),le()),vp=Xe("schema",(function(){return[Ae("preprocess")]})),bp=Le("defaults",y({})),yp=Le("overrides",y({})),wp=zt([mp,gp,pp,hp,bp,yp]),xp=zt([mp,gp,pp,bp,yp]),Sp=zt([mp,gp,pp,hp,bp,yp]),Cp=zt([mp,vp,pp,ye("unit"),hp,bp,yp]),kp=function(n){return n.fold(N.some,N.none,N.some,N.some)},Op=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},Tp=function(n){return n.fold(w,w,w,w)},Dp=function(n,t){return function(e){var r=ie("Converting part type",t,e);return n(r)}},Ep=Dp(dp.required,wp),_p=Dp(dp.external,xp),Ap=Dp(dp.optional,Sp),Rp=Dp(dp.group,Cp),Bp=y("entirety"),Mp=Object.freeze({__proto__:null,required:Ep,external:_p,optional:Ap,group:Rp,asNamedPart:kp,name:Op,asCommon:Tp,original:Bp}),Ip=function(n,t,e,r){return Kn(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))},Np=function(n,t,e){var r={},o={};return q(e,(function(n){n.fold((function(n){r[n.pname]=sp(!0,(function(t,e,r){return n.factory.sketch(Ip(t,n,e,r))}))}),(function(n){var e=t.parts[n.name];o[n.name]=y(n.factory.sketch(Ip(t,n,e[Bp()]),e))}),(function(n){r[n.pname]=sp(!1,(function(t,e,r){return n.factory.sketch(Ip(t,n,e,r))}))}),(function(n){r[n.pname]=lp(!0,(function(t,e,r){var o=t[n.name];return G(o,(function(e){return n.factory.sketch(Kn(n.defaults(t,e,r),e,n.overrides(t,e)))}))}))}))})),{internals:y(r),externals:y(o)}},Fp=function(n,t){var e={};return q(t,(function(t){kp(t).each((function(t){var r=Pp(n,t.pname);e[t.name]=function(e){var o=ie("Part: "+t.name+" in "+n,zt(t.schema),e);return D(D({},r),{config:e,validated:o})}}))})),e},Pp=function(n,t){return{uiType:fp(),owner:n,name:t}},Lp=function(n,t,e){return{uiType:fp(),owner:n,name:t,config:e,validated:{}}},zp=function(n){return en(n,(function(n){return n.fold(N.none,N.some,N.none,N.none).map((function(n){return De(n.name,n.schema.concat([Us(Bp())]))})).toArray()}))},jp=function(n){return G(n,Op)},Hp=function(n,t,e){return Np(n,t,e)},Vp=function(n,t,e){return cp(N.some(n),t,t.components,e)},Up=function(n,t,e){var r=t.partUids[e];return n.getSystem().getByUid(r).toOptional()},Wp=function(n,t,e){return Up(n,t,e).getOrDie("Could not find part: "+e)},Gp=function(n,t,e){var r={},o=t.partUids,i=n.getSystem();return q(e,(function(n){r[n]=y(i.getByUid(o[n]))})),r},qp=function(n,t){var e=n.getSystem();return Bn(t.partUids,(function(n,t){return y(e.getByUid(n))}))},$p=function(n){return _n(n.partUids)},Xp=function(n,t,e){var r={},o=t.partUids,i=n.getSystem();return q(e,(function(n){r[n]=y(i.getByUid(o[n]).getOrDie())})),r},Kp=function(n,t){var e=jp(t);return ft(G(e,(function(t){return{key:t,value:n+"-"+t}})))},Yp=function(n){return $t("partUids","partUids",ot((function(t){return Kp(t.uid,n)})),le())},Jp=Object.freeze({__proto__:null,generate:Fp,generateOne:Lp,schemas:zp,names:jp,substitutes:Hp,components:Vp,defaultUids:Kp,defaultUidsSchema:Yp,getAllParts:qp,getAllPartNames:$p,getPart:Up,getPartOrDie:Wp,getParts:Gp,getPartsOrDie:Xp}),Qp=function(n,t){var e=n.length>0?[De("parts",n)]:[];return e.concat([ye("uid"),Le("dom",{}),Le("components",[]),Us("originalSpec"),Le("debug.sketcher",{})]).concat(t)},Zp=function(n,t,e,r,o){var i=Qp(r,o);return ie(n+" [SpecSchema]",Lt(i.concat(t)),e)},nh=function(n,t,e,r){var o=rh(r),i=Zp(n,t,o,[],[]);return e(i,o)},th=function(n,t,e,r,o){var i=rh(o),u=zp(e),a=Yp(e),c=Zp(n,t,i,u,[a]),s=Hp(n,c,e),l=Vp(n,c,s.internals());return r(c,l,i,s.externals())},eh=function(n){return Hn(n,"uid")},rh=function(n){return eh(n)?n:D(D({},n),{uid:Gu("uid")})},oh=function(n){return void 0!==n.uid},ih=Lt([ye("name"),ye("factory"),ye("configFields"),Le("apis",{}),Le("extraApis",{})]),uh=Lt([ye("name"),ye("factory"),ye("configFields"),ye("partFields"),Le("apis",{}),Le("extraApis",{})]),ah=function(n){var t=ie("Sketcher for "+n.name,ih,n),e=function(n){return nh(t.name,t.configFields,t.factory,n)},r=Bn(t.apis,ea),o=Bn(t.extraApis,(function(n,t){return Ju(n,t)}));return D(D({name:t.name,configFields:t.configFields,sketch:e},r),o)},ch=function(n){var t=ie("Sketcher for "+n.name,uh,n),e=function(n){return th(t.name,t.configFields,t.partFields,t.factory,n)},r=Fp(t.name,t.partFields),o=Bn(t.apis,ea),i=Bn(t.extraApis,(function(n,t){return Ju(n,t)}));return D(D({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e,parts:r},o),i)},sh=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},lh=function(n){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(!r.isSome())return N.none();t.push(r.getOrDie())}return N.some(t)},fh=function(n,t,e){return n.isSome()&&t.isSome()?N.some(e(n.getOrDie(),t.getOrDie())):N.none()},dh=function(n,t,e,r){return n.isSome()&&t.isSome()&&e.isSome()?N.some(r(n.getOrDie(),t.getOrDie(),e.getOrDie())):N.none()},mh=function(n,t){return void 0!==n&&null!==n?N.some(t(n)):N.none()},gh=function(n,t){return n?N.some(t):N.none()},ph=function(n){return"input"===Ii(n)&&"radio"!==Ou(n,"type")||"textarea"===Ii(n)},hh=function(n,t,e){return t.find(n)},vh=Object.freeze({__proto__:null,getCurrent:hh}),bh=[ye("find")],yh=Vl({fields:bh,name:"composing",apis:vh}),wh=function(n,t,e,r){var o=Jd(n.element,"."+t.highlightClass);q(o,(function(e){V(r,(function(n){return n.element===e}))||(za(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),li(e,si())})))}))},xh=function(n,t,e){return wh(n,t,e,[])},Sh=function(n,t,e,r){Eh(n,t,e,r)&&(za(r.element,t.highlightClass),t.onDehighlight(n,r),li(r,si()))},Ch=function(n,t,e,r){wh(n,t,e,[r]),Eh(n,t,e,r)||(Pa(r.element,t.highlightClass),t.onHighlight(n,r),li(r,ci()))},kh=function(n,t,e){Rh(n,t).each((function(r){Ch(n,t,e,r)}))},Oh=function(n,t,e){Bh(n,t).each((function(r){Ch(n,t,e,r)}))},Th=function(n,t,e,r){Ah(n,t,e,r).fold((function(n){throw n}),(function(r){Ch(n,t,e,r)}))},Dh=function(n,t,e,r){var o=Fh(n,t),i=Z(o,r);i.each((function(r){Ch(n,t,e,r)}))},Eh=function(n,t,e,r){return ja(r.element,t.highlightClass)},_h=function(n,t,e){return gs(n.element,"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Ah=function(n,t,e,r){var o=Jd(n.element,"."+t.itemClass);return N.from(o[r]).fold((function(){return vn.error(new Error("No element found with index "+r))}),n.getSystem().getByDom)},Rh=function(n,t,e){return gs(n.element,"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Bh=function(n,t,e){var r=Jd(n.element,"."+t.itemClass),o=r.length>0?N.some(r[r.length-1]):N.none();return o.bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Mh=function(n,t,e,r){var o=Jd(n.element,"."+t.itemClass),i=nn(o,(function(n){return ja(n,t.highlightClass)}));return i.bind((function(t){var e=hf(t,r,0,o.length-1);return n.getSystem().getByDom(o[e]).toOptional()}))},Ih=function(n,t,e){return Mh(n,t,e,-1)},Nh=function(n,t,e){return Mh(n,t,e,1)},Fh=function(n,t,e){var r=Jd(n.element,"."+t.itemClass);return sh(G(r,(function(t){return n.getSystem().getByDom(t).toOptional()})))},Ph=Object.freeze({__proto__:null,dehighlightAll:xh,dehighlight:Sh,highlight:Ch,highlightFirst:kh,highlightLast:Oh,highlightAt:Th,highlightBy:Dh,isHighlighted:Eh,getHighlighted:_h,getFirst:Rh,getLast:Bh,getPrevious:Ih,getNext:Nh,getCandidates:Fh}),Lh=[ye("highlightClass"),ye("itemClass"),Ls("onHighlight"),Ls("onDehighlight")],zh=Vl({fields:Lh,name:"highlighting",apis:Ph}),jh=[8],Hh=[9],Vh=[13],Uh=[27],Wh=[32],Gh=[37],qh=[38],$h=[39],Xh=[40],Kh=function(n,t,e){var r=on(n.slice(0,t)),o=on(n.slice(t+1));return Z(r.concat(o),e)},Yh=function(n,t,e){var r=on(n.slice(0,t));return Z(r,e)},Jh=function(n,t,e){var r=n.slice(0,t),o=n.slice(t+1);return Z(o.concat(r),e)},Qh=function(n,t,e){var r=n.slice(t+1);return Z(r,e)},Zh=function(n){return function(t){var e=t.raw;return H(n,e.which)}},nv=function(n){return function(t){return rn(n,(function(n){return n(t)}))}},tv=function(n){var t=n.raw;return!0===t.shiftKey},ev=function(n){var t=n.raw;return!0===t.ctrlKey},rv=S(tv),ov=function(n,t){return{matches:n,classification:t}},iv=function(n,t){var e=Z(n,(function(n){return n.matches(t)}));return e.map((function(n){return n.classification}))},uv=function(n,t,e){var r=t.exists((function(n){return e.exists((function(t){return oo(t,n)}))}));r||fi(n,oi(),{prevFocus:t,newFocus:e})},av=function(){var n=function(n){return nf(n.element)},t=function(t,e){var r=n(t);t.getSystem().triggerFocus(e,t.element);var o=n(t);uv(t,r,o)};return{get:n,set:t}},cv=function(){var n=function(n){return zh.getHighlighted(n).map((function(n){return n.element}))},t=function(t,e){var r=n(t);t.getSystem().getByDom(e).fold(p,(function(n){zh.highlight(t,n)}));var o=n(t);uv(t,r,o)};return{get:n,set:t}};(function(n){n["OnFocusMode"]="onFocus",n["OnEnterOrSpaceMode"]="onEnterOrSpace",n["OnApiMode"]="onApi"})(jf||(jf={}));var sv=function(n,t,e,r,o){var i=function(){return n.concat([Le("focusManager",av()),ze("focusInside","onFocus",ne((function(n){return H(["onFocus","onEnterOrSpace","onApi"],n)?vn.value(n):vn.error("Invalid value for focusInside")}))),Vs("handler",c),Vs("state",t),Vs("sendFocusIn",o)])},u=function(n,t,e,r,o){var i=e(n,t,r,o);return iv(i,t.event).bind((function(e){return e(n,t,r,o)}))},a=function(n,t){var i=n.focusInside!==jf.OnFocusMode?N.none():o(n).map((function(e){return wi(zo(),(function(r,o){e(r,n,t),o.stop()}))})),a=function(e,r){var i=Zh(Wh.concat(Vh))(r.event);n.focusInside===jf.OnEnterOrSpaceMode&&i&&fo(e,r)&&o(n).each((function(o){o(e,n,t),r.stop()}))},c=[wi(Ao(),(function(r,o){u(r,o,e,n,t).fold((function(){a(r,o)}),(function(n){o.stop()}))})),wi(Ro(),(function(e,o){u(e,o,r,n,t).each((function(n){o.stop()}))}))];return hi(i.toArray().concat(c))},c={schema:i,processKey:u,toEvents:a};return c},lv=function(n){var t=[Ae("onEscape"),Ae("onEnter"),Le("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Le("firstTabstop",0),Le("useTabstopAt",O),Ae("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return ps(t,n)})).getOr(t);return Cc(e)>0},r=function(n,t){var r=Jd(n.element,t.selector),o=K(r,(function(n){return e(t,n)}));return N.from(o[t.firstTabstop])},o=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},i=function(n,t){return e(n,t)&&n.useTabstopAt(t)},u=function(n,t,e){r(n,t).each((function(e){t.focusManager.set(n,e)}))},a=function(n,t,e,r,o){return o(t,e,(function(n){return i(r,n)})).fold((function(){return r.cyclic?N.some(!0):N.none()}),(function(t){return r.focusManager.set(n,t),N.some(!0)}))},c=function(n,t,e,r){var i=Jd(n.element,e.selector);return o(n,e).bind((function(t){var o=nn(i,x(oo,t));return o.bind((function(t){return a(n,i,t,e,r)}))}))},s=function(n,t,e){var r=e.cyclic?Kh:Yh;return c(n,t,e,r)},l=function(n,t,e){var r=e.cyclic?Jh:Qh;return c(n,t,e,r)},f=function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))},d=function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))},m=y([ov(nv([tv,Zh(Hh)]),s),ov(Zh(Hh),l),ov(Zh(Uh),d),ov(nv([rv,Zh(Vh)]),f)]),g=y([]);return sv(t,ra.init,m,g,(function(){return N.some(u)}))},fv=lv(Xe("cyclic",k)),dv=lv(Xe("cyclic",O)),mv=function(n,t,e){return mi(n,e,Uo()),N.some(!0)},gv=function(n,t,e){var r=ph(e)&&Zh(Wh)(t.event);return r?N.none():mv(n,t,e)},pv=function(n,t){return N.some(!0)},hv=[Le("execute",gv),Le("useSpace",!1),Le("useEnter",!0),Le("useControlEnter",!1),Le("useDown",!1)],vv=function(n,t,e){return e.execute(n,t,n.element)},bv=function(n,t,e,r){var o=e.useSpace&&!ph(n.element)?Wh:[],i=e.useEnter?Vh:[],u=e.useDown?Xh:[],a=o.concat(i).concat(u);return[ov(Zh(a),vv)].concat(e.useControlEnter?[ov(nv([ev,Zh(Vh)]),vv)]:[])},yv=function(n,t,e,r){return e.useSpace&&!ph(n.element)?[ov(Zh(Wh),pv)]:[]},wv=sv(hv,ra.init,bv,yv,(function(){return N.none()})),xv=function(){var n=Ke(N.none()),t=function(t,e){n.set(N.some({numRows:t,numColumns:e}))},e=function(){return n.get().map((function(n){return n.numRows}))},r=function(){return n.get().map((function(n){return n.numColumns}))};return oa({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:e,getNumColumns:r})},Sv=function(n){return n.state(n)},Cv=Object.freeze({__proto__:null,flatgrid:xv,init:Sv}),kv=function(n){return function(t,e,r,o){var i=n(t.element);return Ev(i,t,e,r,o)}},Ov=function(n,t){var e=Lf(n,t);return kv(e)},Tv=function(n,t){var e=Lf(t,n);return kv(e)},Dv=function(n){return function(t,e,r,o){return Ev(n,t,e,r,o)}},Ev=function(n,t,e,r,o){var i=r.focusManager.get(t).bind((function(e){return n(t.element,e,r,o)}));return i.map((function(n){return r.focusManager.set(t,n),!0}))},_v=Dv,Av=Dv,Rv=Dv,Bv=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0},Mv=function(n){return!Bv(n.dom)},Iv=function(n,t){return nn(n,t).map((function(t){return{index:t,candidates:n}}))},Nv=function(n,t,e){var r=function(n){return oo(n,t)},o=Jd(n,e),i=K(o,Mv);return Iv(i,r)},Fv=function(n,t){return nn(n,(function(n){return oo(t,n)}))},Pv=function(n,t,e,r){var o=Math.floor(t/e),i=t%e;return r(o,i).bind((function(t){var r=t.row*e+t.column;return r>=0&&r<n.length?N.some(n[r]):N.none()}))},Lv=function(n,t,e,r,o){return Pv(n,t,r,(function(t,i){var u=t===e-1,a=u?n.length-t*r:r,c=hf(i,o,0,a-1);return N.some({row:t,column:c})}))},zv=function(n,t,e,r,o){return Pv(n,t,r,(function(t,i){var u=hf(t,o,0,e-1),a=u===e-1,c=a?n.length-u*r:r,s=vf(i,0,c-1);return N.some({row:u,column:s})}))},jv=function(n,t,e,r){return Lv(n,t,e,r,1)},Hv=function(n,t,e,r){return Lv(n,t,e,r,-1)},Vv=function(n,t,e,r){return zv(n,t,e,r,-1)},Uv=function(n,t,e,r){return zv(n,t,e,r,1)},Wv=[ye("selector"),Le("execute",gv),zs("onEscape"),Le("captureTab",!1),Ws()],Gv=function(n,t,e){gs(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},qv=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},$v=function(n,t,e,r){return qv(n,e).bind((function(r){return e.execute(n,t,r)}))},Xv=function(n){return function(t,e,r,o){return Nv(t,e,r.selector).bind((function(t){return n(t.candidates,t.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},Kv=function(n,t,e){return e.captureTab?N.some(!0):N.none()},Yv=function(n,t,e){return e.onEscape(n,t)},Jv=Xv(Hv),Qv=Xv(jv),Zv=Xv(Vv),nb=Xv(Uv),tb=y([ov(Zh(Gh),Ov(Jv,Qv)),ov(Zh($h),Tv(Jv,Qv)),ov(Zh(qh),_v(Zv)),ov(Zh(Xh),Av(nb)),ov(nv([tv,Zh(Hh)]),Kv),ov(nv([rv,Zh(Hh)]),Kv),ov(Zh(Uh),Yv),ov(Zh(Wh.concat(Vh)),$v)]),eb=y([ov(Zh(Wh),pv)]),rb=sv(Wv,xv,tb,eb,(function(){return N.some(Gv)})),ob=function(n,t,e,r){var o=function(n){return"button"===Ii(n)&&"disabled"===Ou(n,"disabled")},i=function(n,t,e){var u=hf(t,r,0,e.length-1);return u===n?N.none():o(e[u])?i(n,u,e):N.from(e[u])};return Nv(n,e,t).bind((function(n){var t=n.index,e=n.candidates;return i(t,t,e)}))},ib=[ye("selector"),Le("getInitial",N.none),Le("execute",gv),zs("onEscape"),Le("executeOnMove",!1),Le("allowVertical",!0)],ub=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},ab=function(n,t,e){return ub(n,e).bind((function(r){return e.execute(n,t,r)}))},cb=function(n,t,e){t.getInitial(n).orThunk((function(){return gs(n.element,t.selector)})).each((function(e){t.focusManager.set(n,e)}))},sb=function(n,t,e){return ob(n,e.selector,t,-1)},lb=function(n,t,e){return ob(n,e.selector,t,1)},fb=function(n){return function(t,e,r,o){return n(t,e,r,o).bind((function(){return r.executeOnMove?ab(t,e,r):N.some(!0)}))}},db=function(n,t,e){return e.onEscape(n,t)},mb=function(n,t,e,r){var o=Gh.concat(e.allowVertical?qh:[]),i=$h.concat(e.allowVertical?Xh:[]);return[ov(Zh(o),fb(Ov(sb,lb))),ov(Zh(i),fb(Tv(sb,lb))),ov(Zh(Vh),ab),ov(Zh(Wh),ab),ov(Zh(Uh),db)]},gb=y([ov(Zh(Wh),pv)]),pb=sv(ib,ra.init,mb,gb,(function(){return N.some(cb)})),hb=function(n,t,e){return N.from(n[t]).bind((function(n){return N.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},vb=function(n,t,e,r){var o=n[t],i=o.length,u=hf(e,r,0,i-1);return hb(n,t,u)},bb=function(n,t,e,r){var o=hf(e,r,0,n.length-1),i=n[o].length,u=vf(t,0,i-1);return hb(n,o,u)},yb=function(n,t,e,r){var o=n[t],i=o.length,u=vf(e+r,0,i-1);return hb(n,t,u)},wb=function(n,t,e,r){var o=vf(e+r,0,n.length-1),i=n[o].length,u=vf(t,0,i-1);return hb(n,o,u)},xb=function(n,t,e){return vb(n,t,e,1)},Sb=function(n,t,e){return vb(n,t,e,-1)},Cb=function(n,t,e){return bb(n,e,t,-1)},kb=function(n,t,e){return bb(n,e,t,1)},Ob=function(n,t,e){return yb(n,t,e,-1)},Tb=function(n,t,e){return yb(n,t,e,1)},Db=function(n,t,e){return wb(n,e,t,-1)},Eb=function(n,t,e){return wb(n,e,t,1)},_b=[De("selectors",[ye("row"),ye("cell")]),Le("cycles",!0),Le("previousSelector",N.none),Le("execute",gv)],Ab=function(n,t,e){var r=t.previousSelector(n).orThunk((function(){var e=t.selectors;return gs(n.element,e.cell)}));r.each((function(e){t.focusManager.set(n,e)}))},Rb=function(n,t,e){return nf(n.element).bind((function(r){return e.execute(n,t,r)}))},Bb=function(n,t){return G(n,(function(n){return Jd(n,t.selectors.cell)}))},Mb=function(n,t){return function(e,r,o){var i=o.cycles?n:t;return ps(r,o.selectors.row).bind((function(n){var t=Jd(n,o.selectors.cell);return Fv(t,r).bind((function(t){var r=Jd(e,o.selectors.row);return Fv(r,n).bind((function(n){var e=Bb(r,o);return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},Ib=Mb(Sb,Ob),Nb=Mb(xb,Tb),Fb=Mb(Cb,Db),Pb=Mb(kb,Eb),Lb=y([ov(Zh(Gh),Ov(Ib,Nb)),ov(Zh($h),Tv(Ib,Nb)),ov(Zh(qh),_v(Fb)),ov(Zh(Xh),Av(Pb)),ov(Zh(Wh.concat(Vh)),Rb)]),zb=y([ov(Zh(Wh),pv)]),jb=sv(_b,ra.init,Lb,zb,(function(){return N.some(Ab)})),Hb=[ye("selector"),Le("execute",gv),Le("moveOnTab",!1)],Vb=function(n,t,e){return e.focusManager.get(n).bind((function(r){return e.execute(n,t,r)}))},Ub=function(n,t,e){gs(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Wb=function(n,t,e){return ob(n,e.selector,t,-1)},Gb=function(n,t,e){return ob(n,e.selector,t,1)},qb=function(n,t,e,r){return e.moveOnTab?Rv(Wb)(n,t,e,r):N.none()},$b=function(n,t,e,r){return e.moveOnTab?Rv(Gb)(n,t,e,r):N.none()},Xb=y([ov(Zh(qh),Rv(Wb)),ov(Zh(Xh),Rv(Gb)),ov(nv([tv,Zh(Hh)]),qb),ov(nv([rv,Zh(Hh)]),$b),ov(Zh(Vh),Vb),ov(Zh(Wh),Vb)]),Kb=y([ov(Zh(Wh),pv)]),Yb=sv(Hb,ra.init,Xb,Kb,(function(){return N.some(Ub)})),Jb=[zs("onSpace"),zs("onEnter"),zs("onShiftEnter"),zs("onLeft"),zs("onRight"),zs("onTab"),zs("onShiftTab"),zs("onUp"),zs("onDown"),zs("onEscape"),Le("stopSpaceKeyup",!1),Ae("focusIn")],Qb=function(n,t,e){return[ov(Zh(Wh),e.onSpace),ov(nv([rv,Zh(Vh)]),e.onEnter),ov(nv([tv,Zh(Vh)]),e.onShiftEnter),ov(nv([tv,Zh(Hh)]),e.onShiftTab),ov(nv([rv,Zh(Hh)]),e.onTab),ov(Zh(qh),e.onUp),ov(Zh(Xh),e.onDown),ov(Zh(Gh),e.onLeft),ov(Zh($h),e.onRight),ov(Zh(Wh),e.onSpace),ov(Zh(Uh),e.onEscape)]},Zb=function(n,t,e){return e.stopSpaceKeyup?[ov(Zh(Wh),pv)]:[]},ny=sv(Jb,ra.init,Qb,Zb,(function(n){return n.focusIn})),ty=fv.schema(),ey=dv.schema(),ry=pb.schema(),oy=rb.schema(),iy=jb.schema(),uy=wv.schema(),ay=Yb.schema(),cy=ny.schema(),sy=Object.freeze({__proto__:null,acyclic:ty,cyclic:ey,flow:ry,flatgrid:oy,matrix:iy,execution:uy,menu:ay,special:cy}),ly=function(n){return Vn(n,"setGridSize")},fy=Wl({branchKey:"mode",branches:sy,name:"keying",active:{events:function(n,t){var e=n.handler;return e.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(r){r(n,t,e)}))},setGridSize:function(n,t,e,r,o){ly(e)&&e.setGridSize(r,o)}},state:Cv}),dy=function(n,t,e,r){tf((function(){var t=G(r,n.getSystem().build);Lm(n,t)}),n.element)},my=function(n,t,e,r){var o=n.getSystem().build(r);jm(n,o,e)},gy=function(n,t,e,r){my(n,t,fu,r)},py=function(n,t,e,r){my(n,t,lu,r)},hy=function(n,t,e,r){var o=vy(n),i=Z(o,(function(n){return oo(r.element,n.element)}));i.each(Vm)},vy=function(n,t){return n.components()},by=function(n,t,e,r,o){var i=vy(n);return N.from(i[r]).map((function(i){return hy(n,t,e,i),o.each((function(e){my(n,t,(function(n,t){du(n,t,r)}),e)})),i}))},yy=function(n,t,e,r,o){var i=vy(n);return nn(i,r).bind((function(r){return by(n,t,e,r,o)}))},wy=Object.freeze({__proto__:null,append:gy,prepend:py,remove:hy,replaceAt:by,replaceBy:yy,set:dy,contents:vy}),xy=Vl({fields:[],name:"replacing",apis:wy}),Sy=function(n,t){var e=hi(t);return Vl({fields:[ye("enabled")],name:n,active:{events:y(e)}})},Cy=function(n,t){var e=Sy(n,t);return{key:n,value:{config:{},me:e,configAsRaw:y({}),initialConfig:{},state:ra}}},ky=function(n,t){t.ignore||(Yl(n.element),t.onFocus(n))},Oy=function(n,t){t.ignore||Jl(n.element)},Ty=function(n){return Ql(n.element)},Dy=Object.freeze({__proto__:null,focus:ky,blur:Oy,isFocused:Ty}),Ey=function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return sa(e)},_y=function(n){return hi([wi(zo(),(function(t,e){ky(t,n),e.stop()}))].concat(n.stopMousedown?[wi(Co(),(function(n,t){t.event.prevent()}))]:[]))},Ay=Object.freeze({__proto__:null,exhibit:Ey,events:_y}),Ry=[Ls("onFocus"),Le("stopMousedown",!1),Le("ignore",!1)],By=Vl({fields:Ry,name:"focusing",active:Ay,apis:Dy}),My=function(n){var t=function(){var t=Ke(n),e=function(){return t.get()},r=function(n){return t.set(n)},o=function(){return t.set(n)},i=function(){return t.get()};return{get:e,set:r,clear:o,readState:i}};return{init:t}},Iy=function(n,t,e){var r=t.aria;r.update(n,r,e.get())},Ny=function(n,t,e){t.toggleClass.each((function(t){e.get()?Pa(n.element,t):za(n.element,t)}))},Fy=function(n,t,e){zy(n,t,e,!e.get())},Py=function(n,t,e){e.set(!0),Ny(n,t,e),Iy(n,t,e)},Ly=function(n,t,e){e.set(!1),Ny(n,t,e),Iy(n,t,e)},zy=function(n,t,e,r){var o=r?Py:Ly;o(n,t,e)},jy=function(n,t,e){return e.get()},Hy=function(n,t,e){zy(n,t,e,t.selected)},Vy=Object.freeze({__proto__:null,onLoad:Hy,toggle:Fy,isOn:jy,on:Py,off:Ly,set:zy}),Uy=function(){return sa({})},Wy=function(n,t){var e=Ml(n,t,Fy),r=Il(n,t,Hy);return hi(tn([n.toggleOnExecute?[e]:[],[r]]))},Gy=Object.freeze({__proto__:null,exhibit:Uy,events:Wy}),qy=function(n,t,e){Cu(n.element,"aria-pressed",e),t.syncWithExpanded&&Ky(n,t,e)},$y=function(n,t,e){Cu(n.element,"aria-selected",e)},Xy=function(n,t,e){Cu(n.element,"aria-checked",e)},Ky=function(n,t,e){Cu(n.element,"aria-expanded",e)},Yy=[Le("selected",!1),Ae("toggleClass"),Le("toggleOnExecute",!0),ze("aria",{mode:"none"},ce("mode",{pressed:[Le("syncWithExpanded",!1),Vs("update",qy)],checked:[Vs("update",Xy)],expanded:[Vs("update",Ky)],selected:[Vs("update",$y)],none:[Vs("update",p)]}))],Jy=Vl({fields:Yy,name:"toggling",active:Gy,apis:Vy,state:My(!1)}),Qy=function(){var n=function(n,t){t.stop(),di(n)};return[wi(Io(),n),wi(Go(),n),Di(yo()),Di(Co())]},Zy=function(n){var t=function(n){return Mi((function(t,e){n(t),e.stop()}))};return hi(tn([n.map(t).toArray(),Qy()]))},nw="alloy.item-hover",tw="alloy.item-focus",ew=function(n){(nf(n.element).isNone()||By.isFocused(n))&&(By.isFocused(n)||By.focus(n),fi(n,nw,{item:n}))},rw=function(n){fi(n,tw,{item:n})},ow=y(nw),iw=y(tw),uw=function(n){return{dom:n.dom,domModification:D(D({},n.domModification),{attributes:D(D(D({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Zg.augment(n.itemBehaviours,[n.toggling.fold(Jy.revoke,(function(n){return Jy.config(D({aria:{mode:"checked"}},n))})),By.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){rw(n)}}),fy.config({mode:"execution"}),Kg.config({store:{mode:"memory",initialValue:n.data}}),Cy("item-type-events",_(Qy(),[wi(Do(),ew),wi(Wo(),By.focus)]))]),components:n.components,eventOrder:n.eventOrder}},aw=[ye("data"),ye("components"),ye("dom"),Le("hasSubmenu",!1),Ae("toggling"),Zg.field("itemBehaviours",[Jy,By,fy,Kg]),Le("ignoreFocus",!1),Le("domModification",{}),Vs("builder",uw),Le("eventOrder",{})],cw=function(n){return{dom:n.dom,components:n.components,events:hi([Ei(Wo())])}},sw=[ye("dom"),ye("components"),Vs("builder",cw)],lw=y("item-widget"),fw=y([Ep({name:"widget",overrides:function(n){return{behaviours:jl([Kg.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:p}})])}}})]),dw=function(n){var t=Hp(lw(),n,fw()),e=Vp(lw(),n,t.internals()),r=function(t){return Up(t,n,"widget").map((function(n){return fy.focusIn(n),n}))},o=function(t,e){return ph(e.event.target)?N.none():function(){return n.autofocus?(e.setSource(t.element),N.none()):N.none()}()};return{dom:n.dom,components:e,domModification:n.domModification,events:hi([Mi((function(n,t){r(n).each((function(n){t.stop()}))})),wi(Do(),ew),wi(Wo(),(function(t,e){n.autofocus?r(t):By.focus(t)}))]),behaviours:Zg.augment(n.widgetBehaviours,[Kg.config({store:{mode:"memory",initialValue:n.data}}),By.config({ignore:n.ignoreFocus,onFocus:function(n){rw(n)}}),fy.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:Gl(),onLeft:o,onRight:o,onEscape:function(t,e){return By.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),N.none()):N.none():(By.focus(t),N.some(!0))}})])}},mw=[ye("uid"),ye("data"),ye("components"),ye("dom"),Le("autofocus",!1),Le("ignoreFocus",!1),Zg.field("widgetBehaviours",[Kg,By,fy]),Le("domModification",{}),Yp(fw()),Vs("builder",dw)],gw=ce("type",{widget:mw,item:aw,separator:sw}),pw=function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}},hw=function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}},vw=function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}},bw=y([Rp({factory:{sketch:function(n){var t=ie("menu.spec item",gw,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:D(D({},t),{uid:Gu("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),yw=y([ye("value"),ye("items"),ye("dom"),ye("components"),Le("eventOrder",{}),Yg("menuBehaviours",[zh,Kg,yh,fy]),ze("movement",{mode:"menu",moveOnTab:!0},ce("mode",{grid:[Ws(),Vs("config",pw)],matrix:[Vs("config",hw),ye("rowSelector")],menu:[Le("moveOnTab",!0),Vs("config",vw)]})),Is(),Le("fakeFocus",!1),Le("focusManager",av()),Ls("onHighlight")]),ww=y("alloy.menu-focus"),xw=function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Qg(n.menuBehaviours,[zh.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Kg.config({store:{mode:"memory",initialValue:n.value}}),yh.config({find:N.some}),fy.config(n.movement.config(n,n.movement))]),events:hi([wi(iw(),(function(n,t){var e=t.event;n.getSystem().getByDom(e.target).each((function(e){zh.highlight(n,e),t.stop(),fi(n,ww(),{menu:n,item:e})}))})),wi(ow(),(function(n,t){var e=t.event.item;zh.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}},Sw=ch({name:"Menu",configFields:yw(),partFields:bw(),factory:xw}),Cw=function(n){return Mn(n,(function(n,t){return{k:n,v:t}}))},kw=function(n,t,e,r){return jn(e,r).bind((function(r){return jn(n,r).bind((function(r){var o=kw(n,t,e,r);return N.some([r].concat(o))}))})).getOr([])},Ow=function(n,t){var e={};Rn(n,(function(n,t){q(n,(function(n){e[n]=t}))}));var r=t,o=Cw(t),i=Bn(o,(function(n,t){return[t].concat(kw(e,r,o,t))}));return Bn(e,(function(n){return jn(i,n).getOr([n])}))},Tw=function(){var n=Ke({}),t=Ke({}),e=Ke({}),r=Ke(N.none()),o=Ke({}),i=function(){n.set({}),t.set({}),e.set({}),r.set(N.none())},u=function(){return r.get().isNone()},a=function(n,e){var r;t.set(D(D({},t.get()),(r={},r[n]={type:"prepared",menu:e},r)))},c=function(i,u,a,c){r.set(N.some(i)),n.set(a),t.set(u),o.set(c);var s=Ow(c,a);e.set(s)},s=function(t){return Ln(n.get(),(function(n,e){return n===t}))},l=function(n,t,e){return p(n).bind((function(r){return s(n).bind((function(n){return t(n).map((function(n){return{triggeredMenu:r,triggeringItem:n,triggeringPath:e}}))}))}))},f=function(n,t){var o=K(v(n).toArray(),(function(n){return p(n).isSome()}));return jn(e.get(),n).bind((function(n){var e=on(o.concat(n)),i=en(e,(function(n,o){return l(n,t,e.slice(0,o+1)).fold((function(){return r.get().is(n)?[]:[N.none()]}),(function(n){return[N.some(n)]}))}));return lh(i)}))},d=function(t){return jn(n.get(),t).map((function(n){var r=jn(e.get(),t).getOr([]);return[n].concat(r)}))},m=function(n){return jn(e.get(),n).bind((function(n){return n.length>1?N.some(n.slice(1)):N.none()}))},g=function(n){return jn(e.get(),n)},p=function(n){return h(n).bind(Dw)},h=function(n){return jn(t.get(),n)},v=function(t){return jn(n.get(),t)},b=function(n){var t=o.get();return un(_n(t),n)},y=function(){return r.get().bind(p)},w=function(){return t.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:g,collapse:m,lookupMenu:h,lookupItem:v,otherMenus:b,getPrimary:y,getMenus:w,clear:i,isClear:u,getTriggeringPath:f}},Dw=function(n){return"prepared"===n.type?N.some(n.menu):N.none()},Ew={init:Tw,extractPreparedMenu:Dw},_w=function(n,t){var e,r=Ke(N.none()),o=function(t,e,r){return Bn(r,(function(r,o){var i=function(){return Sw.sketch(D(D({},r),{value:o,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?cv():av()}))};return o===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=Ew.init(),u=function(t){var e=o(t,n.data.primary,n.data.menus),r=s();return i.setContents(n.data.primary,e,n.data.expansions,r),i.getPrimary()},a=function(n){return Kg.getValue(n).value},c=function(n,t,e){return mn(t,(function(n){if(!n.getSystem().isConnected())return N.none();var t=zh.getCandidates(n);return Z(t,(function(n){return a(n)===e}))}))},s=function(t){return Bn(n.data.menus,(function(n,t){return en(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},l=function(n,t){zh.highlight(n,t),zh.getHighlighted(t).orThunk((function(){return zh.getFirst(t)})).each((function(t){mi(n,t.element,Wo())}))},f=function(n,t){return sh(G(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?N.some(n.menu):N.none()}))})))},d=function(t,e,r){var o=f(e,e.otherMenus(r));q(o,(function(e){Va(e.element,[n.markers.backgroundMenu]),n.stayInDom||xy.remove(t,e)}))},m=function(t){return r.get().getOrThunk((function(){var e={},o=Jd(t.element,"."+n.markers.item),i=K(o,(function(n){return"true"===Ou(n,"aria-haspopup")}));return q(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),r.set(N.some(e)),e}))},g=function(n,t){var e=m(n);Rn(e,(function(n,e){var r=H(t,e);Cu(n.element,"aria-expanded",r)}))},h=function(t,e,r){return N.from(r[0]).bind((function(o){return e.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return N.none();var i=o.menu,u=f(e,r.slice(1));return q(u,(function(t){Pa(t.element,n.markers.backgroundMenu)})),Wa(i.element)||xy.append(t,wc(i)),Va(i.element,[n.markers.backgroundMenu]),l(t,i),d(t,e,r),N.some(i)}))}))};(function(n){n[n["HighlightSubmenu"]=0]="HighlightSubmenu",n[n["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var v=function(n,t,e){if("notbuilt"===e.type){var r=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,r),r}return e.menu},b=function(t,r,o){void 0===o&&(o=e.HighlightSubmenu);var u=a(r);return i.expand(u).bind((function(u){return g(t,u),N.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=v(t,a,c);return Wa(s.element)||xy.append(t,wc(s)),n.onOpenSubmenu(t,r,s,on(u)),o===e.HighlightSubmenu?(zh.highlightFirst(s),h(t,i,u)):(zh.dehighlightAll(s),N.some(r))}))}))}))},y=function(t,e){var r=a(e);return i.collapse(r).bind((function(r){return g(t,r),h(t,i,r).map((function(r){return n.onCollapseMenu(t,e,r),r}))}))},w=function(n,t){var e=a(t);return i.refresh(e).bind((function(t){return g(n,t),h(n,i,t)}))},x=function(n,t){return ph(t.element)?N.none():b(n,t,e.HighlightSubmenu)},S=function(n,t){return ph(t.element)?N.none():y(n,t)},C=function(t,e){return y(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))},k=function(t){return function(e,r){return ps(r.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map(O)}))}))}},T=hi([wi(ww(),(function(n,t){var e=t.event.item;i.lookupItem(a(e)).each((function(){var e=t.event.menu;zh.highlight(n,e);var r=a(t.event.item);i.refresh(r).each((function(t){return d(n,i,t)}))}))})),Mi((function(t,r){var o=r.event.target;t.getSystem().getByDom(o).each((function(r){var o=a(r);0===o.indexOf("collapse-item")&&y(t,r),b(t,r,e.HighlightSubmenu).fold((function(){n.onExecute(t,r)}),p)}))})),Ai((function(t,e){u(t).each((function(e){xy.append(t,wc(e)),n.onOpenMenu(t,e),n.highlightImmediately&&l(t,e)}))}))].concat(n.navigateOnHover?[wi(ow(),(function(t,r){var o=r.event.item;w(t,o),b(t,o,e.HighlightParent),n.onHover(t,o)}))]:[])),E=function(n){return zh.getHighlighted(n).bind(zh.getHighlighted)},_=function(n){E(n).each((function(t){y(n,t)}))},A=function(n){i.getPrimary().each((function(t){l(n,t)}))},R=function(n){return N.from(n.components()[0]).filter((function(n){return"menu"===Ou(n.element,"role")}))},B=function(t){var e=i.getPrimary().bind((function(n){return E(t).bind((function(n){var e=a(n),r=zn(i.getMenus()),o=sh(G(r,Ew.extractPreparedMenu));return i.getTriggeringPath(e,(function(n){return c(t,o,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))}));e.fold((function(){R(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var r=e.primary,o=e.triggeringPath;n.onRepositionMenu(t,r,o)}))},M={collapseMenu:_,highlightPrimary:A,repositionMenus:B};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Qg(n.tmenuBehaviours,[fy.config({mode:"special",onRight:k(x),onLeft:k(S),onEscape:k(C),focusIn:function(n,t){i.getPrimary().each((function(t){mi(n,t.element,Wo())}))}}),zh.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),yh.config({find:function(n){return zh.getHighlighted(n)}}),xy.config({})]),eventOrder:n.eventOrder,apis:M,events:T}},Aw=y("collapse-item"),Rw=function(n,t,e){return{primary:n,menus:t,expansions:e}},Bw=function(n,t){return{primary:n,menus:lt(n,t),expansions:{}}},Mw=function(n){return{value:Pu(Aw()),meta:{text:n}}},Iw=ah({name:"TieredMenu",configFields:[Hs("onExecute"),Hs("onEscape"),js("onOpenMenu"),js("onOpenSubmenu"),Ls("onRepositionMenu"),Ls("onCollapseMenu"),Le("highlightImmediately",!0),De("data",[ye("primary"),ye("menus"),ye("expansions")]),Le("fakeFocus",!1),Ls("onHighlight"),Ls("onHover"),Ns(),ye("dom"),Le("navigateOnHover",!0),Le("stayInDom",!1),Yg("tmenuBehaviours",[fy,zh,yh,xy]),Le("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:_w,extraApis:{tieredData:Rw,singleData:Bw,collapseItem:Mw}}),Nw=function(n,t,e,r,o){var i=function(){return n.lazySink(t)},u="horizontal"===r.type?{layouts:{onLtr:function(){return Dl()},onRtl:function(){return El()}}}:{},a=function(n){return 2===n.length},c=function(n){return a(n)?u:{}};return Iw.sketch({dom:{tag:"div"},data:r.data,markers:r.menu.markers,highlightImmediately:r.menu.highlightImmediately,onEscape:function(){return mg.close(t),n.onEscape.map((function(n){return n(t)})),N.some(!0)},onExecute:function(){return N.some(!0)},onOpenMenu:function(n,t){Mm.positionWithinBounds(i().getOrDie(),e,t,o())},onOpenSubmenu:function(n,t,e,r){var o=i().getOrDie();Mm.position(o,D({anchor:"submenu",item:t},c(r)),e)},onRepositionMenu:function(n,t,r){var u=i().getOrDie();Mm.positionWithinBounds(u,e,t,o()),q(r,(function(n){var t=c(n.triggeringPath);Mm.position(u,D({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})},Fw=function(n,t){var e=function(t,e){var r=n.getRelated(t);return r.exists((function(n){return ys(n,e)}))},r=function(n,t){mg.setContent(n,t)},o=function(n,t,e){i(n,t,e,N.none())},i=function(n,t,e,r){u(n,t,e,(function(){return r.map((function(n){return os(n)}))}))},u=function(t,e,r,o){var i=n.lazySink(t).getOrDie();mg.openWhileCloaked(t,r,(function(){return Mm.positionWithinBounds(i,e,t,o())})),Kg.setValue(t,N.some({mode:"position",anchor:e,getBounds:o}))},a=function(n,t,e){c(n,t,e,(function(){return N.none()}))},c=function(t,e,r,o){var i=Nw(n,t,e,r,o);mg.open(t,i),Kg.setValue(t,N.some({mode:"menu",menu:i}))},s=function(n){mg.isOpen(n)&&(Kg.setValue(n,N.none()),mg.close(n))},l=function(n){return mg.getState(n)},f=function(t){mg.isOpen(t)&&Kg.getValue(t).each((function(e){switch(e.mode){case"menu":mg.getState(t).each((function(n){Iw.repositionMenus(n)}));break;case"position":var r=n.lazySink(t).getOrDie();Mm.positionWithinBounds(r,e.anchor,t,e.getBounds());break}}))},d={setContent:r,showAt:o,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:l,reposition:f,isOpen:mg.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Qg(n.inlineBehaviours,[mg.config({isPartOf:function(n,t,r){return ys(t,r)||e(n,r)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Kg.config({store:{mode:"memory",initialValue:N.none()}}),ql.config({channels:D(D({},bg(D({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),wg(D(D({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:f})))})]),eventOrder:n.eventOrder,apis:d}},Pw=ah({name:"InlineView",configFields:[ye("lazySink"),Ls("onShow"),Ls("onHide"),Ie("onEscape"),Yg("inlineBehaviours",[mg,Kg,ql]),Fe("fireDismissalEventInstead",[Le("event",ei())]),Fe("fireRepositionEventInstead",[Le("event",ri())]),Le("getRelated",N.none),Le("isExtraPart",k),Le("eventOrder",N.none)],factory:Fw,apis:{showAt:function(n,t,e,r){n.showAt(t,e,r)},showWithin:function(n,t,e,r,o){n.showWithin(t,e,r,o)},showWithinBounds:function(n,t,e,r,o){n.showWithinBounds(t,e,r,o)},showMenuAt:function(n,t,e,r){n.showMenuAt(t,e,r)},showMenuWithinBounds:function(n,t,e,r,o){n.showMenuWithinBounds(t,e,r,o)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),Lw=function(n){return n.x},zw=function(n,t){return n.x+n.width/2-t.width/2},jw=function(n,t){return n.x+n.width-t.width},Hw=function(n){return n.y},Vw=function(n,t){return n.y+n.height-t.height},Uw=function(n,t,e){return Gs(jw(n,t),Vw(n,t),e.innerSoutheast(),Zs(),il(n,{right:0,bottom:3}),"layout-inner-se")},Ww=function(n,t,e){return Gs(Lw(n),Vw(n,t),e.innerSouthwest(),Qs(),il(n,{left:1,bottom:3}),"layout-inner-sw")},Gw=function(n,t,e){return Gs(jw(n,t),Hw(n),e.innerNortheast(),Js(),il(n,{right:0,top:2}),"layout-inner-ne")},qw=function(n,t,e){return Gs(Lw(n),Hw(n),e.innerNorthwest(),Ys(),il(n,{left:1,top:2}),"layout-inner-nw")},$w=function(n,t,e){return Gs(zw(n,t),Hw(n),e.innerNorth(),nl(),il(n,{top:2}),"layout-inner-n")},Xw=function(n,t,e){return Gs(zw(n,t),Vw(n,t),e.innerSouth(),tl(),il(n,{bottom:3}),"layout-inner-s")},Kw=tinymce.util.Tools.resolve("tinymce.util.Delay"),Yw=function(n){var t=Zy(n.action),e=n.dom.tag,r=function(t){return jn(n.dom,"attributes").bind((function(n){return jn(n,t)}))},o=function(){if("button"===e){var n=r("type").getOr("button"),t=r("role").map((function(n){return{role:n}})).getOr({});return D({type:n},t)}var o=r("role").getOr("button");return{role:o}};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Zg.augment(n.buttonBehaviours,[By.config({}),fy.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o()},eventOrder:n.eventOrder}},Jw=ah({name:"Button",factory:Yw,configFields:[Le("uid",void 0),ye("dom"),Le("components",[]),Zg.field("buttonBehaviours",[By,fy]),Ae("action"),Ae("role"),Le("eventOrder",{})]}),Qw=function(n){var t=oh(n)&&Vn(n,"uid")?n.uid:Gu("memento"),e=function(n){return n.getSystem().getByUid(t).getOrDie()},r=function(n){return n.getSystem().getByUid(t).toOptional()},o=function(){return D(D({},n),{uid:t})};return{get:e,getOpt:r,asSpec:o}},Zw=function(n){return N.from(n()["temporary-placeholder"]).getOr("!not found!")},nx=function(n,t){return N.from(t()[n.toLowerCase()]).getOrThunk((function(){return Zw(t)}))},tx=function(n,t,e){return N.from(t()[n.toLowerCase()]).or(e).getOrThunk((function(){return Zw(t)}))},ex=function(n,t){return mn(n,(function(n){return N.from(t()[n.toLowerCase()])})).getOrThunk((function(){return Zw(t)}))},rx={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},ox=function(n){var t=Qw({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:jl([xy.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},r=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},o=Qw({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},r(0)],behaviours:jl([xy.config({})])}),i=function(n,t){n.getSystem().isConnected()&&o.getOpt(n).each((function(n){xy.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},r(t)])}))},u=function(n,e){if(n.getSystem().isConnected()){var r=t.get(n);xy.set(r,[hc(e)])}},a={updateProgress:i,updateText:u},c=tn([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return N.from(rx[n])})).toArray()]),s=Qw(Jw.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:nx("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:ex(c,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:jl([xy.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},behaviours:jl([By.config({}),Cy("notification-events",[wi(Eo(),(function(n){s.getOpt(n).each(By.focus)}))])]),components:l.concat(n.progress?[o.asSpec()]:[]).concat(n.closeButton?[s.asSpec()]:[]),apis:a}},ix=ah({name:"Notification",factory:ox,configFields:[Ae("level"),ye("progress"),ye("icon"),ye("onAction"),ye("text"),ye("iconProvider"),ye("translationProvider"),Ue("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}});function ux(n,t,e){var r=t.backstage,o=function(n){switch(n){case"bc-bc":return Xw;case"tc-tc":return $w;case"tc-bc":return yl;case"bc-tc":default:return wl}},i=function(n){q(n,(function(n){return n.moveTo(0,0)}))},u=function(n){n.length>0&&(ln(n).each((function(n){return n.moveRel(null,"banner")})),q(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},a=function(n){i(n),u(n)},c=function(n,i){var u=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),a=function(){i(),Pw.hide(s)},c=yc(ix.sketch({text:n.text,level:H(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:N.from(n.icon),closeButton:!u,onAction:a,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),s=yc(Pw.sketch(D({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},r.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(s),n.timeout>0&&Kw.setTimeout((function(){a()}),n.timeout),{close:a,moveTo:function(n,t){Pw.showAt(s,{anchor:"makeshift",x:n,y:t},wc(c))},moveRel:function(n,e){if("banner"!==e){var r=o(e),i={anchor:"node",root:Ga(),node:N.some(tr.fromDom(n)),layouts:{onRtl:function(){return[r]},onLtr:function(){return[r]}}};Pw.showAt(s,i,wc(c))}else Pw.showAt(s,t.backstage.shared.anchors.banner(),wc(c))},text:function(n){ix.updateText(c,n)},settings:n,getEl:function(){return c.element.dom},progressBar:{value:function(n){ix.updateProgress(c,n)}}}},s=function(n){n.close()},l=function(n){return n.settings};return{open:c,close:s,reposition:a,getArgs:l}}var ax,cx=function(n,t){var e=null,r=function(){null!==e&&(clearTimeout(e),e=null)},o=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null===e&&(e=setTimeout((function(){n.apply(null,r),e=null}),t))};return{cancel:r,throttle:o}},sx=function(n,t){var e=null,r=function(){null!==e&&(clearTimeout(e),e=null)},o=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,r),e=null}),t)};return{cancel:r,throttle:o}},lx=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),fx=function(n,t){return n.isBlock(t)||H(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)},dx=function(n,t,e,r,o){var i=lx(n,(function(t){return fx(n,t)}));return N.from(i.backwards(t,e,r,o))},mx="[data-mce-autocompleter]",gx=function(n,t){return px(tr.fromDom(n.selection.getNode())).getOrThunk((function(){var e=tr.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return fu(e,tr.fromDom(t.extractContents())),t.insertNode(e.dom),Gi(e).each((function(n){return n.dom.normalize()})),Kd(e).map((function(t){n.selection.setCursorLocation(t.dom,Gd(t))})),e}))},px=function(n){return ps(n,mx)},hx=function(n){return n.collapsed&&3===n.startContainer.nodeType},vx=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},bx=function(n){return""!==n&&-1!==" \f\n\r\t\v".indexOf(n)},yx=function(n,t){return n.substring(t.length)},wx=function(n,t,e){var r;for(r=t-1;r>=0;r--){var o=n.charAt(r);if(bx(o))return N.none();if(o===e)break}return N.some(r)},xx=function(n,t,e,r){if(void 0===r&&(r=0),!hx(t))return N.none();var o=function(n,t,r){return wx(r,t,e).getOr(t)},i=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return dx(n,t.startContainer,t.startOffset,o,i).bind((function(n){var o=t.cloneRange();if(o.setStart(n.container,n.offset),o.setEnd(t.endContainer,t.endOffset),o.collapsed)return N.none();var i=vx(o),u=i.lastIndexOf(e);return 0!==u||yx(i,e).length<r?N.none():N.some({text:yx(i,e),range:o,triggerChar:e})}))},Sx=function(n,t,e,r){return void 0===r&&(r=0),px(tr.fromDom(t.startContainer)).fold((function(){return xx(n,t,e,r)}),(function(t){var r=n.createRng();r.selectNode(t.dom);var o=vx(r);return N.some({range:r,text:yx(o,e),triggerChar:e})}))},Cx=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){fi(n,Ao(),{raw:t})};t.on("keydown",(function(t){var r=function(){return n.getView().bind(zh.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(r().each(di),t.preventDefault()):40===t.which?(r().fold((function(){n.getView().each(zh.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||r().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&px(tr.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},kx={setup:Cx},Ox=tinymce.util.Tools.resolve("tinymce.util.Promise"),Tx=function(n,t){return{container:n,offset:t}},Dx=function(n){return n.nodeType===Zr},Ex=function(n){return n.nodeType===Qr},_x=function(n){if(Dx(n))return Tx(n,n.data.length);var t=n.childNodes;return t.length>0?_x(t[t.length-1]):Tx(n,t.length)},Ax=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?Ax(e[t],0):e.length>0&&Ex(n)&&e.length===t?_x(e[e.length-1]):Tx(n,t)},Rx=function(n,t){return dx(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!bx(t)})).isSome()},Bx=function(n){return function(t){var e=Ax(t.startContainer,t.startOffset);return!Rx(n,e)}},Mx=function(n,t,e){return mn(e.triggerChars,(function(e){return Sx(n,t,e)}))},Ix=function(n,t){var e=t(),r=n.selection.getRng();return Mx(n.dom,r,e).bind((function(e){return Nx(n,t,e)}))},Nx=function(n,t,e,r){void 0===r&&(r={});var o=t(),i=n.selection.getRng(),u=i.startContainer.nodeValue,a=K(o.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Bx(n.dom)}))(e.range,u,e.text)}));if(0===a.length)return N.none();var c=Ox.all(G(a,(function(n){var t=n.fetch(e.text,n.maxResults,r);return t.then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}}))})));return N.some({lookupData:c,context:e})},Fx=zt([Se("type"),Me("text")]),Px=function(n){return re("separatormenuitem",Fx,n)},Lx=zt([Le("type","autocompleteitem"),Le("active",!1),Le("disabled",!1),Le("meta",{}),Se("value"),Me("text"),Me("icon")]),zx=zt([Se("type"),Se("ch"),je("minChars",1),Le("columns",1),je("maxResults",10),Ie("matches"),Oe("fetch"),Oe("onAction"),qe("highlightOn",[],me)]),jx=function(n){return re("Autocompleter.Separator",Fx,n)},Hx=function(n){return re("Autocompleter.Item",Lx,n)},Vx=function(n){return re("Autocompleter",zx,n)},Ux=[Ue("disabled",!1),Me("tooltip"),Me("icon"),Me("text"),We("onSetup",(function(){return p}))],Wx=zt([Se("type"),Oe("onAction")].concat(Ux)),Gx=function(n){return re("toolbarbutton",Wx,n)},qx=[Ue("active",!1)].concat(Ux),$x=zt(qx.concat([Se("type"),Oe("onAction")])),Xx=function(n){return re("ToggleButton",$x,n)},Kx=[We("predicate",k),Ve("scope","node",["node","editor"]),Ve("position","selection",["node","selection","line"])],Yx=Ux.concat([Le("type","contextformbutton"),Le("primary",!1),Oe("onAction"),Xe("original",w)]),Jx=qx.concat([Le("type","contextformbutton"),Le("primary",!1),Oe("onAction"),Xe("original",w)]),Qx=Ux.concat([Le("type","contextformbutton")]),Zx=qx.concat([Le("type","contextformtogglebutton")]),nS=ce("type",{contextformbutton:Yx,contextformtogglebutton:Jx}),tS=zt([Le("type","contextform"),We("initValue",(function(){return""})),Me("label"),_e("commands",nS),Re("launch",ce("type",{contextformbutton:Qx,contextformtogglebutton:Zx}))].concat(Kx)),eS=function(n){return re("ContextForm",tS,n)},rS=zt([Le("type","contexttoolbar"),Se("items")].concat(Kx)),oS=function(n){return re("ContextToolbar",rS,n)},iS=function(n){var t={};return q(n,(function(n){t[n]={}})),_n(t)},uS=function(n){var t=n.ui.registry.getAll().popups,e=Bn(t,(function(n){return Vx(n).fold((function(n){throw new Error(ue(n))}),(function(n){return n}))})),r=iS(Pn(e,(function(n){return n.ch}))),o=zn(e),i=function(n){return K(o,(function(t){return t.ch===n}))};return{dataset:e,triggerChars:r,lookupByChar:i}};(function(n){n[n["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",n[n["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(ax||(ax={}));var aS,cS=ax,sS="tox-menu-nav__js",lS="tox-collection__item",fS="tox-swatch",dS={normal:sS,color:fS},mS="tox-collection__item--enabled",gS="tox-collection__group-heading",pS="tox-collection__item-icon",hS="tox-collection__item-label",vS="tox-collection__item-accessory",bS="tox-collection__item-caret",yS="tox-collection__item-checkmark",wS="tox-collection__item--active",xS="tox-collection__item-icon-rtl",SS="tox-collection__item-container",CS="tox-collection__item-container--column",kS="tox-collection__item-container--row",OS="tox-collection__item-container--align-right",TS="tox-collection__item-container--align-left",DS="tox-collection__item-container--valign-top",ES="tox-collection__item-container--valign-middle",_S="tox-collection__item-container--valign-bottom",AS=function(n){return jn(dS,n).getOr(sS)},RS=function(n){return"color"===n?"tox-swatches":"tox-menu"},BS=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:RS(n),tieredMenu:"tox-tiered-menu"}},MS=function(n){var t=BS(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:AS(n)}},IS=function(n,t,e){var r=BS(e);return{tag:"div",classes:tn([[r.menu,"tox-menu-"+t+"-column"],n?[r.hasIcons]:[]])}},NS=[Sw.parts.items({})],FS=function(n,t,e){var r=BS(e),o={tag:"div",classes:tn([[r.tieredMenu]])};return{dom:o,markers:MS(e)}},PS=function(n,t){return function(e){var r=W(e,t);return G(r,(function(t){return{dom:n,components:t}}))}},LS=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Sw.parts.items({preprocess:"auto"!==n?PS({tag:"div",classes:["tox-swatches__row"]},n):w})]}]}},zS=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Sw.parts.items({preprocess:PS({tag:"div",classes:["tox-collection__group"]},n)})]}},jS=function(n,t){var e=[],r=[];return q(n,(function(n,o){t(n,o)?(r.length>0&&e.push(r),r=[],Hn(n.dom,"innerHtml")&&r.push(n)):r.push(n)})),r.length>0&&e.push(r),G(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},HS=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Sw.parts.items({preprocess:function(e){return"auto"!==n&&n>1?PS({tag:"div",classes:["tox-collection__group"]},n)(e):jS(e,(function(n,e){return"separator"===t[e].type}))}})]}},VS=function(n,t){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Sw.parts.items({preprocess:function(t){return jS(t,(function(t,e){return"separator"===n[e].type}))}})]}},US=function(n){return V(n,(function(n){return"icon"in n&&void 0!==n.icon}))},WS=function(n){return N.none()},GS=function(n,t,e,r,o){var i=VS(e);return{value:n,dom:i.dom,components:i.components,items:e}},qS=function(n,t,e,r,o){if("color"===o){var i=LS(r);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===o&&"auto"===r){i=HS(r,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===o&&1===r){i=HS(1,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===o){i=HS(r,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("listpreview"===o&&"auto"!==r){i=zS(r);return{value:n,dom:i.dom,components:i.components,items:e}}return{value:n,dom:IS(t,r,o),components:NS,items:e}},$S=[Se("type"),Se("src"),Me("alt"),qe("classes",[],me)],XS=zt($S),KS=[Se("type"),Se("text"),Me("name"),qe("classes",["tox-collection__item-label"],me)],YS=zt(KS),JS=Zt((function(){return ae("type",{cardimage:XS,cardtext:YS,cardcontainer:QS})})),QS=zt([Se("type"),He("direction","horizontal"),He("align","left"),He("valign","middle"),_e("items",JS)]),ZS=[Ue("disabled",!1),Me("text"),Me("shortcut"),$t("value","value",rt((function(){return Pu("menuitem-value")})),le()),Le("meta",{})],nC=zt([Se("type"),Me("label"),_e("items",JS),We("onSetup",(function(){return p})),We("onAction",p)].concat(ZS)),tC=function(n){return re("cardmenuitem",nC,n)},eC=zt([Se("type"),Ue("active",!1),Me("icon")].concat(ZS)),rC=function(n){return re("choicemenuitem",eC,n)},oC=["inserttable","colorswatch"],iC=zt([Se("type"),Ce("fancytype",oC),We("onAction",p)]),uC=function(n){return re("fancymenuitem",iC,n)},aC=zt([Se("type"),We("onSetup",(function(){return p})),We("onAction",p),Me("icon")].concat(ZS)),cC=function(n){return re("menuitem",aC,n)},sC=zt([Se("type"),Oe("getSubmenuItems"),We("onSetup",(function(){return p})),Me("icon")].concat(ZS)),lC=function(n){return re("nestedmenuitem",sC,n)},fC=zt([Se("type"),Me("icon"),Ue("active",!1),We("onSetup",(function(){return p})),Oe("onAction")].concat(ZS)),dC=function(n){return re("togglemenuitem",fC,n)},mC=function(n,t,e){var r=Jd(n.element,"."+e);if(r.length>0){var o=nn(r,(function(n){var e=n.dom.getBoundingClientRect().top,o=r[0].dom.getBoundingClientRect().top;return Math.abs(e-o)>t})).getOr(r.length);return N.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return N.none()},gC=function(n,t){return jl([Cy(n,t)])},pC=function(n){return gC(Pu("unnamed-events"),n)},hC={namedEvents:gC,unnamedEvents:pC},vC=Pu("tooltip.exclusive"),bC=Pu("tooltip.show"),yC=Pu("tooltip.hide"),wC=function(n,t,e){n.getSystem().broadcastOn([vC],{})},xC=function(n,t,e,r){e.getTooltip().each((function(n){n.getSystem().isConnected()&&xy.set(n,r)}))},SC=Object.freeze({__proto__:null,hideAllExclusive:wC,setComponents:xC}),CC=function(n,t){var e=function(e){t.getTooltip().each((function(r){Vm(r),n.onHide(e,r),t.clearTooltip()})),t.clearTimer()},r=function(e){if(!t.isShowing()){wC(e);var r=n.lazySink(e).getOrDie(),o=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:hi("normal"===n.mode?[wi(Do(),(function(n){li(e,bC)})),wi(Oo(),(function(n){li(e,yC)}))]:[]),behaviours:jl([xy.config({})])});t.setTooltip(o),zm(r,o),n.onShow(e,o),Mm.position(r,n.anchor(e),o)}};return hi(tn([[wi(bC,(function(e){t.resetTimer((function(){r(e)}),n.delay)})),wi(yC,(function(r){t.resetTimer((function(){e(r)}),n.delay)})),wi(Vo(),(function(n,t){var r=t;r.universal||H(r.channels,vC)&&e(n)})),Ri((function(n){e(n)}))],"normal"===n.mode?[wi(Eo(),(function(n){li(n,bC)})),wi(jo(),(function(n){li(n,yC)})),wi(Do(),(function(n){li(n,bC)})),wi(Oo(),(function(n){li(n,yC)}))]:[wi(ci(),(function(n,t){li(n,bC)})),wi(si(),(function(n){li(n,yC)}))]]))},kC=Object.freeze({__proto__:null,events:CC}),OC=[ye("lazySink"),ye("tooltipDom"),Le("exclusive",!0),Le("tooltipComponents",[]),Le("delay",300),Ve("mode","normal",["normal","follow-highlight"]),Le("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:y([wl,yl,pl,vl,hl,bl]),onRtl:y([wl,yl,pl,vl,hl,bl])}}})),Ls("onHide"),Ls("onShow")],TC=function(){var n=Ke(N.none()),t=Ke(N.none()),e=function(){return t.get()},r=function(n){t.set(N.some(n))},o=function(){t.set(N.none())},i=function(){n.get().each((function(n){clearTimeout(n)}))},u=function(t,e){i(),n.set(N.some(setTimeout((function(){t()}),e)))},a=function(){return t.get().isSome()},c=y("not-implemented");return oa({getTooltip:e,isShowing:a,setTooltip:r,clearTooltip:o,clearTimer:i,resetTimer:u,readState:c})},DC=Object.freeze({__proto__:null,init:TC}),EC=Vl({fields:OC,name:"tooltipping",active:kC,state:DC,apis:SC}),_C=function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},AC=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),RC=tinymce.util.Tools.resolve("tinymce.util.I18n"),BC=["input","button","textarea","select"],MC=function(n,t,e){var r=t.disabled()?HC:VC;r(n,t)},IC=function(n,t){return!0===t.useNative&&H(BC,Ii(n.element))},NC=function(n){return Du(n.element,"disabled")},FC=function(n){Cu(n.element,"disabled","disabled")},PC=function(n){Eu(n.element,"disabled")},LC=function(n){return"true"===Ou(n.element,"aria-disabled")},zC=function(n){Cu(n.element,"aria-disabled","true")},jC=function(n){Cu(n.element,"aria-disabled","false")},HC=function(n,t,e){t.disableClass.each((function(t){Pa(n.element,t)}));var r=IC(n,t)?FC:zC;r(n),t.onDisabled(n)},VC=function(n,t,e){t.disableClass.each((function(t){za(n.element,t)}));var r=IC(n,t)?PC:jC;r(n),t.onEnabled(n)},UC=function(n,t){return IC(n,t)?NC(n):LC(n)},WC=function(n,t,e,r){var o=r?HC:VC;o(n,t)},GC=Object.freeze({__proto__:null,enable:VC,disable:HC,isDisabled:UC,onLoad:MC,set:WC}),qC=function(n,t){return sa({classes:t.disabled()?t.disableClass.toArray():[]})},$C=function(n,t){return hi([vi(Uo(),(function(t,e){return UC(t,n)})),Il(n,t,MC)])},XC=Object.freeze({__proto__:null,exhibit:qC,events:$C}),KC=[We("disabled",k),Le("useNative",!0),Ae("disableClass"),Ls("onDisabled"),Ls("onEnabled")],YC=Vl({fields:KC,name:"disabling",active:XC,apis:GC}),JC=tinymce.util.Tools.resolve("tinymce.EditorManager"),QC=function(n){var t=n.getParam("skin"),e=n.getParam("skin_url");if(!1!==t){var r=t||"oxide";e=e?n.documentBaseURI.toAbsolute(e):JC.baseURL+"/skins/ui/"+r}return e},ZC=function(n){return n.getParam("readonly",!1,"boolean")},nk=function(n){return!1===n.getParam("skin")},tk=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},ek=function(n){return n.getParam("width",AC.DOM.getStyle(n.getElement(),"width"))},rk=function(n){return N.from(n.getParam("min_width")).filter(m)},ok=function(n){return N.from(n.getParam("min_height")).filter(m)},ik=function(n){return N.from(n.getParam("max_width")).filter(m)},uk=function(n){return N.from(n.getParam("max_height")).filter(m)},ak=function(n){return N.from(n.getParam("style_formats")).filter(a)},ck=function(n){return n.getParam("style_formats_merge",!1,"boolean")},sk=function(n){return n.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},lk=function(n){return n.getParam("removed_menuitems","")},fk=function(n){return!1!==n.getParam("menubar",!0,"boolean")},dk=function(n){var t=n.getParam("toolbar",!0),e=!0===t,r=i(t),o=a(t)&&t.length>0;return!gk(n)&&(o||r||e)},mk=function(n){var t=U(9,(function(t){return n.getParam("toolbar"+(t+1),!1,"string")})),e=K(t,(function(n){return"string"===typeof n}));return e.length>0?N.some(e):N.none()},gk=function(n){return mk(n).fold((function(){var t=n.getParam("toolbar",[],"string[]");return t.length>0}),O)};(function(n){n["default"]="wrap",n["floating"]="floating",n["sliding"]="sliding",n["scrolling"]="scrolling"})(aS||(aS={}));var pk,hk=function(n){return n.getParam("toolbar_mode","","string")};(function(n){n["auto"]="auto",n["top"]="top",n["bottom"]="bottom"})(pk||(pk={}));var vk,bk=function(n){return n.getParam("toolbar_groups",{},"object")},yk=function(n){return n.getParam("toolbar_location",pk.auto,"string")},wk=function(n){return yk(n)===pk.bottom},xk=function(n){return n.getParam("fixed_toolbar_container","","string")},Sk=function(n){return n.getParam("fixed_toolbar_container_target")},Ck=function(n){return n.getParam("toolbar_persist",!1,"boolean")},kk=function(n){if(!n.inline)return N.none();var t=xk(n);if(t.length>0)return gs(Ga(),t);var e=Sk(n);return f(e)?N.some(tr.fromDom(e)):N.none()},Ok=function(n){return n.inline&&kk(n).isSome()},Tk=function(n){var t=kk(n);return t.getOrThunk((function(){return eu(tu(tr.fromDom(n.getElement())))}))},Dk=function(n){return n.inline&&!fk(n)&&!dk(n)&&!gk(n)},Ek=function(n){var t=n.getParam("toolbar_sticky",!1,"boolean");return(t||n.inline)&&!Ok(n)&&!Dk(n)},_k=function(n){return n.getParam("draggable_modal",!1,"boolean")},Ak=function(n){var t=n.getParam("menu");return t?Bn(t,(function(n){return D(D({},n),{items:n.items})})):{}},Rk=function(n){return n.getParam("menubar")},Bk=function(n){return n.getParam("toolbar",!0)},Mk=function(n){return n.getParam("file_picker_callback")},Ik=function(n){return n.getParam("file_picker_types")},Nk=function(n){return n.getParam("file_browser_callback_types")},Fk=function(n){return!1===n.getParam("typeahead_urls")},Pk=function(n){return n.getParam("anchor_top","#top")},Lk=function(n){return n.getParam("anchor_bottom","#bottom")},zk=function(n){var t=n.getParam("file_picker_validator_handler",void 0,"function");return void 0===t?n.getParam("filepicker_validator_handler",void 0,"function"):t},jk="silver.readonly",Hk=zt([ke("readonly")]),Vk=function(n,t){var e=n.outerContainer,r=e.element;t&&(n.mothership.broadcastOn([gg()],{target:r}),n.uiMothership.broadcastOn([gg()],{target:r})),n.mothership.broadcastOn([jk],{readonly:t}),n.uiMothership.broadcastOn([jk],{readonly:t})},Uk=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&Vk(t,!0)})),n.on("SwitchMode",(function(){return Vk(t,n.mode.isReadOnly())})),ZC(n)&&n.setMode("readonly")},Wk=function(){var n;return ql.config({channels:(n={},n[jk]={schema:Hk,onReceive:function(n,t){YC.set(n,t.readonly)}},n)})},Gk=function(n){return YC.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},qk=function(n){return YC.config({disabled:n})},$k=function(n){return YC.config({disabled:n,disableClass:"tox-tbtn--disabled"})},Xk=function(n){return YC.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},Kk={item:Gk,button:qk,splitButton:$k,toolbarButton:Xk},Yk=function(n,t){var e=n.getApi(t);return function(n){n(e)}},Jk=function(n,t){return Ai((function(e){var r=Yk(n,e);r((function(e){var r=n.onSetup(e);d(r)&&t.set(r)}))}))},Qk=function(n,t){return Ri((function(e){return Yk(n,e)(t.get())}))},Zk=function(n,t){return Mi((function(e,r){Yk(n,e)(n.onAction),n.triggersSubmenu||t!==cS.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&li(e,$o()),r.stop())}))},nO=(vk={},vk[Uo()]=["disabling","alloy.base.behaviour","toggling","item-events"],vk),tO=function(n){return en(n,(function(n){return n.toArray()}))},eO=function(n,t,e,r){var o=Ke(p);return{type:"item",dom:t.dom,components:tO(t.optComponents),data:n.data,eventOrder:nO,hasSubmenu:n.triggersSubmenu,itemBehaviours:jl([Cy("item-events",[Zk(n,e),Jk(n,o),Qk(n,o)]),Kk.item((function(){return n.disabled||r.isDisabled()})),Wk(),xy.config({})].concat(n.itemBehaviours))}},rO=function(n){return{value:n.value,meta:D({text:n.text.getOr("")},n.meta)}},oO=tinymce.util.Tools.resolve("tinymce.Env"),iO=function(n){var t={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},r=oO.mac?t:e,o=n.split("+"),i=G(o,(function(n){var t=n.toLowerCase().trim();return Hn(r,t)?r[t]:n}));return oO.mac?i.join(""):i.join("+")},uO=function(n){return{dom:{tag:"div",classes:[pS],innerHtml:n}}},aO=function(n){return{dom:{tag:"div",classes:[hS]},components:[hc(RC.translate(n))]}},cO=function(n,t){return{dom:{tag:"div",classes:t,innerHtml:n}}},sO=function(n,t){return{dom:{tag:"div",classes:[hS]},components:[{dom:{tag:n.tag,styles:n.styles},components:[hc(RC.translate(t))]}]}},lO=function(n){return{dom:{tag:"div",classes:[vS],innerHtml:iO(n)}}},fO=function(n){return{dom:{tag:"div",classes:[yS],innerHtml:nx("checkmark",n)}}},dO=function(n){return{dom:{tag:"div",classes:[bS],innerHtml:nx("chevron-right",n)}}},mO=function(n){return{dom:{tag:"div",classes:[bS],innerHtml:nx("chevron-down",n)}}},gO=function(n,t){var e="vertical"===n.direction?CS:kS,r="left"===n.align?TS:OS,o=function(){switch(n.valign){case"top":return DS;case"middle":return ES;case"bottom":return _S}};return{dom:{tag:"div",classes:[SS,e,r,o()]},components:t}},pO=function(n,t,e){return{dom:{tag:"img",classes:t,attributes:{src:n,alt:e.getOr("")}}}},hO=function(n,t,e,r){var o="custom",i="remove",u=function(){var u=fS,a=e.getOr(""),c=n.map((function(n){return{title:r.translate(n)}})).getOr({}),s={tag:"div",attributes:c,classes:[u]};return D(D({},s),t===o?{tag:"button",classes:_(s.classes,["tox-swatches__picker-btn"]),innerHtml:a}:t===i?{classes:_(s.classes,["tox-swatch--remove"]),innerHtml:a}:{attributes:D(D({},s.attributes),{"data-mce-color":t}),styles:{"background-color":t}})};return{dom:u(),optComponents:[]}},vO=function(n,t){var e=t.map((function(n){return{attributes:{title:RC.translate(n)}}})).getOr({});return D({tag:"div",classes:[sS,lS].concat(n?[xS]:[])},e)},bO=function(n,t,e,r,o){var i=e?t.or(N.some("")).map(uO):N.none(),u=n.checkMark,a=n.htmlContent.fold((function(){return n.textContent.map(r)}),(function(n){return N.some(cO(n,[hS]))})),c={dom:vO(o,n.ariaLabel),optComponents:[i,a,n.shortcutContent.map(lO),u,n.caret]};return c},yO=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],wO=["list-bull-circle","list-bull-default","list-bull-square"],xO=function(n,t,e,r){void 0===r&&(r=N.none());var o=function(n){return n.map((function(n){return RC.isRtl()&&H(yO,n)?n+"-rtl":n}))},i=RC.isRtl()&&n.iconContent.exists((function(n){return H(wO,n)})),u=o(n.iconContent).map((function(n){return tx(n,t.icons,r)})),a=N.from(n.meta).fold((function(){return aO}),(function(n){return Hn(n,"style")?x(sO,n.style):aO}));return"color"===n.presets?hO(n.ariaLabel,n.value,u,t):bO(n,u,e,a,i)},SO=function(n,t){return jn(n,"tooltipWorker").map((function(n){return[EC.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:Af}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){EC.setComponents(t,[vc({element:tr.fromDom(n)})])}))}})]})).getOr([])},CO=function(n){return AC.DOM.encode(n)},kO=function(n,t){var e=RC.translate(n),r=CO(e);if(t.length>0){var o=new RegExp(_C(t),"gi");return r.replace(o,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return r},OO=function(n,t,e,r,o,i,u,a){void 0===a&&(a=!0);var c=xO({presets:r,textContent:N.none(),htmlContent:e?n.text.map((function(n){return kO(n,t)})):N.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:N.none(),checkMark:N.none(),caret:N.none(),value:n.value},u.providers,a,n.icon);return eO({data:rO(n),disabled:n.disabled,getApi:y({}),onAction:function(t){return o(n.value,n.meta)},onSetup:y(p),triggersSubmenu:!1,itemBehaviours:SO(n.meta,u)},c,i,u.providers)},TO=function(n,t){return G(n,(function(n){switch(n.type){case"cardcontainer":return gO(n,TO(n.items,t));case"cardimage":return pO(n.src,n.classes,n.alt);case"cardtext":var e=n.name.exists((function(n){return H(t.cardText.highlightOn,n)})),r=e?N.from(t.cardText.matchText).getOr(""):"";return cO(kO(n.text,r),n.classes)}}))},DO=function(n,t,e,r){var o=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){YC.set(n,t),q(Jd(n.element,"*"),(function(e){n.getSystem().getByDom(e).each((function(n){n.hasConfigured(YC)&&YC.set(n,t)}))}))}}},i={dom:vO(!1,n.label),optComponents:[N.some({dom:{tag:"div",classes:[SS,kS]},components:TO(n.items,r)})]};return eO({data:rO(D({text:N.none()},n)),disabled:n.disabled,getApi:o,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:N.from(r.itemBehaviours).getOr([])},i,t,e.providers)},EO=function(n,t,e,r,o,i,u,a){void 0===a&&(a=!0);var c=function(n){return{setActive:function(t){Jy.set(n,t)},isActive:function(){return Jy.isOn(n)},isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},s=xO({presets:e,textContent:t?n.text:N.none(),htmlContent:N.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:N.none(),checkMark:t?N.some(fO(u.icons)):N.none(),caret:N.none(),value:n.value},u,a);return Kn(eO({data:rO(n),disabled:n.disabled,getApi:c,onAction:function(t){return r(n.value)},onSetup:function(n){return n.setActive(o),p},triggersSubmenu:!1,itemBehaviours:[]},s,i,u),{toggling:{toggleClass:mS,toggleOnExecute:!1,selected:n.active}})},_O=Fp(lw(),fw()),AO=function(n){return{value:n}},RO=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,BO=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,MO=function(n){return RO.test(n)||BO.test(n)},IO=function(n){var t=n.value.replace(RO,(function(n,t,e,r){return t+t+e+e+r+r}));return{value:t}},NO=function(n){var t=IO(n),e=BO.exec(t.value);return null===e?["FFFFFF","FF","FF","FF"]:e},FO=function(n){var t=n.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},PO=function(n){var t=FO(n.red)+FO(n.green)+FO(n.blue);return AO(t)},LO=Math.min,zO=Math.max,jO=Math.round,HO=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,VO=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,UO=function(n,t,e,r){return{red:n,green:t,blue:e,alpha:r}},WO=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},GO=function(n){var t,e,r,o=(n.hue||0)%360,i=n.saturation/100,u=n.value/100;if(i=zO(0,LO(i,1)),u=zO(0,LO(u,1)),0===i)return t=e=r=jO(255*u),UO(t,e,r,1);var a=o/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:t=c,e=s,r=0;break;case 1:t=s,e=c,r=0;break;case 2:t=0,e=c,r=s;break;case 3:t=0,e=s,r=c;break;case 4:t=s,e=0,r=c;break;case 5:t=c,e=0,r=s;break;default:t=e=r=0}return t=jO(255*(t+l)),e=jO(255*(e+l)),r=jO(255*(r+l)),UO(t,e,r,1)},qO=function(n){var t=NO(n),e=parseInt(t[1],16),r=parseInt(t[2],16),o=parseInt(t[3],16);return UO(e,r,o,1)},$O=function(n,t,e,r){var o=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(r);return UO(o,i,u,a)},XO=function(n){if("transparent"===n)return N.some(UO(0,0,0,0));var t=HO.exec(n);if(null!==t)return N.some($O(t[1],t[2],t[3],"1"));var e=VO.exec(n);return null!==e?N.some($O(e[1],e[2],e[3],e[4])):N.none()},KO=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},YO=UO(255,0,0,1),JO=function(n){return n.fire("SkinLoaded")},QO=function(n,t){return n.fire("SkinLoadError",t)},ZO=function(n){return n.fire("ResizeEditor")},nT=function(n,t){return n.fire("ResizeContent",t)},tT=function(n,t){return n.fire("ScrollContent",t)},eT=function(n,t){return n.fire("TextColorChange",t)},rT=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),oT="tinymce-custom-colors";function iT(n){void 0===n&&(n=10);var t=rT.getItem(oT),e=i(t)?JSON.parse(t):[],r=function(t){var e=n-t.length;return e<0?t.slice(0,n):t},o=r(e),u=function(t){j(o,t).each(a),o.unshift(t),o.length>n&&o.pop(),rT.setItem(oT,JSON.stringify(o))},a=function(n){o.splice(n,1)},c=function(){return o.slice(0)};return{add:u,state:c}}var uT,aT="choiceitem",cT=[{type:aT,text:"Light Green",value:"#BFEDD2"},{type:aT,text:"Light Yellow",value:"#FBEEB8"},{type:aT,text:"Light Red",value:"#F8CAC6"},{type:aT,text:"Light Purple",value:"#ECCAFA"},{type:aT,text:"Light Blue",value:"#C2E0F4"},{type:aT,text:"Green",value:"#2DC26B"},{type:aT,text:"Yellow",value:"#F1C40F"},{type:aT,text:"Red",value:"#E03E2D"},{type:aT,text:"Purple",value:"#B96AD9"},{type:aT,text:"Blue",value:"#3598DB"},{type:aT,text:"Dark Turquoise",value:"#169179"},{type:aT,text:"Orange",value:"#E67E23"},{type:aT,text:"Dark Red",value:"#BA372A"},{type:aT,text:"Dark Purple",value:"#843FA1"},{type:aT,text:"Dark Blue",value:"#236FA1"},{type:aT,text:"Light Gray",value:"#ECF0F1"},{type:aT,text:"Medium Gray",value:"#CED4D9"},{type:aT,text:"Gray",value:"#95A5A6"},{type:aT,text:"Dark Gray",value:"#7E8C8D"},{type:aT,text:"Navy Blue",value:"#34495E"},{type:aT,text:"Black",value:"#000000"},{type:aT,text:"White",value:"#ffffff"}],sT=iT(10),lT=function(n){var t=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var r=e.getContext("2d"),o=function(n,t){var e=255,r=t/255,o=Math.round(n*r+e*(1-r));return("0"+o.toString(16)).slice(-2).toUpperCase()},i=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();r.clearRect(0,0,e.width,e.height),r.fillStyle="#FFFFFF",r.fillStyle=n,r.fillRect(0,0,1,1);var t=r.getImageData(0,0,1,1).data,i=t[0],u=t[1],a=t[2],c=t[3];return"#"+o(i,c)+o(u,c)+o(a,c)},u=0;u<n.length;u+=2)t.push({text:n[u+1],value:i(n[u]),type:"choiceitem"});return t},fT=function(n,t){return n.getParam("color_cols",t,"number")},dT=function(n){return!1!==n.getParam("custom_colors")},mT=function(n){return n.getParam("color_map")},gT=function(n){var t=mT(n);return void 0!==t?lT(t):cT},pT=function(){return G(sT.state(),(function(n){return{type:aT,text:n,value:n}}))},hT=function(n){sT.add(n)},vT=function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var r;(r=n.style["forecolor"===t?"color":"background-color"])&&(e=e||r)})),e},bT=function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))},yT=function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))},wT=function(n){n.addCommand("mceApplyTextcolor",(function(t,e){bT(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){yT(n,t)}))},xT=function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))},ST=function(n){var t=gT(n),e=xT(t.length);return fT(n,e)},CT=function(n){var t="choiceitem",e={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},r={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return n?[e,r]:[e]},kT=function(n,t,e,r){if("custom"===e){var o=AT(n);o((function(e){e.each((function(e){hT(e),n.execCommand("mceApplyTextcolor",t,e),r(e)}))}),"#000000")}else"remove"===e?(r(""),n.execCommand("mceRemoveTextcolor",t)):(r(e),n.execCommand("mceApplyTextcolor",t,e))},OT=function(n,t){return n.concat(pT().concat(CT(t)))},TT=function(n,t){return function(e){e(OT(n,t))}},DT=function(n,t,e){var r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";n.setIconFill(r,e)},ET=function(n,t,e,r,o){n.ui.registry.addSplitButton(t,{tooltip:r,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var r=N.from(vT(n,e));return r.bind((function(n){return XO(n).map((function(n){var e=PO(n).value;return gr(t.toLowerCase(),e)}))})).getOr(!1)},columns:ST(n),fetch:TT(gT(n),dT(n)),onAction:function(t){null!==o.get()&&kT(n,e,o.get(),p)},onItemAction:function(r,i){kT(n,e,i,(function(e){o.set(e),eT(n,{name:t,color:e})}))},onSetup:function(e){null!==o.get()&&DT(e,t,o.get());var r=function(n){n.name===t&&DT(e,n.name,n.color)};return n.on("TextColorChange",r),function(){n.off("TextColorChange",r)}}})},_T=function(n,t,e,r){n.ui.registry.addNestedMenuItem(t,{text:r,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){kT(n,e,t.value,p)}}]}})},AT=function(n){return function(t,e){var r=!1,o=function(e){var o=e.getData(),i=o.colorpicker;r?(t(N.from(i)),e.close()):n.windowManager.alert(n.translate(["Invalid hex color code: {0}",i]))},i=function(n,t){"hex-valid"===t.name&&(r=t.value)},u={colorpicker:e};n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onAction:i,onSubmit:o,onClose:p,onCancel:function(){t(N.none())}})}},RT=function(n){wT(n);var t=Ke(null),e=Ke(null);ET(n,"forecolor","forecolor","Text color",t),ET(n,"backcolor","hilitecolor","Background color",e),_T(n,"forecolor","forecolor","Text color"),_T(n,"backcolor","hilitecolor","Background color")},BT=function(n,t,e,r,o,i,u,a){var c=US(t),s="color"!==o?"normal":"color",l=MT(t,e,r,s,i,u,a);return qS(n,c,l,r,o)},MT=function(n,t,e,r,o,i,u){return sh(G(n,(function(a){return"choiceitem"===a.type?rC(a).fold(WS,(function(c){return N.some(EO(c,1===e,r,t,i(a.value),o,u,US(n)))})):N.none()})))},IT=function(n,t){var e=MS(t);if(1===n)return{mode:"menu",moveOnTab:!0};if("auto"===n)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var r="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+r}},NT=function(n,t){return 1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+fS:"."+lS}}},FT=function(n,t){var e=OT(t.colorinput.getColors(),t.colorinput.hasCustomColors()),r=t.colorinput.getColorCols(),o="color",i=BT(Pu("menu-value"),e,(function(t){n.onAction({value:t})}),r,o,cS.CLOSE_ON_EXECUTE,k,t.shared.providers),u=D(D({},i),{markers:MS(o),movement:IT(r,o)});return{type:"widget",data:{value:Pu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[_O.widget(Sw.sketch(u))]}},PT=Pu("cell-over"),LT=Pu("cell-execute"),zT=function(n,t,e){var r,o=function(e){return fi(e,PT,{row:n,col:t})},i=function(e){return fi(e,LT,{row:n,col:t})},u=function(n,t){t.stop(),i(n)};return yc({dom:{tag:"div",attributes:(r={role:"button"},r["aria-labelledby"]=e,r)},behaviours:jl([Cy("insert-table-picker-cell",[wi(Do(),By.focus),wi(Uo(),i),wi(Io(),u),wi(Go(),u)]),Jy.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),By.config({onFocus:o})])})},jT=function(n,t,e){for(var r=[],o=0;o<t;o++){for(var i=[],u=0;u<e;u++)i.push(zT(o,u,n));r.push(i)}return r},HT=function(n,t,e,r,o){for(var i=0;i<r;i++)for(var u=0;u<o;u++)Jy.set(n[i][u],i<=t&&u<=e)},VT=function(n){return en(n,(function(n){return G(n,wc)}))},UT=function(n,t){return hc(t+1+"x"+(n+1))},WT=function(n){var t=10,e=10,r=Pu("size-label"),o=jT(r,t,e),i=Qw({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:r}},components:[hc("0x0")],behaviours:jl([xy.config({})])});return{type:"widget",data:{value:Pu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[_O.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:VT(o).concat(i.asSpec()),behaviours:jl([Cy("insert-table-picker",[Ti(PT,(function(n,r,u){var a=u.event.row,c=u.event.col;HT(o,a,c,t,e),xy.set(i.get(n),[UT(a,c)])})),Ti(LT,(function(t,e,r){n.onAction({numRows:r.event.row+1,numColumns:r.event.col+1}),li(t,$o())}))]),fy.config({initSize:{numRows:t,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}},GT={inserttable:WT,colorswatch:FT},qT=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?N.some(n[t]):N.none()},$T=function(n,t){return qT(GT,n.fancytype).map((function(e){return e(n,t)}))},XT=function(n,t,e,r,o){void 0===r&&(r=!0),void 0===o&&(o=!1);var i=o?mO(e.icons):dO(e.icons),u=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},a=xO({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:N.none(),ariaLabel:n.text,caret:N.some(i),checkMark:N.none(),shortcutContent:n.shortcut},e,r);return eO({data:rO(n),getApi:u,disabled:n.disabled,onAction:p,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,t,e)},KT=function(n,t,e,r){void 0===r&&(r=!0);var o=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},i=xO({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:N.none(),ariaLabel:n.text,caret:N.none(),checkMark:N.none(),shortcutContent:n.shortcut},e,r);return eO({data:rO(n),getApi:o,disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e)},YT=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}));return{type:"separator",dom:D({tag:"div",classes:[lS,gS]},t),components:[]}},JT=function(n,t,e,r){void 0===r&&(r=!0);var o=function(n){return{setActive:function(t){Jy.set(n,t)},isActive:function(){return Jy.isOn(n)},isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},i=xO({iconContent:n.icon,textContent:n.text,htmlContent:N.none(),ariaLabel:n.text,checkMark:N.some(fO(e.icons)),caret:N.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,r);return Kn(eO({data:rO(n),disabled:n.disabled,getApi:o,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e),{toggling:{toggleClass:mS,toggleOnExecute:!1,selected:n.active}})},QT=OO,ZT=YT,nD=KT,tD=XT,eD=JT,rD=$T,oD=DO;(function(n){n[n["ContentFocus"]=0]="ContentFocus",n[n["UiFocus"]=1]="UiFocus"})(uT||(uT={}));var iD=function(n,t,e,r,o){var i=e.shared.providers,u=function(n){return o?D(D({},n),{shortcut:N.none(),icon:n.text.isSome()?N.none():n.icon}):n};switch(n.type){case"menuitem":return cC(n).fold(WS,(function(n){return N.some(nD(u(n),t,i,r))}));case"nestedmenuitem":return lC(n).fold(WS,(function(n){return N.some(tD(u(n),t,i,r,o))}));case"togglemenuitem":return dC(n).fold(WS,(function(n){return N.some(eD(u(n),t,i,r))}));case"separator":return Px(n).fold(WS,(function(n){return N.some(ZT(n))}));case"fancymenuitem":return uC(n).fold(WS,(function(n){return rD(u(n),e)}));default:return N.none()}},uD=function(n,t,e,r,o,i,u){var a=1===r,c=!a||US(n);return sh(G(n,(function(n){switch(n.type){case"separator":return jx(n).fold(WS,(function(n){return N.some(ZT(n))}));case"cardmenuitem":return tC(n).fold(WS,(function(n){return N.some(oD(D(D({},n),{onAction:function(t){n.onAction(t),e(n.value,n.meta)}}),o,i,{itemBehaviours:SO(n.meta,i),cardText:{matchText:t,highlightOn:u}}))}));case"autocompleteitem":default:return Hx(n).fold(WS,(function(n){return N.some(QT(n,t,a,"normal",e,o,i,c))}))}})))},aD=function(n,t,e,r,o){var i=US(t),u=sh(G(t,(function(n){var t=function(n){return o?!n.hasOwnProperty("text"):i},u=function(n){return iD(n,e,r,t(n),o)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?u(D(D({},n),{disabled:!0})):u(n)}))),a=o?GS:qS;return a(n,i,u,1,"normal")},cD=function(n){return Iw.singleData(n.value,n)},sD=function(n,t,e,r){var o=e===uT.ContentFocus?cv():av(),i=IT(t,r),u=MS(r);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===uT.ContentFocus,focusManager:o,menuBehaviours:hC.unnamedEvents("auto"!==t?[]:[Ai((function(n,t){mC(n,4,u.item).each((function(t){var e=t.numColumns,r=t.numRows;fy.setGridSize(n,r,e)}))}))])}},lD=function(n,t){var e=Ke(N.none()),r=Ke(!1),o=yc(Pw.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:jl([Cy("dismissAutocompleter",[wi(ei(),(function(){return c()}))])]),lazySink:t.getSink})),i=function(){return Pw.isOpen(o)},u=function(){return e.get().isSome()},a=function(){u()&&Pw.hide(o)},c=function(){if(u()){var t=e.get().map((function(n){return n.element}));px(t.getOr(tr.fromDom(n.selection.getNode()))).each(vu),a(),e.set(N.none()),r.set(!1)}},s=Jn((function(){return uS(n)})),l=function(e,o){var i=mn(o,(function(n){return N.from(n.columns)})).getOr(1);return en(o,(function(o){var u=o.items;return uD(u,o.matchText,(function(t,i){var u=n.selection.getRng();Sx(n.dom,u,e).fold((function(){}),(function(n){var e=n.range,u={hide:function(){c()},reload:function(n){a(),g(n)}};r.set(!0),o.onAction(u,e,t,i),r.set(!1)}))}),i,cS.BUBBLE_TO_SANDBOX,t,o.highlightOn)}))},f=function(t){if(!u()){var o=gx(n,t.range);e.set(N.some({triggerChar:t.triggerChar,element:o,matchLength:t.text.length})),r.set(!1)}},d=function(t,e,r,i){t.matchLength=e.text.length;var u=mn(r,(function(n){return N.from(n.columns)})).getOr(1);Pw.showAt(o,{anchor:"node",root:tr.fromDom(n.getBody()),node:N.from(t.element)},Sw.sketch(sD(qS("autocompleter-value",!0,i,u,"normal"),u,uT.ContentFocus,"normal"))),Pw.getContent(o).each(zh.highlightFirst)},m=function(t){return e.get().map((function(e){return Sx(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return Nx(n,s,e,t)}))})).getOrThunk((function(){return Ix(n,s)}))},g=function(n){m(n).fold(c,(function(n){f(n.context),n.lookupData.then((function(t){e.get().map((function(e){var r=n.context;if(e.triggerChar===r.triggerChar){var o=l(r.triggerChar,t);o.length>0?d(e,r,t,o):r.text.length-e.matchLength>=10?c():a()}}))}))}))},p=sx((function(n){27!==n.which&&g()}),50),h={onKeypress:p,cancelIfNecessary:c,isMenuOpen:i,isActive:u,isProcessingAction:r.get,getView:function(){return Pw.getContent(o)}};!1===n.hasPlugin("rtc")&&kx.setup(h,n)},fD={register:lD},dD=O,mD=function(n,t,e){return Hc(n,t,dD,e)},gD=function(n,t,e){return Vc(n,t,dD,e)},pD=Lc,hD=function(n,t,e){return ps(n,t,e).isSome()},vD=function(n,t){var e=null,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e=setTimeout((function(){n.apply(null,r),e=null}),t)},o=function(){null!==e&&(clearTimeout(e),e=null)};return{cancel:o,schedule:r}},bD=5,yD=400,wD=function(n){var t=n.raw;return void 0===t.touches||1!==t.touches.length?N.none():N.some(t.touches[0])},xD=function(n,t){var e=Math.abs(n.clientX-t.x),r=Math.abs(n.clientY-t.y);return e>bD||r>bD},SD=function(n){var t=Ke(N.none()),e=Ke(!1),r=vD((function(t){n.triggerEvent(qo(),t),e.set(!0)}),yD),o=function(n){return wD(n).each((function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:n.target};r.schedule(n),e.set(!1),t.set(N.some(i))})),N.none()},i=function(n){return r.cancel(),wD(n).each((function(n){t.get().each((function(e){xD(n,e)&&t.set(N.none())}))})),N.none()},u=function(o){r.cancel();var i=function(n){return oo(n.target,o.target)};return t.get().filter(i).map((function(t){return e.get()?(o.prevent(),!1):n.triggerEvent(Go(),o)}))},a=ft([{key:yo(),value:o},{key:wo(),value:i},{key:xo(),value:u}]),c=function(n,t){return jn(a,t).bind((function(t){return t(n)}))};return{fireIfReady:c}},CD=function(n){var t=n.raw;return t.which===jh[0]&&!H(["input","textarea"],Ii(n.target))&&!hD(n.target,'[contenteditable="true"]')},kD=function(){return $r().browser.isFirefox()},OD=Lt([Oe("triggerEvent"),Le("stopBackspace",!0)]),TD=function(n,t){return kD()?gD(n,"focus",t):mD(n,"focusin",t)},DD=function(n,t){return kD()?gD(n,"blur",t):mD(n,"focusout",t)},ED=function(n,t){var e=ie("Getting GUI events settings",OD,t),r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],o=SD(e),i=G(r.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return mD(n,t,(function(n){o.fireIfReady(n,t).each((function(t){t&&n.kill()}));var r=e.triggerEvent(t,n);r&&n.kill()}))})),u=Ke(N.none()),a=mD(n,"paste",(function(n){o.fireIfReady(n,"paste").each((function(t){t&&n.kill()}));var t=e.triggerEvent("paste",n);t&&n.kill(),u.set(N.some(setTimeout((function(){e.triggerEvent(Ho(),n)}),0)))})),c=mD(n,"keydown",(function(n){var t=e.triggerEvent("keydown",n);t?n.kill():!0===e.stopBackspace&&CD(n)&&n.prevent()})),s=TD(n,(function(n){var t=e.triggerEvent("focusin",n);t&&n.kill()})),l=Ke(N.none()),f=DD(n,(function(n){var t=e.triggerEvent("focusout",n);t&&n.kill(),l.set(N.some(setTimeout((function(){e.triggerEvent(jo(),n)}),0)))})),d=function(){q(i,(function(n){n.unbind()})),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(clearTimeout),l.get().each(clearTimeout)};return{unbind:d}},_D=function(n,t){var e=jn(n,"target").getOr(t);return Ke(e)},AD=function(n,t){var e=Ke(!1),r=Ke(!1),o=function(){e.set(!0)},i=function(){r.set(!0)};return{stop:o,cut:i,isStopped:e.get,isCut:r.get,event:n,setSource:t.set,getSource:t.get}},RD=function(n){var t=Ke(!1),e=function(){t.set(!0)};return{stop:e,cut:p,isStopped:t.get,isCut:k,event:n,setSource:C("Cannot set source of a broadcasted event"),getSource:C("Cannot get source of a broadcasted event")}},BD=Wn.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),MD=function(n,t,e,r,o,i){var u=n(t,r),a=AD(e,o);return u.fold((function(){return i.logEventNoHandlers(t,r),BD.complete()}),(function(n){var e=n.descHandler,r=ha(e);return r(a),a.isStopped()?(i.logEventStopped(t,n.element,e.purpose),BD.stopped()):a.isCut()?(i.logEventCut(t,n.element,e.purpose),BD.complete()):Gi(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose),BD.complete()}),(function(r){return i.logEventResponse(t,n.element,e.purpose),BD.resume(r)}))}))},ID=function(n,t,e,r,o,i){return MD(n,t,e,r,o,i).fold(O,(function(r){return ID(n,t,e,r,o,i)}),k)},ND=function(n,t,e,r,o){var i=_D(e,r);return MD(n,t,e,r,i,o)},FD=function(n,t,e){var r=RD(t);return q(n,(function(n){var t=n.descHandler,e=ha(t);e(r)})),r.isStopped()},PD=function(n,t,e,r){return LD(n,t,e,e.target,r)},LD=function(n,t,e,r,o){var i=_D(e,r);return ID(n,t,e,r,i,o)},zD=function(n,t){return{element:n,descHandler:t}},jD=function(n,t){return{id:n,descHandler:t}},HD=function(){var n={},t=function(t,e,r){Rn(r,(function(r,o){var i=void 0!==n[o]?n[o]:{};i[e]=pa(r,t),n[o]=i}))},e=function(n,t){return Wu(t).fold((function(){return N.none()}),(function(e){return n.bind((function(n){return jn(n,e)})).map((function(n){return zD(t,n)}))}))},r=function(t){return jn(n,t).map((function(n){return Pn(n,(function(n,t){return jD(t,n)}))})).getOr([])},o=function(t,r,o){var i=jn(n,r);return lo(o,(function(n){return e(i,n)}),t)},i=function(t){Rn(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))};return{registerId:t,unregisterId:i,filterByType:r,find:o}},VD=function(){var n=HD(),t={},e=function(n){var t=n.element;return Wu(t).fold((function(){return Vu("uid-",n.element)}),(function(n){return n}))},r=function(n,e){var r=t[e];if(r!==n)throw new Error('The tagId "'+e+'" is already used by: '+Bu(r.element)+"\nCannot use it for: "+Bu(n.element)+"\nThe conflicting element is"+(Wa(r.element)?" ":" not ")+"already in the DOM");i(n)},o=function(o){var i=e(o);Vn(t,i)&&r(o,i);var u=[o];n.registerId(u,i,o.events),t[i]=o},i=function(e){Wu(e.element).each((function(e){delete t[e],n.unregisterId(e)}))},u=function(t){return n.filterByType(t)},a=function(t,e,r){return n.find(t,e,r)},c=function(n){return jn(t,n)};return{find:a,filter:u,register:o,unregister:i,getById:c}},UD=function(n){var t=n.dom,e=t.attributes,r=E(t,["attributes"]);return{uid:n.uid,dom:D({tag:"div",attributes:D({role:"presentation"},e)},r),components:n.components,behaviours:Jg(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},WD=ah({name:"Container",factory:UD,configFields:[Le("components",[]),Yg("containerBehaviours",[]),Le("events",{}),Le("domModification",{}),Le("eventOrder",{})]}),GD=function(n){var t=function(t){return Gi(n.element).fold(O,(function(n){return oo(t,n)}))},e=VD(),r=function(n,r){return e.find(t,n,r)},o=ED(n.element,{triggerEvent:function(n,t){return Es(n,t.target,(function(e){return PD(r,n,t,e)}))}}),i={debugInfo:y("real"),triggerEvent:function(n,t,e){Es(n,t,(function(o){return LD(r,n,e,t,o)}))},triggerFocus:function(n,t){Wu(n).fold((function(){Yl(n)}),(function(e){Es(zo(),n,(function(e){return ND(r,zo(),{originator:t,kill:p,prevent:p,target:n},n,e),!1}))}))},triggerEscape:function(n,t){i.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return h(n)},getByDom:function(n){return v(n)},build:yc,addToGui:function(n){c(n)},removeFromGui:function(n){s(n)},addToWorld:function(n){u(n)},removeFromWorld:function(n){a(n)},broadcast:function(n){d(n)},broadcastOn:function(n,t){m(n,t)},broadcastEvent:function(n,t){g(n,t)},isConnected:O},u=function(n){n.connect(i),Li(n.element)||(e.register(n),q(n.components(),u),i.triggerEvent(Ko(),n.element,{target:n.element}))},a=function(n){Li(n.element)||(q(n.components(),a),e.unregister(n)),n.disconnect()},c=function(t){zm(n,t)},s=function(n){Vm(n)},l=function(){o.unbind(),hu(n.element)},f=function(n){var t=e.filter(Vo());q(t,(function(t){var e=t.descHandler,r=ha(e);r(n)}))},d=function(n){f({universal:!0,data:n})},m=function(n,t){f({universal:!1,channels:n,data:t})},g=function(n,t){var r=e.filter(n);return FD(r,t)},h=function(n){return e.getById(n).fold((function(){return vn.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),vn.value)},v=function(n){var t=Wu(n).getOr("not found");return h(t)};return u(n),{root:n,element:n.element,destroy:l,add:c,remove:s,getByUid:h,getByDom:v,addToWorld:u,removeFromWorld:a,broadcast:d,broadcastOn:m,broadcastEvent:g}},qD=function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:G(n.items,t.interpreter)}},$D=y([Le("prefix","form-field"),Yg("fieldBehaviours",[yh,Kg])]),XD=y([Ap({schema:[ye("dom")],name:"label"}),Ap({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ye("text")],name:"aria-descriptor"}),Ep({factory:{sketch:function(n){var t=st(n,["factory"]);return n.factory.sketch(t)}},schema:[ye("factory")],name:"field"})]),KD=function(n,t,e,r){var o=Qg(n.fieldBehaviours,[yh.config({find:function(t){return Up(t,n,"field")}}),Kg.config({store:{mode:"manual",getValue:function(n){return yh.getCurrent(n).bind(Kg.getValue)},setValue:function(n,t){yh.getCurrent(n).each((function(n){Kg.setValue(n,t)}))}}})]),i=hi([Ai((function(t,e){var r=Gp(t,n,["label","field","aria-descriptor"]);r.field().each((function(t){var e=Pu(n.prefix);r.label().each((function(n){Cu(n.element,"for",e),Cu(t.element,"id",e)})),r["aria-descriptor"]().each((function(e){var r=Pu(n.prefix);Cu(e.element,"id",r),Cu(t.element,"aria-describedby",r)}))}))}))]),u={getField:function(t){return Up(t,n,"field")},getLabel:function(t){return Up(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:o,events:i,apis:u}},YD=ch({name:"FormField",configFields:$D(),partFields:XD(),factory:KD,apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),JD=function(n,t){return sa({attributes:ft([{key:t.tabAttr,value:"true"}])})},QD=Object.freeze({__proto__:null,exhibit:JD}),ZD=[Le("tabAttr","data-alloy-tabstop")],nE=Vl({fields:ZD,name:"tabstopping",active:QD}),tE=tinymce.util.Tools.resolve("tinymce.html.Entities"),eE=function(n,t,e,r){var o=oE(n,t,e,r);return YD.sketch(o)},rE=function(n,t){return eE(n,t,[],[])},oE=function(n,t,e,r){return{dom:uE(e),components:n.toArray().concat([t]),fieldBehaviours:jl(r)}},iE=function(){return uE([])},uE=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},aE=function(n,t){return YD.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},cE=Pu("form-component-change"),sE=Pu("form-close"),lE=Pu("form-cancel"),fE=Pu("form-action"),dE=Pu("form-submit"),mE=Pu("form-block"),gE=Pu("form-unblock"),pE=Pu("form-tabchange"),hE=Pu("form-resize"),vE=function(n,t){var e,r=n.label.map((function(n){return aE(n,t)})),o=function(n){return function(t,e){ps(e.event.target,"[data-collection-item-value]").each((function(r){n(t,e,r,Ou(r,"data-collection-item-value"))}))}},i=function(e,r){var o=G(r,(function(e){var r=RC.translate(e.text),o=1===n.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=r.replace(/\_| \- |\-/g,(function(n){return u[n]})),c=t.isDisabled()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+c+'" tabindex="-1" data-collection-item-value="'+tE.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+o+"</div>"})),i="auto"!==n.columns&&n.columns>1?W(o,n.columns):[o],u=G(i,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));wu(e.element,u.join(""))},u=o((function(e,r,o,i){r.stop(),t.isDisabled()||fi(e,fE,{name:n.name,value:i})})),a=[wi(Do(),o((function(n,t,e){Yl(e)}))),wi(Io(),u),wi(Go(),u),wi(Eo(),o((function(n,t,e){gs(n.element,"."+wS).each((function(n){za(n,wS)})),Pa(e,wS)}))),wi(_o(),o((function(n){gs(n.element,"."+wS).each((function(n){za(n,wS)}))}))),Mi(o((function(t,e,r,o){fi(t,fE,{name:n.name,value:o})})))],c=function(n,t){return G(Jd(n.element,".tox-collection__item"),t)},s=YD.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:jl([YC.config({disabled:t.isDisabled,onDisabled:function(n){c(n,(function(n){Pa(n,"tox-collection__item--state-disabled"),Cu(n,"aria-disabled",!0)}))},onEnabled:function(n){c(n,(function(n){za(n,"tox-collection__item--state-disabled"),Eu(n,"aria-disabled")}))}}),Wk(),xy.config({}),Kg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,e){i(t,e),"auto"===n.columns&&mC(t,5,"tox-collection__item").each((function(n){var e=n.numRows,r=n.numColumns;fy.setGridSize(t,e,r)})),li(t,hE)}}),nE.config({}),fy.config(NT(n.columns,"normal")),Cy("collection-events",a)]),eventOrder:(e={},e[Uo()]=["disabling","alloy.base.behaviour","collection-events"],e)}),l=["tox-form__group--collection"];return eE(r,s,l,[])},bE=y([Ae("data"),Le("inputAttributes",{}),Le("inputStyles",{}),Le("tag","input"),Le("inputClasses",[]),Ls("onSetValue"),Le("styles",{}),Le("eventOrder",{}),Yg("inputBehaviours",[Kg,By]),Le("selectOnFocus",!0)]),yE=function(n){return jl([By.config({onFocus:n.selectOnFocus?function(n){var t=n.element,e=ic(t);t.dom.setSelectionRange(0,e.length)}:p})])},wE=function(n){return D(D({},yE(n)),Qg(n.inputBehaviours,[Kg.config({store:D(D({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return ic(n.element)},setValue:function(n,t){var e=ic(n.element);e!==t&&uc(n.element,t)}}),onSetValue:n.onSetValue})]))},xE=function(n){return{tag:n.tag,attributes:D({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},SE=function(n,t){return{uid:n.uid,dom:xE(n),components:[],behaviours:wE(n),eventOrder:n.eventOrder}},CE=ah({name:"Input",configFields:bE(),factory:SE}),kE={},OE={exports:kE};(function(t,e,r,o){(function(o){if("object"===typeof e&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof t&&t.amd)t([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function n(t,e,r){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[a]={exports:{}};t[a][0].call(f.exports,(function(n){var e=t[a][1][n];return i(e||n)}),f,f.exports,n,t,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return n}()({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}function s(n){if(o===clearTimeout)return clearTimeout(n);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{return o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(n){o=a}})();var l,f=[],d=!1,m=-1;function g(){d&&l&&(d=!1,l.length?f=l.concat(f):m=-1,f.length&&p())}function p(){if(!d){var n=c(g);d=!0;var t=f.length;while(t){l=f,f=[];while(++m<t)l&&l[m].run();m=-1,t=f.length}l=null,d=!1,s(n)}}function h(n,t){this.fun=n,this.array=t}function v(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];f.push(new h(n,t)),1!==f.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var r=setTimeout;function o(){}function i(n,t){return function(){n.apply(t,arguments)}}function u(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(n,this)}function a(n,t){while(3===n._state)n=n._value;0!==n._state?(n._handled=!0,u._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(o){return void s(t.promise,o)}c(t.promise,r)}else(1===n._state?c:s)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var e=t.then;if(t instanceof u)return n._state=3,n._value=t,void l(n);if("function"===typeof e)return void d(i(e,t),n)}n._state=1,n._value=t,l(n)}catch(r){s(n,r)}}function s(n,t){n._state=2,n._value=t,l(n)}function l(n){2===n._state&&0===n._deferreds.length&&u._immediateFn((function(){n._handled||u._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)a(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.promise=e}function d(n,t){var e=!1;try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,s(t,n))}))}catch(r){if(e)return;e=!0,s(t,r)}}u.prototype["catch"]=function(n){return this.then(null,n)},u.prototype.then=function(n,t){var e=new this.constructor(o);return a(this,new f(n,t,e)),e},u.all=function(n){var t=Array.prototype.slice.call(n);return new u((function(n,e){if(0===t.length)return n([]);var r=t.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){o(i,n)}),e)}t[i]=u,0===--r&&n(t)}catch(c){e(c)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},u.resolve=function(n){return n&&"object"===typeof n&&n.constructor===u?n:new u((function(t){t(n)}))},u.reject=function(n){return new u((function(t,e){e(n)}))},u.race=function(n){return new u((function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)}))},u._immediateFn="function"===typeof n?function(t){n(t)}:function(n){r(n,0)},u._unhandledRejectionFn=function(n){"undefined"!==typeof console&&console},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},"undefined"!==typeof t&&t.exports?t.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"===typeof t?t:function(n){var t=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,o((function(){a[t]&&(r?n.apply(null,r):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"===typeof r?r:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,kE,OE,void 0);var TE,DE=OE.exports.boltExport,EE=function(n){var t=N.none(),e=[],r=function(n){return EE((function(t){o((function(e){t(n(e))}))}))},o=function(n){u()?c(n):e.push(n)},i=function(n){u()||(t=N.some(n),a(e),e=[])},u=function(){return t.isSome()},a=function(n){q(n,c)},c=function(n){t.each((function(t){setTimeout((function(){n(t)}),0)}))};return n(i),{get:o,map:r,isReady:u}},_E=function(n){return EE((function(t){t(n)}))},AE={nu:EE,pure:_E},RE=function(n){setTimeout((function(){throw n}),0)},BE=function(n){var t=function(t){n().then(t,RE)},e=function(t){return BE((function(){return n().then(t)}))},r=function(t){return BE((function(){return n().then((function(n){return t(n).toPromise()}))}))},o=function(t){return BE((function(){return n().then((function(){return t.toPromise()}))}))},i=function(){return AE.nu(t)},u=function(){var t=null;return BE((function(){return null===t&&(t=n()),t}))},a=n;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:t}},ME=function(n){return BE((function(){return new DE(n)}))},IE=function(n){return BE((function(){return DE.resolve(n)}))},NE={nu:ME,pure:IE},FE=["input","textarea"],PE=function(n){var t=Ii(n);return H(FE,t)},LE=function(n,t){var e=t.getRoot(n).getOr(n.element);za(e,t.invalidClass),t.notify.each((function(t){PE(n.element)&&Cu(n.element,"aria-invalid",!1),t.getContainer(n).each((function(n){wu(n,t.validHtml)})),t.onValid(n)}))},zE=function(n,t,e,r){var o=t.getRoot(n).getOr(n.element);Pa(o,t.invalidClass),t.notify.each((function(t){PE(n.element)&&Cu(n.element,"aria-invalid",!0),t.getContainer(n).each((function(n){wu(n,r)})),t.onInvalid(n,r)}))},jE=function(n,t,e){return t.validator.fold((function(){return NE.pure(vn.value(!0))}),(function(t){return t.validate(n)}))},HE=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),jE(n,t).map((function(r){return n.getSystem().isConnected()?r.fold((function(r){return zE(n,t,e,r),vn.error(r)}),(function(e){return LE(n,t),vn.value(e)})):vn.error("No longer in system")}))},VE=function(n,t){var e=t.getRoot(n).getOr(n.element);return ja(e,t.invalidClass)},UE=Object.freeze({__proto__:null,markValid:LE,markInvalid:zE,query:jE,run:HE,isInvalid:VE}),WE=function(n,t){return n.validator.map((function(e){return hi([wi(e.onEvent,(function(e){HE(e,n,t).get(w)}))].concat(e.validateOnLoad?[Ai((function(e){HE(e,n,t).get(p)}))]:[]))})).getOr({})},GE=Object.freeze({__proto__:null,events:WE}),qE=[ye("invalidClass"),Le("getRoot",N.none),Fe("notify",[Le("aria","alert"),Le("getContainer",N.none),Le("validHtml",""),Ls("onValid"),Ls("onInvalid"),Ls("onValidate")]),Fe("validator",[ye("validate"),Le("onEvent","input"),Le("validateOnLoad",!0)])],$E=Vl({fields:qE,name:"invalidating",active:GE,apis:UE,extra:{validation:function(n){return function(t){var e=Kg.getValue(t);return NE.pure(n(e))}}}}),XE=function(n,t,e,r){return e.getOrCreate(n,t,r)},KE=Object.freeze({__proto__:null,getCoupled:XE}),YE=[we("others",te(vn.value,le()))],JE=function(){var n={},t=function(t,e,r){var o=_n(e.others);if(o)return jn(n,r).getOrThunk((function(){var o=jn(e.others,r).getOrDie("No information found for coupled component: "+r),i=o(t),u=t.getSystem().build(i);return n[r]=u,u}));throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(o,null,2))},e=y({});return oa({readState:e,getOrCreate:t})},QE=Object.freeze({__proto__:null,init:JE}),ZE=Vl({fields:YE,name:"coupling",apis:KE,state:QE}),n_=y("sink"),t_=y(Ap({name:n_(),overrides:y({dom:{tag:"div"},behaviours:jl([Mm.config({useFixed:O})]),events:hi([Di(Ao()),Di(Co()),Di(Io())])})}));(function(n){n[n["HighlightFirst"]=0]="HighlightFirst",n[n["HighlightNone"]=1]="HighlightNone"})(TE||(TE={}));var e_,r_=function(n,t){var e=n.getHotspot(t).getOr(t),r="hotspot",o=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:r,hotspot:e,overrides:o}}),(function(n){return{anchor:r,hotspot:e,overrides:o,layouts:n}}))},o_=function(n,t,e){var r=n.fetch;return r(e).map(t)},i_=function(n,t,e,r,o,i,u){var a=o_(n,t,r),c=l_(r,n);return a.map((function(n){return n.bind((function(n){return N.from(Iw.sketch(D(D({},i.menu()),{uid:Gu(""),data:n,highlightImmediately:u===TE.HighlightFirst,onOpenMenu:function(n,t){var r=c().getOrDie();Mm.position(r,e,t),mg.decloak(o)},onOpenSubmenu:function(n,t,e){var r=c().getOrDie();Mm.position(r,{anchor:"submenu",item:t},e),mg.decloak(o)},onRepositionMenu:function(n,t,r){var o=c().getOrDie();Mm.position(o,e,t),q(r,(function(n){Mm.position(o,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return By.focus(r),mg.close(o),N.some(!0)}})))}))}))},u_=function(n,t,e,r,o,i,u){var a=r_(n,e),c=i_(n,t,a,e,r,o,u);return c.map((function(n){return n.fold((function(){mg.isOpen(r)&&mg.close(r)}),(function(n){mg.cloak(r),mg.open(r,n),i(r)})),r}))},a_=function(n,t,e,r,o,i,u){return mg.close(r),NE.pure(r)},c_=function(n,t,e,r,o,i){var u=ZE.getCoupled(e,"sandbox"),a=mg.isOpen(u),c=a?a_:u_;return c(n,t,e,u,r,o,i)},s_=function(n,t,e){var r=yh.getCurrent(t).getOr(t),o=Ic(n.element);e?Ka(r.element,"min-width",o+"px"):Mc(r.element,o)},l_=function(n,t){return n.getSystem().getByUid(t.uid+"-"+n_()).map((function(n){return function(){return vn.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return vn.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},f_=function(n){mg.getState(n).each((function(n){Iw.repositionMenus(n)}))},d_=function(n,t,e){var r=vs(),o=function(o,i){var u=r_(n,t);r.link(t.element),n.matchWidth&&s_(u.hotspot,i,n.useMinWidth),n.onOpen(u,o,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(o,i)},i=function(n,o){r.unlink(t.element),void 0!==e&&void 0!==e.onClose&&e.onClose(n,o)},u=l_(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:r.id,role:"listbox"}},behaviours:Zg.augment(n.sandboxBehaviours,[Kg.config({store:{mode:"memory",initialValue:t}}),mg.config({onOpen:o,onClose:i,isPartOf:function(n,e,r){return ys(e,r)||ys(t,r)},getAttachPoint:function(){return u().getOrDie()}}),yh.config({find:function(n){return mg.getState(n).bind((function(n){return yh.getCurrent(n)}))}}),ql.config({channels:D(D({},bg({isExtraPart:k})),wg({doReposition:f_}))})])}},m_=function(n){var t=ZE.getCoupled(n,"sandbox");f_(t)},g_=function(){return[Le("sandboxClasses",[]),Zg.field("sandboxBehaviours",[yh,ql,mg,Kg])]},p_=y([ye("dom"),ye("fetch"),Ls("onOpen"),zs("onExecute"),Le("getHotspot",N.some),Le("getAnchorOverrides",y({})),Uf(),Yg("dropdownBehaviours",[Jy,ZE,fy,By]),ye("toggleClass"),Le("eventOrder",{}),Ae("lazySink"),Le("matchWidth",!1),Le("useMinWidth",!1),Ae("role")].concat(g_())),h_=y([_p({schema:[Ns()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),t_()]),v_=function(n,t,e,r){var o,i=function(t){return jn(n.dom,"attributes").bind((function(n){return jn(n,t)}))},u=function(n){mg.getState(n).each((function(n){Iw.highlightPrimary(n)}))},a=function(t){var e=u;c_(n,(function(n){return n}),t,r,e,TE.HighlightFirst).get(p)},c={expand:function(t){Jy.isOn(t)||c_(n,(function(n){return n}),t,r,p,TE.HighlightNone).get(p)},open:function(t){Jy.isOn(t)||c_(n,(function(n){return n}),t,r,p,TE.HighlightFirst).get(p)},isOpen:Jy.isOn,close:function(t){Jy.isOn(t)&&c_(n,(function(n){return n}),t,r,p,TE.HighlightFirst).get(p)},repositionMenus:function(n){Jy.isOn(n)&&m_(n)}},s=function(n,t){return di(n),N.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.dropdownBehaviours,[Jy.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),ZE.config({others:{sandbox:function(t){return d_(n,t,{onOpen:function(){return Jy.on(t)},onClose:function(){return Jy.off(t)}})}}}),fy.config({mode:"special",onSpace:s,onEnter:s,onDown:function(n,t){if(b_.isOpen(n)){var e=ZE.getCoupled(n,"sandbox");u(e)}else b_.open(n);return N.some(!0)},onEscape:function(n,t){return b_.isOpen(n)?(b_.close(n),N.some(!0)):N.none()}}),By.config({})]),events:Zy(N.some(a)),eventOrder:D(D({},n.eventOrder),(o={},o[Uo()]=["disabling","toggling","alloy.base.behaviour"],o)),apis:c,domModification:{attributes:D(D({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:i("type").getOr("button")}:{})}}},b_=ch({name:"Dropdown",configFields:p_(),partFields:h_(),factory:v_,apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),y_=function(){return sa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},w_=function(){return hi([vi(Fo(),O)])},x_=Object.freeze({__proto__:null,events:w_,exhibit:y_}),S_=Vl({fields:[],name:"unselecting",active:x_}),C_=function(n,t){return b_.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:jl([Kk.button(t.providers.isDisabled),Wk(),S_.config({}),nE.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return NE.nu((function(t){return n.fetch(t)})).map((function(r){return N.from(cD(Kn(BT(Pu("menu-value"),r,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,cS.CLOSE_ON_EXECUTE,k,t.providers),{movement:IT(n.columns,n.presets)})))}))},parts:{menu:FS(!1,1,n.presets)}})},k_=Pu("color-input-change"),O_=Pu("color-swatch-change"),T_=Pu("color-picker-cancel"),D_=function(n,t,e){var r=YD.parts.field({factory:CE,inputClasses:["tox-textfield"],onSetValue:function(n){return $E.run(n).get(p)},inputBehaviours:jl([YC.config({disabled:t.providers.isDisabled}),Wk(),nE.config({}),$E.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return Gi(n.element)},notify:{onValid:function(n){var t=Kg.getValue(n);fi(n,k_,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Kg.getValue(n);if(0===t.length)return NE.pure(vn.value(!0));var e=tr.fromTag("span");Ka(e,"background-color",t);var r=nc(e,"background-color").fold((function(){return vn.error("blah")}),(function(n){return vn.value(t)}));return NE.pure(r)}}})]),selectOnFocus:!1}),o=n.label.map((function(n){return aE(n,t.providers)})),i=function(n,t){fi(n,O_,{value:t})},u=function(n,t){a.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return li(n,T_)}),(function(t){i(n,t),hT(t)}))}),"#ffffff"):i(n,"remove"===t?"":t)}))},a=Qw(C_({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[hl,pl,wl]},onLtr:function(){return[pl,hl,wl]}},components:[],fetch:TT(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},t));return YD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:o.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,a.asSpec()]}]),fieldBehaviours:jl([Cy("form-field-events",[wi(k_,(function(t,e){a.getOpt(t).each((function(n){Ka(n.element,"background-color",e.event.color)})),fi(t,cE,{name:n.name})})),wi(O_,(function(n,t){YD.getField(n).each((function(e){Kg.setValue(e,t.event.value),yh.getCurrent(n).each(By.focus)}))})),wi(T_,(function(n,t){YD.getField(n).each((function(t){yh.getCurrent(n).each(By.focus)}))}))])])})},E_=Ap({schema:[ye("dom")],name:"label"}),__=function(n){return Ap({name:n+"-edge",overrides:function(t){var e=t.model.manager.edgeActions[n];return e.fold((function(){return{}}),(function(n){return{events:hi([xi(yo(),(function(t,e,r){return n(t,r)}),[t]),xi(Co(),(function(t,e,r){return n(t,r)}),[t]),xi(ko(),(function(t,e,r){r.mouseIsDown.get()&&n(t,r)}),[t])])}}))}})},A_=__("top-left"),R_=__("top"),B_=__("top-right"),M_=__("right"),I_=__("bottom-right"),N_=__("bottom"),F_=__("bottom-left"),P_=__("left"),L_=Ep({name:"thumb",defaults:y({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:hi([Oi(yo(),n,"spectrum"),Oi(wo(),n,"spectrum"),Oi(xo(),n,"spectrum"),Oi(Co(),n,"spectrum"),Oi(ko(),n,"spectrum"),Oi(To(),n,"spectrum")])}}}),z_=Ep({schema:[Xe("mouseIsDown",(function(){return Ke(!1)}))],name:"spectrum",overrides:function(n){var t=n.model,e=t.manager,r=function(t,r){return e.getValueFromEvent(r).map((function(r){return e.setValueFrom(t,n,r)}))};return{behaviours:jl([fy.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),By.config({})]),events:hi([wi(yo(),r),wi(wo(),r),wi(Co(),r),wi(ko(),(function(t,e){n.mouseIsDown.get()&&r(t,e)}))])}}}),j_=[E_,P_,M_,R_,N_,A_,B_,F_,I_,L_,z_],H_="slider.change.value",V_=y(H_),U_=function(n){return-1!==n.type.indexOf("touch")},W_=function(n){var t=n.event.raw;if(U_(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?N.some(e.touches[0]).map((function(n){return Dc(n.clientX,n.clientY)})):N.none()}var r=t;return void 0!==r.clientX?N.some(r).map((function(n){return Dc(n.clientX,n.clientY)})):N.none()},G_="top",q_="right",$_="bottom",X_="left",K_=function(n){return n.model.minX},Y_=function(n){return n.model.minY},J_=function(n){return n.model.minX-1},Q_=function(n){return n.model.minY-1},Z_=function(n){return n.model.maxX},nA=function(n){return n.model.maxY},tA=function(n){return n.model.maxX+1},eA=function(n){return n.model.maxY+1},rA=function(n,t,e){return t(n)-e(n)},oA=function(n){return rA(n,Z_,K_)},iA=function(n){return rA(n,nA,Y_)},uA=function(n){return oA(n)/2},aA=function(n){return iA(n)/2},cA=function(n){return n.stepSize},sA=function(n){return n.snapToGrid},lA=function(n){return n.snapStart},fA=function(n){return n.rounded},dA=function(n,t){return void 0!==n[t+"-edge"]},mA=function(n){return dA(n,X_)},gA=function(n){return dA(n,q_)},pA=function(n){return dA(n,G_)},hA=function(n){return dA(n,$_)},vA=function(n){return n.model.value.get()},bA=function(n){return{x:n}},yA=function(n){return{y:n}},wA=function(n,t){return{x:n,y:t}},xA=function(n,t){fi(n,V_(),{value:t})},SA=function(n,t){xA(n,wA(J_(t),Q_(t)))},CA=function(n,t){xA(n,yA(Q_(t)))},kA=function(n,t){xA(n,wA(uA(t),Q_(t)))},OA=function(n,t){xA(n,wA(tA(t),Q_(t)))},TA=function(n,t){xA(n,bA(tA(t)))},DA=function(n,t){xA(n,wA(tA(t),aA(t)))},EA=function(n,t){xA(n,wA(tA(t),eA(t)))},_A=function(n,t){xA(n,yA(eA(t)))},AA=function(n,t){xA(n,wA(uA(t),eA(t)))},RA=function(n,t){xA(n,wA(J_(t),eA(t)))},BA=function(n,t){xA(n,bA(J_(t)))},MA=function(n,t){xA(n,wA(J_(t),aA(t)))},IA=function(n,t,e,r){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-r)},NA=function(n,t,e,r){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+r)},FA=function(n,t,e){return Math.max(t,Math.min(e,n))},PA=function(n,t,e,r,o){return o.fold((function(){var o=n-t,i=Math.round(o/r)*r;return FA(t+i,t-1,e+1)}),(function(t){var o=(n-t)%r,i=Math.round(o/r),u=Math.floor((n-t)/r),a=Math.floor((e-t)/r),c=Math.min(a,u+i),s=t+c*r;return Math.max(t,s)}))},LA=function(n,t,e){return Math.min(e,Math.max(n,t))-t},zA=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,l=n.hasMaxEdge,f=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=l?e+1:e;if(o<f)return g;if(o>d)return p;var h=LA(o,f,d),v=FA(h/m*r+t,g,p);return u&&v>=t&&v<=e?PA(v,t,e,i,a):c?Math.round(v):v},jA=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,l=n.centerMaxEdge;return o<t?i?0:s:o>e?u?a:l:(o-t)/r*c},HA="top",VA="right",UA="bottom",WA="left",GA="width",qA="height",$A=function(n){return n.element.dom.getBoundingClientRect()},XA=function(n,t){return n[t]},KA=function(n){var t=$A(n);return XA(t,WA)},YA=function(n){var t=$A(n);return XA(t,VA)},JA=function(n){var t=$A(n);return XA(t,HA)},QA=function(n){var t=$A(n);return XA(t,UA)},ZA=function(n){var t=$A(n);return XA(t,GA)},nR=function(n){var t=$A(n);return XA(t,qA)},tR=function(n,t,e){return(n+t)/2-e},eR=function(n,t){var e=$A(n),r=$A(t),o=XA(e,WA),i=XA(e,VA),u=XA(r,WA);return tR(o,i,u)},rR=function(n,t){var e=$A(n),r=$A(t),o=XA(e,HA),i=XA(e,UA),u=XA(r,HA);return tR(o,i,u)},oR=function(n,t){fi(n,V_(),{value:t})},iR=function(n){return{x:n}},uR=function(n,t,e){var r={min:K_(t),max:Z_(t),range:oA(t),value:e,step:cA(t),snap:sA(t),snapStart:lA(t),rounded:fA(t),hasMinEdge:mA(t),hasMaxEdge:gA(t),minBound:KA(n),maxBound:YA(n),screenRange:ZA(n)};return zA(r)},aR=function(n,t,e){var r=uR(n,t,e),o=iR(r);return oR(n,o),r},cR=function(n,t){var e=K_(t);oR(n,iR(e))},sR=function(n,t){var e=Z_(t);oR(n,iR(e))},lR=function(n,t,e){var r=n>0?NA:IA,o=r(vA(e).x,K_(e),Z_(e),cA(e));return oR(t,iR(o)),N.some(o)},fR=function(n){return function(t,e){return lR(n,t,e).map(O)}},dR=function(n){var t=W_(n);return t.map((function(n){return n.left}))},mR=function(n,t,e,r,o){var i=0,u=ZA(n),a=r.bind((function(t){return N.some(eR(t,n))})).getOr(i),c=o.bind((function(t){return N.some(eR(t,n))})).getOr(u),s={min:K_(t),max:Z_(t),range:oA(t),value:e,hasMinEdge:mA(t),hasMaxEdge:gA(t),minBound:KA(n),minOffset:i,maxBound:YA(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return jA(s)},gR=function(n,t,e,r,o,i){var u=mR(t,i,e,r,o);return KA(t)-KA(n)+u},pR=function(n,t,e,r){var o=vA(e),i=gR(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=Ic(t.element)/2;Ka(t.element,"left",i-u+"px")},hR=fR(-1),vR=fR(1),bR=N.none,yR=N.none,wR={"top-left":N.none(),top:N.none(),"top-right":N.none(),right:N.some(TA),"bottom-right":N.none(),bottom:N.none(),"bottom-left":N.none(),left:N.some(BA)},xR=Object.freeze({__proto__:null,setValueFrom:aR,setToMin:cR,setToMax:sR,findValueOfOffset:uR,getValueFromEvent:dR,findPositionOfValue:gR,setPositionFromValue:pR,onLeft:hR,onRight:vR,onUp:bR,onDown:yR,edgeActions:wR}),SR=function(n,t){fi(n,V_(),{value:t})},CR=function(n){return{y:n}},kR=function(n,t,e){var r={min:Y_(t),max:nA(t),range:iA(t),value:e,step:cA(t),snap:sA(t),snapStart:lA(t),rounded:fA(t),hasMinEdge:pA(t),hasMaxEdge:hA(t),minBound:JA(n),maxBound:QA(n),screenRange:nR(n)};return zA(r)},OR=function(n,t,e){var r=kR(n,t,e),o=CR(r);return SR(n,o),r},TR=function(n,t){var e=Y_(t);SR(n,CR(e))},DR=function(n,t){var e=nA(t);SR(n,CR(e))},ER=function(n,t,e){var r=n>0?NA:IA,o=r(vA(e).y,Y_(e),nA(e),cA(e));return SR(t,CR(o)),N.some(o)},_R=function(n){return function(t,e){return ER(n,t,e).map(O)}},AR=function(n){var t=W_(n);return t.map((function(n){return n.top}))},RR=function(n,t,e,r,o){var i=0,u=nR(n),a=r.bind((function(t){return N.some(rR(t,n))})).getOr(i),c=o.bind((function(t){return N.some(rR(t,n))})).getOr(u),s={min:Y_(t),max:nA(t),range:iA(t),value:e,hasMinEdge:pA(t),hasMaxEdge:hA(t),minBound:JA(n),minOffset:i,maxBound:QA(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return jA(s)},BR=function(n,t,e,r,o,i){var u=RR(t,i,e,r,o);return JA(t)-JA(n)+u},MR=function(n,t,e,r){var o=vA(e),i=BR(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),u=Cc(t.element)/2;Ka(t.element,"top",i-u+"px")},IR=N.none,NR=N.none,FR=_R(-1),PR=_R(1),LR={"top-left":N.none(),top:N.some(CA),"top-right":N.none(),right:N.none(),"bottom-right":N.none(),bottom:N.some(_A),"bottom-left":N.none(),left:N.none()},zR=Object.freeze({__proto__:null,setValueFrom:OR,setToMin:TR,setToMax:DR,findValueOfOffset:kR,getValueFromEvent:AR,findPositionOfValue:BR,setPositionFromValue:MR,onLeft:IR,onRight:NR,onUp:FR,onDown:PR,edgeActions:LR}),jR=function(n,t){fi(n,V_(),{value:t})},HR=function(n,t){return{x:n,y:t}},VR=function(n,t,e){var r=uR(n,t,e.left),o=kR(n,t,e.top),i=HR(r,o);return jR(n,i),i},UR=function(n,t,e,r){var o=n>0?NA:IA,i=t?vA(r).x:o(vA(r).x,K_(r),Z_(r),cA(r)),u=t?o(vA(r).y,Y_(r),nA(r),cA(r)):vA(r).y;return jR(e,HR(i,u)),N.some(i)},WR=function(n,t){return function(e,r){return UR(n,t,e,r).map(O)}},GR=function(n,t){var e=K_(t),r=Y_(t);jR(n,HR(e,r))},qR=function(n,t){var e=Z_(t),r=nA(t);jR(n,HR(e,r))},$R=function(n){return W_(n)},XR=function(n,t,e,r){var o=vA(e),i=gR(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=BR(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),a=Ic(t.element)/2,c=Cc(t.element)/2;Ka(t.element,"left",i-a+"px"),Ka(t.element,"top",u-c+"px")},KR=WR(-1,!1),YR=WR(1,!1),JR=WR(-1,!0),QR=WR(1,!0),ZR={"top-left":N.some(SA),top:N.some(kA),"top-right":N.some(OA),right:N.some(DA),"bottom-right":N.some(EA),bottom:N.some(AA),"bottom-left":N.some(RA),left:N.some(MA)},nB=Object.freeze({__proto__:null,setValueFrom:VR,setToMin:GR,setToMax:qR,getValueFromEvent:$R,setPositionFromValue:XR,onLeft:KR,onRight:YR,onUp:JR,onDown:QR,edgeActions:ZR}),tB=[Le("stepSize",1),Le("onChange",p),Le("onChoose",p),Le("onInit",p),Le("onDragStart",p),Le("onDragEnd",p),Le("snapToGrid",!1),Le("rounded",!0),Ae("snapStart"),we("model",ce("mode",{x:[Le("minX",0),Le("maxX",100),Xe("value",(function(n){return Ke(n.mode.minX)})),ye("getInitialValue"),Vs("manager",xR)],y:[Le("minY",0),Le("maxY",100),Xe("value",(function(n){return Ke(n.mode.minY)})),ye("getInitialValue"),Vs("manager",zR)],xy:[Le("minX",0),Le("maxX",100),Le("minY",0),Le("maxY",100),Xe("value",(function(n){return Ke({x:n.mode.minX,y:n.mode.minY})})),ye("getInitialValue"),Vs("manager",nB)]})),Yg("sliderBehaviours",[fy,Kg]),Xe("mouseIsDown",(function(){return Ke(!1)}))],eB=function(n,t,e,r){var o,i=function(t){return Wp(t,n,"thumb")},u=function(t){return Wp(t,n,"spectrum")},a=function(t){return Up(t,n,"left-edge")},c=function(t){return Up(t,n,"right-edge")},s=function(t){return Up(t,n,"top-edge")},l=function(t){return Up(t,n,"bottom-edge")},f=n.model,d=f.manager,m=function(t,e){d.setPositionFromValue(t,e,n,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:l,getSpectrum:u})},g=function(n,t){f.value.set(t);var e=i(n);m(n,e)},p=function(t,e){g(t,e);var r=i(t);return n.onChange(t,r,e),N.some(!0)},h=function(t){d.setToMin(t,n)},v=function(t){d.setToMax(t,n)},b=function(t){var e=function(){Up(t,n,"thumb").each((function(e){var r=f.value.get();n.onChoose(t,e,r)}))},r=n.mouseIsDown.get();n.mouseIsDown.set(!1),r&&e()},y=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},w=function(t,e){e.stop(),n.onDragEnd(t,i(t)),b(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.sliderBehaviours,[fy.config({mode:"special",focusIn:function(t){return Up(t,n,"spectrum").map(fy.focusIn).map(O)}}),Kg.config({store:{mode:"manual",getValue:function(n){return f.value.get()}}}),ql.config({channels:(o={},o[hg()]={onReceive:b},o)})]),events:hi([wi(V_(),(function(n,t){p(n,t.event.value)})),Ai((function(t,e){var r=f.getInitialValue();f.value.set(r);var o=i(t);m(t,o);var a=u(t);n.onInit(t,o,a,f.value.get())})),wi(yo(),y),wi(xo(),w),wi(Co(),y),wi(To(),w)]),apis:{resetToMin:h,resetToMax:v,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},rB=ch({name:"Slider",configFields:tB,partFields:j_,factory:eB,apis:{setValue:function(n,t,e){n.setValue(t,e)},resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),oB=function(n,t,e){return{hue:n,saturation:t,value:e}},iB=function(n){var t=0,e=0,r=0,o=n.red/255,i=n.green/255,u=n.blue/255,a=Math.min(o,Math.min(i,u)),c=Math.max(o,Math.max(i,u));if(a===c)return r=a,oB(0,0,100*r);var s=o===a?i-u:u===a?o-i:u-o;return t=o===a?3:u===a?1:5,t=60*(t-s/(c-a)),e=(c-a)/c,r=c,oB(Math.round(t),Math.round(100*e),Math.round(100*r))},uB=function(n){return iB(qO(n))},aB=function(n){return PO(GO(n))},cB=Pu("rgb-hex-update"),sB=Pu("slider-update"),lB=Pu("palette-update"),fB=function(n,t){var e=rB.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=rB.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return rB.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:y({y:0})},components:[e,r],sliderBehaviours:jl([By.config({})]),onChange:function(n,t,e){fi(n,sB,{value:e})}})},dB="form",mB=[Yg("formBehaviours",[Kg])],gB=function(n){return"<alloy.field."+n+">"},pB=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Lp(dB,gB(t),e)};return{field:t,record:function(){return n}}}(),e=n(t),r=t.record(),o=G(r,(function(n){return Ep({name:n,pname:gB(n)})}));return th(dB,mB,o,vB,e)},hB=function(n,t){return n.fold((function(){return vn.error(t)}),vn.value)},vB=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.formBehaviours,[Kg.config({store:{mode:"manual",getValue:function(t){var e=qp(t,n);return Bn(e,(function(n,t){return n().bind((function(n){var e=yh.getCurrent(n);return hB(e,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Bu(n.element)))})).map(Kg.getValue)}))},setValue:function(t,e){Rn(e,(function(e,r){Up(t,n,r).each((function(n){yh.getCurrent(n).each((function(n){Kg.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Up(t,n,e).bind(yh.getCurrent)}}}},bB={getField:ea((function(n,t,e){return n.getField(t,e)})),sketch:pB},yB=Pu("valid-input"),wB=Pu("invalid-input"),xB=Pu("validating-input"),SB="colorcustom.rgb.",CB=function(n,t,e,r){var o=function(e,r){return $E.config({invalidClass:t("invalid"),notify:{onValidate:function(n){fi(n,xB,{type:e})},onValid:function(n){fi(n,yB,{type:e,value:Kg.getValue(n)})},onInvalid:function(n){fi(n,wB,{type:e,value:Kg.getValue(n)})}},validator:{validate:function(t){var e=Kg.getValue(t),o=r(e)?vn.value(!0):vn.error(n("aria.input.invalid"));return NE.pure(o)},validateOnLoad:!1}})},i=function(e,r,i,u,a){var c=n(SB+"range"),s=YD.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),l=YD.parts.field({data:a,factory:CE,inputAttributes:D({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:jl([o(r,e),nE.config({})]),onSetValue:function(n){if($E.isInvalid(n)){var t=$E.run(n);t.get(p)}}}),f=[s,l],d="hex"!==r?[YD.parts["aria-descriptor"]({text:c})]:[],m=f.concat(d);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},u=function(n,t){var e=PO(t);return bB.getField(n,"hex").each((function(t){By.isFocused(t)||Kg.setValue(n,{hex:e.value})})),e},a=function(n,t){var e=t.red,r=t.green,o=t.blue;Kg.setValue(n,{red:e,green:r,blue:o})},c=Qw({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(n,t){c.getOpt(n).each((function(n){Ka(n.element,"background-color","#"+t.value)}))},l=function(){var o={red:Ke(N.some(255)),green:Ke(N.some(255)),blue:Ke(N.some(255)),hex:Ke(N.some("ffffff"))},l=function(n,t){var e=qO(t);a(n,e),g(e)},f=function(n){return o[n].get()},d=function(n,t){o[n].set(t)},m=function(){return f("red").bind((function(n){return f("green").bind((function(t){return f("blue").map((function(e){return UO(n,t,e,1)}))}))}))},g=function(n){var t=n.red,e=n.green,r=n.blue;d("red",N.some(t)),d("green",N.some(e)),d("blue",N.some(r))},p=function(n,t){var e=t.event;"hex"!==e.type?d(e.type,N.none()):r(n)},h=function(n,t){e(n);var r=AO(t);d("hex",N.some(t));var o=qO(r);a(n,o),g(o),fi(n,cB,{hex:r}),s(n,r)},v=function(n,t,e){var r=parseInt(e,10);d(t,N.some(r)),m().each((function(t){var e=u(n,t);fi(n,cB,{hex:e}),s(n,e)}))},b=function(n){return"hex"===n.type},y=function(n,t){var e=t.event;b(e)?h(n,e.value):v(n,e.type,e.value)},w=function(t){return{label:n(SB+t+".label"),description:n(SB+t+".description")}},x=w("red"),S=w("green"),C=w("blue"),k=w("hex");return Kn(bB.sketch((function(e){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[e.field("red",YD.sketch(i(WO,"red",x.label,x.description,255))),e.field("green",YD.sketch(i(WO,"green",S.label,S.description,255))),e.field("blue",YD.sketch(i(WO,"blue",C.label,C.description,255))),e.field("hex",YD.sketch(i(MO,"hex",k.label,k.description,"ffffff"))),c.asSpec()],formBehaviours:jl([$E.config({invalidClass:t("form-invalid")}),Cy("rgb-form-events",[wi(yB,y),wi(wB,p),wi(xB,p)])])}})),{apis:{updateHex:function(n,t){Kg.setValue(n,{hex:t.value}),l(n,t),s(n,t)}}})},f=ah({factory:l,name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}});return f},kB=function(n,t){var e=rB.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=rB.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),o=function(n,t){var e=n.width,r=n.height,o=n.getContext("2d");if(null!==o){o.fillStyle=t,o.fillRect(0,0,e,r);var i=o.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=i,o.fillRect(0,0,e,r);var u=o.createLinearGradient(0,0,0,r);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),o.fillStyle=u,o.fillRect(0,0,e,r)}},i=function(n,t){var e=n.components()[0].element.dom,r=oB(t,100,100),i=GO(r);o(e,KO(i))},u=function(n,t){var e=iB(qO(t));rB.setValue(n,{x:e.saturation,y:100-e.value})},a=function(n){var i=y({x:0,y:0}),u=function(n,t,e){fi(n,lB,{value:e})},a=function(n,t,e,r){o(e.element.dom,KO(YO))},c=jl([yh.config({find:N.some}),By.config({})]);return rB.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,r],onChange:u,onInit:a,sliderBehaviours:c})},c=ah({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(n,t,e){i(t,e)},setThumb:function(n,t,e){u(t,e)}},extraApis:{}});return c},OB=function(n,t){var e=function(e){var r=CB(n,t,e.onValidHex,e.onInvalidHex),o=kB(n,t),i=function(n){return(100-n)/100*360},u=function(n){return 100-n/360*100},a={paletteRgba:Ke(YO),paletteHue:Ke(0)},c=Qw(fB(n,t)),s=Qw(o.sketch({})),l=Qw(r.sketch({})),f=function(n,t,e){s.getOpt(n).each((function(n){o.setHue(n,e)}))},d=function(n,t){l.getOpt(n).each((function(n){r.updateHex(n,t)}))},m=function(n,t,e){c.getOpt(n).each((function(n){rB.setValue(n,{y:u(e)})}))},g=function(n,t){s.getOpt(n).each((function(n){o.setThumb(n,t)}))},p=function(n,t){var e=qO(n);a.paletteRgba.set(e),a.paletteHue.set(t)},h=function(n,t,e,r){p(t,e),q(r,(function(r){r(n,t,e)}))},v=function(){var n=[d];return function(t,e){var r=e.event.value,o=a.paletteHue.get(),i=oB(o,r.x,100-r.y),u=aB(i);h(t,u,o,n)}},b=function(){var n=[f,d];return function(t,e){var r=i(e.event.value.y),o=a.paletteRgba.get(),u=iB(o),c=oB(r,u.saturation,u.value),s=aB(c);h(t,s,r,n)}},y=function(){var n=[f,m,g];return function(t,e){var r=e.event.hex,o=uB(r);h(t,r,o.hue,n)}};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),l.asSpec()],behaviours:jl([Cy("colour-picker-events",[wi(cB,y()),wi(lB,v()),wi(sB,b())]),yh.config({find:function(n){return l.getOpt(n)}}),fy.config({mode:"acyclic"})])}},r=ah({name:"ColourPicker",configFields:[ye("dom"),Le("onValidHex",p),Le("onInvalidHex",p)],factory:e});return r},TB=function(){return yh.config({find:N.some})},DB=function(n){return yh.config({find:n.getOpt})},EB=function(n){return yh.config({find:function(t){return Yi(t.element,n).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}})},_B={self:TB,memento:DB,childAt:EB},AB={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},RB=function(n){return AB[n]},BB=function(n){return RB(n)},MB=function(n){var t=function(n){return"tox-"+n},e=OB(BB,t),r=function(n){fi(n,fE,{name:"hex-valid",value:!0})},o=function(n){fi(n,fE,{name:"hex-valid",value:!1})},i=Qw(e.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:r,onInvalidHex:o}));return{dom:{tag:"div"},components:[i.asSpec()],behaviours:jl([Kg.config({store:{mode:"manual",getValue:function(n){var t=i.get(n),e=yh.getCurrent(t),r=e.bind((function(n){var t=Kg.getValue(n);return t.hex}));return r.map((function(n){return"#"+n})).getOr("")},setValue:function(n,t){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,r=e.exec(t),o=i.get(n),u=yh.getCurrent(o);u.fold((function(){}),(function(n){Kg.setValue(n,{hex:N.from(r[1]).getOr("")}),bB.getField(n,"hex").each((function(n){li(n,Bo())}))}))}}}),_B.self()])}},IB=tinymce.util.Tools.resolve("tinymce.Resource"),NB=function(n){return Object.prototype.hasOwnProperty.call(n,"init")},FB=function(n){var t=Ke(N.none()),e=Qw({dom:{tag:n.tag}}),r=Ke(N.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:jl([Cy("custom-editor-events",[Ai((function(o){e.getOpt(o).each((function(e){(NB(n)?n.init(e.element.dom):IB.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element.dom,n.settings)}))).then((function(n){r.get().each((function(t){n.setValue(t)})),r.set(N.none()),t.set(N.some(n))}))}))}))]),Kg.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return r.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){r.set(N.some(e))}),(function(n){return n.setValue(e)}))}}}),_B.self()]),components:[e.asSpec()]}},PB=tinymce.util.Tools.resolve("tinymce.util.Tools"),LB=zt([Le("preprocess",w),Le("postprocess",w)]),zB=function(n,t){var e=ie("RepresentingConfigs.memento processors",LB,t);return Kg.config({store:{mode:"manual",getValue:function(t){var r=n.get(t),o=Kg.getValue(r);return e.postprocess(o)},setValue:function(t,r){var o=e.preprocess(r),i=n.get(t);Kg.setValue(i,o)}}})},jB=function(n,t,e){return Kg.config(Kn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},HB=function(n,t,e){return jB(n,(function(n){return t(n.element)}),(function(n,t){return e(n.element,t)}))},VB=function(n){return HB(n,ic,uc)},UB=function(n){return HB(n,yu,wu)},WB=function(n){return Kg.config({store:{mode:"memory",initialValue:n}})},GB={memento:zB,withElement:HB,withComp:jB,domValue:VB,domHtml:UB,memory:WB},qB="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp",$B=function(n,t){var e=PB.explode(t.getSetting("images_file_types",qB,"string")),r=function(n){return V(e,(function(t){return pr(n.name.toLowerCase(),"."+t.toLowerCase())}))};return K(dn(n),r)},XB=function(n,t){var e=function(n,t){t.stop()},r=function(n){return function(t,e){q(n,(function(n){n(t,e)}))}},o=function(n,t){if(!YC.isDisabled(n)){var e=t.event.raw;u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event.raw.target;u(n,e.files)},u=function(e,r){Kg.setValue(e,$B(r,t)),fi(e,cE,{name:n.name})},a=Qw({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:jl([Cy("input-file-events",[Di(Io()),Di(Go())])])}),c=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:jl([GB.memory([]),_B.self(),YC.config({}),Jy.config({toggleClass:"dragenter",toggleOnExecute:!1}),Cy("dropzone-events",[wi("dragenter",r([e,Jy.toggle])),wi("dragleave",r([e,Jy.toggle])),wi("dragover",e),wi("drop",r([e,o])),wi(Mo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},Jw.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){var t=a.get(n);t.element.dom.click()},buttonBehaviours:jl([nE.config({}),Kk.button(t.isDisabled),Wk()])})]}]}},s=n.label.map((function(n){return aE(n,t)})),l=YD.parts.field({factory:{sketch:c}});return eE(s,l,["tox-form__group--stretched"],[])},KB=function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:G(n.items,t.interpreter)}},YB=Pu("alloy-fake-before-tabstop"),JB=Pu("alloy-fake-after-tabstop"),QB=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:jl([By.config({ignore:!0}),nE.config({})])}},ZB=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[QB([YB]),n,QB([JB])],behaviours:jl([_B.childAt(1)])}},nM=function(n,t){fi(n,Ao(),{raw:{which:9,shiftKey:t}})},tM=function(n,t){var e=t.element;ja(e,YB)?nM(n,!0):ja(e,JB)&&nM(n,!1)},eM=function(n){return hD(n,["."+YB,"."+JB].join(","),k)},rM=!($r().browser.isIE()||$r().browser.isEdge()),oM=function(n){var t=Ke("");return{getValue:function(n){return t.get()},setValue:function(e,r){if(n)Cu(e.element,"srcdoc",r);else{Cu(e.element,"src","javascript:''");var o=e.element.dom.contentWindow.document;o.open(),o.write(r),o.close()}t.set(r)}}},iM=function(n,t){var e=rM&&n.sandboxed,r=D(D({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),o=oM(e),i=n.label.map((function(n){return aE(n,t)})),u=function(n){return ZB({uid:n.uid,dom:{tag:"iframe",attributes:r},behaviours:jl([nE.config({}),By.config({}),GB.withComp(N.none(),o.getValue,o.setValue)])})},a=YD.parts.field({factory:{sketch:u}});return eE(i,a,["tox-form__group--stretched"],[])},uM=function(n,t){return sM(document.createElement("canvas"),n,t)},aM=function(n){var t=uM(n.width,n.height),e=cM(t);return e.drawImage(n,0,0),t},cM=function(n){return n.getContext("2d")},sM=function(n,t,e){return n.width=t,n.height=e,n},lM=function(n){return n.naturalWidth||n.width},fM=function(n){return n.naturalHeight||n.height},dM=function(){var n=function(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(n,r(u,this),r(a,this))},t=window,e=n.immediateFn||"function"===typeof t.setImmediate&&t.setImmediate||function(n){return setTimeout(n,1)},r=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.apply(t,e)}},o=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(o){return void n.reject(o)}n.resolve(r)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var t=n.then;if("function"===typeof t)return void l(r(t,n),r(u,this),r(a,this))}this._state=!0,this._value=n,c.call(this)}catch(e){a.call(this,e)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];i.call(this,e)}this._deferreds=[]}function s(n,t,e,r){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.resolve=e,this.reject=r}var l=function(n,t,e){var r=!1;try{n((function(n){r||(r=!0,t(n))}),(function(n){r||(r=!0,e(n))}))}catch(o){if(r)return;r=!0,e(o)}};return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var r=this;return new n((function(n,o){i.call(r,new s(t,e,n,o))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Array.prototype.slice.call(1===t.length&&o(t[0])?t[0]:t);return new n((function(n,t){if(0===r.length)return n([]);for(var e=r.length,o=function(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){o(i,n)}),t)}r[i]=u,0===--e&&n(r)}catch(c){t(c)}},i=0;i<r.length;i++)o(i,r[i])}))},n.resolve=function(t){return t&&"object"===typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var r=0,o=t;r<o.length;r++){var i=o[r];i.then(n,e)}}))},n},mM=window.Promise?window.Promise:dM(),gM=function(n){return new mM((function(t,e){var r=URL.createObjectURL(n),o=new Image,i=function(){o.removeEventListener("load",u),o.removeEventListener("error",a)},u=function(){i(),t(o)},a=function(){i(),e("Unable to load data of type "+n.type+": "+r)};o.addEventListener("load",u),o.addEventListener("error",a),o.src=r,o.complete&&setTimeout(u,0)}))},pM=function(n){var t=n.split(","),e=/data:([^;]+)/.exec(t[0]);if(!e)return N.none();for(var r=e[1],o=t[1],i=1024,u=atob(o),a=u.length,c=Math.ceil(a/i),s=new Array(c),l=0;l<c;++l){for(var f=l*i,d=Math.min(f+i,a),m=new Array(d-f),g=f,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[l]=new Uint8Array(m)}return N.some(new Blob(s,{type:r}))},hM=function(n){return new mM((function(t,e){pM(n).fold((function(){e("uri is not base64: "+n)}),t)}))},vM=function(n,t,e){return t=t||"image/png",d(HTMLCanvasElement.prototype.toBlob)?new mM((function(r,o){n.toBlob((function(n){n?r(n):o()}),t,e)})):hM(n.toDataURL(t,e))},bM=function(n,t,e){return t=t||"image/png",n.toDataURL(t,e)},yM=function(n){return gM(n).then((function(n){xM(n);var t=uM(lM(n),fM(n)),e=cM(t);return e.drawImage(n,0,0),t}))},wM=function(n){return new mM((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))},xM=function(n){URL.revokeObjectURL(n.src)},SM=function(n,t,e){var r=t.type,o=y(r),i=function(){return mM.resolve(t)},u=y(e),a=function(){return e.split(",")[1]},c=function(t,e){return n.then((function(n){return vM(n,t,e)}))},s=function(t,e){return n.then((function(n){return bM(n,t,e)}))},l=function(n,t){return s(n,t).then((function(n){return n.split(",")[1]}))},f=function(){return n.then(aM)};return{getType:o,toBlob:i,toDataURL:u,toBase64:a,toAdjustedBlob:c,toAdjustedDataURL:s,toAdjustedBase64:l,toCanvas:f}},CM=function(n){return wM(n).then((function(t){return SM(yM(n),n,t)}))},kM=function(n,t){return vM(n,t).then((function(t){return SM(mM.resolve(n),t,n.toDataURL())}))},OM=function(n){return CM(n)},TM=function(n,t,e){var r="string"===typeof n?parseFloat(n):n;return r>e?r=e:r<t&&(r=t),r},DM=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},EM=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],_M=function(n,t){for(var e,r=[],o=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)r[u]=t[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=n[u+5*a]*r[a];o[u+5*i]=e}}return o},AM=function(n,t){var e;return t=TM(t,-1,1),t*=100,t<0?e=127+t/100*127:(e=t%1,e=0===e?EM[t]:EM[Math.floor(t)]*(1-e)+EM[Math.floor(t)+1]*e,e=127*e+127),_M(n,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},RM=function(n,t){return t=TM(255*t,-255,255),_M(n,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])},BM=function(n,t,e,r){return t=TM(t,0,2),e=TM(e,0,2),r=TM(r,0,2),_M(n,[t,0,0,0,0,0,e,0,0,0,0,0,r,0,0,0,0,0,1,0,0,0,0,0,1])},MM=function(n,t){return n.toCanvas().then((function(e){return IM(e,n.getType(),t)}))},IM=function(n,t,e){var r=cM(n),o=function(n,t){for(var e,r,o,i,u=n.data,a=t[0],c=t[1],s=t[2],l=t[3],f=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],w=t[13],x=t[14],S=t[15],C=t[16],k=t[17],O=t[18],T=t[19],D=0;D<u.length;D+=4)e=u[D],r=u[D+1],o=u[D+2],i=u[D+3],u[D]=e*a+r*c+o*s+i*l+f,u[D+1]=e*d+r*m+o*g+i*p+h,u[D+2]=e*v+r*b+o*y+i*w+x,u[D+3]=e*S+r*C+o*k+i*O+T;return n},i=o(r.getImageData(0,0,n.width,n.height),e);return r.putImageData(i,0,0),kM(n,t)},NM=function(n,t){return n.toCanvas().then((function(e){return FM(e,n.getType(),t)}))},FM=function(n,t,e){var r=cM(n),o=function(n,t,e){for(var r=function(n,t,e){return n>e?n=e:n<t&&(n=t),n},o=Math.round(Math.sqrt(e.length)),i=Math.floor(o/2),u=n.data,a=t.data,c=n.width,s=n.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<o;p++)for(var h=0;h<o;h++){var v=r(f+h-i,0,c-1),b=r(l+p-i,0,s-1),y=4*(b*c+v),w=e[p*o+h];d+=u[y]*w,m+=u[y+1]*w,g+=u[y+2]*w}var x=4*(l*c+f);a[x]=r(d,0,255),a[x+1]=r(m,0,255),a[x+2]=r(g,0,255)}return t},i=r.getImageData(0,0,n.width,n.height),u=r.getImageData(0,0,n.width,n.height);return u=o(i,u,e),r.putImageData(u,0,0),kM(n,t)},PM=function(n){var t=function(t,e,r){for(var o=cM(t),i=new Array(256),u=function(n,t){for(var e=n.data,r=0;r<e.length;r+=4)e[r]=t[e[r]],e[r+1]=t[e[r+1]],e[r+2]=t[e[r+2]];return n},a=0;a<i.length;a++)i[a]=n(a,r);var c=u(o.getImageData(0,0,t.width,t.height),i);return o.putImageData(c,0,0),kM(t,e)};return function(n,e){return n.toCanvas().then((function(r){return t(r,n.getType(),e)}))}},LM=function(n){return function(t,e){return MM(t,n(DM(),e))}},zM=function(n){return function(t){return MM(t,n)}},jM=function(n){return function(t){return NM(t,n)}},HM=zM([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),VM=LM(RM),UM=LM(AM),WM=function(n,t,e,r){return MM(n,BM(DM(),t,e,r))},GM=jM([0,-1,0,-1,5,-1,0,-1,0]),qM=PM((function(n,t){return 255*Math.pow(n/255,1-t)})),$M=function(n,t,e){var r=lM(n),o=fM(n),i=t/r,u=e/o,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=XM(n,i,u);return a?c.then((function(n){return $M(n,t,e)})):c},XM=function(n,t,e){return new mM((function(r){var o=lM(n),i=fM(n),u=Math.floor(o*t),a=Math.floor(i*e),c=uM(u,a),s=cM(c);s.drawImage(n,0,0,o,i,0,0,u,a),r(c)}))},KM=function(n,t){void 0===t&&(t=2);var e=Math.pow(10,t),r=Math.round(n*e);return Math.ceil(r/e)},YM=function(n,t){return n.toCanvas().then((function(e){return JM(e,n.getType(),t)}))},JM=function(n,t,e){var r=e<0?360+e:e,o=r*Math.PI/180,i=n.width,u=n.height,a=Math.sin(o),c=Math.cos(o),s=KM(Math.abs(i*c)+Math.abs(u*a)),l=KM(Math.abs(i*a)+Math.abs(u*c)),f=uM(s,l),d=cM(f);return d.translate(s/2,l/2),d.rotate(o),d.drawImage(n,-i/2,-u/2),kM(f,t)},QM=function(n,t){return n.toCanvas().then((function(e){return ZM(e,n.getType(),t)}))},ZM=function(n,t,e){var r=uM(n.width,n.height),o=cM(r);return"v"===e?(o.scale(1,-1),o.drawImage(n,0,-r.height)):(o.scale(-1,1),o.drawImage(n,-r.width,0)),kM(r,t)},nI=function(n,t,e,r,o){return n.toCanvas().then((function(i){return tI(i,n.getType(),t,e,r,o)}))},tI=function(n,t,e,r,o,i){var u=uM(o,i),a=cM(u);return a.drawImage(n,-e,-r),kM(u,t)},eI=function(n,t,e){return n.toCanvas().then((function(r){return $M(r,t,e).then((function(t){return kM(t,n.getType())}))}))},rI=function(n){return HM(n)},oI=function(n){return GM(n)},iI=function(n,t){return qM(n,t)},uI=function(n,t,e,r){return WM(n,t,e,r)},aI=function(n,t){return VM(n,t)},cI=function(n,t){return UM(n,t)},sI=function(n,t){return QM(n,t)},lI=function(n,t,e,r,o){return nI(n,t,e,r,o)},fI=function(n,t,e){return eI(n,t,e)},dI=function(n,t){return YM(n,t)},mI=function(n,t){return D({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},gI=function(n,t){return mI(nx(n,t),{})},pI=function(n,t){return mI(nx(n,t),{behaviours:jl([xy.config({})])})},hI=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:jl([xy.config({})])}},vI=Pu("toolbar.button.execute"),bI=function(n){return Mi((function(t,e){Yk(n,t)((function(e){fi(t,vI,{buttonApi:e}),n.onAction(e)}))}))},yI=(e_={},e_[Uo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],e_),wI=Pu("update-menu-text"),xI=Pu("update-menu-icon"),SI=function(n,t,e){var r=Ke(p),o=n.text.map((function(n){return Qw(hI(n,t,e.providers))})),i=n.icon.map((function(n){return Qw(pI(n,e.providers.icons))})),u=function(n,t){var e=Kg.getValue(n);return By.focus(e),fi(e,"keydown",{raw:t.event.raw}),b_.close(e),N.some(!0)},a=n.role.fold((function(){return{}}),(function(n){return{role:n}})),c=n.tooltip.fold((function(){return{}}),(function(n){var t=e.providers.translate(n);return{title:t,"aria-label":t}})),s=Qw(b_.sketch(D(D(D({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[t,t+"--select"].concat(G(n.classes,(function(n){return t+"--"+n}))),attributes:D({},c)},components:tO([i.map((function(n){return n.asSpec()})),o.map((function(n){return n.asSpec()})),N.some({dom:{tag:"div",classes:[t+"__select-chevron"],innerHtml:nx("chevron-down",e.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:jl(_(n.dropdownBehaviours,[Kk.button((function(){return n.disabled||e.providers.isDisabled()})),Wk(),S_.config({}),xy.config({}),Cy("dropdown-events",[Jk(n,r),Qk(n,r)]),Cy("menubutton-update-display-text",[wi(wI,(function(n,t){o.bind((function(t){return t.getOpt(n)})).each((function(n){xy.set(n,[hc(e.providers.translate(t.event.text))])}))})),wi(xI,(function(n,t){i.bind((function(t){return t.getOpt(n)})).each((function(n){xy.set(n,[pI(t.event.icon,e.providers.icons)])}))}))])])),eventOrder:Kn(yI,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:jl([fy.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:t+"--active",parts:{menu:FS(!1,n.columns,n.presets)},fetch:function(t){return NE.nu(x(n.fetch,t))}})));return s.asSpec()},CI=function(n){return i(n)},kI=function(n){return"separator"===n.type},OI=function(n){return Hn(n,"getSubmenuItems")},TI={type:"separator"},DI=function(n,t){var e=J(n,(function(n,e){return CI(e)?""===e?n:"|"===e?n.length>0&&!kI(n[n.length-1])?n.concat([TI]):n:Hn(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&kI(e[e.length-1])&&e.pop(),e},EI=function(n,t){var e=n.getSubmenuItems(),r=RI(e,t),o=Kn(r.menus,lt(n.value,r.items)),i=Kn(r.expansions,lt(n.value,n.value));return{item:n,menus:o,expansions:i}},_I=function(n,t){return OI(n)?EI(n,t):{item:n,menus:{},expansions:{}}},AI=function(n){if(kI(n))return n;var t=jn(n,"value").getOrThunk((function(){return Pu("generated-menu-item")}));return Kn({value:t},n)},RI=function(n,t){var e=DI(i(n)?n.split(" "):n,t);return Y(e,(function(n,e){var r=AI(e),o=_I(r,t);return{menus:Kn(n.menus,o.menus),items:[o.item].concat(n.items),expansions:Kn(n.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},BI=function(n,t,e,r){var o=Pu("primary-menu"),i=RI(n,e.shared.providers.menuItems());if(0===i.items.length)return N.none();var u=aD(o,i.items,t,e,r),a=Bn(i.menus,(function(n,r){return aD(r,n,t,e,!1)})),c=Kn(a,lt(o,u));return N.from(Iw.tieredData(o,c,i.expansions))},MI=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)},setActive:function(t){var e=n.element;t?(Pa(e,"tox-tbtn--enabled"),Cu(e,"aria-pressed",!0)):(za(e,"tox-tbtn--enabled"),Eu(e,"aria-pressed"))},isActive:function(){return ja(n.element,"tox-tbtn--enabled")}}},II=function(n,t,e,r){return SI({text:n.text,icon:n.icon,tooltip:n.tooltip,role:r,fetch:function(t,r){n.fetch((function(n){r(BI(n,cS.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:MI,columns:1,presets:"normal",classes:[],dropdownBehaviours:[nE.config({})]},t,e.shared)},NI=function(n,t,e){var r=function(n){return function(r){var o=!r.isActive();r.setActive(o),n.storage.set(o),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){Yl(t.element),fi(t,fE,{name:n.name,value:n.storage.get()})}))}))}},o=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(G(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}));return D(D({type:n.type,active:!1},t),{onAction:r(n),onSetup:o(n)})})))}},FI=function(n,t,e,r,o,i){void 0===e&&(e=[]);var u=t.fold((function(){return{}}),(function(n){return{action:n}})),a=D({buttonBehaviours:jl([Kk.button((function(){return n.disabled||i.isDisabled()})),Wk(),nE.config({}),Cy("button press",[yi("click"),yi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Kn(a,{dom:r});return Kn(c,{components:o})},PI=function(n,t,e,r){void 0===r&&(r=[]);var o=n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:o},u=n.icon.map((function(n){return gI(n,e.icons)})),a=tO([u]);return FI(n,t,r,i,a,e)},LI=function(n,t,e,r){void 0===r&&(r=[]);var o=PI(n,N.some(t),e,r);return Jw.sketch(o)},zI=function(n,t,e,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return gI(n,e.icons)})):N.none(),a=u.isSome()?tO([u]):[],c=u.isSome()?{}:{innerHtml:i},s=_(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],o),l=D(D({tag:"button",classes:s},c),{attributes:{title:i}});return FI(n,t,r,l,a,e)},jI=function(n,t,e,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=zI(n,N.some(t),e,r,o);return Jw.sketch(i)},HI=function(n,t){return function(e){"custom"===t?fi(e,fE,{name:n,value:{}}):"submit"===t?li(e,dE):"cancel"===t&&li(e,lE)}},VI=function(n,t){return"menu"===t},UI=function(n,t){return"custom"===t||"cancel"===t||"submit"===t},WI=function(n,t,e){if(VI(n,t)){var r=function(){return u},o=n,i=D(D({},n),{onSetup:function(t){return t.setDisabled(n.disabled),p},fetch:NI(o.items,r,e)}),u=Qw(II(i,"tox-tbtn",e,N.none()));return u.asSpec()}if(UI(n,t)){var a=HI(n.name,t),c=D(D({},n),{borderless:!1});return jI(c,a,e.shared.providers,[])}},GI=function(n,t){var e=HI(n.name,"custom");return rE(N.none(),YD.parts.field(D({factory:Jw},zI(n,N.some(e),t,[GB.memory(""),_B.self()]))))},qI=y([Le("field1Name","field1"),Le("field2Name","field2"),js("onLockedChange"),Fs(["lockClass"]),Le("locked",!1),Zg.field("coupledFieldBehaviours",[yh,Kg])]),$I=function(n,t,e){return Up(n,t,e).bind(yh.getCurrent)},XI=function(n,t){return Ep({factory:YD,name:n,overrides:function(n){return{fieldBehaviours:jl([Cy("coupled-input-behaviour",[wi(Bo(),(function(e){$I(e,n,t).each((function(t){Up(e,n,"lock").each((function(r){Jy.isOn(r)&&n.onLockedChange(e,t,r)}))}))}))])])}}})},KI=y([XI("field1","field2"),XI("field2","field1"),Ep({factory:Jw,schema:[ye("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:jl([Jy.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),YI=function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:Zg.augment(n.coupledFieldBehaviours,[yh.config({find:N.some}),Kg.config({store:{mode:"manual",getValue:function(t){var e,r=Xp(t,n,["field1","field2"]);return e={},e[n.field1Name]=Kg.getValue(r.field1()),e[n.field2Name]=Kg.getValue(r.field2()),e},setValue:function(t,e){var r=Xp(t,n,["field1","field2"]);Vn(e,n.field1Name)&&Kg.setValue(r.field1(),e[n.field1Name]),Vn(e,n.field2Name)&&Kg.setValue(r.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Up(t,n,"field1")},getField2:function(t){return Up(t,n,"field2")},getLock:function(t){return Up(t,n,"lock")}}}},JI=ch({name:"FormCoupledInputs",configFields:qI(),partFields:KI(),factory:YI,apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),QI=function(n){var t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(n){return n in t?t[n]:1},r=n.value.toFixed(e(n.unit));return-1!==r.indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+n.unit},ZI=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=t.exec(n);if(null!==e){var r=parseFloat(e[1]),o=e[2];return vn.value({value:r,unit:o})}return vn.error(n)},nN=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(n){return Object.prototype.hasOwnProperty.call(e,n)};return n.unit===t?N.some(n.value):r(n.unit)&&r(t)?e[n.unit]===e[t]?N.some(n.value):N.some(n.value/e[n.unit]*e[t]):N.none()},tN=function(n){return N.none()},eN=function(n,t){return function(e){return nN(e,t).map((function(e){return{value:e*n,unit:t}}))}},rN=function(n,t){var e=ZI(n).toOptional(),r=ZI(t).toOptional();return fh(e,r,(function(n,t){return nN(n,t.unit).map((function(n){return t.value/n})).map((function(n){return eN(n,t.unit)})).getOr(tN)})).getOr(tN)},oN=function(n,t){var e=tN,r=Pu("ratio-event"),o=JI.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:nx("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:nx("unlock",t.icons)}}],buttonBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()}}),Wk(),nE.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(e){return YD.parts.field({factory:CE,inputClasses:["tox-textfield"],inputBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()}}),Wk(),nE.config({}),Cy("size-input-events",[wi(Eo(),(function(n,t){fi(n,r,{isField1:e})})),wi(Mo(),(function(t,e){fi(t,cE,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=JI.parts.field1(i([YD.parts.label(a("Width")),u(!0)])),s=JI.parts.field2(i([YD.parts.label(a("Height")),u(!1)]));return JI.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,r){ZI(Kg.getValue(n)).each((function(n){e(n).each((function(n){Kg.setValue(t,QI(n))}))}))},coupledFieldBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){JI.getField1(n).bind(YD.getField).each(YC.disable),JI.getField2(n).bind(YD.getField).each(YC.disable),JI.getLock(n).each(YC.disable)},onEnabled:function(n){JI.getField1(n).bind(YD.getField).each(YC.enable),JI.getField2(n).bind(YD.getField).each(YC.enable),JI.getLock(n).each(YC.enable)}}),Wk(),Cy("size-input-events2",[wi(r,(function(n,t){var r=t.event.isField1,o=r?JI.getField1(n):JI.getField2(n),i=r?JI.getField2(n):JI.getField1(n),u=o.map(Kg.getValue).getOr(""),a=i.map(Kg.getValue).getOr("");e=rN(u,a)}))])])})},iN=y(Pu("undo")),uN=y(Pu("redo")),aN=y(Pu("zoom")),cN=y(Pu("back")),sN=y(Pu("apply")),lN=y(Pu("swap")),fN=y(Pu("transform")),dN=y(Pu("temp-transform")),mN=y(Pu("transform-apply")),gN={undo:iN,redo:uN,zoom:aN,back:cN,apply:sN,swap:lN,transform:fN,tempTransform:dN,transformApply:mN},pN=y("save-state"),hN=y("disable"),vN=y("enable"),bN={formActionEvent:fE,saveState:pN,disable:hN,enable:vN},yN=function(n,t){var e=function(n,e,r,o){return Qw(jI({name:n,text:n,disabled:r,primary:o,icon:N.none(),borderless:!1},e,t))},r=function(n,e,r,o){return Qw(LI({name:n,icon:N.some(n),tooltip:N.some(e),disabled:o,primary:!1,borderless:!1},r,t))},o=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(YC)&&YC.disable(e)}))},i=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(YC)&&YC.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=p,c=function(n,t,e){fi(n,t,e)},s=function(n){return li(n,bN.disable())},l=function(n){return li(n,bN.enable())},f=function(n,t){s(n),c(n,gN.transform(),{transform:t}),l(n)},d=function(n,t){s(n),c(n,gN.tempTransform(),{transform:t}),l(n)},m=function(n){return function(){an.getOpt(n).each((function(n){xy.set(n,[on])}))}},g=function(n,t){s(n),c(n,gN.transformApply(),{transform:t,swap:m(n)}),l(n)},h=function(){return e("Back",(function(n){return c(n,gN.back(),{swap:m(n)})}),!1,!1)},v=function(){return Qw({dom:{tag:"div",classes:["tox-spacer"]},behaviours:jl([YC.config({})])})},b=function(){return e("Apply",(function(n){return c(n,gN.apply(),{swap:m(n)})}),!0,!0)},w=function(){return function(t){var e=n.getRect();return lI(t,e.x,e.y,e.w,e.h)}},x=[h(),v(),e("Apply",(function(t){var e=w();g(t,e),n.hideCrop()}),!1,!0)],S=WD.sketch({dom:u,components:x.map((function(n){return n.asSpec()})),containerBehaviours:jl([Cy("image-tools-crop-buttons-events",[wi(bN.disable(),(function(n,t){o(x,n)})),wi(bN.enable(),(function(n,t){i(x,n)}))])])}),C=Qw(oN({name:"size",label:N.none(),constrain:!0,disabled:!1},t)),k=function(n,t){return function(e){return fI(e,n,t)}},O=[h(),v(),C,v(),e("Apply",(function(n){C.getOpt(n).each((function(t){var e=Kg.getValue(t),r=parseInt(e.width,10),o=parseInt(e.height,10),i=k(r,o);g(n,i)}))}),!1,!0)],T=WD.sketch({dom:u,components:O.map((function(n){return n.asSpec()})),containerBehaviours:jl([Cy("image-tools-resize-buttons-events",[wi(bN.disable(),(function(n,t){o(O,n)})),wi(bN.enable(),(function(n,t){i(O,n)}))])])}),D=function(n,t){return function(e){return n(e,t)}},E=D(sI,"h"),_=D(sI,"v"),A=D(dI,-90),R=D(dI,90),B=function(n,t){d(n,t)},M=[h(),v(),r("flip-horizontally","Flip horizontally",(function(n){B(n,E)}),!1),r("flip-vertically","Flip vertically",(function(n){B(n,_)}),!1),r("rotate-left","Rotate counterclockwise",(function(n){B(n,A)}),!1),r("rotate-right","Rotate clockwise",(function(n){B(n,R)}),!1),v(),b()],I=WD.sketch({dom:u,components:M.map((function(n){return n.asSpec()})),containerBehaviours:jl([Cy("image-tools-fliprotate-buttons-events",[wi(bN.disable(),(function(n,t){o(M,n)})),wi(bN.enable(),(function(n,t){i(M,n)}))])])}),F=function(n,e,r,o,i){var u=rB.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}),a=rB.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=rB.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Qw(rB.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:i,getInitialValue:y({x:o})},components:[u,a,c],sliderBehaviours:jl([By.config({})]),onChoose:e}))},P=function(n,t,e,r,o){var i=function(n,e,r){var o=D(t,r.x/100);f(n,o)};return F(n,i,e,r,o)},L=function(n,t,e,r,o){return[h(),P(n,t,e,r,o),b()]},z=function(n,t,e,r,a){var c=L(n,t,e,r,a);return WD.sketch({dom:u,components:c.map((function(n){return n.asSpec()})),containerBehaviours:jl([Cy("image-tools-filter-panel-buttons-events",[wi(bN.disable(),(function(n,t){o(c,n)})),wi(bN.enable(),(function(n,t){i(c,n)}))])])})},j=[h(),v(),b()],H=WD.sketch({dom:u,components:j.map((function(n){return n.asSpec()}))}),V=z("Brightness",aI,-100,0,100),U=z("Contrast",cI,-100,0,100),W=z("Gamma",iI,-100,0,100),G=function(n,t,e){return function(r){return uI(r,n,t,e)}},q=function(n){var t=function(n,t,e){var r=$.getOpt(n),o=K.getOpt(n),i=X.getOpt(n);r.each((function(t){o.each((function(e){i.each((function(r){var o=Kg.getValue(t).x/100,i=Kg.getValue(r).x/100,u=Kg.getValue(e).x/100,a=G(o,i,u);f(n,a)}))}))}))};return F(n,t,0,100,200)},$=q("R"),X=q("G"),K=q("B"),Y=[h(),$,X,K,b()],J=WD.sketch({dom:u,components:Y.map((function(n){return n.asSpec()}))}),Q=function(n,t,e){return function(r){var o=function(){an.getOpt(r).each((function(t){xy.set(t,[n]),e(t)}))};c(r,gN.swap(),{transform:t,swap:o})}},Z=function(t){n.showCrop()},nn=function(t){C.getOpt(t).each((function(t){var e=n.getMeasurements(),r=e.width,o=e.height;Kg.setValue(t,{width:r,height:o})}))},tn=N.some(oI),en=N.some(rI),rn=[r("crop","Crop",Q(S,N.none(),Z),!1),r("resize","Resize",Q(T,N.none(),nn),!1),r("orientation","Orientation",Q(I,N.none(),a),!1),r("brightness","Brightness",Q(V,N.none(),a),!1),r("sharpen","Sharpen",Q(H,tn,a),!1),r("contrast","Contrast",Q(U,N.none(),a),!1),r("color-levels","Color levels",Q(J,N.none(),a),!1),r("gamma","Gamma",Q(W,N.none(),a),!1),r("invert","Invert",Q(H,en,a),!1)],on=WD.sketch({dom:u,components:rn.map((function(n){return n.asSpec()}))}),un=WD.sketch({dom:{tag:"div"},components:[on],containerBehaviours:jl([xy.config({})])}),an=Qw(un),cn=function(n){return an.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))};return{memContainer:an,getApplyButton:cn}},wN=tinymce.util.Tools.resolve("tinymce.geom.Rect"),xN=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),SN=tinymce.util.Tools.resolve("tinymce.util.Observable"),CN=tinymce.util.Tools.resolve("tinymce.util.VK"),kN=function(n){var t=Math.max,e=n.documentElement,r=n.body,o=t(e.scrollWidth,r.scrollWidth),i=t(e.clientWidth,r.clientWidth),u=t(e.offsetWidth,r.offsetWidth),a=t(e.scrollHeight,r.scrollHeight),c=t(e.clientHeight,r.clientHeight),s=t(e.offsetHeight,r.offsetHeight);return{width:o<u?i:o,height:a<s?c:a}},ON=function(n){var t,e;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]};function TN(n,t){var e,r,o,i,u=t.document||document,a=u.getElementById(t.handle||n),c=function(n){var c,f=kN(u);ON(n),n.preventDefault(),r=n.button;var d=a;o=n.screenX,i=n.screenY,c=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=xN("<div></div>").css({position:"absolute",top:0,left:0,width:f.width,height:f.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(u.body),xN(u).on("mousemove touchmove",s).on("mouseup touchend",l),t.start(n)},s=function(n){if(ON(n),n.button!==r)return l(n);n.deltaX=n.screenX-o,n.deltaY=n.screenY-i,n.preventDefault(),t.drag(n)},l=function(n){ON(n),xN(u).off("mousemove touchmove",s).off("mouseup touchend",l),e.remove(),t.stop&&t.stop(n)},f=function(){xN(a).off()};return xN(a).on("mousedown touchstart",c),{destroy:f}}var DN=0,EN=function(n,t,e,r,o){var i,u="tox-",a=u+"crid-"+DN++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(n,t){return{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},f=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}},d=function(){return f(e,n)},m=function(t,r,o,i){var u,a,c,s,l;u=r.x,a=r.y,c=r.w,s=r.h,u+=o*t.deltaX,a+=i*t.deltaY,c+=o*t.deltaW,s+=i*t.deltaH,c<20&&(c=20),s<20&&(s=20),l=n=wN.clamp({x:u,y:a,w:c,h:s},e,"move"===t.name),l=f(e,l),S.fire("updateRect",{rect:l}),y(l)},g=function(){var t=function(t){var e;return TN(a,{document:r.ownerDocument,handle:a+"-"+t.name,start:function(){e=n},drag:function(n){m(t,e,n.deltaX,n.deltaY)}})};xN('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),PB.each(s,(function(n){xN("#"+a,r).append('<div id="'+a+"-"+n+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),PB.each(c,(function(n){xN("#"+a,r).append('<div id="'+a+"-"+n.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),i=PB.map(c,t),h(n),xN(r).on("focusin focusout",(function(n){xN(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),xN(r).on("keydown",(function(t){var e;PB.each(c,(function(n){if(t.target.id===a+"-"+n.name)return e=n,!1}));var r=function(n,t,r,o,i){n.stopPropagation(),n.preventDefault(),m(e,r,o,i)};switch(t.keyCode){case CN.LEFT:r(t,e,n,-10,0);break;case CN.RIGHT:r(t,e,n,10,0);break;case CN.UP:r(t,e,n,0,-10);break;case CN.DOWN:r(t,e,n,0,10);break;case CN.ENTER:case CN.SPACEBAR:t.preventDefault(),o();break}}))},p=function(n){var t=PB.map(c,(function(n){return"#"+a+"-"+n.name})).concat(PB.map(s,(function(n){return"#"+a+"-"+n}))).join(",");n?xN(t,r).show():xN(t,r).hide()},h=function(n){var e=function(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),xN("#"+a+"-"+n,r).css({left:t.x,top:t.y,width:t.w,height:t.h})};PB.each(c,(function(t){xN("#"+a+"-"+t.name,r).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)},v=function(t){n=t,h(n)},b=function(e){t=e,h(n)},y=function(n){v(l(e,n))},w=function(t){e=t,h(n)},x=function(){PB.each(i,(function(n){n.destroy()})),i=[]};g();var S=PB.extend({toggleVisibility:p,setClampRect:w,setRect:v,getInnerRect:d,setInnerRect:y,setViewPortRect:b,destroy:x},SN);return S},_N={create:EN},AN=function(n){return new Ox((function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)}))},RN=function(n){var t=Qw({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Ke(1),r=Ke(N.none()),o=Ke({x:0,y:0,w:1,h:1}),i=Ke({x:0,y:0,w:1,h:1}),u=function(n,i){g.getOpt(n).each((function(n){var u=e.get(),a=Ic(n.element),c=Cc(n.element),s=i.dom.naturalWidth*u,l=i.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Ya(i,m),t.getOpt(n).each((function(n){Ya(n.element,m)})),r.get().each((function(n){var t=o.get();n.setRect({x:t.x*u+f,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:f,y:d,w:s,h:l}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(n,t){g.getOpt(n).each((function(n){var r=Ic(n.element),o=Cc(n.element),i=t.dom.naturalWidth,u=t.dom.naturalHeight,a=Math.min(r/i,o/u);a>=1?e.set(1):e.set(a)}))},c=function(n,t){var e=tr.fromTag("img");return Cu(e,"src",t),AN(e.dom).then((function(){return g.getOpt(n).map((function(n){var t=vc({element:e});xy.replaceAt(n,1,N.some(t));var r=i.get(),c={x:0,y:0,w:e.dom.naturalWidth,h:e.dom.naturalHeight};i.set(c);var s=wN.inflate(c,-20,-20);return o.set(s),r.w===c.w&&r.h===c.h||a(n,e),u(n,e),e}))}))},s=function(n,t){var r=e.get(),o=t>0?Math.min(2,r+.1):Math.max(.1,r-.1);e.set(o),g.getOpt(n).each((function(n){var t=n.components()[1].element;u(n,t)}))},l=function(){r.get().each((function(n){n.toggleVisibility(!0)}))},f=function(){r.get().each((function(n){n.toggleVisibility(!1)}))},d=function(){return o.get()},m=WD.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:jl([Cy("image-panel-crop-events",[Ai((function(n){g.getOpt(n).each((function(n){var t=n.element.dom,i=_N.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,p);i.toggleVisibility(!1),i.on("updateRect",(function(n){var t=n.rect,r=e.get(),i={x:Math.round(t.x/r),y:Math.round(t.y/r),w:Math.round(t.w/r),h:Math.round(t.h/r)};o.set(i)})),r.set(N.some(i))}))}))])])}],containerBehaviours:jl([xy.config({}),Cy("image-panel-events",[Ai((function(t){c(t,n)}))])])}),g=Qw(m),h=function(){var n=i.get();return{width:n.w,height:n.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:l,hideCrop:f,getRect:d,getMeasurements:h}},BN=function(n,t,e,r,o){return LI({name:n,icon:N.some(t),disabled:e,tooltip:N.some(n),primary:!1,borderless:!1},r,o)},MN=function(n,t){t?YC.enable(n):YC.disable(n)},IN=function(n){var t=function(n,t,o){e.getOpt(n).each((function(n){MN(n,t)})),r.getOpt(n).each((function(n){MN(n,o)}))},e=Qw(BN("Undo","undo",!0,(function(n){fi(n,gN.undo(),{direction:1})}),n)),r=Qw(BN("Redo","redo",!0,(function(n){fi(n,gN.redo(),{direction:1})}),n)),o=WD.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),r.asSpec(),BN("Zoom in","zoom-in",!1,(function(n){fi(n,gN.zoom(),{direction:1})}),n),BN("Zoom out","zoom-out",!1,(function(n){fi(n,gN.zoom(),{direction:-1})}),n)]});return{container:o,updateButtonUndoStates:t}};function NN(){var n=[],t=-1,e=function(e){var r=n.splice(++t);return n.push(e),{state:e,removed:r}},r=function(){if(i())return n[--t]},o=function(){if(u())return n[++t]},i=function(){return t>0},u=function(){return-1!==t&&t<n.length-1};return{data:n,add:e,undo:r,redo:o,canUndo:i,canRedo:u}}var FN,PN=function(n){var t=Ke(n),e=Ke(N.none()),r=NN();r.add(n);var o=function(){return t.get()},i=function(n){t.set(n)},u=function(){return e.get().fold((function(){return t.get()}),(function(n){return n}))},a=function(n){var t=c(n);return f(),e.set(N.some(t)),t.url},c=function(n){return{blob:n,url:URL.createObjectURL(n)}},s=function(n){URL.revokeObjectURL(n.url)},l=function(n){PB.each(n,s)},f=function(){e.get().each(s),e.set(N.none())},d=function(n){var t=c(n);i(t);var e=r.add(t).removed;return l(e),t.url},m=function(n){var t=c(n);return e.set(N.some(t)),t.url},g=function(n){return e.get().fold(p,(function(t){d(t.blob),n()}))},h=function(){var n=r.undo();return i(n),n.url},v=function(){var n=r.redo();return i(n),n.url},b=function(){var n=r.canUndo(),t=r.canRedo();return{undoEnabled:n,redoEnabled:t}};return{getBlobState:o,setBlobState:i,addBlobState:d,getTempState:u,updateTempState:a,addTempState:m,applyTempState:g,destroyTempState:f,undo:h,redo:v,getHistoryStates:b}},LN=function(n,t){var e=PN(n.currentState),r=function(n,t){var e=t.event.direction;k.zoom(n,e)},o=function(n){var t=e.getHistoryStates();O.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),fi(n,bN.formActionEvent,{name:bN.saveState(),value:t.undoEnabled})},i=function(n){O.updateButtonUndoStates(n,!1,!1)},u=function(n,t){var r=e.undo();f(n,r).then((function(t){l(n),o(n)}))},a=function(n,t){var r=e.redo();f(n,r).then((function(t){l(n),o(n)}))},c=function(n){return n.toBlob()},s=function(n){fi(n,bN.formActionEvent,{name:bN.disable(),value:{}})},l=function(n){T.getApplyButton(n).each((function(n){YC.enable(n)})),fi(n,bN.formActionEvent,{name:bN.enable(),value:{}})},f=function(n,t){return s(n),k.updateSrc(n,t)},d=function(n,t,e,r,i){return s(n),OM(t).then(e).then(c).then(r).then((function(t){return f(n,t).then((function(t){return o(n),i(),l(n),t}))})).catch((function(t){return l(n),t}))},m=function(n,t,r){var o=e.getBlobState().blob,i=function(n){return e.updateTempState(n)};d(n,o,t,i,r)},g=function(n,t){var r=e.getTempState().blob,o=function(n){return e.addTempState(n)};d(n,r,t,o,p)},h=function(n,t,r){var o=e.getBlobState().blob,i=function(t){var r=e.addBlobState(t);return b(n),r};d(n,o,t,i,r)},v=function(n,t){var r=function(){b(n);var e=t.event.swap;e()};e.applyTempState(r)},b=function(n){var t=e.getBlobState().url;return e.destroyTempState(),o(n),t},y=function(n){var t=b(n);f(n,t).then((function(t){l(n)}))},w=function(n,t){y(n);var e=t.event.swap;e(),k.hideCrop()},x=function(n,t){return m(n,t.event.transform,p)},S=function(n,t){return g(n,t.event.transform)},C=function(n,t){return h(n,t.event.transform,t.event.swap)},k=RN(n.currentState.url),O=IN(t),T=yN(k,t),D=function(n,t){i(n);var e=t.event.transform,r=t.event.swap;e.fold((function(){r()}),(function(t){m(n,t,r)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[T.memContainer.asSpec(),k.memContainer.asSpec(),O.container],behaviours:jl([Kg.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),Cy("image-tools-events",[wi(gN.undo(),u),wi(gN.redo(),a),wi(gN.zoom(),r),wi(gN.back(),w),wi(gN.apply(),v),wi(gN.transform(),x),wi(gN.tempTransform(),S),wi(gN.transformApply(),C),wi(gN.swap(),D)]),_B.self()])}},zN=function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},r=G(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(r),behaviours:jl([_B.self(),xy.config({}),GB.domHtml(N.none()),fy.config({mode:"acyclic"})])}},jN=function(n){return!Hn(n,"items")},HN="data-value",VN=function(n,t,e,r){return G(e,(function(e){return jN(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===r,onAction:function(){Kg.setValue(n,e.value),fi(n,cE,{name:t}),By.focus(n)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return VN(n,t,e.items,r)}}}))},UN=function(n,t){return mn(n,(function(n){return jN(n)?gh(n.value===t,n):UN(n.items,t)}))},WN=function(n,t){var e=t.shared.providers,r=ln(n.items).filter(jN),o=n.label.map((function(n){return aE(n,e)})),i=YD.parts.field({dom:{},factory:{sketch:function(e){return SI({uid:e.uid,text:r.map((function(n){return n.text})),icon:N.none(),tooltip:n.label,role:N.none(),fetch:function(e,r){var o=VN(e,n.name,n.items,Kg.getValue(e));r(BI(o,cS.CLOSE_ON_EXECUTE,t,!1))},onSetup:y(p),getApi:y({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[nE.config({}),Kg.config({store:{mode:"manual",initialValue:r.map((function(n){return n.value})).getOr(""),getValue:function(n){return Ou(n.element,HN)},setValue:function(t,e){UN(n.items,e).each((function(n){Cu(t.element,HN,n.value),fi(t,wI,{text:n.text})}))}}})]},"tox-listbox",t.shared)}}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]};return YD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tn([o.toArray(),[u]]),fieldBehaviours:jl([YC.config({disabled:y(n.disabled),onDisabled:function(n){YD.getField(n).each(YC.disable)},onEnabled:function(n){YD.getField(n).each(YC.enable)}})])})},GN=function(n,t){return{dom:{tag:"div",classes:n.classes},components:G(n.items,t.shared.interpreter)}},qN=function(n,t){var e=G(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),r=n.data.map((function(n){return lt("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Qg(n.selectBehaviours,[By.config({}),Kg.config({store:D({mode:"manual",getValue:function(n){return ic(n.element)},setValue:function(t,e){var r=Z(n.options,(function(n){return n.value===e}));r.isSome()&&uc(t.element,e)}},r)})])}},$N=ah({name:"HtmlSelect",configFields:[ye("options"),Yg("selectBehaviours",[By,Kg]),Le("selectClasses",[]),Le("selectAttributes",{}),Ae("data")],factory:qN}),XN=function(n,t){var e=G(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),r=n.label.map((function(n){return aE(n,t)})),o=YD.parts.field({dom:{},selectAttributes:{size:n.size},options:e,factory:$N,selectBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()}}),nE.config({}),Cy("selectbox-change",[wi(Mo(),(function(t,e){fi(t,cE,{name:n.name})}))])])}),i=n.size>1?N.none():N.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:nx("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:tn([[o],i.toArray()])};return YD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tn([r.toArray(),[u]]),fieldBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){YD.getField(n).each(YC.disable)},onEnabled:function(n){YD.getField(n).each(YC.enable)}}),Wk()])})},KN=function(n,t){var e=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},r=function(n){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:G(n,e)}]}},o=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"tr"},components:G(n,o)}},u=function(n){return{dom:{tag:"tbody"},components:G(n,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[r(n.header),u(n.cells)],behaviours:jl([nE.config({}),By.config({})])}},YN=function(n,t){var e=n.label.map((function(n){return aE(n,t)})),r=[YC.config({disabled:function(){return n.disabled||t.isDisabled()}}),Wk(),fy.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return li(n,dE),N.some(!0)}}),Cy("textfield-change",[wi(Bo(),(function(t,e){fi(t,cE,{name:n.name})})),wi(Ho(),(function(t,e){fi(t,cE,{name:n.name})}))]),nE.config({})],o=n.validation.map((function(n){return $E.config({getRoot:function(n){return Gi(n.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Kg.getValue(t),r=n.validator(e);return NE.pure(!0===r?vn.value(e):vn.error(r))},validateOnLoad:n.validateOnLoad}})})).toArray(),i=n.placeholder.fold(y({}),(function(n){return{placeholder:t.translate(n)}})),u=n.inputMode.fold(y({}),(function(n){return{inputmode:n}})),a=D(D({},i),u),c=YD.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:a,inputClasses:[n.classname],inputBehaviours:jl(tn([r,o])),selectOnFocus:!1,factory:CE}),s=n.flex?["tox-form__group--stretched"]:[],l=s.concat(n.maximized?["tox-form-group--maximize"]:[]),f=[YC.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){YD.getField(n).each(YC.disable)},onEnabled:function(n){YD.getField(n).each(YC.enable)}}),Wk()];return eE(e,c,l,f)},JN=function(n,t){return YN({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:N.none(),maximized:n.maximized},t)},QN=function(n,t){return YN({name:n.name,multiline:!0,label:n.label,inputMode:N.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:N.none(),maximized:n.maximized},t)},ZN=function(n,t){var e=n.stream.streams,r=e.setup(n,t);return hi([wi(n.event,r),Ri((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[wi(n,(function(){return t.cancel()}))]})).getOr([])))},nF=Object.freeze({__proto__:null,events:ZN}),tF=function(n){var t=Ke(null),e=function(){return{timer:null!==t.get()?"set":"unset"}},r=function(n){t.set(n)},o=function(){var n=t.get();null!==n&&n.cancel()};return oa({readState:e,setTimer:r,cancel:o})},eF=function(n){return n.stream.streams.state(n)},rF=Object.freeze({__proto__:null,throttle:tF,init:eF}),oF=function(n,t){var e=n.stream,r=sx(n.onStream,e.delay);return t.setTimer(r),function(n,t){r.throttle(n,t),e.stopEvent&&t.stop()}},iF=[we("stream",ce("mode",{throttle:[ye("delay"),Le("stopEvent",!0),Vs("streams",{setup:oF,state:tF})]})),Le("event","input"),Ae("cancelEvent"),js("onStream")],uF=Vl({fields:iF,name:"streaming",active:nF,state:rF}),aF=function(n,t,e){var r=Kg.getValue(e);Kg.setValue(t,r),sF(t)},cF=function(n,t){var e=n.element,r=ic(e),o=e.dom;"number"!==Ou(e,"type")&&t(o,r)},sF=function(n){cF(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},lF=function(n,t){cF(n,(function(n,e){return n.setSelectionRange(t,e.length)}))},fF=function(n,t,e){if(n.selectsOver){var r=Kg.getValue(t),o=n.getDisplayText(r),i=Kg.getValue(e),u=n.getDisplayText(i);return 0===u.indexOf(o)?N.some((function(){aF(n,t,e),lF(t,o.length)})):N.none()}return N.none()},dF=y("alloy.typeahead.itemexecute"),mF=function(n,t,e,r){var o=function(t,e,o){n.previewing.set(!1);var i=ZE.getCoupled(t,"sandbox");if(mg.isOpen(i))yh.getCurrent(i).each((function(n){zh.getHighlighted(n).fold((function(){o(n)}),(function(){pi(i,n.element,"keydown",e)}))}));else{var a=function(n){yh.getCurrent(n).each(o)};u_(n,u(t),t,i,r,a,TE.HighlightFirst).get(p)}},i=yE(n),u=function(n){return function(t){return t.map((function(t){var e=zn(t.menus),r=en(e,(function(n){return K(n.items,(function(n){return"item"===n.type}))})),o=Kg.getState(n);return o.update(G(r,(function(n){return n.data}))),t}))}},a=[By.config({}),Kg.config({onSetValue:n.onSetValue,store:D({mode:"dataset",getDataKey:function(n){return ic(n.element)},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,e){uc(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(n){return lt("initialValue",n)})).getOr({}))}),uF.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(t,e){var o=ZE.getCoupled(t,"sandbox"),i=By.isFocused(t);if(i&&ic(t.element).length>=n.minChars){var a=yh.getCurrent(o).bind((function(n){return zh.getHighlighted(n).map(Kg.getValue)}));n.previewing.set(!0);var c=function(t){yh.getCurrent(o).each((function(t){a.fold((function(){n.model.selectsOver&&zh.highlightFirst(t)}),(function(n){zh.highlightBy(t,(function(t){var e=Kg.getValue(t);return e.value===n.value})),zh.getHighlighted(t).orThunk((function(){return zh.highlightFirst(t),N.none()}))}))}))};u_(n,u(t),t,o,r,c,TE.HighlightFirst).get(p)}},cancelEvent:Xo()}),fy.config({mode:"special",onDown:function(n,t){return o(n,t,zh.highlightFirst),N.some(!0)},onEscape:function(n){var t=ZE.getCoupled(n,"sandbox");return mg.isOpen(t)?(mg.close(t),N.some(!0)):N.none()},onUp:function(n,t){return o(n,t,zh.highlightLast),N.some(!0)},onEnter:function(t){var e=ZE.getCoupled(t,"sandbox"),r=mg.isOpen(e);if(r&&!n.previewing.get())return yh.getCurrent(e).bind((function(n){return zh.getHighlighted(n)})).map((function(n){return fi(t,dF(),{item:n}),!0}));var o=Kg.getValue(t);return li(t,Xo()),n.onExecute(e,t,o),r&&mg.close(e),N.some(!0)}}),Jy.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),ZE.config({others:{sandbox:function(t){return d_(n,t,{onOpen:function(){return Jy.on(t)},onClose:function(){return Jy.off(t)}})}}}),Cy("typeaheadevents",[Mi((function(t){var e=p;c_(n,u(t),t,r,e,TE.HighlightFirst).get(p)})),wi(dF(),(function(t,e){var r=ZE.getCoupled(t,"sandbox");aF(n.model,t,e.event.item),li(t,Xo()),n.onItemExecute(t,r,e.event.item,Kg.getValue(t)),mg.close(r),sF(t)}))].concat(n.dismissOnBlur?[wi(jo(),(function(n){var t=ZE.getCoupled(n,"sandbox");nf(t.element).isNone()&&mg.close(t)}))]:[]))];return{uid:n.uid,dom:xE(Kn(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:D(D({},i),Qg(n.typeaheadBehaviours,a)),eventOrder:n.eventOrder}},gF=y([Ae("lazySink"),ye("fetch"),Le("minChars",5),Le("responseTime",1e3),Ls("onOpen"),Le("getHotspot",N.some),Le("getAnchorOverrides",y({})),Le("layouts",N.none()),Le("eventOrder",{}),$e("model",{},[Le("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),Le("selectsOver",!0),Le("populateFromBrowse",!0)]),Ls("onSetValue"),zs("onExecute"),Ls("onItemExecute"),Le("inputClasses",[]),Le("inputAttributes",{}),Le("inputStyles",{}),Le("matchWidth",!0),Le("useMinWidth",!1),Le("dismissOnBlur",!0),Fs(["openClass"]),Ae("initialData"),Yg("typeaheadBehaviours",[By,Kg,uF,fy,Jy,ZE]),Xe("previewing",(function(){return Ke(!0)}))].concat(bE()).concat(g_())),pF=y([_p({schema:[Ns()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(r){fF(n.model,r,e).fold((function(){return zh.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aF(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOptional().map((function(n){return fi(n,dF(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aF(n.model,t,e)}))}}}})]),hF=ch({name:"Typeahead",configFields:gF(),partFields:pF(),factory:mF}),vF=function(n){var t=function(){return vF(n.toCached())},e=function(t){return vF(n.bind((function(n){return n.fold((function(n){return NE.pure(vn.error(n))}),(function(n){return t(n)}))})))},r=function(t){return vF(n.map((function(n){return n.bind(t)})))},o=function(t){return vF(n.map((function(n){return n.map(t)})))},i=function(t){return vF(n.map((function(n){return n.mapError(t)})))},u=function(t,e){return n.map((function(n){return n.fold(t,e)}))},a=function(t,e){return vF(NE.nu((function(r){var o=!1,i=setTimeout((function(){o=!0,r(vn.error(e()))}),t);n.get((function(n){o||(clearTimeout(i),r(n))}))})))};return D(D({},n),{toCached:t,bindFuture:e,bindResult:r,mapResult:o,mapError:i,foldResult:u,withTimeout:a})},bF=function(n){return vF(NE.nu(n))},yF=function(n){return vF(NE.pure(vn.value(n)))},wF=function(n){return vF(NE.pure(vn.error(n)))},xF=function(n){return vF(NE.pure(n))},SF=function(n){return vF(n.map(vn.value))},CF=function(n){return bF((function(t){n.then((function(n){t(vn.value(n))}),(function(n){t(vn.error(n))}))}))},kF={nu:bF,wrap:vF,pure:yF,value:yF,error:wF,fromResult:xF,fromFuture:SF,fromPromise:CF},OF={type:"separator"},TF=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:p}},DF=function(n,t){return{type:"menuitem",value:t,text:n,meta:{attach:void 0},onAction:p}},EF=function(n){return G(n,TF)},_F=function(n,t){return K(t,(function(t){return t.type===n}))},AF=function(n,t){return EF(_F(n,t))},RF=function(n){return AF("header",n.targets)},BF=function(n){return AF("anchor",n.targets)},MF=function(n){return N.from(n.anchorTop).map((function(n){return DF("<top>",n)})).toArray()},IF=function(n){return N.from(n.anchorBottom).map((function(n){return DF("<bottom>",n)})).toArray()},NF=function(n){return G(n,(function(n){return DF(n,n)}))},FF=function(n){return J(n,(function(n,t){var e=0===n.length||0===t.length;return e?n.concat(t):n.concat(OF,t)}),[])},PF=function(n,t){var e=n.toLowerCase();return K(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return gr(t.toLowerCase(),e)||gr(n.value.toLowerCase(),e)}))},LF=function(n,t,e){var r=Kg.getValue(t),o=void 0!==r.meta.text?r.meta.text:r.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(t){var r=PF(o,NF(e.getHistory(n)));return"file"===n?FF([r,PF(o,RF(t)),PF(o,tn([MF(t),BF(t),IF(t)]))]):r}))},zF=Pu("aria-invalid"),jF=function(n,t,e){var r,o=t.shared.providers,i=function(t){var r=Kg.getValue(t);e.addToHistory(r.value,n.filetype)},u=YD.parts.field({factory:hF,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":zF,type:"url"},minChars:0,responseTime:0,fetch:function(r){var o=LF(n.filetype,r,e),i=BI(o,cS.BUBBLE_TO_SANDBOX,t,!1);return NE.pure(i)},getHotspot:function(n){return m.getOpt(n)},onSetValue:function(n,t){n.hasConfigured($E)&&$E.run(n).get(p)},typeaheadBehaviours:jl(tn([e.getValidationHandler().map((function(t){return $E.config({getRoot:function(n){return Gi(n.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){s.getOpt(n).each((function(n){Cu(n.element,"title",o.translate(t))}))}},validator:{validate:function(e){var r=Kg.getValue(e);return kF.nu((function(e){t({type:n.filetype,url:r.value},(function(n){if("invalid"===n.status){var t=vn.error(n.message);e(t)}else{var r=vn.value(n.message);e(r)}}))}))},validateOnLoad:!1}})})).toArray(),[YC.config({disabled:function(){return n.disabled||o.isDisabled()}}),nE.config({}),Cy("urlinput-events",tn(["file"===n.filetype?[wi(Bo(),(function(t){fi(t,cE,{name:n.name})}))]:[],[wi(Mo(),(function(t){fi(t,cE,{name:n.name}),i(t)})),wi(Ho(),(function(t){fi(t,cE,{name:n.name}),i(t)}))]]))]])),eventOrder:(r={},r[Bo()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:FS(!1,1,"normal")},onExecute:function(n,t,e){fi(t,dE,{})},onItemExecute:function(t,e,r,o){i(t),fi(t,cE,{name:n.name})}}),a=n.label.map((function(n){return aE(n,o)})),c=function(n,t,e,r){return void 0===e&&(e=n),void 0===r&&(r=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:nx(e,o.icons),attributes:D({title:o.translate(r),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}},s=Qw(c("invalid",N.some(zF),"warning")),l=Qw({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),f=e.getUrlPicker(n.filetype),d=Pu("browser.url.event"),m=Qw({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,l.asSpec()],behaviours:jl([YC.config({disabled:function(){return n.disabled||o.isDisabled()}})])}),g=Qw(jI({name:n.name,icon:N.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(n){return li(n,d)}),o,[],["tox-browse-url"])),h=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:tn([[m.asSpec()],f.map((function(){return g.asSpec()})).toArray()])}},v=function(t){yh.getCurrent(t).each((function(e){var r=Kg.getValue(e),o=D({fieldname:n.name},r);f.each((function(r){r(o).get((function(r){Kg.setValue(e,r),fi(t,cE,{name:n.name})}))}))}))};return YD.sketch({dom:iE(),components:a.toArray().concat([h()]),fieldBehaviours:jl([YC.config({disabled:function(){return n.disabled||o.isDisabled()},onDisabled:function(n){YD.getField(n).each(YC.disable),g.getOpt(n).each(YC.disable)},onEnabled:function(n){YD.getField(n).each(YC.enable),g.getOpt(n).each(YC.enable)}}),Wk(),Cy("url-input-events",[wi(d,v)])])})},HF=function(n,t){return WD.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Jw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:nx(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){fi(t,fE,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})},VF=function(n,t){var e=Kg.config({store:{mode:"manual",getValue:function(n){var t=n.element.dom;return t.checked},setValue:function(n,t){var e=n.element.dom;e.checked=t}}}),r=function(n){return n.element.dom.click(),N.some(!0)},o=YD.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:jl([_B.self(),YC.config({disabled:function(){return n.disabled||t.isDisabled()}}),nE.config({}),By.config({}),e,fy.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),Cy("checkbox-events",[wi(Mo(),(function(t,e){fi(t,cE,{name:n.name})}))])])}),i=YD.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:jl([S_.config({})])}),u=function(n){var e="checked"===n?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:nx(e,t.icons)}}},a=Qw({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return YD.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[o,a.asSpec(),i],fieldBehaviours:jl([YC.config({disabled:function(){return n.disabled||t.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){YD.getField(n).each(YC.disable)},onEnabled:function(n){YD.getField(n).each(YC.enable)}}),Wk()])})},UF=function(n){return"presentation"===n.presets?WD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):WD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:jl([nE.config({}),By.config({})])})},WF=function(n){return function(t,e,r){return jn(e,"name").fold((function(){return n(e,r)}),(function(o){return t.field(o,n(e,r))}))}},GF=function(n){return function(t,e,r){var o=Kn(e,{source:"dynamic"});return WF(n)(t,o,r)}},qF={bar:WF((function(n,t){return qD(n,t.shared)})),collection:WF((function(n,t){return vE(n,t.shared.providers)})),alertbanner:WF((function(n,t){return HF(n,t.shared.providers)})),input:WF((function(n,t){return JN(n,t.shared.providers)})),textarea:WF((function(n,t){return QN(n,t.shared.providers)})),label:WF((function(n,t){return zN(n,t.shared)})),iframe:GF((function(n,t){return iM(n,t.shared.providers)})),button:WF((function(n,t){return GI(n,t.shared.providers)})),checkbox:WF((function(n,t){return VF(n,t.shared.providers)})),colorinput:WF((function(n,t){return D_(n,t.shared,t.colorinput)})),colorpicker:WF(MB),dropzone:WF((function(n,t){return XB(n,t.shared.providers)})),grid:WF((function(n,t){return KB(n,t.shared)})),listbox:WF((function(n,t){return WN(n,t)})),selectbox:WF((function(n,t){return XN(n,t.shared.providers)})),sizeinput:WF((function(n,t){return oN(n,t.shared.providers)})),urlinput:WF((function(n,t){return jF(n,t,t.urlinput)})),customeditor:WF(FB),htmlpanel:WF(UF),imagetools:WF((function(n,t){return LN(n,t.shared.providers)})),table:WF((function(n,t){return KN(n,t.shared.providers)})),panel:WF((function(n,t){return GN(n,t)}))},$F={field:function(n,t){return t}},XF=function(n,t,e){var r=Kn(e,{shared:{interpreter:function(t){return KF(n,t,r)}}});return KF(n,t,r)},KF=function(n,t,e){return jn(qF,t.type).fold((function(){return t}),(function(r){return r(n,t,e)}))},YF=function(n,t){var e=$F;return KF(e,n,t)},JF={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},QF=function(n,t,e){var r=Nf(-12,12,JF),o={maxHeightFunction:Af()},i=function(){return{anchor:"node",root:eu(n()),node:N.from(n()),bubble:r,layouts:{onRtl:function(){return[qw]},onLtr:function(){return[Gw]}},overrides:o}},u=function(){return{anchor:"hotspot",hotspot:t(),bubble:r,layouts:{onRtl:function(){return[pl]},onLtr:function(){return[hl]}},overrides:o}};return function(){return e()?i():u()}},ZF=function(n,t,e){var r=function(){return{anchor:"node",root:eu(n()),node:N.from(n()),layouts:{onRtl:function(){return[$w]},onLtr:function(){return[$w]}}}},o=function(){return{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[wl]},onLtr:function(){return[wl]}}}};return function(){return e()?r():o()}},nP=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return N.some(Ed.range(tr.fromDom(t.startContainer),t.startOffset,tr.fromDom(t.endContainer),t.endOffset))}}}},tP=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},eP=function(n,t,e){var r=Ok(n),o=function(){return tr.fromDom(n.getBody())},i=function(){return tr.fromDom(n.getContentAreaContainer())},u=function(){return r||!e()};return{inlineDialog:QF(i,t,u),banner:ZF(i,t,u),cursor:nP(n,o),node:tP(o)}},rP=function(n){return function(t,e){var r=AT(n);r(t,e)}},oP=function(n){return function(){return dT(n)}},iP=function(n){return function(){return gT(n)}},uP=function(n){return function(){return ST(n)}},aP=function(n){return{colorPicker:rP(n),hasCustomColors:oP(n),getColors:iP(n),getColorCols:uP(n)}},cP=function(n){return function(){return _k(n)}},sP=function(n){return{isDraggableModal:cP(n)}},lP=function(n){var t=Ke(wk(n)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}},fP=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],dP=function(n){return Hn(n,"items")},mP=function(n){return Hn(n,"block")},gP=function(n){return Hn(n,"inline")},pP=function(n){return Hn(n,"selector")},hP=function(n){return J(n,(function(n,t){if(dP(t)){var e=hP(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(gP(t)||mP(t)||pP(t)){var r=i(t.name)?t.name:t.title.toLowerCase(),o="custom-"+r;return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return D(D({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},vP=function(n,t){var e=hP(t),r=function(t){q(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?r(e.customFormats):n.on("init",(function(){r(e.customFormats)})),e.formats},bP=function(n){return ak(n).map((function(t){var e=vP(n,t);return ck(n)?fP.concat(e):e})).getOr(fP)},yP=function(n,t,e){var r={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return Kn(n,r)},wP=function(n,t,e,r){var o=function(n){return yP(n,e,r)},u=function(n){var t={type:"submenu"};return Kn(n,t)},a=function(t){var o=i(t.name)?t.name:Pu(t.title),u="custom-"+o,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:r(u)},c=Kn(t,a);return n.formatter.register(o,c),c},c=function(n){return G(n,(function(n){var t=_n(n);if(Vn(n,"items")){var e=c(n.items);return Kn(u(n),{getStyleItems:function(){return e}})}return Vn(n,"format")?o(n):1===t.length&&H(t,"title")?Kn(n,{type:"separator"}):a(n)}))};return c(t)},xP=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?N.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):N.none()}},r=function(n){var t=n.items;return void 0!==t&&t.length>0?en(t,r):[n.format]},o=Ke([]),i=Ke([]),u=Ke([]),a=Ke([]),c=Ke(!1);n.on("PreInit",(function(u){var a=bP(n),c=wP(n,a,t,e);o.set(c),i.set(en(c,r))})),n.on("addStyleModifications",(function(o){var i=wP(n,o.items,t,e);u.set(i),c.set(o.replace),a.set(en(i,r))}));var s=function(){var n=c.get()?[]:o.get(),t=u.get();return n.concat(t)},l=function(){var n=c.get()?[]:i.get(),t=a.get();return n.concat(t)};return{getData:s,getFlattenedKeys:l}},SP=function(n){return f(n)&&1===n.nodeType},CP=PB.trim,kP=function(n){return function(t){if(SP(t)){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},OP=kP("true"),TP=kP("false"),DP=function(n,t,e,r,o){return{type:n,title:t,url:e,level:r,attach:o}},EP=function(n){while(n=n.parentNode){var t=n.contentEditable;if(t&&"inherit"!==t)return OP(n)}return!1},_P=function(n,t){return G(Jd(tr.fromDom(t),n),(function(n){return n.dom}))},AP=function(n){return n.innerText||n.textContent},RP=function(n){return n.id?n.id:Pu("h")},BP=function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)},MP=function(n){return BP(n)&&NP(n)},IP=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},NP=function(n){return EP(n)&&!TP(n)},FP=function(n){return IP(n)&&NP(n)},PP=function(n){return IP(n)?parseInt(n.nodeName.substr(1),10):0},LP=function(n){var t=RP(n),e=function(){n.id=t};return DP("header",AP(n),"#"+t,PP(n),e)},zP=function(n){var t=n.id||n.name,e=AP(n);return DP("anchor",e||"#"+t,"#"+t,0,p)},jP=function(n){return G(K(n,FP),LP)},HP=function(n){return G(K(n,MP),zP)},VP=function(n){var t=_P("h1,h2,h3,h4,h5,h6,a:not([href])",n);return t},UP=function(n){return CP(n.title).length>0},WP=function(n){var t=VP(n);return K(jP(t).concat(HP(t)),UP)},GP={find:WP},qP="tinymce-url-history",$P=5,XP=function(n){return i(n)&&/^https?/.test(n)},KP=function(n){return a(n)&&n.length<=$P&&rn(n,XP)},YP=function(n){return u(n)&&Ln(n,(function(n){return!KP(n)})).isNone()},JP=function(){var n,t=rT.getItem(qP);if(null===t)return{};try{n=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return{};throw e}return YP(n)?n:{}},QP=function(n){if(!YP(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));rT.setItem(qP,JSON.stringify(n))},ZP=function(n){var t=JP();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},nL=function(n,t){if(XP(n)){var e=JP(),r=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],o=K(r,(function(t){return t!==n}));e[t]=[n].concat(o).slice(0,$P),QP(e)}},tL=function(n){return!!n},eL=function(n){return Bn(PB.makeMap(n,/[, ]/),tL)},rL=function(n){return N.from(Mk(n)).filter(d)},oL=function(n){var t=N.some(Ik(n)).filter(tL),e=N.some(Nk(n)).filter(tL),r=t.or(e).map(eL);return rL(n).fold(k,(function(n){return r.fold(O,(function(n){return _n(n).length>0&&n}))}))},iL=function(n,t){var e=oL(n);return c(e)?e?rL(n):N.none():e[t]?rL(n):N.none()},uL=function(n,t){return iL(n,t).map((function(e){return function(r){return NE.nu((function(o){var a=function(n,t){if(!i(n))throw new Error("Expected value to be string");if(void 0!==t&&!u(t))throw new Error("Expected meta to be a object");var e={value:n,meta:t};o(e)},c=D({filetype:t,fieldname:r.fieldname},N.from(r.meta).getOr({}));e.call(n,a,r.value,c)}))}}))},aL=function(n){return N.from(n).filter(i).getOrUndefined()},cL=function(n){return Fk(n)?N.none():N.some({targets:GP.find(n.getBody()),anchorTop:aL(Pk(n)),anchorBottom:aL(Lk(n))})},sL=function(n){return N.from(zk(n))},lL=function(n){return{getHistory:ZP,addToHistory:nL,getLinkInformation:function(){return cL(n)},getValidationHandler:function(){return sL(n)},getUrlPicker:function(t){return uL(n,t)}}},fL=function(n,t,e){var r=Ke(!1),o=lP(t),i={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:RC.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(n){return YF(n,i)},anchors:eP(t,e,o.isPositionedAtTop),header:o,getSink:function(){return vn.value(n)}},urlinput:lL(t),styleselect:xP(t),colorinput:aP(t),dialog:sP(t),isContextMenuOpen:function(){return r.get()},setContextMenuState:function(n){return r.set(n)}};return i},dL=y((function(n,t){Fc(n,Math.floor(t))})),mL="contexttoolbar-show",gL="contexttoolbar-hide",pL=y([ye("dom"),Le("shell",!0),Yg("toolbarBehaviours",[xy])]),hL=function(){return{behaviours:jl([xy.config({})])}},vL=y([Ap({name:"groups",overrides:hL})]),bL=function(n,t,e,r){var o=function(n,t){i(n).fold((function(){throw new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){xy.set(n,t)}))},i=function(t){return n.shell?N.some(t):Up(t,n,"groups")},u=n.shell?{behaviours:[xy.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Qg(n.toolbarBehaviours,u.behaviours),apis:{setGroups:o},domModification:{attributes:{role:"group"}}}},yL=ch({name:"Toolbar",configFields:pL(),partFields:vL(),factory:bL,apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),wL=function(n,t){var e={len:0,list:[]},r=J(n,(function(n,e){var r=t(e,n.len);return r.fold(y(n),(function(t){return{len:t.finish,list:n.list.concat([t])}}))}),e);return r.list},xL=function(n,t,e){return{within:n,extra:t,withinWidth:e}},SL=function(n,t,e){var r=wL(n,(function(n,t){var r=e(n);return N.some({element:n,start:t,finish:t+r,width:r})})),o=K(r,(function(n){return n.finish<=t})),i=Y(o,(function(n,t){return n+t.width}),0),u=r.slice(o.length);return{within:o,extra:u,withinWidth:i}},CL=function(n){return G(n,(function(n){return n.element}))},kL=function(n,t,e){var r=CL(n.concat(t));return xL(r,[],e)},OL=function(n,t,e,r){var o=CL(n).concat([e]);return xL(o,CL(t),r)},TL=function(n,t,e){return xL(CL(n),[],e)},DL=function(n,t,e){var r=SL(t,n,e);return 0===r.extra.length?N.some(r):N.none()},EL=function(n,t,e,r){var o=DL(n,t,e).getOrThunk((function(){return SL(t,n-e(r),e)})),i=o.within,u=o.extra,a=o.withinWidth;return 1===u.length&&u[0].width<=e(r)?kL(i,u,a):u.length>=1?OL(i,u,r,a):TL(i,u,a)},_L=function(n,t){var e=G(t,(function(n){return wc(n)}));yL.setGroups(n,e)},AL=function(n){return mn(n,(function(n){return nf(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}))},RL=function(n,t,e){var r=Wp(n,t,"primary"),o=ZE.getCoupled(n,"overflowGroup");Ka(r.element,"visibility","hidden");var i=t.builtGroups.get().concat([o]),u=AL(i);e([]),_L(r,i);var a=Ic(r.element),c=EL(a,t.builtGroups.get(),(function(n){return Ic(n.element)}),o);0===c.extra.length?(xy.remove(r,o),e([])):(_L(r,c.within),e(c.extra)),rc(r.element,"visibility"),oc(r.element),u.each(By.focus)},BL=y([Yg("splitToolbarBehaviours",[ZE]),Xe("builtGroups",(function(){return Ke([])}))]),ML=y([Fs(["overflowToggledClass"]),Ie("getOverflowBounds"),ye("lazySink"),Xe("overflowGroups",(function(){return Ke([])}))].concat(BL())),IL=y([Ep({factory:yL,schema:pL(),name:"primary"}),_p({schema:pL(),name:"overflow"}),_p({name:"overflow-button"}),_p({name:"overflow-group"})]),NL=y([Fs(["toggledClass"]),ye("lazySink"),Oe("fetch"),Ie("getBounds"),Fe("fireDismissalEventInstead",[Le("event",ei())]),Uf()]),FL=y([_p({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:jl([Jy.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),_p({factory:yL,schema:pL(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:jl([fy.config({mode:"cyclic",onEscape:function(t){return Up(t,n,"button").each(By.focus),N.none()}})])}}})]),PL=function(n,t){var e=ZE.getCoupled(n,"toolbarSandbox");mg.isOpen(e)?mg.close(e):mg.open(e,t.toolbar())},LL=function(n,t,e,r){var o=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie();Mm.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:r,overrides:{maxWidthFunction:dL()}},t,o)},zL=function(n,t,e,r,o){yL.setGroups(t,o),LL(n,t,e,r),Jy.on(n)},jL=function(n,t,e){var r=vs(),o=function(o,i){e.fetch().get((function(o){zL(n,i,e,t.layouts,o),r.link(n.element),fy.focusIn(i)}))},i=function(){Jy.off(n),By.focus(n),r.unlink(n.element)};return{dom:{tag:"div",attributes:{id:r.id}},behaviours:jl([fy.config({mode:"special",onEscape:function(n){return mg.close(n),N.some(!0)}}),mg.config({onOpen:o,onClose:i,isPartOf:function(t,e,r){return ys(e,r)||ys(n,r)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),ql.config({channels:D(D({},bg(D({isExtraPart:k},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),wg({doReposition:function(){mg.getState(ZE.getCoupled(n,"toolbarSandbox")).each((function(r){LL(n,r,e,t.layouts)}))}}))})])}},HL=function(n,t,e,r){return D(D({},Jw.sketch(D(D({},r.button()),{action:function(n){PL(n,r)},buttonBehaviours:Zg.augment({dump:r.button().buttonBehaviours},[ZE.config({others:{toolbarSandbox:function(t){return jL(t,e,n)}}})])}))),{apis:{setGroups:function(t,r){mg.getState(ZE.getCoupled(t,"toolbarSandbox")).each((function(o){zL(t,o,n,e.layouts,r)}))},reposition:function(t){mg.getState(ZE.getCoupled(t,"toolbarSandbox")).each((function(r){LL(t,r,n,e.layouts)}))},toggle:function(n){PL(n,r)},getToolbar:function(n){return mg.getState(ZE.getCoupled(n,"toolbarSandbox"))},isOpen:function(n){return mg.isOpen(ZE.getCoupled(n,"toolbarSandbox"))}}})},VL=ch({name:"FloatingToolbarButton",factory:HL,configFields:NL(),partFields:FL(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)},isOpen:function(n,t){return n.isOpen(t)}}}),UL=y([ye("items"),Fs(["itemSelector"]),Yg("tgroupBehaviours",[fy])]),WL=y([Rp({name:"items",unit:"item"})]),GL=function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.tgroupBehaviours,[fy.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},qL=ch({name:"ToolbarGroup",configFields:UL(),partFields:WL(),factory:GL}),$L=function(n){return G(n,(function(n){return wc(n)}))},XL=function(n,t,e){RL(n,e,(function(r){e.overflowGroups.set(r),t.getOpt(n).each((function(n){VL.setGroups(n,$L(r))}))}))},KL=function(n,t,e,r){var o=Qw(VL.sketch({fetch:function(){return NE.nu((function(t){t($L(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[hl,pl]},onRtl:function(){return[pl,hl]},onBottomLtr:function(){return[bl,vl]},onBottomRtl:function(){return[vl,bl]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:r["overflow-button"](),toolbar:r.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.splitToolbarBehaviours,[ZE.config({others:{overflowGroup:function(){return qL.sketch(D(D({},r["overflow-group"]()),{items:[o.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(G(e,t.getSystem().build)),XL(t,o,n)},refresh:function(t){return XL(t,o,n)},toggle:function(n){o.getOpt(n).each((function(n){VL.toggle(n)}))},isOpen:function(n){return o.getOpt(n).map(VL.isOpen).getOr(!1)},reposition:function(n){o.getOpt(n).each((function(n){VL.reposition(n)}))},getOverflow:function(n){return o.getOpt(n).bind(VL.getToolbar)}},domModification:{attributes:{role:"group"}}}},YL=ch({name:"SplitFloatingToolbar",configFields:ML(),partFields:IL(),factory:KL,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),JL=function(n,t){return t.getAnimationRoot.fold((function(){return n.element}),(function(t){return t(n)}))},QL=function(n){return n.dimension.property},ZL=function(n,t){return n.dimension.getDimension(t)},nz=function(n,t){var e=JL(n,t);Va(e,[t.shrinkingClass,t.growingClass])},tz=function(n,t){za(n.element,t.openClass),Pa(n.element,t.closedClass),Ka(n.element,QL(t),"0px"),oc(n.element)},ez=function(n,t){za(n.element,t.closedClass),Pa(n.element,t.openClass),rc(n.element,QL(t))},rz=function(n,t,e,r){e.setCollapsed(),Ka(n.element,QL(t),ZL(t,n.element)),oc(n.element),nz(n,t),tz(n,t),t.onStartShrink(n),t.onShrunk(n)},oz=function(n,t,e,r){var o=r.getOrThunk((function(){return ZL(t,n.element)}));e.setCollapsed(),Ka(n.element,QL(t),o),oc(n.element);var i=JL(n,t);za(i,t.growingClass),Pa(i,t.shrinkingClass),tz(n,t),t.onStartShrink(n)},iz=function(n,t,e){var r=ZL(t,n.element),o="0px"===r?rz:oz;o(n,t,e,N.some(r))},uz=function(n,t,e){var r=JL(n,t),o=ja(r,t.shrinkingClass),i=ZL(t,n.element);ez(n,t);var u=ZL(t,n.element),a=function(){Ka(n.element,QL(t),i),oc(n.element)},c=function(){tz(n,t)},s=o?a:c;s(),za(r,t.shrinkingClass),Pa(r,t.growingClass),ez(n,t),Ka(n.element,QL(t),u),e.setExpanded(),t.onStartGrow(n)},az=function(n,t,e){if(e.isExpanded()){rc(n.element,QL(t));var r=ZL(t,n.element);Ka(n.element,QL(t),r)}},cz=function(n,t,e){e.isExpanded()||uz(n,t,e)},sz=function(n,t,e){e.isExpanded()&&iz(n,t,e)},lz=function(n,t,e){e.isExpanded()&&rz(n,t,e,N.none())},fz=function(n,t,e){return e.isExpanded()},dz=function(n,t,e){return e.isCollapsed()},mz=function(n,t,e){var r=JL(n,t);return!0===ja(r,t.growingClass)},gz=function(n,t,e){var r=JL(n,t);return!0===ja(r,t.shrinkingClass)},pz=function(n,t,e){return mz(n,t)||gz(n,t)},hz=function(n,t,e){var r=e.isExpanded()?iz:uz;r(n,t,e)},vz=Object.freeze({__proto__:null,refresh:az,grow:cz,shrink:sz,immediateShrink:lz,hasGrown:fz,hasShrunk:dz,isGrowing:mz,isShrinking:gz,isTransitioning:pz,toggleGrow:hz,disableTransitions:nz}),bz=function(n,t,e){var r=t.expanded;return sa(r?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:lt(t.dimension.property,"0px")})},yz=function(n,t){return hi([_i(No(),(function(e,r){var o=r.event.raw;if(o.propertyName===n.dimension.property){nz(e,n),t.isExpanded()&&rc(e.element,n.dimension.property);var i=t.isExpanded()?n.onGrown:n.onShrunk;i(e)}}))])},wz=Object.freeze({__proto__:null,exhibit:bz,events:yz}),xz=[ye("closedClass"),ye("openClass"),ye("shrinkingClass"),ye("growingClass"),Ae("getAnimationRoot"),Ls("onShrunk"),Ls("onStartShrink"),Ls("onGrown"),Ls("onStartGrow"),Le("expanded",!1),we("dimension",ce("property",{width:[Vs("property","width"),Vs("getDimension",(function(n){return Ic(n)+"px"}))],height:[Vs("property","height"),Vs("getDimension",(function(n){return Cc(n)+"px"}))]}))],Sz=function(n){var t=Ke(n.expanded),e=function(){return"expanded: "+t.get()};return oa({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:x(t.set,!1),setExpanded:x(t.set,!0),readState:e})},Cz=Object.freeze({__proto__:null,init:Sz}),kz=Vl({fields:xz,name:"sliding",active:wz,apis:vz,state:Cz}),Oz=y([Fs(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ls("onOpened"),Ls("onClosed")].concat(BL())),Tz=y([Ep({factory:yL,schema:pL(),name:"primary"}),Ep({factory:yL,schema:pL(),name:"overflow",overrides:function(n){return{toolbarBehaviours:jl([kz.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Up(t,n,"overflow-button").each((function(n){Jy.off(n),By.focus(n)})),n.onClosed(t)},onGrown:function(t){fy.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Up(t,n,"overflow-button").each(Jy.on)}}),fy.config({mode:"acyclic",onEscape:function(t){return Up(t,n,"overflow-button").each(By.focus),N.some(!0)}})])}}}),_p({name:"overflow-button",overrides:function(n){return{buttonBehaviours:jl([Jy.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),_p({name:"overflow-group"})]),Dz=function(n,t){return Up(n,t,"overflow").map(kz.hasGrown).getOr(!1)},Ez=function(n,t){Up(n,t,"overflow-button").bind((function(){return Up(n,t,"overflow")})).each((function(e){_z(n,t),kz.toggleGrow(e)}))},_z=function(n,t){Up(n,t,"overflow").each((function(e){RL(n,t,(function(n){var t=G(n,(function(n){return wc(n)}));yL.setGroups(e,t)})),Up(n,t,"overflow-button").each((function(n){kz.hasGrown(e)&&Jy.on(n)})),kz.refresh(e)}))},Az=function(n,t,e,r){var o="alloy.toolbar.toggle",i=function(t,e){var r=G(e,t.getSystem().build);n.builtGroups.set(r)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.splitToolbarBehaviours,[ZE.config({others:{overflowGroup:function(n){return qL.sketch(D(D({},r["overflow-group"]()),{items:[Jw.sketch(D(D({},r["overflow-button"]()),{action:function(t){li(n,o)}}))]}))}}}),Cy("toolbar-toggle-events",[wi(o,(function(t){Ez(t,n)}))])]),apis:{setGroups:function(t,e){i(t,e),_z(t,n)},refresh:function(t){return _z(t,n)},toggle:function(t){return Ez(t,n)},isOpen:function(t){return Dz(t,n)}},domModification:{attributes:{role:"group"}}}},Rz=ch({name:"SplitSlidingToolbar",configFields:Oz(),partFields:Tz(),factory:Az,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)}}}),Bz=y(Pu("toolbar-height-change")),Mz=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}));return{dom:D({tag:"div",classes:["tox-toolbar__group"]},t),components:[qL.parts.items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:jl([nE.config({}),By.config({})])}},Iz=function(n){return qL.sketch(Mz(n))},Nz=function(n,t){var e=Ai((function(t){var e=G(n.initGroups,Iz);yL.setGroups(t,e)}));return jl([Kk.toolbarButton(n.providers.isDisabled),Wk(),fy.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),Cy("toolbar-events",[e])])},Fz=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":Mz({title:N.none(),items:[]}),"overflow-button":PI({name:"more",icon:N.some("more-drawer"),disabled:!1,tooltip:N.some("More..."),primary:!1,borderless:!1},N.none(),n.providers)},splitToolbarBehaviours:Nz(n,t)}},Pz=function(n){var t=Fz(n),e=4,r=YL.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return YL.sketch(D(D({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element,r=is(t),o=Ui(t),i=is(o),u=Math.max(o.dom.scrollHeight,i.height);return rs(r.x+e,i.y,r.width-2*e,u)},parts:D(D({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[r],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},Lz=function(n){var t=Rz.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=Rz.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=Fz(n);return Rz.sketch(D(D({},r),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([Bz()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([Bz()],{type:"closed"})}}))},zz=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return yL.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===aS.scrolling?["tox-toolbar--scrolling"]:[])},components:[yL.parts.groups({})],toolbarBehaviours:Nz(n,t)})},jz=zt([Se("type"),we("items",Ht([Jt([Se("name"),_e("items",me)]),me]))].concat(Ux)),Hz=function(n){return re("GroupToolbarButton",jz,n)},Vz=[Me("text"),Me("tooltip"),Me("icon"),Oe("fetch"),We("onSetup",(function(){return p}))],Uz=zt(_([Se("type")],Vz)),Wz=function(n){return re("menubutton",Uz,n)},Gz=zt([Se("type"),Me("tooltip"),Me("icon"),Me("text"),Ie("select"),Oe("fetch"),We("onSetup",(function(){return p})),Ve("presets","normal",["normal","color","listpreview"]),Le("columns",1),Oe("onAction"),Oe("onItemAction")]),qz=function(n){return re("SplitButton",Gz,n)},$z=function(n,t){var e=function(e,r){n.updateState.each((function(n){var o=n(e,r);t.set(o)})),n.renderComponents.each((function(n){var o=n(r,t.get()),i=G(o,e.getSystem().build);Lm(e,i)}))};return hi([wi(Vo(),(function(t,r){var o=r;if(!o.universal){var i=n.channel;H(o.channels,i)&&e(t,o.data)}})),Ai((function(t,r){n.initialData.each((function(n){e(t,n)}))}))])},Xz=Object.freeze({__proto__:null,events:$z}),Kz=function(n,t,e){return e},Yz=Object.freeze({__proto__:null,getState:Kz}),Jz=[ye("channel"),Ae("renderComponents"),Ae("updateState"),Ae("initialData")],Qz=function(){var n=Ke(N.none()),t=function(t){return n.set(t)},e=function(){return n.set(N.none())},r=function(){return n.get()},o=function(){return n.get().fold((function(){return"none"}),(function(n){return n}))};return{readState:o,get:r,set:t,clear:e}},Zz=Object.freeze({__proto__:null,init:Qz}),nj=Vl({fields:Jz,name:"reflecting",active:Xz,apis:Yz,state:Zz}),tj=y([ye("toggleClass"),ye("fetch"),js("onExecute"),Le("getHotspot",N.some),Le("getAnchorOverrides",y({})),Uf(),js("onItemExecute"),Ae("lazySink"),ye("dom"),Ls("onOpen"),Yg("splitDropdownBehaviours",[ZE,fy,By]),Le("matchWidth",!1),Le("useMinWidth",!1),Le("eventOrder",{}),Ae("role")].concat(g_())),ej=Ep({factory:Jw,schema:[ye("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:jl([By.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(di)},buttonBehaviours:jl([Jy.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),rj=Ep({factory:Jw,schema:[ye("dom")],name:"button",defaults:function(){return{buttonBehaviours:jl([By.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),oj=y([ej,rj,Ap({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ye("text")],name:"aria-descriptor"}),_p({schema:[Ns()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(r){n.onItemExecute(r,t,e)}))}}}}),t_()]),ij=function(n,t,e,r){var o,i=function(n){yh.getCurrent(n).each((function(n){zh.highlightFirst(n),fy.focusIn(n)}))},u=function(t){var e=i;c_(n,(function(n){return n}),t,r,e,TE.HighlightFirst).get(p)},a=function(n){return u(n),N.some(!0)},c=function(t){var e=Wp(t,n,"button");return di(e),N.some(!0)},s=D(D({},hi([Ai((function(t,e){var r=Up(t,n,"aria-descriptor");r.each((function(n){var e=Pu("aria");Cu(n.element,"id",e),Cu(t.element,"aria-describedby",e)}))}))])),Zy(N.some(u))),l={repositionMenus:function(n){Jy.isOn(n)&&m_(n)}};return{uid:n.uid,dom:n.dom,components:t,apis:l,eventOrder:D(D({},n.eventOrder),(o={},o[Uo()]=["disabling","toggling","alloy.base.behaviour"],o)),events:s,behaviours:Qg(n.splitDropdownBehaviours,[ZE.config({others:{sandbox:function(t){var e=Wp(t,n,"arrow"),r={onOpen:function(){Jy.on(e),Jy.on(t)},onClose:function(){Jy.off(e),Jy.off(t)}};return d_(n,t,r)}}}),fy.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),By.config({}),Jy.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},uj=ch({name:"SplitDropdown",configFields:tj(),partFields:oj(),factory:ij,apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),aj=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},cj=function(n){return{setActive:function(t){Jy.set(n,t)},isActive:function(){return Jy.isOn(n)},isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)}}},sj=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},lj=Pu("focus-button"),fj=["checklist","ordered-list"],dj=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],mj=function(n,t,e,r,o,i){var u,a=function(n){return RC.isRtl()&&H(fj,n)?n+"-rtl":n},c=RC.isRtl()&&n.exists((function(n){return H(dj,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:sj(e,i)},components:tO([n.map((function(n){return gI(a(n),i.icons)})),t.map((function(n){return hI(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[Co()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:jl([Kk.toolbarButton(i.isDisabled),Wk(),Cy("common-button-display-events",[wi(Co(),(function(n,t){t.event.prevent(),li(n,lj)}))])].concat(r.map((function(e){return nj.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return tO([n.icon.map((function(n){return gI(a(n),i.icons)})),n.text.map((function(n){return hI(n,"tox-tbtn",i)}))])}})})).toArray()).concat(o.getOr([])))}},gj=function(n,t,e,r){var o=t.shared;return VL.sketch({lazySink:o.getSink,fetch:function(){return NE.nu((function(t){t(G(e(n.items),Iz))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:mj(n.icon,n.text,n.tooltip,N.none(),N.none(),o.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:r}}}})},pj=function(n,t,e){var r=Ke(p),o=mj(n.icon,n.text,n.tooltip,N.none(),N.none(),e);return Jw.sketch({dom:o.dom,components:o.components,eventOrder:yI,buttonBehaviours:jl([Cy("toolbar-button-events",[bI({onAction:n.onAction,getApi:t.getApi}),Jk(t,r),Qk(t,r)]),Kk.toolbarButton((function(){return n.disabled||e.isDisabled()})),Wk()].concat(t.toolbarButtonBehaviours))})},hj=function(n,t){return vj(n,t,[])},vj=function(n,t,e){return pj(n,{toolbarButtonBehaviours:[].concat(e.length>0?[Cy("toolbarButtonWith",e)]:[]),getApi:aj,onSetup:n.onSetup},t)},bj=function(n,t){return yj(n,t,[])},yj=function(n,t,e){return Kn(pj(n,{toolbarButtonBehaviours:[xy.config({}),Jy.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[Cy("toolbarToggleButtonWith",e)]:[]),getApi:cj,onSetup:n.onSetup},t))},wj=function(n,t,e){return function(r){return NE.nu((function(n){return t.fetch(n)})).map((function(o){return N.from(cD(Kn(BT(Pu("menu-value"),o,(function(e){t.onItemAction(n(r),e)}),t.columns,t.presets,cS.CLOSE_ON_EXECUTE,t.select.getOr(k),e),{movement:IT(t.columns,t.presets),menuBehaviours:hC.unnamedEvents("auto"!==t.columns?[]:[Ai((function(n,e){mC(n,4,AS(t.presets)).each((function(t){var e=t.numRows,r=t.numColumns;fy.setGridSize(n,e,r)}))}))])})))}))}},xj=function(n,t){var e,r=Pu("channel-update-split-dropdown-display"),o=function(n){return{isDisabled:function(){return YC.isDisabled(n)},setDisabled:function(t){return YC.set(n,t)},setIconFill:function(t,e){gs(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Cu(n,"fill",e)}))},setIconStroke:function(t,e){gs(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Cu(n,"stroke",e)}))},setActive:function(t){n.getSystem().isConnected()&&(Cu(n.element,"aria-pressed",t),gs(n.element,"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return Jy.set(n,t)}))})))},isActive:function(){return gs(n.element,"span").exists((function(t){return!!n.getSystem().isConnected()&&n.getSystem().getByDom(t).exists(Jy.isOn)}))}}},i=Ke(p),u={getApi:o,onSetup:n.onSetup};return uj.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:D({"aria-pressed":!1},sj(n.tooltip,t.providers))},onExecute:function(t){n.onAction(o(t))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:jl([Kk.splitButton(t.providers.isDisabled),Wk(),Cy("split-dropdown-events",[wi(lj,By.focus),Jk(u,i),Qk(u,i)]),S_.config({})]),eventOrder:(e={},e[ni()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:wj(o,n,t.providers),parts:{menu:FS(!1,n.columns,n.presets)},components:[uj.parts.button(mj(n.icon,n.text,N.none(),N.some(r),N.some([Jy.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),uj.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:nx("chevron-down",t.providers.icons)},buttonBehaviours:jl([Kk.splitButton(t.providers.isDisabled),Wk()])}),uj.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},Sj=function(n){return{hide:function(){return li(n,$o())},getValue:function(){return Kg.getValue(n)}}},Cj=function(n,t){return wi(vI,(function(e,r){var o=n.get(e),i=Sj(o);t.onAction(i,r.event.buttonApi)}))},kj=function(n,t,e){var r=t.original,o=(r.primary,E(r,["primary"])),i=oe(Gx(D(D({},o),{type:"button",onAction:p})));return vj(i,e.backstage.shared.providers,[Cj(n,t)])},Oj=function(n,t,e){var r=t.original,o=(r.primary,E(r,["primary"])),i=oe(Xx(D(D({},o),{type:"togglebutton",onAction:p})));return yj(i,e.backstage.shared.providers,[Cj(n,t)])},Tj=function(n,t,e){var r={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===t.type?Oj(n,t,r):kj(n,t,r)},Dj=function(n,t,e){var r=G(t,(function(t){return Qw(Tj(n,t,e))})),o=function(){return G(r,(function(n){return n.asSpec()}))},i=function(n){return mn(t,(function(t,e){return t.primary?N.from(r[e]).bind((function(t){return t.getOpt(n)})).filter(S(YC.isDisabled)):N.none()}))};return{asSpecs:o,findPrimary:i}},Ej=function(n,t){var e=n.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),r=Qw(CE.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:jl([fy.config({mode:"special",onEnter:function(n){return o.findPrimary(n).map((function(n){return di(n),!0}))},onLeft:function(n,t){return t.cut(),N.none()},onRight:function(n,t){return t.cut(),N.none()}})])})),o=Dj(r,n.commands,t);return[{title:N.none(),items:[r.asSpec()]},{title:N.none(),items:o.asSpecs()}]},_j=function(n,t,e){return zz({type:n,uid:Pu("context-toolbar"),initGroups:Ej(t,e),onEscape:N.none,cyclicKeying:!0,providers:e})},Aj={renderContextForm:_j,buildInitGroups:Ej},Rj=function(n,t){var e=Math.max(t.x,n.x),r=n.right-e,o=t.width-(e-t.x),i=Math.min(r,o);return{x:e,width:i}},Bj=function(n,t,e,r){var o=tr.fromDom(n.getContainer()),i=gs(o,".tox-editor-header").getOr(o),u=os(i),a=u.y>=t.bottom,c=r&&!a;if(n.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(n.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=os(o);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}},Mj=function(n,t){var e=Xc(window),r=os(tr.fromDom(n.getContentAreaContainer())),o=fk(n)||dk(n)||gk(n),i=Rj(r,e),u=i.x,a=i.width;if(n.inline&&!o)return rs(u,e.y,a,e.height);var c=t.header.isPositionedAtTop(),s=Bj(n,r,e,c),l=s.y,f=s.bottom;return rs(u,l,a,f-l)},Ij=function(n,t){var e=K(t,(function(t){return t.predicate(n.dom)})),r=X(e,(function(n){return"contexttoolbar"===n.type})),o=r.pass,i=r.fail;return{contextToolbars:o,contextForms:i}},Nj=function(n){if(n.length<=1)return n;var t=function(t){return V(n,(function(n){return n.position===t}))},e=function(t){return K(n,(function(n){return n.position===t}))},r=t("selection"),o=t("node");if(r||o){if(o&&r){var i=e("node"),u=G(e("selection"),(function(n){return D(D({},n),{position:"node"})}));return i.concat(u)}return e(r?"selection":"node")}return e("line")},Fj=function(n){if(n.length<=1)return n;var t=function(t){return Z(n,(function(n){return n.position===t}))},e=t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position}));return e.fold((function(){return[]}),(function(t){return K(n,(function(n){return n.position===t}))}))},Pj=function(n,t,e){var r=Ij(n,t);if(r.contextForms.length>0)return N.some({elem:n,toolbars:[r.contextForms[0]]});var o=Ij(n,e);if(o.contextForms.length>0)return N.some({elem:n,toolbars:[o.contextForms[0]]});if(r.contextToolbars.length>0||o.contextToolbars.length>0){var i=Nj(r.contextToolbars.concat(o.contextToolbars));return N.some({elem:n,toolbars:i})}return N.none()},Lj=function(n,t,e){return n(t)?N.none():so(t,(function(n){var t=Ij(n,e.inNodeScope),r=t.contextToolbars,o=t.contextForms,i=o.length>0?o:Fj(r);return i.length>0?N.some({elem:n,toolbars:i}):N.none()}),n)},zj=function(n,t){var e=tr.fromDom(t.getBody()),r=function(n){return oo(n,e)},o=function(n){return!r(n)&&!ao(e,n)},i=tr.fromDom(t.selection.getNode());return o(i)?N.none():Pj(i,n.inNodeScope,n.inEditorScope).orThunk((function(){return Lj(r,i,n)}))},jj=function(n,t){var e={},r=[],o=[],i={},u={},a=function(n,a){var c=oe(eS(a));e[n]=c,c.launch.map((function(e){i["form:"+n]=D(D({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?o.push(c):r.push(c),u[n]=c},c=function(n,t){oS(t).each((function(e){"editor"===t.scope?o.push(e):r.push(e),u[n]=e}))},s=_n(n);return q(s,(function(t){var e=n[t];"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:r,inEditorScope:o,lookupTable:u,formNavigators:i}},Hj=Pu("forward-slide"),Vj=Pu("backward-slide"),Uj=Pu("change-slide-event"),Wj="tox-pop--resizing",Gj=function(n){var t=Ke([]);return Pw.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){t.set([]),Pw.getContent(n).each((function(n){rc(n.element,"visibility")})),za(n.element,Wj),rc(n.element,"width")},inlineBehaviours:jl([Cy("context-toolbar-events",[_i(No(),(function(n,t){za(n.element,Wj),rc(n.element,"width")})),wi(Uj,(function(n,t){var e=n.element;rc(e,"width");var r=Ic(e);Pw.setContent(n,t.event.contents),Pa(e,Wj);var o=Ic(e);Ka(e,"width",r+"px"),Pw.getContent(n).each((function(n){t.event.focus.bind((function(n){return Yl(n),nf(e)})).orThunk((function(){return fy.focusIn(n),Zl(tu(e))}))})),Kw.setTimeout((function(){Ka(n.element,"width",o+"px")}),0)})),wi(Hj,(function(n,e){Pw.getContent(n).each((function(e){t.set(t.get().concat([{bar:e,focus:Zl(tu(n.element))}]))})),fi(n,Uj,{contents:e.event.forwardContents,focus:N.none()})})),wi(Vj,(function(n,e){fn(t.get()).each((function(e){t.set(t.get().slice(0,t.get().length-1)),fi(n,Uj,{contents:wc(e.bar),focus:e.focus})}))}))]),fy.config({mode:"special",onEscape:function(e){return fn(t.get()).fold((function(){return n.onEscape()}),(function(n){return li(e,Vj),N.some(!0)}))}})]),lazySink:function(){return vn.value(n.sink)}})},qj=function(n,t,e){var r=function(n,r,i,u){var a=t.shared.providers.translate(n.title);if("separator"===n.type)return N.some({type:"separator",text:a});if("submenu"===n.type){var c=en(n.getStyleItems(),(function(n){return o(n,r,u)}));return 0===r&&c.length<=0?N.none():N.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return en(n.getStyleItems(),(function(n){return o(n,r,u)}))}})}return N.some(D({type:"togglemenuitem",text:a,icon:n.icon,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},o=function(n,t,o){var i="formatter"===n.type&&e.isInvalid(n);return 0===t?i?[]:r(n,t,!1,o).toArray():r(n,t,i,o).toArray()},i=function(n){var t=e.getCurrentValue(),r=e.shouldHide?0:1;return en(n,(function(n){return o(n,r,t)}))},u=function(n,t){return function(e,r){var o=t(),u=i(o),a=BI(u,cS.CLOSE_ON_EXECUTE,n,!1);r(a)}};return{validateItems:i,getFetch:u}},$j=function(n,t,e){var r=e.dataset,o="basic"===r.type?function(){return G(r.data,(function(n){return yP(n,e.isSelectedFor,e.getPreviewFor)}))}:r.getData;return{items:qj(n,t,e),getStyleItems:o}},Xj=function(n,t,e){var r=$j(n,t,e),o=r.items,i=r.getStyleItems,u=function(n){return{getComponent:y(n)}},a=function(t){var r=function(){var n=t.getComponent();n.getSystem().isConnected()&&e.updateText(n)};return r(),n.on("NodeChange",r),function(){n.off("NodeChange",r)}};return SI({text:e.icon.isSome()?N.none():N.some(""),icon:e.icon,tooltip:N.from(e.tooltip),role:N.none(),fetch:o.getFetch(t,i),onSetup:a,getApi:u,columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},Kj=function(n){return G(n,(function(n){var t=n,e=n,r=n.split("=");return r.length>1&&(t=r[0],e=r[1]),{title:t,format:e}}))},Yj=function(n){return{type:"basic",data:n}};(function(n){n[n["SemiColon"]=0]="SemiColon",n[n["Space"]=1]="Space"})(FN||(FN={}));var Jj,Qj=function(n,t){return t===FN.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")},Zj=function(n,t,e,r){var o=n.getParam(t,e,"string"),i=Kj(Qj(o,r));return{type:"basic",data:i}},nH=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],tH=function(n){var t=function(){return Z(nH,(function(t){return n.formatter.match(t.format)}))},e=function(t){return function(){return n.formatter.match(t)}},r=function(n){return function(){return N.none()}},o=function(n){var e=t(),r=e.fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));fi(n,xI,{icon:"align-"+r})},i=Yj(nH),u=function(t){return function(){return Z(nH,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}};return{tooltip:"Align",icon:N.some("align-left"),isSelectedFor:e,getCurrentValue:N.none,getPreviewFor:r,onAction:u,updateText:o,dataset:i,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},eH=function(n,t){return Xj(n,t,tH(n))},rH=function(n,t){var e=$j(n,t,tH(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},oH="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",iH=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],uH=function(n){var t=n.split(/\s*,\s*/);return G(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},aH=function(n){var t=function(){var t=uH(n.toLowerCase());return rn(iH,(function(n){return t.indexOf(n.toLowerCase())>-1}))};return 0===n.indexOf("-apple-system")&&t()},cH=function(n){var t=function(){var t=function(n){return n?uH(n)[0]:""},e=n.queryCommandValue("FontName"),r=a.data,o=e?e.toLowerCase():"",i=Z(r,(function(n){var e=n.format;return e.toLowerCase()===o||t(e).toLowerCase()===t(o).toLowerCase()})).orThunk((function(){return aH(o)?N.from({title:"System Font",format:o}):N.none()}));return{matchOpt:i,font:e}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},r=function(){var n=t().matchOpt;return n},o=function(n){return function(){return N.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},u=function(n){var e=t(),r=e.matchOpt,o=e.font,i=r.fold((function(){return o}),(function(n){return n.title}));fi(n,wI,{text:i})},a=Zj(n,"font_formats",oH,FN.SemiColon);return{tooltip:"Fonts",icon:N.none(),isSelectedFor:e,getCurrentValue:r,getPreviewFor:o,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:k}},sH=function(n,t){return Xj(n,t,cH(n))},lH=function(n,t){var e=$j(n,t,cH(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},fH="8pt 10pt 12pt 14pt 18pt 24pt 36pt",dH={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},mH={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},gH=function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e},pH=function(n,t){return/[0-9.]+px$/.test(n)?gH(72*parseInt(n,10)/96,t||0)+"pt":jn(mH,n).getOr(n)},hH=function(n){return jn(dH,n).getOr("")},vH=function(n){var t=function(){var t=N.none(),e=a.data,r=n.queryCommandValue("FontSize");if(r)for(var o=function(n){var o=pH(r,n),i=hH(o);t=Z(e,(function(n){return n.format===r||n.format===o||n.format===i}))},i=3;t.isNone()&&i>=0;i--)o(i);return{matchOpt:t,size:r}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},r=function(){var n=t().matchOpt;return n},o=y(N.none),i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},u=function(n){var e=t(),r=e.matchOpt,o=e.size,i=r.fold((function(){return o}),(function(n){return n.title}));fi(n,wI,{text:i})},a=Zj(n,"fontsize_formats",fH,FN.Space);return{tooltip:"Font sizes",icon:N.none(),isSelectedFor:e,getPreviewFor:o,getCurrentValue:r,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:k}},bH=function(n,t){return Xj(n,t,vH(n))},yH=function(n,t){var e=$j(n,t,vH(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},wH=function(n,t){var e=t(),r=G(e,(function(n){return n.format}));return N.from(n.formatter.closest(r)).bind((function(n){return Z(e,(function(t){return t.format===n}))})).orThunk((function(){return gh(n.formatter.match("p"),{title:"Paragraph",format:"p"})}))},xH=function(n){var t=Ke(N.none()),e=function(){return t.get().each(n)},r=function(){e(),t.set(N.none())},o=function(){return t.get().isSome()},i=function(n){e(),t.set(N.some(n))};return{clear:r,isSet:o,set:i}},SH=function(){return xH((function(n){return n.destroy()}))},CH=function(){return xH((function(n){return n.unbind()}))},kH=function(){var n=Ke(N.none()),t=function(){return n.set(N.none())},e=function(t){return n.set(N.some(t))},r=function(){return n.get().isSome()},o=function(t){return n.get().each(t)};return{clear:t,set:e,isSet:r,on:o}},OH=function(n,t){return function(e){var r=CH(),o=function(){e.setActive(n.formatter.match(t));var o=n.formatter.formatChanged(t,e.setActive);r.set(o)};return n.initialized?o():n.on("init",o),r.clear}},TH=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},DH="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",EH=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return N.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},r=function(t){var e=wH(n,(function(){return o.data})),r=e.fold((function(){return"Paragraph"}),(function(n){return n.title}));fi(t,wI,{text:r})},o=Zj(n,"block_formats",DH,FN.SemiColon);return{tooltip:"Blocks",icon:N.none(),isSelectedFor:t,getCurrentValue:N.none,getPreviewFor:e,onAction:TH(n),updateText:r,dataset:o,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},_H=function(n,t){return Xj(n,t,EH(n))},AH=function(n,t){var e=$j(n,t,EH(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},RH=function(n,t){var e=function(t){return function(){return n.formatter.match(t)}},r=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?N.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):N.none()}},o=function(t){var e=function(n){var t=n.items;return void 0!==t&&t.length>0?en(t,e):[{title:n.title,format:n.format}]},r=en(bP(n),e),o=wH(n,(function(){return r})),i=o.fold((function(){return"Paragraph"}),(function(n){return n.title}));fi(t,wI,{text:i})};return{tooltip:"Formats",icon:N.none(),isSelectedFor:e,getCurrentValue:N.none,getPreviewFor:r,onAction:TH(n),updateText:o,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},BH=function(n,t){var e=D({type:"advanced"},t.styleselect);return Xj(n,t,RH(n,e))},MH=function(n,t){var e=D({type:"advanced"},t.styleselect),r=$j(n,t,RH(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})},IH=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],NH=function(n,t){return function(e,r,o){var i=n(e).mapError((function(n){return ue(n)})).getOrDie();return t(i,r,o)}},FH={button:NH(Gx,(function(n,t){return hj(n,t.backstage.shared.providers)})),togglebutton:NH(Xx,(function(n,t){return bj(n,t.backstage.shared.providers)})),menubutton:NH(Wz,(function(n,t){return II(n,"tox-tbtn",t.backstage,N.none())})),splitbutton:NH(qz,(function(n,t){return xj(n,t.backstage.shared)})),grouptoolbarbutton:NH(Hz,(function(n,t,e){var r,o=e.ui.registry.getAll().buttons,i=function(n){return WH(e,{buttons:o,toolbar:n,allowToolbarGroups:!1},t,N.none())},u=(r={},r[Hf]=t.backstage.shared.header.isPositionedAtTop()?xs.TopToBottom:xs.BottomToTop,r);switch(hk(e)){case aS.floating:return gj(n,t.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return BH(n,t.backstage)},fontsizeSelectButton:function(n,t){return bH(n,t.backstage)},fontSelectButton:function(n,t){return sH(n,t.backstage)},formatButton:function(n,t){return _H(n,t.backstage)},alignMenuButton:function(n,t){return eH(n,t.backstage)}},PH=function(n,t,e){return jn(FH,n.type).fold((function(){return N.none()}),(function(r){return N.some(r(n,t,e))}))},LH={styleselect:FH.styleSelectButton,fontsizeselect:FH.fontsizeSelectButton,fontselect:FH.fontSelectButton,formatselect:FH.formatButton,align:FH.alignMenuButton},zH=function(n){var t=G(IH,(function(t){var e=K(t.items,(function(t){return Hn(n,t)||Hn(LH,t)}));return{name:t.name,items:e}}));return K(t,(function(n){return n.items.length>0}))},jH=function(n){var t=n.split("|");return G(t,(function(n){return{items:n.trim().split(" ")}}))},HH=function(n){return g(n,(function(n){return Hn(n,"name")&&Hn(n,"items")}))},VH=function(n){var t=n.toolbar,e=n.buttons;return!1===t?[]:void 0===t||!0===t?zH(e):i(t)?jH(t):HH(t)?t:[]},UH=function(n,t,e,r,o,i){return jn(t,e.toLowerCase()).orThunk((function(){return i.bind((function(n){return mn(n,(function(n){return jn(t,n+e.toLowerCase())}))}))})).fold((function(){return jn(LH,e.toLowerCase()).map((function(t){return t(n,o)})).orThunk((function(){return N.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||r?PH(t,o,n):N.none()}))},WH=function(n,t,e,r){var o=VH(t),i=G(o,(function(o){var i=en(o.items,(function(o){return 0===o.trim().length?[]:UH(n,t.buttons,o,t.allowToolbarGroups,e,r).toArray()}));return{title:N.from(n.translate(o.name)),items:i}}));return K(i,(function(n){return n.items.length>0}))},GH=12,qH={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},$H={maxHeightFunction:Af(),maxWidthFunction:dL()},XH={onLtr:function(){return[yl,wl,vl,pl,bl,hl,$w,Xw,Gw,Uw,qw,Ww]},onRtl:function(){return[yl,wl,bl,hl,vl,pl,$w,Xw,qw,Ww,Gw,Uw]}},KH={onLtr:function(){return[wl,pl,hl,vl,bl,yl,$w,Xw,Gw,Uw,qw,Ww]},onRtl:function(){return[wl,hl,pl,bl,vl,yl,$w,Xw,qw,Ww,Gw,Uw]}},YH=function(n,t){return"line"===n?{bubble:Nf(GH,0,qH),layouts:{onLtr:function(){return[xl]},onRtl:function(){return[Sl]}},overrides:$H}:{bubble:Nf(0,GH,qH),layouts:t?KH:XH,overrides:$H}},JH=function(n,t,e,r){var o=$r().deviceType.isTouch,i=yc(Gj({sink:e,onEscape:function(){return n.focus(),N.some(!0)}})),u=function(){return Mj(n,r.backstage.shared)},a=function(n,t,e,r){return Math.max(n,e)<=Math.min(t,r)},c=function(){var t=g.get().filter((function(n){return Wa(tr.fromDom(n))})).map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Wc().top:is(tr.fromDom(n.getBody())).y;return{y:t.top+e,bottom:t.bottom+e}},s=function(){if(o()&&r.backstage.isContextMenuOpen())return!0;var n=c(),t=u();return!a(n.y,n.bottom,t.y,t.bottom)},l=function(){m.set(N.none()),Pw.hide(i)},f=function(){Pw.hide(i)},d=function(){m.get().each((function(n){var t=i.element;rc(t,"display"),s()?Ka(t,"display","none"):Mm.positionWithinBounds(e,n,i,N.some(u()))}))},m=Ke(N.none()),g=Ke(N.none()),h=Ke(null),v=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:jl([fy.config({mode:"acyclic"}),Cy("pop-dialog-wrap-events",[Ai((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return fy.focusIn(t)}))})),Ri((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},b=Jn((function(){return jj(t,(function(n){var t=x([n]);fi(i,Hj,{forwardContents:v(t)})}))})),y=function(t,e){return WH(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},r,N.some(["form:"]))},w=function(n,t){return Aj.buildInitGroups(n,t)},x=function(t){var e=n.ui.registry.getAll().buttons,o=b(),i=D(D({},e),o.formNavigators),u=hk(n)===aS.scrolling?aS.scrolling:aS.default,a=tn(G(t,(function(n){return"contexttoolbar"===n.type?y(i,n):w(n,r.backstage.shared.providers)})));return zz({type:u,uid:Pu("context-toolbar"),initGroups:a,onEscape:N.none,cyclicKeying:!0,providers:r.backstage.shared.providers})};n.on(mL,(function(t){var e=b();jn(e.lookupTable,t.toolbarKey).each((function(e){C([e],t.target===n?N.none():N.some(t)),Pw.getContent(i).each(fy.focusIn)}))}));var S=function(n,t){var e="node"===n?r.backstage.shared.anchors.node(t):r.backstage.shared.anchors.cursor();return Kn(e,YH(n,o()))},C=function(n,t){if(O(),!o()||!r.backstage.isContextMenuOpen()){var e=x(n),a=t.map(tr.fromDom),c=S(n[0].position,a);m.set(N.some(c)),g.set(t);var l=i.element;rc(l,"display"),Pw.showWithinBounds(i,c,v(e),(function(){return N.some(u())})),s()&&Ka(l,"display","none")}},k=function(){if(n.hasFocus()){var t=b();zj(t,n).fold(l,(function(n){C(n.toolbars,N.some(n.elem.dom))}))}},O=function(){var n=h.get();null!==n&&(Kw.clearTimeout(n),h.set(null))},T=function(){O(),h.set(Kw.setEditorTimeout(n,k,0))};n.on("init",(function(){n.on(gL,f),n.on("ScrollContent ScrollWindow longpress",d),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){T()})),n.on("focusout",(function(t){Kw.setEditorTimeout(n,(function(){nf(e.element).isNone()&&nf(i.element).isNone()&&l()}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&l()})),n.on("AfterProgressState",(function(t){t.state?l():n.hasFocus()&&T()})),n.on("NodeChange",(function(n){nf(i.element).fold(T,p)}))}))},QH=function(n,t,e){var r=function(n,r){q([t,e],(function(t){t.broadcastEvent(n,r)}))},o=function(n,r){q([t,e],(function(t){t.broadcastOn([n],r)}))},i=function(n){return o(gg(),{target:n.target})},u=mD(tr.fromDom(document),"touchstart",i),a=mD(tr.fromDom(document),"touchmove",(function(n){return r(Yo(),n)})),c=mD(tr.fromDom(document),"touchend",(function(n){return r(Jo(),n)})),s=mD(tr.fromDom(document),"mousedown",i),l=mD(tr.fromDom(document),"mouseup",(function(n){0===n.raw.button&&o(hg(),{target:n.target})})),f=function(n){return o(gg(),{target:tr.fromDom(n.target)})},d=function(n){0===n.button&&o(hg(),{target:tr.fromDom(n.target)})},m=function(n){return r(Qo(),pD(n))},g=function(n){o(pg(),{}),r(Zo(),pD(n))},p=function(){return o(pg(),{})},h=function(t){t.state&&o(gg(),{target:tr.fromDom(n.getContainer())})};n.on("PostRender",(function(){n.on("click",f),n.on("tap",f),n.on("mouseup",d),n.on("ScrollWindow",m),n.on("ResizeWindow",g),n.on("ResizeEditor",p),n.on("AfterProgressState",h)})),n.on("remove",(function(){n.off("click",f),n.off("tap",f),n.off("mouseup",d),n.off("ScrollWindow",m),n.off("ResizeWindow",g),n.off("ResizeEditor",p),n.off("AfterProgressState",h),s.unbind(),u.unbind(),a.unbind(),c.unbind(),l.unbind()})),n.on("detach",(function(){$m(t),$m(e),t.destroy(),e.destroy()}))},ZH=Jp,nV=Mp,tV=y([Le("shell",!1),ye("makeItem"),Le("setupItem",p),Zg.field("listBehaviours",[xy])]),eV=function(){return{behaviours:jl([xy.config({})])}},rV=Ap({name:"items",overrides:eV}),oV=y([rV]),iV=y("CustomList"),uV=function(n,t,e,r){var o=function(t,e){u(t).fold((function(){throw new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(r){var o=xy.contents(r),i=e.length,u=i-o.length,a=u>0?U(u,(function(){return n.makeItem()})):[],c=o.slice(i);q(c,(function(n){return xy.remove(r,n)})),q(a,(function(n){return xy.append(r,n)}));var s=xy.contents(r);q(s,(function(r,o){n.setupItem(t,r,e[o],o)}))}))},i=n.shell?{behaviours:[xy.config({})],components:[]}:{behaviours:[],components:t},u=function(t){return n.shell?N.some(t):Up(t,n,"items")};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:Qg(n.listBehaviours,i.behaviours),apis:{setItems:o}}},aV=ch({name:iV(),configFields:tV(),partFields:oV(),factory:uV,apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),cV=p,sV=k,lV=y([]),fV=Object.freeze({__proto__:null,setup:cV,isDocked:sV,getBehaviours:lV}),dV=function(n){var t=nc(n,"position").is("fixed"),e=t?N.none():$i(n);return e.orThunk((function(){var t=tr.fromTag("span");return Gi(n).bind((function(n){fu(n,t);var e=$i(t);return hu(t),e}))}))},mV=function(n){return dV(n).map(Ac).getOrThunk((function(){return Dc(0,0)}))},gV=Wn.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),pV=function(n,t){var e=n.element;Pa(e,t.transitionClass),za(e,t.fadeOutClass),Pa(e,t.fadeInClass),t.onShow(n)},hV=function(n,t){var e=n.element;Pa(e,t.transitionClass),za(e,t.fadeInClass),Pa(e,t.fadeOutClass),t.onHide(n)},vV=function(n,t){return n.y<t.bottom&&n.bottom>t.y},bV=function(n,t){return n.y>=t.y},yV=function(n,t){return n.bottom<=t.bottom},wV=function(n,t,e){return rn(n,(function(n){switch(n){case"bottom":return yV(t,e);case"top":return bV(t,e)}}))},xV=function(n,t){return t.getInitialPosition().map((function(t){return rs(t.bounds.x,t.bounds.y,Ic(n),Cc(n))}))},SV=function(n,t,e){e.setInitialPosition(N.some({style:tc(n),position:Qa(n,"position")||"static",bounds:t}))},CV=function(n,t,e){return e.getInitialPosition().bind((function(r){switch(e.setInitialPosition(N.none()),r.position){case"static":return N.some(gV.static());case"absolute":var o=dV(n).map(os).getOrThunk((function(){return os(Ga())}));return N.some(gV.absolute(ef("absolute",jn(r.style,"left").map((function(n){return t.x-o.x})),jn(r.style,"top").map((function(n){return t.y-o.y})),jn(r.style,"right").map((function(n){return o.right-t.right})),jn(r.style,"bottom").map((function(n){return o.bottom-t.bottom})))));default:return N.none()}}))},kV=function(n,t,e){return xV(n,e).filter((function(n){return wV(e.getModes(),n,t)})).bind((function(t){return CV(n,t,e)}))},OV=function(n,t,e){var r=os(n);if(wV(e.getModes(),r,t))return N.none();SV(n,r,e);var o=us(),i=r.x-o.x,u=t.y-o.y,a=o.bottom-t.bottom,c=r.y<=t.y;return N.some(gV.fixed(ef("fixed",N.some(i),c?N.some(u):N.none(),N.none(),c?N.none():N.some(a))))},TV=function(n,t,e){var r=n.element,o=nc(r,"position").is("fixed");return o?kV(r,t,e):OV(r,t,e)},DV=function(n,t){var e=n.element;return xV(e,t).bind((function(n){return CV(e,n,t)}))},EV=function(n,t){q(["left","right","top","bottom","position"],(function(t){return rc(n.element,t)})),t.onUndocked(n)},_V=function(n,t,e){rf(n.element,e);var r="fixed"===e.position?t.onDocked:t.onUndocked;r(n)},AV=function(n,t,e,r,o){void 0===o&&(o=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=vV(i,r);if(u!==e.isVisible())if(e.setVisible(u),o&&!u)Ha(n.element,[t.fadeOutClass]),t.onHide(n);else{var a=u?pV:hV;a(n,t)}}))}))},RV=function(n,t,e){var r=t.lazyViewport(n),o=e.isDocked();o&&AV(n,t,e,r),TV(n,r,e).each((function(i){e.setDocked(!o),i.fold((function(){return EV(n,t)}),(function(e){return _V(n,t,e)}),(function(o){AV(n,t,e,r,!0),_V(n,t,o)}))}))},BV=function(n,t,e){var r=n.element;e.setDocked(!1),DV(n,e).each((function(e){e.fold((function(){return EV(n,t)}),(function(e){return _V(n,t,e)}),p)})),e.setVisible(!0),t.contextual.each((function(t){Va(r,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),MV(n,t,e)},MV=function(n,t,e){n.getSystem().isConnected()&&RV(n,t,e)},IV=function(n,t,e){e.isDocked()&&BV(n,t,e)},NV=function(n,t,e){return e.isDocked()},FV=function(n,t,e,r){return e.setModes(r)},PV=function(n,t,e){return e.getModes()},LV=Object.freeze({__proto__:null,refresh:MV,reset:IV,isDocked:NV,getModes:PV,setModes:FV}),zV=function(n,t){return hi([_i(No(),(function(e,r){n.contextual.each((function(n){if(ja(e.element,n.transitionClass)){Va(e.element,[n.transitionClass,n.fadeInClass]);var o=t.isVisible()?n.onShown:n.onHidden;o(e)}r.stop()}))})),wi(Qo(),(function(e,r){MV(e,n,t)})),wi(Zo(),(function(e,r){IV(e,n,t)}))])},jV=Object.freeze({__proto__:null,events:zV}),HV=[Fe("contextual",[Se("fadeInClass"),Se("fadeOutClass"),Se("transitionClass"),Oe("lazyContext"),Ls("onShow"),Ls("onShown"),Ls("onHide"),Ls("onHidden")]),We("lazyViewport",us),qe("modes",["top","bottom"],me),Ls("onDocked"),Ls("onUndocked")],VV=function(n){var t=Ke(!1),e=Ke(!0),r=Ke(N.none()),o=Ke(n.modes),i=function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+o.get().join(",")};return oa({isDocked:t.get,setDocked:t.set,getInitialPosition:r.get,setInitialPosition:r.set,isVisible:e.get,setVisible:e.set,getModes:o.get,setModes:o.set,readState:i})},UV=Object.freeze({__proto__:null,init:VV}),WV=Vl({fields:HV,name:"docking",active:jV,apis:LV,state:UV}),GV={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},qV="tox-tinymce--toolbar-sticky-on",$V="tox-tinymce--toolbar-sticky-off",XV=function(n,t){var e=Hi(t),r=e.dom.defaultView.innerHeight,o=Wc(e),i=tr.fromDom(n.elm),u=is(i),a=Cc(i),c=u.y,s=c+a,l=Ac(t),f=Cc(t),d=l.top,m=d+f,g=Math.abs(d-o.top)<2,p=Math.abs(m-(o.top+r))<2;if(g&&c<m)Gc(o.left,c-f,e);else if(p&&s>d){var h=c-r+a+f;Gc(o.left,h,e)}},KV=function(n,t){return H(WV.getModes(n),t)},YV=function(n){var t=function(n){return kc(n)+(parseInt(Qa(n,"margin-top"),10)||0)+(parseInt(Qa(n,"margin-bottom"),10)||0)},e=n.element;Gi(e).each((function(r){var o="padding-"+WV.getModes(n)[0];if(WV.isDocked(n)){var i=Ic(r);Ka(e,"width",i+"px"),Ka(r,o,t(e)+"px")}else rc(e,"width"),rc(r,o)}))},JV=function(n,t){t?(za(n,GV.fadeOutClass),Ha(n,[GV.transitionClass,GV.fadeInClass])):(za(n,GV.fadeInClass),Ha(n,[GV.fadeOutClass,GV.transitionClass]))},QV=function(n,t){var e=tr.fromDom(n.getContainer());t?(Pa(e,qV),za(e,$V)):(Pa(e,$V),za(e,qV))},ZV=function(n,t){var e=Hi(t);Zl(e).filter((function(n){return!oo(t,n)})).filter((function(t){return oo(t,tr.fromDom(e.dom.body))||ao(n,t)})).each((function(){return Yl(t)}))},nU=function(n,t){return nf(n).orThunk((function(){return t().toOptional().bind((function(n){return nf(n.element)}))}))},tU=function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(WV.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(YV)})),n.on("SkinLoaded",(function(){e().each((function(n){WV.isDocked(n)?WV.reset(n):WV.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(WV.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(t){WV.refresh(t);var e=t.element;Mv(e)&&XV(n,e)}))})),n.on("PostRender",(function(){QV(n,!1)}))},eU=function(n){return n().map(WV.isDocked).getOr(!1)},rU=function(){var n;return[ql.config({channels:(n={},n[Bz()]={onReceive:YV},n)})]},oU=function(n,t){var e=Ke(N.none()),r=t.getSink,o=function(n){r().each((function(t){return n(t.element)}))},i=function(t){n.inline||YV(t),QV(n,WV.isDocked(t)),t.getSystem().broadcastOn([pg()],{}),r().each((function(n){return n.getSystem().broadcastOn([pg()],{})}))},u=n.inline?[]:rU();return _([By.config({}),WV.config({contextual:D({lazyContext:function(t){var e=kc(t.element),r=n.inline?n.getContentAreaContainer():n.getContainer(),o=os(tr.fromDom(r)),i=o.height-e,u=o.y+(KV(t,"top")?0:e);return N.some(rs(o.x,u,o.width,i))},onShow:function(){o((function(n){return JV(n,!0)}))},onShown:function(n){o((function(n){return Va(n,[GV.transitionClass,GV.fadeInClass])})),e.get().each((function(t){ZV(n.element,t),e.set(N.none())}))},onHide:function(n){e.set(nU(n.element,r)),o((function(n){return JV(n,!1)}))},onHidden:function(){o((function(n){return Va(n,[GV.transitionClass])}))}},GV),modes:[t.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},iU=Object.freeze({__proto__:null,setup:tU,isDocked:eU,getBehaviours:oU}),uU=function(n){var t=n.editor,e=n.sticky?oU:lV;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:jl(e(t,n.sharedBackstage))}},aU=function(n,t){var e=function(n,e){var r=G(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},r=Wz(e).mapError((function(n){return ue(n)})).getOrDie();return II(r,"tox-mbtn",t.backstage,N.some("menuitem"))}));xy.set(n,r)},r={focus:fy.focusIn,setMenus:e};return{uid:n.uid,dom:n.dom,components:[],behaviours:jl([xy.config({}),Cy("menubar-events",[Ai((function(t){n.onSetup(t)})),wi(Do(),(function(n,t){gs(n.element,".tox-mbtn--active").each((function(e){ps(t.event.target,".tox-mbtn").each((function(t){oo(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){b_.expand(n),b_.close(e),By.focus(n)}))}))}))}))})),wi(oi(),(function(n,t){t.event.prevFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(e){t.event.newFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(n){b_.isOpen(e)&&(b_.expand(n),b_.close(e))}))}))}))]),fy.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),N.some(!0)}}),nE.config({})]),apis:r,domModification:{attributes:{role:"menubar"}}}},cU=ah({factory:aU,name:"silver.Menubar",configFields:[ye("dom"),ye("uid"),ye("onEscape"),ye("backstage"),Le("onSetup",p)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),sU="container",lU=[Yg("slotBehaviours",[])],fU=function(n){return"<alloy.field."+n+">"},dU=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Lp(sU,fU(t),e)};return{slot:t,record:function(){return n}}}(),e=n(t),r=t.record(),o=G(r,(function(n){return Ep({name:n,pname:fU(n)})}));return th(sU,lU,o,mU,e)},mU=function(n,t){var e=function(t){return $p(n)},r=function(t,e){return Up(t,n,e)},o=function(t,e){return function(r,o){return Up(r,n,o).map((function(n){return t(n,o)})).getOr(e)}},i=function(n){return function(t,e){q(e,(function(e){return n(t,e)}))}},u=function(n,t){return"true"!==Ou(n.element,"aria-hidden")},a=function(n,t){if(!u(n)){var e=n.element;rc(e,"display"),Eu(e,"aria-hidden"),fi(n,ii(),{name:t,visible:!0})}},c=function(n,t){if(u(n)){var e=n.element;Ka(e,"display","none"),Cu(e,"aria-hidden","true"),fi(n,ii(),{name:t,visible:!1})}},s=o(u,!1),l=o(c),f=i(l),d=function(n){return f(n,e())},m=o(a),g={getSlotNames:e,getSlot:r,isShowing:s,hideSlot:l,hideAllSlots:d,showSlot:m};return{uid:n.uid,dom:n.dom,components:t,behaviours:Jg(n.slotBehaviours),apis:g}},gU=Bn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return ea(n)})),pU=D(D({},gU),{sketch:dU}),hU=zt([Me("icon"),Me("tooltip"),We("onShow",p),We("onHide",p),We("onSetup",(function(){return p}))]),vU=function(n){return re("sidebar",hU,n)},bU=function(n){var t=n.ui.registry.getAll().sidebars;q(_n(t),(function(e){var r=t[e],o=function(){return N.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:r.icon,tooltip:r.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(o())},onSetup:function(t){var e=function(){return t.setActive(o())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))},yU=function(n){return{element:function(){return n.element.dom}}},wU=function(n,t){var e=G(_n(t),(function(n){var e=t[n],r=oe(vU(e));return{name:n,getApi:yU,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}}));return G(e,(function(t){var r=Ke(p);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:hC.unnamedEvents([Jk(t,r),Qk(t,r),wi(ii(),(function(n,t){var r=t.event,o=Z(e,(function(n){return n.name===r.name}));o.each((function(t){var e=r.visible?t.onShow:t.onHide;e(t.getApi(n))}))}))])})}))},xU=function(n){return pU.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:wU(t,n),slotBehaviours:hC.unnamedEvents([Ai((function(n){return pU.hideAllSlots(n)}))])}}))},SU=function(n,t){var e=yh.getCurrent(n);e.each((function(n){return xy.set(n,[xU(t)])}))},CU=function(n,t){var e=yh.getCurrent(n);e.each((function(n){var e=yh.getCurrent(n);e.each((function(e){kz.hasGrown(n)?pU.isShowing(e,t)?kz.shrink(n):(pU.hideAllSlots(e),pU.showSlot(e,t)):(pU.hideAllSlots(e),pU.showSlot(e,t),kz.grow(n))}))}))},kU=function(n){var t=yh.getCurrent(n);return t.bind((function(n){var t=kz.isGrowing(n)||kz.hasGrown(n);if(t){var e=yh.getCurrent(n);return e.bind((function(n){return Z(pU.getSlotNames(n),(function(t){return pU.isShowing(n,t)}))}))}return N.none()}))},OU=Pu("FixSizeEvent"),TU=Pu("AutoSizeEvent"),DU=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:jl([nE.config({}),By.config({}),kz.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){var t=yh.getCurrent(n);t.each(pU.hideAllSlots),li(n,TU)},onGrown:function(n){li(n,TU)},onStartGrow:function(n){fi(n,OU,{width:nc(n.element,"width").getOr("")})},onStartShrink:function(n){fi(n,OU,{width:Ic(n.element)+"px"})}}),xy.config({}),yh.config({find:function(n){var t=xy.contents(n);return ln(t)}})])}],behaviours:jl([_B.childAt(0),Cy("sidebar-sliding-events",[wi(OU,(function(n,t){Ka(n.element,"width",t.event.width)})),wi(TU,(function(n,t){rc(n.element,"width")}))])])}},EU=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[];return J(t,(function(n,t){var e;return"class"===t.name?n:D(D({},n),(e={},e[t.name]=t.value,e))}),{})},_U=function(n){return Array.prototype.slice.call(n.dom.classList,0)},AU=function(n){var t=tr.fromHtml(n),e=Ki(t),r=EU(t),o=_U(t),i=0===e.length?{}:{innerHtml:yu(t)};return D({tag:Ii(t),classes:o,attributes:r},i)},RU=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:AU('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:jl([fy.config({mode:"special",onTab:function(){return N.some(!0)},onShiftTab:function(){return N.some(!0)}}),By.config({})])}},BU=function(n,t,e){var r=n.element;!0===t?(xy.set(n,[RU(e)]),rc(r,"display"),Eu(r,"aria-hidden")):(xy.set(n,[]),Ka(r,"display","none"),Cu(r,"aria-hidden","true"))},MU=function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:jl([xy.config({})]),components:[]}},IU=function(n,t,e){var r=Ke(!1),o=Ke(N.none()),i=function(o){o!==r.get()&&(BU(t(),o,e.providers),r.set(o),n.fire("AfterProgressState",{state:o}))};n.on("ProgressState",(function(t){if(o.get().each(Kw.clearTimeout),m(t.time)){var e=Kw.setEditorTimeout(n,(function(){return i(t.state)}),t.time);o.set(N.some(e))}else i(t.state),o.set(N.none())}))},NU=function(n,t,e){var r={getSocket:function(t){return ZH.getPart(t,n,"socket")},setSidebar:function(t,e){ZH.getPart(t,n,"sidebar").each((function(n){return SU(n,e)}))},toggleSidebar:function(t,e){ZH.getPart(t,n,"sidebar").each((function(n){return CU(n,e)}))},whichSidebar:function(t){return ZH.getPart(t,n,"sidebar").bind(kU).getOrNull()},getHeader:function(t){return ZH.getPart(t,n,"header")},getToolbar:function(t){return ZH.getPart(t,n,"toolbar")},setToolbar:function(t,e){ZH.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){ZH.getPart(t,n,"multiple-toolbar").each((function(n){aV.setItems(n,e)}))},refreshToolbar:function(t){var e=ZH.getPart(t,n,"toolbar");e.each((function(n){return n.getApis().refresh(n)}))},toggleToolbarDrawer:function(t){ZH.getPart(t,n,"toolbar").each((function(n){mh(n.getApis().toggle,(function(t){return t(n)}))}))},isToolbarDrawerToggled:function(t){return ZH.getPart(t,n,"toolbar").bind((function(n){return N.from(n.getApis().isOpen).map((function(t){return t(n)}))})).getOr(!1)},getThrobber:function(t){return ZH.getPart(t,n,"throbber")},focusToolbar:function(t){var e=ZH.getPart(t,n,"toolbar").orThunk((function(){return ZH.getPart(t,n,"multiple-toolbar")}));e.each((function(n){fy.focusIn(n)}))},setMenubar:function(t,e){ZH.getPart(t,n,"menubar").each((function(n){cU.setMenus(n,e)}))},focusMenubar:function(t){ZH.getPart(t,n,"menubar").each((function(n){cU.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:r,behaviours:n.behaviours}},FU=nV.optional({factory:cU,name:"menubar",schema:[ye("backstage")]}),PU=function(n){return n.type===aS.sliding?Lz:n.type===aS.floating?Pz:zz},LU=nV.optional({factory:{sketch:function(n){return aV.sketch({uid:n.uid,dom:n.dom,listBehaviours:jl([fy.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return zz({type:n.type,uid:Pu("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return n.onEscape(),N.some(!0)}})},setupItem:function(n,t,e,r){yL.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[ye("dom"),ye("onEscape")]}),zU=nV.optional({factory:{sketch:function(n){var t=PU(n),e={type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),N.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes};return t(e)}},name:"toolbar",schema:[ye("dom"),ye("onEscape"),ye("getSink")]}),jU=nV.optional({factory:{sketch:uU},name:"header",schema:[ye("dom")]}),HU=nV.optional({name:"socket",schema:[ye("dom")]}),VU=nV.optional({factory:{sketch:DU},name:"sidebar",schema:[ye("dom")]}),UU=nV.optional({factory:{sketch:MU},name:"throbber",schema:[ye("dom")]}),WU=ch({name:"OuterContainer",factory:NU,configFields:[ye("dom"),ye("behaviours")],partFields:[jU,FU,zU,LU,HU,VU,UU],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var r=G(e,(function(n){return Iz(n)}));n.setToolbar(t,r)},setToolbars:function(n,t,e){var r=G(e,(function(n){return G(n,Iz)}));n.setToolbars(t,r)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},toggleToolbarDrawer:function(n,t){n.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(n,t){return n.isToolbarDrawerToggled(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),GU="file edit view insert format tools table help",qU={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},$U=function(n,t,e){var r=lk(e).split(/[ ,]/);return{text:n.title,getItems:function(){return en(n.items,(function(n){var e=n.toLowerCase();return 0===e.trim().length||V(r,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}},XU=function(n){return"string"===typeof n?n.split(" "):n},KU=function(n,t){var e=D(D({},qU),t.menus),r=_n(t.menus).length>0,o=void 0===t.menubar||!0===t.menubar?XU(GU):XU(!1===t.menubar?"":t.menubar),i=K(o,(function(n){return r&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||qU.hasOwnProperty(n)})),u=G(i,(function(r){var o=e[r];return $U({title:o.title,items:XU(o.items)},t,n)}));return K(u,(function(n){var t=function(n){return"separator"!==n.type};return n.getItems().length>0&&V(n.getItems(),t)}))},YU=function(n){var t=function(){n._skinLoaded=!0,JO(n)};return function(){n.initialized?t():n.on("init",t)}},JU=function(n,t){return function(){return QO(n,{message:t})}},QU=function(n,t,e){return new Ox((function(r,o){e.load(t,r,o),n.on("remove",(function(){return e.unload(t)}))}))},ZU=function(n,t){var e=t+"/skin.min.css";return QU(n,e,n.ui.styleSheetLoader)},nW=function(n,t){var e=ru(tr.fromDom(n.getElement()));if(e){var r=t+"/skin.shadowdom.min.css";return QU(n,r,AC.DOM.styleSheetLoader)}return Ox.resolve()},tW=function(n,t){var e=QC(t);e&&t.contentCSS.push(e+(n?"/content.inline":"/content")+".min.css"),!1===nk(t)&&i(e)?Ox.all([ZU(t,e),nW(t,e)]).then(YU(t),JU(t,"Skin could not be loaded")):YU(t)()},eW=x(tW,!1),rW=x(tW,!0),oW=function(n,t,e,r){var o=t.outerContainer,u=e.toolbar,a=e.buttons;if(g(u,i)){var c=u.map((function(t){var o={toolbar:t,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return WH(n,o,{backstage:r},N.none())}));WU.setToolbars(o,c)}else WU.setToolbar(o,WH(n,e,{backstage:r},N.none()))},iW=$r(),uW=iW.os.isiOS()&&iW.os.version.major<=12,aW=function(n,t){var e=n.dom,r=n.getWin(),o=n.getDoc().documentElement,i=Ke(Dc(r.innerWidth,r.innerHeight)),u=Ke(Dc(o.offsetWidth,o.offsetHeight)),a=function(){var t=i.get();t.left===r.innerWidth&&t.top===r.innerHeight||(i.set(Dc(r.innerWidth,r.innerHeight)),nT(n))},c=function(){var t=n.getDoc().documentElement,e=u.get();e.left===t.offsetWidth&&e.top===t.offsetHeight||(u.set(Dc(t.offsetWidth,t.offsetHeight)),nT(n))},s=function(t){return tT(n,t)};e.bind(r,"resize",a),e.bind(r,"scroll",s);var l=gD(tr.fromDom(n.getBody()),"load",c),f=t.uiMothership.element;n.on("hide",(function(){Ka(f,"display","none")})),n.on("show",(function(){rc(f,"display")})),n.on("NodeChange",c),n.on("remove",(function(){l.unbind(),e.unbind(r,"resize",a),e.unbind(r,"scroll",s),r=null}))},cW=function(n,t,e,r,o){var i=Ke(0),u=t.outerContainer;eW(n);var a=tr.fromDom(o.targetNode),c=eu(tu(a));Gm(a,t.mothership),Wm(c,t.uiMothership),n.on("PostRender",(function(){oW(n,t,e,r),i.set(n.getWin().innerWidth),WU.setMenubar(u,KU(n,e)),WU.setSidebar(u,e.sidebar),aW(n,t)}));var s=WU.getSocket(u).getOrDie("Could not find expected socket element");if(uW){Ya(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var l=cx((function(){n.fire("ScrollContent")}),20),f=mD(s.element,"scroll",l.throttle);n.on("remove",f.unbind)}Uk(n,t),n.addCommand("ToggleSidebar",(function(t,e){WU.toggleSidebar(u,e),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return WU.whichSidebar(u)}));var d=hk(n),m=function(){WU.refreshToolbar(t.outerContainer)};d!==aS.sliding&&d!==aS.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var t=n.getWin().innerWidth;t!==i.get()&&(m(),i.set(t))}));var g={enable:function(){Vk(t,!1)},disable:function(){Vk(t,!0)},isDisabled:function(){return YC.isDisabled(u)}};return{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:g}},sW=Object.freeze({__proto__:null,render:cW}),lW=function(n){var t=/^[0-9\.]+(|px)$/i;return t.test(""+n)?N.some(parseInt(""+n,10)):N.none()},fW=function(n){return m(n)?n+"px":n},dW=function(n,t,e){var r=t.filter((function(t){return n<t})),o=e.filter((function(t){return n>t}));return r.or(o).getOr(n)},mW=function(n){var t=tk(n),e=ok(n),r=uk(n);return lW(t).map((function(n){return dW(n,e,r)}))},gW=function(n){var t=mW(n);return t.getOr(tk(n))},pW=function(n){var t=ek(n),e=rk(n),r=ik(n);return lW(t).map((function(n){return dW(n,e,r)}))},hW=function(n){var t=pW(n);return t.getOr(ek(n))},vW=function(n,t,e,r,o){var i=e.uiMothership,u=e.outerContainer,a=AC.DOM,c=Ok(n),s=Ek(n),l=ik(n).or(pW(n)),f=r.shared.header,d=f.isPositionedAtTop,m=hk(n),g=m===aS.sliding||m===aS.floating,p=Ke(!1),h=function(){return p.get()&&!n.removed},v=function(n){return g?n.fold((function(){return 0}),(function(n){return n.components().length>1?Cc(n.components()[1].element):0})):0},b=function(e){switch(yk(n)){case pk.auto:var r=WU.getToolbar(u),o=v(r),i=Cc(e.element)-o,a=os(t),c=a.y>i;if(c)return"top";var s=Ui(t),l=Math.max(s.dom.scrollHeight,Cc(s)),f=a.bottom<l-i;if(f)return"bottom";var d=us(),m=d.bottom<a.bottom-i;return m?"bottom":"top";case pk.bottom:return"bottom";case pk.top:default:return"top"}},y=function(n){var t=o.get();WV.setModes(t,[n]),f.setDockingMode(n);var e=d()?xs.TopToBottom:xs.BottomToTop;Cu(t.element,Hf,e)},w=function(){var n=l.getOrThunk((function(){var n=lW(Qa(Ga(),"margin-left")).getOr(0);return Ic(Ga())-Ac(t).left+n}));Ka(o.get().element,"max-width",n+"px")},x=function(){var n=WU.getToolbar(u),e=v(n),r=os(t),i=d()?Math.max(r.y-Cc(o.get().element)+e,0):r.bottom;Ya(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(r.x)+"px"})},S=function(){i.broadcastOn([pg()],{})},C=function(n){if(void 0===n&&(n=!1),h()){if(c||w(),g&&WU.refreshToolbar(u),c||x(),s){var t=o.get();n?WV.reset(t):WV.refresh(t)}S()}},k=function(n){if(void 0===n&&(n=!0),!c&&s&&h()){var t=f.getDockingMode(),e=b(o.get());e!==t&&(y(e),n&&C(!0))}},O=function(){p.set(!0),Ka(u.element,"display","flex"),a.addClass(n.getBody(),"mce-edit-focus"),rc(i.element,"display"),k(!1),C()},T=function(){p.set(!1),e.outerContainer&&(Ka(u.element,"display","none"),a.removeClass(n.getBody(),"mce-edit-focus")),Ka(i.element,"display","none")};return{isVisible:h,isPositionedAtTop:d,show:O,hide:T,update:C,updateMode:k,repositionPopups:S}},bW=function(n,t){var e=os(n);return{pos:t?e.y:e.bottom,bounds:e}},yW=function(n,t,e,r){var o=Ke(bW(t,e.isPositionedAtTop())),i=function(r){var i=bW(t,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=o.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;o.set({pos:u,bounds:a}),f&&nT(n,r),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};r||(n.on("activate",e.show),n.on("deactivate",e.hide)),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){Kw.requestAnimationFrame((function(){return i(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}));var u=CH();u.set(gD(tr.fromDom(n.getBody()),"load",i)),n.on("remove",(function(){u.clear()}))},wW=function(n,t,e,r,o){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=Ke(null),s=tr.fromDom(o.targetNode),l=vW(n,s,t,r,c),f=Ck(n);rW(n);var d=function(){if(c.get())l.show();else{c.set(WU.getHeader(a).getOrDie());var o=Tk(n);Wm(o,i),Wm(o,u),oW(n,t,e,r),WU.setMenubar(a,KU(n,e)),l.show(),yW(n,s,l,f),n.nodeChanged()}},m=function(){return Kw.setEditorTimeout(n,d,0)};n.on("show",d),n.on("hide",l.hide),f||(n.on("focus",m),n.on("blur",l.hide)),n.on("init",(function(){(n.hasFocus()||f)&&m()})),Uk(n,t);var g={show:function(){l.show()},hide:function(){l.hide()},enable:function(){Vk(t,!1)},disable:function(){Vk(t,!0)},isDisabled:function(){return YC.isDisabled(a)}};return{editorContainer:a.element.dom,api:g}},xW=Object.freeze({__proto__:null,render:wW}),SW=function(n){var t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];PB.each(t,(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:OH(n,t.name)})}));var e={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};n.ui.registry.addButton(e.name,{tooltip:e.text,onAction:function(){return n.execCommand(e.cmd)},icon:e.icon})},CW=function(n,t){rH(n,t),lH(n,t),MH(n,t),AH(n,t),yH(n,t)},kW=function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},OW=function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return kW(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},TW=function(n){OW(n)},DW={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},EW=function(){var n="[0-9]+",t="[+-]?"+n,e="[eE]"+t,r="\\.",o=function(n){return"(?:"+n+")?"},i=["Infinity",n+r+o(n)+o(e),r+n+o(e),n+o(e)].join("|"),u="[+-]?(?:"+i+")";return new RegExp("^("+u+")(.*)$")}(),_W=function(n,t){return V(t,(function(t){return V(DW[t],(function(t){return n===t}))}))},AW=function(n,t){var e=N.from(EW.exec(n));return e.bind((function(n){var e=Number(n[1]),r=n[2];return _W(r,t)?N.some({value:e,unit:r}):N.none()}))},RW=function(n,t){return AW(n,t).map((function(n){var t=n.value,e=n.unit;return t+e}))},BW=function(n){return RW(n,["fixed","relative","empty"]).getOr(n)},MW=function(n){var t=sk(n),e=new Map,r=SH(),o=function(){var t=BW(n.queryCommandValue("LineHeight"));N.from(e.get(t)).fold((function(){return r.clear()}),(function(n){r.set({destroy:function(){n.setActive(!1)}}),n.setActive(!0)}))};return n.on("nodeChange",o),G(t,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(BW(i),a),u+1===t.length&&o(),function(){0===u&&(n.off("nodeChange",o),r.clear())}},onAction:function(){return n.execCommand("LineHeight",!1,i)}}}))},IW=function(n){n.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return MW(n)}})},NW=function(n){n.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(MW(n))}})},FW=function(n){IW(n),NW(n)},PW=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},LW=function(n){PB.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:OH(n,t.name),onAction:PW(n,t.name)})}));for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:OH(n,e),onAction:PW(n,e)})}},zW=function(n){PB.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))},jW=function(n){PB.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:OH(n,t.name)})}))},HW=function(n){LW(n),zW(n),jW(n)},VW=function(n){PB.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:PW(n,"code")})},UW=function(n){HW(n),VW(n)},WW=function(n,t,e){var r=function(){return!!t.undoManager&&t.undoManager[e]()},o=function(){n.setDisabled(t.mode.isReadOnly()||!r())};return n.setDisabled(!r()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},GW=function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return WW(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return WW(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},qW=function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return WW(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return WW(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},$W=function(n){GW(n),qW(n)},XW=function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}},KW=function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return XW(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})},YW=function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})},JW=function(n){YW(n),KW(n)},QW=function(n,t){SW(n),UW(n),CW(n,t),$W(n),RT(n),JW(n),TW(n),FW(n)},ZW=function(n,t){return{anchor:"makeshift",x:n,y:t}},nG=function(n,t,e){return ZW(n.x+t,n.y+e)},tG=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},eG=function(n){if(tG(n)){var t=n.touches[0];return ZW(t.pageX,t.pageY)}return ZW(n.pageX,n.pageY)},rG=function(n){if(tG(n)){var t=n.touches[0];return ZW(t.clientX,t.clientY)}return ZW(n.clientX,n.clientY)},oG=function(n,t){var e=AC.DOM.getPos(n);return nG(t,e.x,e.y)},iG=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?eG(t):oG(n.getContentAreaContainer(),rG(t)):uG(n)},uG=function(n){return{anchor:"selection",root:tr.fromDom(n.selection.getNode())}},aG=function(n){return{anchor:"node",node:N.some(tr.fromDom(n.selection.getNode())),root:tr.fromDom(n.getBody())}},cG=function(n,t,e,r,o,i){var u=e(),a=i?aG(n):iG(n,t);BI(u,cS.CLOSE_ON_EXECUTE,r,!1).map((function(n){t.preventDefault(),Pw.showMenuAt(o,a,{menu:{markers:MS("normal")},data:n})}))},sG={onLtr:function(){return[wl,pl,hl,vl,bl,yl,$w,Xw,Gw,Uw,qw,Ww]},onRtl:function(){return[wl,hl,pl,bl,vl,yl,$w,Xw,qw,Ww,Gw,Uw]}},lG=12,fG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},dG=function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var r=t.touches[0],o=e.getRng(),i=om(n.getWin(),Ed.domRange(o));return i.exists((function(n){return n.left<=r.clientX&&n.right>=r.clientX&&n.top<=r.clientY&&n.bottom>=r.clientY}))},mG=function(n,t){return D({bubble:Nf(0,lG,fG),layouts:sG,overrides:{maxWidthFunction:dL(),maxHeightFunction:Af()}},iG(n,t))},gG=function(n){var t=n.selection.getRng(),e=function(){Kw.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()};n.once("touchend",e);var r=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",r,!0);var o=function(){return i()};n.once("longpresscancel",o);var i=function(){n.off("touchend",e),n.off("longpresscancel",o),n.off("mousedown",r)}},pG=function(n,t,e,r,o,i,u){var a=i?aG(n):mG(n,t);BI(e,cS.CLOSE_ON_EXECUTE,r,!0).map((function(e){t.preventDefault(),Pw.showMenuWithinBounds(o,a,{menu:{markers:MS("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return N.some(Mj(n,r.shared))})),n.fire(gL)}))},hG=function(n,t,e,r,o,i){var u=$r(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),l=u.deviceType.isTouch(),f=function(){return!(s||a||c&&l)},d=function(){var u=e();pG(n,t,u,r,o,i,f())};if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),d();else{var m=function(){gG(n),d()};dG(n,t)?m():(n.once("selectionchange",m),n.once("touchend",(function(){return n.off("selectionchange",m)})))}},vG=function(n){return"string"===typeof n?n.split(/[ ,]/):n},bG=function(n){return n.getParam("contextmenu_never_use_native",!1,"boolean")},yG=function(n,t,e){var r=n.ui.registry.getAll().contextMenus;return N.from(n.getParam(t)).map(vG).getOrThunk((function(){return K(vG(e),(function(n){return Hn(r,n)}))}))},wG=function(n){return!1===n.getParam("contextmenu")},xG=function(n){return yG(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},SG=function(n){return n.getParam("contextmenu_avoid_overlap","","string")},CG=function(n){return i(n)?"|"===n:"separator"===n.type},kG={type:"separator"},OG=function(n){var t=function(n){return{text:n.text,icon:n.icon,disabled:n.disabled,shortcut:n.shortcut}};if(i(n))return n;switch(n.type){case"separator":return kG;case"submenu":return D(D({type:"nestedmenuitem"},t(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return i(t)?t:G(t,OG)}});default:return D(D({type:"menuitem"},t(n)),{onAction:h(n.onAction)})}},TG=function(n,t){if(0===t.length)return n;var e=fn(n).filter((function(n){return!CG(n)})),r=e.fold((function(){return[]}),(function(n){return[kG]}));return n.concat(r).concat(t).concat([kG])},DG=function(n,t,e){var r=J(t,(function(t,r){return jn(n,r.toLowerCase()).map((function(n){var r=n.update(e);if(i(r))return TG(t,r.split(" "));if(r.length>0){var o=G(r,OG);return TG(t,o)}return t})).getOrThunk((function(){return t.concat([r])}))}),[]);return r.length>0&&CG(r[r.length-1])&&r.pop(),r},EG=function(n,t){return t.ctrlKey&&!bG(n)},_G=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},AG=function(n,t){return _G(n,t)?n.selection.getStart(!0):t.target},RG=function(n,t){var e=SG(n);if(_G(n,t))return!0;if(e){var r=AG(n,t);return hD(tr.fromDom(r),e)}return!1},BG=function(n,t,e){var r=$r(),o=r.deviceType.isTouch,i=yc(Pw.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:jl([Cy("dismissContextMenu",[wi(ei(),(function(t,e){mg.close(t),n.focus()}))])])})),u=function(n){return Pw.hide(i)},a=function(t){if(bG(n)&&t.preventDefault(),!EG(n,t)&&!wG(n)){var r=RG(n,t),u=function(){var e=AG(n,t),r=n.ui.registry.getAll(),o=xG(n);return DG(r.contextMenus,o,e)},a=o()?hG:cG;a(n,t,u,e,i,r)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");n.on(t,u),n.on("longpress contextmenu",a)}))},MG=Wn.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),IG=function(n){return function(t){return t.translate(-n.left,-n.top)}},NG=function(n){return function(t){return t.translate(n.left,n.top)}},FG=function(n){return function(t,e){return J(n,(function(n,t){return t(n)}),Dc(t,e))}},PG=function(n,t,e){return n.fold(FG([NG(e),IG(t)]),FG([IG(t)]),FG([]))},LG=function(n,t,e){return n.fold(FG([NG(e)]),FG([]),FG([NG(t)]))},zG=function(n,t,e){return n.fold(FG([]),FG([IG(e)]),FG([NG(t),IG(e)]))},jG=function(n,t,e,r,o,i){var u=LG(n,o,i),a=LG(t,o,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=r},HG=function(n,t,e,r,o,i){var u=LG(n,o,i),a=LG(t,o,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return Dc(c,s)},VG=function(n,t,e){var r=n.fold((function(n,t){return{position:N.some("absolute"),left:N.some(n+"px"),top:N.some(t+"px")}}),(function(n,t){return{position:N.some("absolute"),left:N.some(n-e.left+"px"),top:N.some(t-e.top+"px")}}),(function(n,t){return{position:N.some("fixed"),left:N.some(n+"px"),top:N.some(t+"px")}}));return D({right:N.none(),bottom:N.none()},r)},UG=function(n,t,e){return n.fold((function(n,r){return GG(n+t,r+e)}),(function(n,r){return qG(n+t,r+e)}),(function(n,r){return $G(n+t,r+e)}))},WG=function(n,t,e,r){var o=function(n,o){return function(i,u){var a=n(t,e,r);return o(i.getOr(a.left),u.getOr(a.top))}};return n.fold(o(zG,GG),o(LG,qG),o(PG,$G))},GG=MG.offset,qG=MG.absolute,$G=MG.fixed,XG=function(n,t){var e=Ou(n,t);return s(e)?NaN:parseInt(e,10)},KG=function(n,t){var e=n.element,r=XG(e,t.leftAttr),o=XG(e,t.topAttr);return isNaN(r)||isNaN(o)?N.none():N.some(Dc(r,o))},YG=function(n,t,e){var r=n.element;Cu(r,t.leftAttr,e.left+"px"),Cu(r,t.topAttr,e.top+"px")},JG=function(n,t){var e=n.element;Eu(e,t.leftAttr),Eu(e,t.topAttr)},QG=function(n,t,e,r){return KG(n,t).fold((function(){return e}),(function(n){return $G(n.left+r.left,n.top+r.top)}))},ZG=function(n,t,e,r,o,i){var u=QG(n,t,e,r),a=t.mustSnap?eq(n,t,u,o,i):rq(n,t,u,o,i),c=PG(u,o,i);return YG(n,t,c),a.fold((function(){return{coord:$G(c.left,c.top),extra:N.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},nq=function(n,t){JG(n,t)},tq=function(n,t,e,r){return mn(n,(function(n){var o=n.sensor,i=jG(t,o,n.range.left,n.range.top,e,r);return i?N.some({output:WG(n.output,t,e,r),extra:n.extra}):N.none()}))},eq=function(n,t,e,r,o){var i=t.getSnapPoints(n),u=tq(i,e,r,o);return u.orThunk((function(){var n=J(i,(function(n,t){var i=t.sensor,u=HG(e,i,t.range.left,t.range.top,r,o);return n.deltas.fold((function(){return{deltas:N.some(u),snap:N.some(t)}}),(function(e){var r=(u.left+u.top)/2,o=(e.left+e.top)/2;return r<=o?{deltas:N.some(u),snap:N.some(t)}:n}))}),{deltas:N.none(),snap:N.none()});return n.snap.map((function(n){return{output:WG(n.output,e,r,o),extra:n.extra}}))}))},rq=function(n,t,e,r,o){var i=t.getSnapPoints(n);return tq(i,e,r,o)},oq=function(n,t,e){return{coord:WG(n.output,n.output,t,e),extra:n.extra}},iq=function(n,t,e,r){var o=t.getTarget(n.element);if(t.repositionTarget){var i=Hi(n.element),u=Wc(i),a=mV(o),c=oq(r,u,a),s=VG(c.coord,u,a);Ja(o,s)}},uq=Object.freeze({__proto__:null,snapTo:iq}),aq="data-initial-z-index",cq=function(n){Gi(n.element).filter(Pi).each((function(n){Tu(n,aq).fold((function(){return rc(n,"z-index")}),(function(t){return Ka(n,"z-index",t)})),Eu(n,aq)}))},sq=function(n){Gi(n.element).filter(Pi).each((function(t){nc(t,"z-index").each((function(n){Cu(t,aq,n)})),Ka(t,"z-index",Qa(n.element,"z-index"))}))},lq=function(n,t){n.getSystem().addToGui(t),sq(t)},fq=function(n){cq(n),n.getSystem().removeFromGui(n)},dq=function(n,t,e){return n.getSystem().build(WD.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},mq=Fe("snaps",[ye("getSnapPoints"),Ls("onSensor"),ye("leftAttr"),ye("topAttr"),Le("lazyViewport",us),Le("mustSnap",!1)]),gq=[Le("useFixed",k),ye("blockerClass"),Le("getTarget",w),Le("onDrag",p),Le("repositionTarget",!0),Le("onDrop",p),We("getBounds",us),mq],pq=function(n){return dh(nc(n,"left"),nc(n,"top"),nc(n,"position"),(function(n,t,e){var r="fixed"===e?$G:GG;return r(parseInt(n,10),parseInt(t,10))})).getOrThunk((function(){var t=Ac(n);return qG(t.left,t.top)}))},hq=function(n,t,e,r,o){var i=o.bounds,u=LG(t,e,r),a=vf(u.left,i.x,i.x+i.width-o.width),c=vf(u.top,i.y,i.y+i.height-o.height),s=qG(a,c);return t.fold((function(){var n=zG(s,e,r);return GG(n.left,n.top)}),(function(){return s}),(function(){var n=PG(s,e,r);return $G(n.left,n.top)}))},vq=function(n,t,e,r,o,i,u){var a=t.fold((function(){var n=UG(e,i.left,i.top),t=PG(n,r,o);return $G(t.left,t.top)}),(function(t){var u=ZG(n,t,e,i,r,o);return u.extra.each((function(e){t.onSensor(n,e)})),u.coord}));return hq(n,a,r,o,u)},bq=function(n,t,e,r){var o=t.getTarget(n.element);if(t.repositionTarget){var i=Hi(n.element),u=Wc(i),a=mV(o),c=pq(o),s=vq(n,t.snaps,c,u,a,r,e),l=VG(s,u,a);Ja(o,l)}t.onDrag(n,o,r)},yq=function(n,t){return{bounds:n.getBounds(),height:kc(t.element),width:Nc(t.element)}},wq=function(n,t,e,r,o){var i=e.update(r,o),u=e.getStartData().getOrThunk((function(){return yq(t,n)}));i.each((function(e){bq(n,t,u,e)}))},xq=function(n,t,e,r){t.each(fq),e.snaps.each((function(t){nq(n,t)}));var o=e.getTarget(n.element);r.reset(),e.onDrop(n,o)},Sq=function(n){return function(t,e){var r=function(n){e.setStartData(yq(t,n))};return hi(_([wi(Qo(),(function(n){e.getStartData().each((function(){return r(n)}))}))],n(t,e,r)))}},Cq=function(n){return hi([wi(Co(),n.forceDrop),wi(To(),n.drop),wi(ko(),(function(t,e){n.move(e.event)})),wi(Oo(),n.delayDrop)])},kq=function(n){return N.from(Dc(n.x,n.y))},Oq=function(n,t){return Dc(t.left-n.left,t.top-n.top)},Tq=Object.freeze({__proto__:null,getData:kq,getDelta:Oq}),Dq=function(n,t,e){return[wi(Co(),(function(r,o){var i=o.event.raw;if(0===i.button){o.stop();var u=function(){return xq(r,N.some(s),n,t)},a=vD(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),wq(r,n,t,Tq,e)}},s=dq(r,n.blockerClass,Cq(c)),l=function(){e(r),lq(r,s)};l()}}))]},Eq=_(gq,[Vs("dragger",{handlers:Sq(Dq)})]),_q=function(n){return hi([wi(yo(),n.forceDrop),wi(xo(),n.drop),wi(So(),n.drop),wi(wo(),(function(t,e){n.move(e.event)}))])},Aq=function(n){var t=n[0];return N.some(Dc(t.clientX,t.clientY))},Rq=function(n){var t=n.raw,e=t.touches;return 1===e.length?Aq(e):N.none()},Bq=function(n,t){return Dc(t.left-n.left,t.top-n.top)},Mq=Object.freeze({__proto__:null,getData:Rq,getDelta:Bq}),Iq=function(n,t,e){var r=Ke(N.none());return[wi(yo(),(function(o,i){i.stop();var u=function(){xq(o,r.get(),n,t),r.set(N.none())},a={drop:u,delayDrop:p,forceDrop:u,move:function(e){wq(o,n,t,Mq,e)}},c=dq(o,n.blockerClass,_q(a));r.set(N.some(c));var s=function(){e(o),lq(o,c)};s()})),wi(wo(),(function(e,r){r.stop(),wq(e,n,t,Mq,r.event)})),wi(xo(),(function(e,o){o.stop(),xq(e,r.get(),n,t),r.set(N.none())})),wi(So(),(function(e){xq(e,r.get(),n,t),r.set(N.none())}))]},Nq=_(gq,[Vs("dragger",{handlers:Sq(Iq)})]),Fq=function(n,t,e){return _(Dq(n,t,e),Iq(n,t,e))},Pq=_(gq,[Vs("dragger",{handlers:Sq(Fq)})]),Lq=Eq,zq=Nq,jq=Pq,Hq=Object.freeze({__proto__:null,mouse:Lq,touch:zq,mouseOrTouch:jq}),Vq=function(){var n=N.none(),t=N.none(),e=function(){n=N.none(),t=N.none()},r=function(t,e){var r=n.map((function(n){return t.getDelta(n,e)}));return n=N.some(e),r},o=function(n,t){return n.getData(t).bind((function(t){return r(n,t)}))},i=function(n){t=N.some(n)},u=function(){return t},a=y({});return oa({readState:a,reset:e,update:o,getStartData:u,setStartData:i})},Uq=Object.freeze({__proto__:null,init:Vq}),Wq=Wl({branchKey:"mode",branches:Hq,name:"dragging",active:{events:function(n,t){var e=n.dragger;return e.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:N.from(n.extra)}}},state:Uq,apis:uq}),Gq=40,qq=Gq/2,$q=function(n,t,e,r,o,i){return n.fold((function(){return Wq.snap({sensor:qG(e-qq,r-qq),range:Dc(o,i),output:qG(N.some(e),N.some(r)),extra:{td:t}})}),(function(n){var o=e-qq,i=r-qq,u=Gq,a=Gq,c=n.element.dom.getBoundingClientRect();return Wq.snap({sensor:qG(o,i),range:Dc(u,a),output:qG(N.some(e-c.width/2),N.some(r-c.height/2)),extra:{td:t}})}))},Xq=function(n,t,e){var r=function(n,t){return n.exists((function(n){return oo(n,t)}))};return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,o){var i=o.td;r(t.get(),i)||(t.set(N.some(i)),e(i))},mustSnap:!0}},Kq=function(n){return Qw(Jw.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:jl([Wq.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),S_.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},Yq=function(n,t){var e=Ke([]),r=Ke([]),o=Ke(!1),i=Ke(N.none()),u=Ke(N.none()),a=function(n){var e=is(n);return $q(m.getOpt(t),n,e.x,e.y,e.width,e.height)},c=function(){return G(e.get(),(function(n){return a(n)}))},s=function(n){var e=is(n);return $q(g.getOpt(t),n,e.right,e.bottom,e.width,e.height)},l=function(){return G(r.get(),(function(n){return s(n)}))},f=Xq(c,i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),d=Xq(l,u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),m=Kq(f),g=Kq(d),p=yc(m.asSpec()),h=yc(g.asSpec()),v=function(t,e,r,o){var i=e.dom.getBoundingClientRect();rc(t.element,"display");var u=Wi(tr.fromDom(n.getBody())).dom.innerHeight,a=r(i),c=o(i,u);(a||c)&&Ka(t.element,"display","none")},b=function(n,t,e,r){var o=e(t);Wq.snapTo(n,o);var i=function(n){return n[r]<0},u=function(n,t){return n[r]>t};v(n,t,i,u)},y=function(n){return b(p,n,a,"top")},w=function(){return i.get().each(y)},x=function(n){return b(h,n,s,"bottom")},S=function(){return u.get().each(x)};$r().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){o.get()||(zm(t,p),zm(t,h),o.set(!0)),i.set(N.some(n.start)),u.set(N.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),r.set(t.downOrRightCells),y(n.start),x(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){w(),S()})),n.on("TableSelectionClear",(function(){o.get()&&(Vm(p),Vm(h),o.set(!1)),i.set(N.none()),u.set(N.none())})))},Jq=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},Qq=function(n,t,e){t.delimiter||(t.delimiter="");var r=function(r){var o=r||[],i=G(o,(function(t,r){return Jw.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":r,"tab-index":-1,"aria-level":r+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:jl([Kk.button(e.isDisabled),Wk()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}};return J(i.slice(1),(function(n,t){var e=n;return e.push(u),e.push(t),e}),[i[0]])},o=function(t){var e=[],r=t.length;while(r-- >0){var o=t[r];if(1===o.nodeType&&!Jq(o)){var i=n.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(i.isDefaultPrevented()||e.push({name:i.name,element:o}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:jl([fy.config({mode:"flow",selector:"div[role=button]"}),YC.config({disabled:e.isDisabled}),Wk(),nE.config({}),xy.config({}),Cy("elementPathEvents",[Ai((function(t,e){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return fy.focusIn(t)})),n.on("NodeChange",(function(n){var e=o(n.parents);e.length>0?xy.set(t,r(e)):xy.set(t,[])}))}))])]),components:[]}};(function(n){n[n["None"]=0]="None",n[n["Both"]=1]="Both",n[n["Vertical"]=2]="Vertical"})(Jj||(Jj={}));var Zq=function(n,t,e,r,o){var i={};return i.height=dW(r+t.top,ok(n),uk(n)),e===Jj.Both&&(i.width=dW(o+t.left,rk(n),ik(n))),i},n$=function(n,t,e){var r=tr.fromDom(n.getContainer()),o=Zq(n,t,e,Cc(r),Ic(r));Rn(o,(function(n,t){return Ka(r,t,fW(n))})),ZO(n)},t$=function(n){var t=!n.hasPlugin("autoresize"),e=n.getParam("resize",t);return!1===e?Jj.None:"both"===e?Jj.Both:Jj.Vertical},e$=function(n,t,e,r){var o=20,i=Dc(e*o,r*o);return n$(n,i,t),N.some(!0)},r$=function(n,t){var e=t$(n);return e===Jj.None?N.none():N.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:nx("resize-handle",t.icons)},behaviours:jl([Wq.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,r,o){return n$(n,o,e)},blockerClass:"tox-blocker"}),fy.config({mode:"special",onLeft:function(){return e$(n,e,-1,0)},onRight:function(){return e$(n,e,1,0)},onUp:function(){return e$(n,e,0,-1)},onDown:function(){return e$(n,e,0,1)}}),nE.config({}),By.config({})])})},o$=function(n,t){var e,r=function(n,e,r){return xy.set(n,[hc(t.translate(["{0} "+r,e[r]]))])};return Jw.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:jl([Kk.button(t.isDisabled),Wk(),nE.config({}),xy.config({}),Kg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Cy("wordcount-events",[Mi((function(n){var t=Kg.getValue(n),e="words"===t.mode?"characters":"words";Kg.setValue(n,{mode:e,count:t.count}),r(n,t.count,e)})),Ai((function(t){n.on("wordCountUpdate",(function(n){var e=Kg.getValue(t).mode;Kg.setValue(t,{mode:e,count:n.wordCount}),r(t,n.wordCount,e)}))}))])]),eventOrder:(e={},e[Uo()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})},i$=function(n,t){var e=function(){var n=RC.translate(["Powered by {0}","Tiny"]),t='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+n+'">'+n+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:t}}},r=function(){var r=[];return n.getParam("elementpath",!0,"boolean")&&r.push(Qq(n,{},t)),n.hasPlugin("wordcount")&&r.push(o$(n,t)),n.getParam("branding",!0,"boolean")&&r.push(e()),r.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:r}]:[]},o=function(){var e=r(),o=r$(n,t);return e.concat(o.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:o()}},u$=function(n){var t,e=n.inline,r=e?xW:sW,o=Ek(n)?iU:fV,i=N.none(),u=$r(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),l="tox-platform-touch",f=s?[l]:[],d=wk(n),m=Tk(n),g=RC.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:(t={},t[Hf]=d?xs.BottomToTop:xs.TopToBottom,t)},v=function(){return i.bind(WU.getHeader)},b=function(){return o.isDocked(v)},y=function(){Ka(Q.element,"width",document.body.clientWidth+"px")},w=function(){var n=oo(Ga(),m)&&"grid"===Qa(m,"display"),t={dom:D({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(f)},g),behaviours:jl([Mm.config({useFixed:function(){return b()}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:hi([wi(Zo(),y)])};return Kn(t,n?e:{})},x=yc(w()),S=function(){return vn.value(x)},C=Qw({dom:{tag:"div",classes:["tox-anchorbar"]}}),k=function(){return i.bind((function(n){return C.getOpt(n)})).getOrDie("Could not find a anchor bar element")},O=function(){return i.bind((function(n){return WU.getToolbar(n)})).getOrDie("Could not find more toolbar element")},T=function(){return i.bind((function(n){return WU.getThrobber(n)})).getOrDie("Could not find throbber element")},E=fL(x,n,k),_=WU.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:E,onEscape:function(){n.focus()}}),A=hk(n),R=WU.parts.toolbar(D({dom:{tag:"div",classes:["tox-toolbar"]},getSink:S,providers:E.shared.providers,onEscape:function(){n.focus()},type:A,lazyToolbar:O,lazyHeader:function(){return v().getOrDie("Could not find header element")}},h)),B=WU.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:E.shared.providers,onEscape:function(){n.focus()},type:A}),M=WU.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),I=WU.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),F=WU.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:E}),P=n.getParam("statusbar",!0,"boolean"),L=P&&!e?N.some(i$(n,E.shared.providers)):N.none(),z={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[M,I]},j=gk(n),H=dk(n),V=fk(n),U=function(){return j?[B]:H?[R]:[]},W=WU.parts.header({dom:D({tag:"div",classes:["tox-editor-header"]},h),components:tn([V?[_]:[],U(),Ok(n)?[]:[C.asSpec()]]),sticky:Ek(n),editor:n,sharedBackstage:E.shared}),G=tn([d?[]:[W],e?[]:[z],d?[W]:[]]),q={dom:{tag:"div",classes:["tox-editor-container"]},components:G},$=tn([[q],e?[]:L.toArray(),[F]]),X=Dk(n),K=D(D({role:"application"},RC.isRtl()?{dir:"rtl"}:{}),X?{"aria-hidden":"true"}:{}),Y=yc(WU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(f).concat(c),styles:D({visibility:"hidden"},X?{opacity:"0",border:"0"}:{}),attributes:K},components:$,behaviours:jl([Wk(),YC.config({disableClass:"tox-tinymce--disabled"}),fy.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));i=N.some(Y),n.shortcuts.add("alt+F9","focus menubar",(function(){WU.focusMenubar(Y)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){WU.focusToolbar(Y)})),n.addCommand("ToggleToolbarDrawer",(function(){WU.toggleToolbarDrawer(Y)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return WU.isToolbarDrawerToggled(Y)}));var J=GD(Y),Q=GD(x);QH(n,J,Q);var Z=function(){var n={broadcastAll:Q.broadcast,broadcastOn:Q.broadcastOn,register:p};return{channels:n}},nn=function(){var t=fW(gW(n)),e=fW(hW(n));return n.inline||(ec("div","width",e)&&Ka(Y.element,"width",e),ec("div","height",t)?Ka(Y.element,"height",t):Ka(Y.element,"height","200px")),t},en=function(){o.setup(n,E.shared,v),QW(n,E),BG(n,S,E),bU(n),IU(n,T,E.shared),Bn(bk(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,i=t.menuItems,u=t.contextToolbars,a=t.sidebars,c=mk(n),s={menuItems:i,menus:Ak(n),menubar:Rk(n),toolbar:c.getOrThunk((function(){return Bk(n)})),allowToolbarGroups:A===aS.floating,buttons:e,sidebar:a};JH(n,u,x,{backstage:E}),Yq(n,x);var l=n.getElement(),f=nn(),d={mothership:J,uiMothership:Q,outerContainer:Y},m={targetNode:l,height:f};return r.render(n,d,s,E,m)};return{mothership:J,uiMothership:Q,backstage:E,renderUI:en,getUi:Z}},a$=function(n,t){var e=N.from(Ou(n,"id")).fold((function(){var n=Pu("dialog-describe");return Cu(t,"id",n),n}),w);Cu(n,"aria-describedby",e)},c$=function(n,t){var e=Tu(n,"id").fold((function(){var n=Pu("dialog-label");return Cu(t,"id",n),n}),w);Cu(n,"aria-labelledby",e)},s$=y([ye("lazySink"),Ae("dragBlockClass"),We("getBounds",us),Le("useTabstopAt",O),Le("eventOrder",{}),Yg("modalBehaviours",[fy]),zs("onExecute"),Hs("onEscape")]),l$={sketch:w},f$=y([Ap({name:"draghandle",overrides:function(n,t){return{behaviours:jl([Wq.config({mode:"mouse",getTarget:function(n){return ms(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),Ep({schema:[ye("dom")],name:"title"}),Ep({factory:l$,schema:[ye("dom")],name:"close"}),Ep({factory:l$,schema:[ye("dom")],name:"body"}),Ap({factory:l$,schema:[ye("dom")],name:"footer"}),_p({factory:{sketch:function(n,t){return D(D({},n),{dom:t.dom,components:t.components})}},schema:[Le("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Le("components",[])],name:"blocker"})]),d$=function(n,t,e,r){Cu(n.element,"aria-busy",!0);var o=t.getRoot(n).getOr(n),i=jl([fy.config({mode:"special",onTab:function(){return N.some(!0)},onShiftTab:function(){return N.some(!0)}}),By.config({})]),u=r(o,i),a=o.getSystem().build(u);xy.append(o,wc(a)),a.hasConfigured(fy)&&fy.focusIn(a),e.isBlocked()||t.onBlock(n),e.blockWith((function(){return xy.remove(o,a)}))},m$=function(n,t,e){Eu(n.element,"aria-busy"),e.isBlocked()&&t.onUnblock(n),e.clear()},g$=Object.freeze({__proto__:null,block:d$,unblock:m$}),p$=[We("getRoot",N.none),Ls("onBlock"),Ls("onUnblock")],h$=function(){var n=SH(),t=function(t){n.set({destroy:t})};return oa({readState:n.isSet,blockWith:t,clear:n.clear,isBlocked:n.isSet})},v$=Object.freeze({__proto__:null,init:h$}),b$=Vl({fields:p$,name:"blocking",apis:g$,state:v$}),y$=function(n,t,e,r){var o,i=Ke(N.none()),u=function(t){i.set(N.some(t));var e=n.lazySink(t).getOrDie(),o=r.blocker(),u=e.getSystem().build(D(D({},o),{components:o.components.concat([wc(t)]),behaviours:jl([By.config({}),Cy("dialog-blocker-events",[_i(Eo(),(function(){fy.focusIn(t)}))])])}));zm(e,u),fy.focusIn(t)},a=function(n){i.set(N.none()),Gi(n.element).each((function(t){n.getSystem().getByDom(t).each((function(n){Vm(n)}))}))},c=function(t){return Wp(t,n,"body")},s=function(t){return Wp(t,n,"footer")},l=function(n,t){b$.block(n,t)},f=function(n){b$.unblock(n)},d=Pu("modal-events"),m=D(D({},n.eventOrder),(o={},o[ni()]=[d].concat(n.eventOrder["alloy.system.attached"]||[]),o));return{uid:n.uid,dom:n.dom,components:t,apis:{show:u,hide:a,getBody:c,getFooter:s,setIdle:f,setBusy:l},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Qg(n.modalBehaviours,[xy.config({}),fy.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),b$.config({getRoot:i.get}),Cy(d,[Ai((function(t){c$(t.element,Wp(t,n,"title").element),a$(t.element,Wp(t,n,"body").element)}))])])}},w$=ch({name:"ModalDialog",configFields:s$(),partFields:f$(),factory:y$,apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),x$=zt([Se("type"),Se("name")].concat(ZS)),S$=ge,C$=[$t("name","name",rt((function(){return Pu("button-name")})),me),Me("icon"),Ve("align","end",["start","end"]),Ue("primary",!1),Ue("disabled",!1)],k$=_(C$,[Se("text")]),O$=_([Ce("type",["submit","cancel","custom"])],k$),T$=_([Ce("type",["menu"]),Me("text"),Me("tooltip"),Me("icon"),_e("items",x$)],C$),D$=ce("type",{submit:O$,cancel:O$,custom:O$,menu:T$}),E$=[Se("type"),Se("text"),Ce("level",["info","warn","error","success"]),Se("icon"),Le("url","")],_$=zt(E$),A$=function(n){return[Se("type"),n]},R$=[Se("type"),Se("text"),Ue("disabled",!1),Ue("primary",!1),$t("name","name",rt((function(){return Pu("button-name")})),me),Me("icon"),Ue("borderless",!1)],B$=zt(R$),M$=[Se("type"),Se("name"),Se("label"),Ue("disabled",!1)],I$=zt(M$),N$=ge,F$=[Se("type"),Se("name")],P$=F$.concat([Me("label")]),L$=P$.concat([Le("columns","auto")]),z$=zt(L$),j$=Jt([Se("value"),Se("text"),Se("icon")]),H$=P$,V$=zt(H$),U$=me,W$=P$,G$=zt(W$),q$=me,$$=F$.concat([He("tag","textarea"),Se("scriptId"),Se("scriptUrl"),Ge("settings",void 0)]),X$=F$.concat([He("tag","textarea"),Oe("init")]),K$=ne((function(n){return re("customeditor.old",Lt(X$),n).orThunk((function(){return re("customeditor.new",Lt($$),n)}))})),Y$=me,J$=P$,Q$=zt(J$),Z$=Qt(),nX=function(n){return[Se("type"),xe("columns"),n]},tX=[Se("type"),Se("html"),Ve("presets","presentation",["presentation","document"])],eX=zt(tX),rX=P$.concat([Ue("sandboxed",!0)]),oX=zt(rX),iX=me,uX=P$.concat([we("currentState",zt([ye("blob"),Se("url")]))]),aX=zt(uX),cX=P$.concat([Me("inputMode"),Me("placeholder"),Ue("maximized",!1),Ue("disabled",!1)]),sX=zt(cX),lX=me,fX=function(n){return[Se("type"),Se("label"),n]},dX=[Se("text"),Se("value")],mX=[Se("text"),_e("items",se("items",(function(){return gX})))],gX=Ht([zt(dX),zt(mX)]),pX=P$.concat([_e("items",gX),Ue("disabled",!1)]),hX=zt(pX),vX=me,bX=P$.concat([Ee("items",[Se("text"),Se("value")]),je("size",1),Ue("disabled",!1)]),yX=zt(bX),wX=me,xX=P$.concat([Ue("constrain",!0),Ue("disabled",!1)]),SX=zt(xX),CX=zt([Se("width"),Se("height")]),kX=[Se("type"),_e("header",me),_e("cells",jt(me))],OX=zt(kX),TX=P$.concat([Me("placeholder"),Ue("maximized",!1),Ue("disabled",!1)]),DX=zt(TX),EX=me,_X=P$.concat([Ve("filetype","file",["image","media","file"]),Le("disabled",!1)]),AX=zt(_X),RX=zt([Se("value"),Le("meta",{})]),BX=function(n){return $t("items","items",tt(),jt(ne((function(t){return re("Checking item of "+n,MX,t).fold((function(n){return vn.error(ue(n))}),(function(n){return vn.value(n)}))}))))},MX=Zt((function(){return ae("type",{alertbanner:_$,bar:zt(A$(BX("bar"))),button:B$,checkbox:I$,colorinput:V$,colorpicker:G$,dropzone:Q$,grid:zt(nX(BX("grid"))),iframe:oX,input:sX,listbox:hX,selectbox:yX,sizeinput:SX,textarea:DX,urlinput:AX,customeditor:K$,htmlpanel:eX,imagetools:aX,collection:z$,label:zt(fX(BX("label"))),table:OX,panel:NX})})),IX=[Se("type"),Le("classes",[]),_e("items",MX)],NX=zt(IX),FX=[$t("name","name",rt((function(){return Pu("tab-name")})),me),Se("title"),_e("items",MX)],PX=[Se("type"),Ee("tabs",FX)],LX=zt(PX),zX=k$,jX=D$,HX=zt([Se("title"),we("body",ae("type",{panel:NX,tabpanel:LX})),He("size","normal"),_e("buttons",jX),Le("initialData",{}),We("onAction",p),We("onChange",p),We("onSubmit",p),We("onClose",p),We("onCancel",p),Le("onTabChange",p)]),VX=function(n){return re("dialog",HX,n)},UX=zt(_([Ce("type",["cancel","custom"])],zX)),WX=zt([Se("title"),Se("url"),Be("height"),Be("width"),Ne("buttons",UX),We("onAction",p),We("onCancel",p),We("onClose",p),We("onMessage",p)]),GX=function(n){return re("dialog",WX,n)},qX=function(n){return u(n)?[n].concat(en(zn(n),qX)):a(n)?en(n,qX):[]},$X=function(n){return i(n.type)&&i(n.name)},XX={checkbox:N$,colorinput:U$,colorpicker:q$,dropzone:Z$,input:lX,iframe:iX,sizeinput:CX,selectbox:wX,listbox:vX,size:CX,textarea:EX,urlinput:RX,customeditor:Y$,collection:j$,togglemenuitem:S$},KX=function(n){return N.from(XX[n.type])},YX=function(n){return K(qX(n),$X)},JX=function(n){var t=YX(n),e=en(t,(function(n){return KX(n).fold((function(){return[]}),(function(t){return[we(n.name,t)]}))}));return zt(e)},QX=function(n){var t=oe(VX(n)),e=JX(n),r=n.initialData;return{internalDialog:t,dataValidator:e,initialData:r}},ZX={open:function(n,t){var e=QX(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){var e=oe(GX(t));return n(e)},redial:function(n){return QX(n)}},nK=function(n){var t=[],e={};return Rn(n,(function(n,r){n.fold((function(){t.push(r)}),(function(n){e[r]=n}))})),t.length>0?vn.error(t):vn.value(e)},tK=function(n,t){var e=Qw(bB.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:G(n.items,(function(n){return XF(e,n,t)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:jl([fy.config({mode:"acyclic",useTabstopAt:S(eM)}),_B.memento(e),GB.memento(e,{postprocess:function(n){return nK(n).fold((function(n){return{}}),(function(n){return n}))}})])}},eK=function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:Zy(n.action),behaviours:Qg(n.tabButtonBehaviours,[By.config({}),fy.config({mode:"execution",useSpace:!0,useEnter:!0}),Kg.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}},rK=ah({name:"TabButton",configFields:[Le("uid",void 0),ye("value"),$t("dom","dom",ot((function(){return{attributes:{role:"tab",id:Pu("aria"),"aria-selected":"false"}}})),le()),Ae("action"),Le("domModification",{}),Yg("tabButtonBehaviours",[By,fy,Kg]),ye("view")],factory:eK}),oK=y([ye("tabs"),ye("dom"),Le("clickToDismiss",!1),Yg("tabbarBehaviours",[zh,fy]),Fs(["tabClass","selectedClass"])]),iK=Rp({factory:rK,name:"tabs",unit:"tab",overrides:function(n){var t=function(n,t){zh.dehighlight(n,t),fi(n,ai(),{tabbar:n,button:t})},e=function(n,t){zh.highlight(n,t),fi(n,ui(),{tabbar:n,button:t})};return{action:function(r){var o=r.getSystem().getByUid(n.uid).getOrDie(),i=zh.isHighlighted(o,r),u=function(){return i&&n.clickToDismiss?t:i?p:e}();u(o,r)},domModification:{classes:[n.markers.tabClass]}}}}),uK=y([iK]),aK=function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Qg(n.tabbarBehaviours,[zh.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){Cu(t.element,"aria-selected","true")},onDehighlight:function(n,t){Cu(t.element,"aria-selected","false")}}),fy.config({mode:"flow",getInitial:function(n){return zh.getHighlighted(n).map((function(n){return n.element}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}},cK=ch({name:"Tabbar",configFields:oK(),partFields:uK(),factory:aK}),sK=function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Qg(n.tabviewBehaviours,[xy.config({})]),domModification:{attributes:{role:"tabpanel"}}}},lK=ah({name:"Tabview",configFields:[Yg("tabviewBehaviours",[xy])],factory:sK}),fK=y([Le("selectFirst",!0),Ls("onChangeTab"),Ls("onDismissTab"),Le("tabs",[]),Yg("tabSectionBehaviours",[])]),dK=Ep({factory:cK,schema:[ye("dom"),De("markers",[ye("tabClass"),ye("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),mK=Ep({factory:lK,name:"tabview"}),gK=y([dK,mK]),pK=function(n,t,e,r){var o=function(t){var e=Kg.getValue(t);Up(t,n,"tabview").each((function(r){var o=Z(n.tabs,(function(n){return n.value===e}));o.each((function(e){var o=e.view();Tu(t.element,"id").each((function(n){Cu(r.element,"aria-labelledby",n)})),xy.set(r,o),n.onChangeTab(r,t,o)}))}))},i=function(t,e){Up(t,n,"tabbar").each((function(n){e(n).each(di)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:Jg(n.tabSectionBehaviours),events:hi(tn([n.selectFirst?[Ai((function(n,t){i(n,zh.getFirst)}))]:[],[wi(ui(),(function(n,t){var e=t.event.button;o(e)})),wi(ai(),(function(t,e){var r=e.event.button;n.onDismissTab(t,r)}))]])),apis:{getViewItems:function(t){return Up(t,n,"tabview").map((function(n){return xy.contents(n)})).getOr([])},showTab:function(n,t){var e=function(n){var e=zh.getCandidates(n),r=Z(e,(function(n){return Kg.getValue(n)===t}));return r.filter((function(t){return!zh.isHighlighted(n,t)}))};i(n,e)}}}},hK=ch({name:"TabSection",configFields:fK(),partFields:gK(),factory:pK,apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),vK=function(n,t,e){return G(n,(function(r,o){xy.set(e,n[o].view());var i=t.dom.getBoundingClientRect();return xy.set(e,[]),i.height}))},bK=function(n){return ln(cn(n,(function(n,t){return n>t?-1:n<t?1:0})))},yK=function(n,t,e){var r,o=Ui(n).dom,i=ms(n,".tox-dialog-wrap").getOr(n),u="fixed"===Qa(i,"position");r=u?Math.max(o.clientHeight,window.innerHeight):Math.max(o.offsetHeight,o.scrollHeight);var a=Cc(t),c=t.dom.offsetLeft>=e.dom.offsetLeft+Ic(e),s=c?Math.max(Cc(e),a):a,l=parseInt(Qa(n,"margin-top"),10)||0,f=parseInt(Qa(n,"margin-bottom"),10)||0,d=Cc(n)+l+f,m=d-s;return r-m},wK=function(n,t){ln(n).each((function(n){return hK.showTab(t,n.value)}))},xK=function(n,t){Ka(n,"height",t+"px"),$r().browser.isIE()?rc(n,"flex-basis"):Ka(n,"flex-basis",t+"px")},SK=function(n,t,e){ms(n,'[role="dialog"]').each((function(n){gs(n,'[role="tablist"]').each((function(r){e.get().map((function(e){return Ka(t,"height","0"),Ka(t,"flex-basis","0"),Math.min(e,yK(n,t,r))})).each((function(n){xK(t,n)}))}))}))},CK=function(n){return gs(n,'[role="tabpanel"]')},kK=function(n){var t=function(){var t=Ke(N.none()),e=[Ai((function(e){var r=e.element;CK(r).each((function(o){Ka(o,"visibility","hidden"),e.getSystem().getByDom(o).toOptional().each((function(e){var r=vK(n,o,e),i=bK(r);t.set(i)})),SK(r,o,t),rc(o,"visibility"),wK(n,e),Kw.requestAnimationFrame((function(){SK(r,o,t)}))}))})),wi(Zo(),(function(n){var e=n.element;CK(e).each((function(n){SK(e,n,t)}))})),wi(hE,(function(n,e){var r=n.element;CK(r).each((function(n){var e=Zl(tu(n));Ka(n,"visibility","hidden");var o=nc(n,"height").map((function(n){return parseInt(n,10)}));rc(n,"height"),rc(n,"flex-basis");var i=n.dom.getBoundingClientRect().height,u=o.forall((function(n){return i>n}));u?(t.set(N.from(i)),SK(r,n,t)):o.each((function(t){xK(n,t)})),rc(n,"visibility"),e.each(Yl)}))}))],r=!1;return{extraEvents:e,selectFirst:r}}(),e=function(){var n=[],t=!0;return{extraEvents:n,selectFirst:t}}();return{smartTabHeight:t,naiveTabHeight:e}},OK="send-data-to-section",TK="send-data-to-view",DK=function(n,t){var e=Ke({}),r=function(n){var t=Kg.getValue(n),r=nK(t).getOr({}),o=e.get(),i=Kn(o,r);e.set(i)},o=function(n){var t=e.get();Kg.setValue(n,t)},i=Ke(null),u=G(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[bB.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:G(n.items,(function(n){return XF(e,n,t)})),formBehaviours:jl([fy.config({mode:"acyclic",useTabstopAt:S(eM)}),Cy("TabView.form.events",[Ai(o),Ri(r)]),ql.config({channels:ft([{key:OK,value:{onReceive:r}},{key:TK,value:{onReceive:o}}])})])}}))]}}})),a=kK(u).smartTabHeight;return hK.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var r=Kg.getValue(t);fi(n,pE,{name:r,oldName:i.get()}),i.set(r)},tabs:u,components:[hK.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[cK.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:jl([nE.config({})])}),hK.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:jl([Cy("tabpanel",a.extraEvents),fy.config({mode:"acyclic"}),yh.config({find:function(n){return ln(hK.getViewItems(n))}}),Kg.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn([OK],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn([TK],{})}}})])})},EK=Pu("update-dialog"),_K=Pu("update-title"),AK=Pu("update-body"),RK=Pu("update-footer"),BK=Pu("body-send-message"),MK=function(n,t,e,r){var o=function(n){switch(n.body.type){case"tabpanel":return[DK(n.body,e)];default:return[tK(n.body,e)]}},i=function(n,t){return N.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:D(D({},t.map((function(n){return{id:n}})).getOr({})),r?u:{})},components:[],behaviours:jl([_B.childAt(0),nj.config({channel:AK,updateState:i,renderComponents:o,initialData:n})])}},IK=function(n,t,e,r){return MK(n,N.some(t),e,r)},NK=function(n,t){var e=MK(n,N.none(),t,!1);return w$.parts.body(e)},FK=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ZB({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:jl([nE.config({}),By.config({})])})]}],behaviours:jl([fy.config({mode:"acyclic",useTabstopAt:S(eM)})])};return w$.parts.body(t)},PK=oO.deviceType.isTouch(),LK=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},zK=function(n,t){return w$.parts.close(Jw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:jl([nE.config({})])}))},jK=function(){return w$.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},HK=function(n,t){return w$.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:AU("<p>"+t.translate(n)+"</p>")}]}]})},VK=function(n){return w$.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},UK=function(n,t){return[WD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),WD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},WK=function(n){var t,e="tox-dialog",r=e+"-wrap",o=r+"__backdrop",i=e+"__disable-scroll";return w$.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),N.some(!0)},useTabstopAt:function(n){return!eM(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:D({position:"relative"},n.extraStyles)},components:_([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:AU('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:PK?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:r,modalBehaviours:jl(_([By.config({}),Cy("dialog-events",n.dialogEvents.concat([_i(Eo(),(function(n,t){fy.focusIn(n)}))])),Cy("scroll-lock",[Ai((function(){Pa(Ga(),i)})),Ri((function(){za(Ga(),i)}))])],n.extraBehaviours)),eventOrder:D((t={},t[Uo()]=["dialog-events"],t[ni()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[ti()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},GK=function(n){return Jw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:nx("close",n.icons)}}],action:function(n){li(n,lE)}})},qK=function(n,t,e){var r=function(n){return[hc(e.translate(n.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:D({},t.map((function(n){return{id:n}})).getOr({}))},components:r(n),behaviours:jl([nj.config({channel:_K,renderComponents:r})])}},$K=function(){return{dom:AU('<div class="tox-dialog__draghandle"></div>')}},XK=function(n,t,e){return WD.sketch({dom:AU('<div class="tox-dialog__header"></div>'),components:[qK(n,N.some(t),e),$K(),GK(e)],containerBehaviours:jl([Wq.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return ps(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},KK=function(n,t){var e=w$.parts.title(qK(n,N.none(),t)),r=w$.parts.draghandle($K()),o=w$.parts.close(GK(t)),i=[e].concat(n.draggable?[r]:[]).concat([o]);return WD.sketch({dom:AU('<div class="tox-dialog__header"></div>'),components:i})},YK=function(n,t){return KK({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},JK=function(n,t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(n)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:AU('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},QK=function(n,t,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){w$.setBusy(n(),(function(n,r){return JK(e.message,r,t)}))},onUnblock:function(){w$.setIdle(n())}}},ZK=function(n,t,e,r){var o,i=function(n,t){return N.some(t)};return yc(WK(D(D({},n),{lazySink:r.shared.getSink,extraBehaviours:_([nj.config({channel:EK,updateState:i,initialData:t}),GB.memory({})],n.extraBehaviours),onEscape:function(n){li(n,lE)},dialogEvents:e,eventOrder:(o={},o[Vo()]=[nj.name(),ql.name()],o[ni()]=["scroll-lock",nj.name(),"messages","dialog-events","alloy.base.behaviour"],o[ti()]=["alloy.base.behaviour","dialog-events","messages",nj.name(),"scroll-lock"],o)})))},nY=function(n){var t=function(n){var t=G(n.items,(function(n){var t=Ke(!1);return D(D({},n),{storage:t})}));return D(D({},n),{items:t})};return G(n,(function(n){return"menu"===n.type?t(n):n}))},tY=function(n){return J(n,(function(n,t){if("menu"===t.type){var e=t;return J(e.items,(function(n,t){return n[t.name]=t.storage,n}),n)}return n}),{})},eY=function(n,t){return[Ti(Eo(),tM),n(sE,(function(n,e){t.onClose(),e.onClose()})),n(lE,(function(n,t,e,r){t.onCancel(n),li(r,sE)})),wi(gE,(function(n,e){return t.onUnblock()})),wi(mE,(function(n,e){return t.onBlock(e.event)}))]},rY=function(n,t){var e=function(t,e){return wi(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event,t)}))}))},r=function(n,t){nj.getState(n).get().each((function(e){t(e,n)}))};return _(eY(e,t),[e(fE,(function(n,t,e){t.onAction(n,{name:e.name})}))])},oY=function(n,t,e){var r=function(t,e){return wi(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event,t)}))}))},o=function(n,t){nj.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return _(eY(r,t),[r(dE,(function(n,t){return t.onSubmit(n)})),r(cE,(function(n,t,e){t.onChange(n,{name:e.name})})),r(fE,(function(n,t,r,o){var i=function(){return fy.focusIn(o)},u=function(n){return Du(n,"disabled")||Tu(n,"aria-disabled").exists((function(n){return"true"===n}))},a=tu(o.element),c=Zl(a);t.onAction(n,{name:r.name,value:r.value}),Zl(a).fold(i,(function(n){u(n)||c.exists((function(t){return ao(n,t)&&u(t)}))?i():e().toOptional().filter((function(t){return!ao(t.element,n)})).each(i)}))})),r(pE,(function(n,t,e){t.onTabChange(n,{newTabName:e.name,oldTabName:e.oldName})})),Ri((function(t){var e=n();Kg.setValue(t,e.getData())}))])},iY={initUrlDialog:rY,initDialog:oY},uY=function(n,t){return WI(n,n.type,t)},aY=function(n,t,e){return Z(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))},cY=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),r=X(e,(function(n){return"start"===n.align})),o=function(n,t){return WD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:G(t,(function(n){return n.memento.asSpec()}))})},i=o("start",r.pass),u=o("end",r.fail);return[i,u]},sY=function(n,t){var e=function(n,e){var r=G(e.buttons,(function(n){var e=Qw(uY(n,t));return{name:n.name,align:n.align,memento:e}})),o=function(n,t){return aY(n,r,t)};return N.some({lookupByName:o,footerButtons:r})};return{dom:AU('<div class="tox-dialog__footer"></div>'),components:[],behaviours:jl([nj.config({channel:RK,initialData:n,updateState:e,renderComponents:cY})])}},lY=function(n,t){return sY(n,t)},fY=function(n,t){return w$.parts.footer(sY(n,t))},dY=function(n,t){var e=n.getRoot();if(e.getSystem().isConnected()){var r=yh.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return bB.getField(r,t).fold((function(){var e=n.getFooter(),o=nj.getState(e);return o.get().bind((function(n){return n.lookupByName(r,t)}))}),(function(n){return N.some(n)}))}return N.none()},mY=function(n,t){var e=n.getRoot();return nj.getState(e).get().map((function(n){return oe(re("data",n.dataValidator,t))})).getOr(t)},gY=function(n,t,e){var r=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},o=function(){var t=n.getRoot(),r=t.getSystem().isConnected()?n.getFormWrapper():t,o=Kg.getValue(r),i=Bn(e,(function(n){return n.get()}));return D(D({},o),i)},u=function(t){r((function(r){var o=p.getData(),i=D(D({},o),t),u=mY(n,i),a=n.getFormWrapper();Kg.setValue(a,u),Rn(e,(function(n,t){Hn(i,t)&&n.set(i[t])}))}))},a=function(t){dY(n,t).each(YC.disable)},c=function(t){dY(n,t).each(YC.enable)},s=function(t){dY(n,t).each(By.focus)},l=function(n){if(!i(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(t){fi(t,mE,{message:n})}))},f=function(){r((function(n){li(n,gE)}))},d=function(t){r((function(e){var r=n.getBody(),o=nj.getState(r);o.get().exists((function(n){return n.isTabPanel()}))&&yh.getCurrent(r).each((function(n){hK.showTab(n,t)}))}))},m=function(n){r((function(e){var r=t(n);e.getSystem().broadcastOn([EK],r),e.getSystem().broadcastOn([_K],r.internalDialog),e.getSystem().broadcastOn([AK],r.internalDialog),e.getSystem().broadcastOn([RK],r.internalDialog),p.setData(r.initialData)}))},g=function(){r((function(n){li(n,sE)}))},p={getData:o,setData:u,disable:a,enable:c,focus:s,block:l,unblock:f,showTab:d,redial:m,close:g};return p},pY=function(n){switch(n){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},hY=function(n,t,e){var r=YK(n.internalDialog.title,e),o=NK({body:n.internalDialog.body},e),i=nY(n.internalDialog.buttons),u=tY(i),a=fY({buttons:i},e),c=iY.initDialog((function(){return m}),QK((function(){return f}),e.shared.providers,t),e.shared.getSink),s=pY(n.internalDialog.size),l={header:r,body:o,footer:N.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},f=ZK(l,n,c,e),d=function(){var n=function(){var n=w$.getBody(f);return yh.getCurrent(n).getOr(n)};return{getRoot:function(){return f},getBody:function(){return w$.getBody(f)},getFooter:function(){return w$.getFooter(f)},getFormWrapper:n}}(),m=gY(d,t.redial,u);return{dialog:f,instanceApi:m}},vY=function(n,t,e,r){var o,i,u=Pu("dialog-label"),a=Pu("dialog-content"),c=function(n,t){return N.some(t)},s=Qw(XK({title:n.internalDialog.title,draggable:!0},u,e.shared.providers)),l=Qw(IK({body:n.internalDialog.body},a,e,r)),f=nY(n.internalDialog.buttons),d=tY(f),m=Qw(lY({buttons:f},e)),g=iY.initDialog((function(){return h}),{onBlock:function(n){b$.block(p,(function(t,r){return JK(n.message,r,e.shared.providers)}))},onUnblock:function(){b$.unblock(p)},onClose:function(){return t.closeWindow()}},e.shared.getSink),p=yc({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(o={role:"dialog"},o["aria-labelledby"]=u,o["aria-describedby"]=""+a,o)},eventOrder:(i={},i[Vo()]=[nj.name(),ql.name()],i[Uo()]=["execute-on-form"],i[ni()]=["reflecting","execute-on-form"],i),behaviours:jl([fy.config({mode:"cyclic",onEscape:function(n){return li(n,sE),N.some(!0)},useTabstopAt:function(n){return!eM(n)&&("button"!==Ii(n)||"disabled"!==Ou(n,"disabled"))}}),nj.config({channel:EK,updateState:c,initialData:n}),By.config({}),Cy("execute-on-form",g.concat([_i(Eo(),(function(n,t){fy.focusIn(n)}))])),b$.config({getRoot:function(){return N.some(p)}}),xy.config({}),GB.memory({})]),components:[s.asSpec(),l.asSpec(),m.asSpec()]}),h=gY({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return l.get(p)},getFormWrapper:function(){var n=l.get(p);return yh.getCurrent(n).getOr(n)}},t.redial,d);return{dialog:p,instanceApi:h}},bY=tinymce.util.Tools.resolve("tinymce.util.URI"),yY=function(n){var t=function(t){n.getSystem().isConnected()&&t(n)},e=function(n){if(!i(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((function(t){fi(t,mE,{message:n})}))},r=function(){t((function(n){li(n,gE)}))},o=function(){t((function(n){li(n,sE)}))},u=function(n){t((function(t){t.getSystem().broadcastOn([BK],n)}))};return{block:e,unblock:r,close:o,sendMessage:u}},wY=["insertContent","setContent","execCommand","close","block","unblock"],xY=function(n){return u(n)&&-1!==wY.indexOf(n.mceAction)},SY=function(n){return!xY(n)&&u(n)&&Hn(n,"mceAction")},CY=function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content);break;case"setContent":n.setContent(e.content);break;case"execCommand":var r=!!c(e.ui)&&e.ui;n.execCommand(e.cmd,r,e.value);break;case"close":t.close();break;case"block":t.block(e.message);break;case"unblock":t.unblock();break}},kY=function(n,t,e,r){var o,i=YK(n.title,r),u=FK(n),a=n.buttons.bind((function(n){return 0===n.length?N.none():N.some(fY({buttons:n},r))})),c=iY.initUrlDialog((function(){return v}),QK((function(){return h}),r.shared.providers,t)),s=D(D({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),l=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],f=new bY(n.url,{base_uri:new bY(window.location.href)}),d=f.protocol+"://"+f.host+(f.port?":"+f.port:""),m=Ke(N.none()),g=[Cy("messages",[Ai((function(){var t=mD(tr.fromDom(window),"message",(function(t){if(f.isSameOrigin(new bY(t.raw.origin))){var r=t.raw.data;xY(r)?CY(e,v,r):SY(r)&&n.onMessage(v,r)}}));m.set(N.some(t))})),Ri((function(){m.get().each((function(n){return n.unbind()}))}))]),ql.config({channels:(o={},o[BK]={onReceive:function(n,t){gs(n.element,"iframe").each((function(n){var e=n.dom.contentWindow;e.postMessage(t,d)}))}},o)})],p={header:i,body:u,footer:a,extraClasses:l,extraBehaviours:g,extraStyles:s},h=ZK(p,n,c,r),v=yY(h);return{dialog:h,instanceApi:v}},OY=function(n){var t=n.backstage.shared,e=function(e,r){var o=function(){w$.hide(c),r()},i=Qw(WI({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:N.none()},"cancel",n.backstage)),u=jK(),a=zK(o,t.providers),c=yc(WK({lazySink:function(){return t.getSink()},header:LK(u,a),body:HK(e,t.providers),footer:N.some(VK(UK([],[i.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[wi(lE,o)],eventOrder:{}}));w$.show(c);var s=i.get(c);By.focus(s)};return{open:e}},TY=function(n){var t=n.backstage.shared,e=function(e,r){var o=function(n){w$.hide(s),r(n)},i=Qw(WI({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:N.none()},"submit",n.backstage)),u=WI({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:N.none()},"cancel",n.backstage),a=jK(),c=zK((function(){return o(!1)}),t.providers),s=yc(WK({lazySink:function(){return t.getSink()},header:LK(a,c),body:HK(e,t.providers),footer:N.some(VK(UK([],[u,i.asSpec()]))),onEscape:function(){return o(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[wi(lE,(function(){return o(!1)})),wi(dE,(function(){return o(!0)}))],eventOrder:{}}));w$.show(s);var l=i.get(s);By.focus(l)};return{open:e}},DY=function(n,t){return oe(re("data",t,n))},EY=function(n){return hD(n,".tox-alert-dialog")||hD(n,".tox-confirm-dialog")},_Y=function(n,t,e){return t&&e?[]:[WV.config({contextual:{lazyContext:function(){return N.some(os(tr.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},AY=function(n){var t=n.backstage,e=n.editor,r=Ek(e),o=OY(n),i=TY(n),u=function(n,e,r){return void 0!==e&&"toolbar"===e.inline?l(n,t.shared.anchors.inlineDialog(),r,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?l(n,t.shared.anchors.cursor(),r,e.ariaAttrs):s(n,r)},a=function(n,t){return c(n,t)},c=function(n,r){var o=function(n){var o=kY(n,{closeWindow:function(){w$.hide(o.dialog),r(o.instanceApi)}},e,t);return w$.show(o.dialog),o.instanceApi};return ZX.openUrl(o,n)},s=function(n,e){var r=function(n,r,o){var i=r,u={dataValidator:o,initialData:i,internalDialog:n},a=hY(u,{redial:ZX.redial,closeWindow:function(){w$.hide(a.dialog),e(a.instanceApi)}},t);return w$.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return ZX.open(r,n)},l=function(n,o,i,u){var a=function(n,a,c){var s=DY(a,c),l=kH(),f=t.shared.header.isPositionedAtTop(),d={dataValidator:c,initialData:s,internalDialog:n},m=function(){return l.on((function(n){Pw.reposition(n),WV.refresh(n)}))},g=vY(d,{redial:ZX.redial,closeWindow:function(){l.on(Pw.hide),e.off("ResizeEditor",m),l.clear(),i(g.instanceApi)}},t,u),p=yc(Pw.sketch(D(D({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},f?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:jl(_([Cy("window-manager-inline-events",[wi(ei(),(function(n,t){li(g.dialog,lE)}))])],_Y(e,r,f))),isExtraPart:function(n,t){return EY(t)}})));return l.set(p),Pw.showWithin(p,o,wc(g.dialog),N.some(Ga())),r&&f||(WV.refresh(p),e.on("ResizeEditor",m)),g.instanceApi.setData(s),fy.focusIn(g.dialog),g.instanceApi};return ZX.open(a,n)},f=function(n,t){i.open(n,(function(n){t(n)}))},d=function(n,t){o.open(n,(function(){t()}))},m=function(n){n.close()};return{open:u,openUrl:a,alert:d,close:m,confirm:f}};function RY(){T.add("silver",(function(n){var t=u$(n),e=t.uiMothership,r=t.backstage,o=t.renderUI,i=t.getUi;fD.register(n,r.shared);var u=AY({editor:n,backstage:r});return{renderUI:o,getWindowManagerImpl:y(u),getNotificationManagerImpl:function(){return ux(n,{backstage:r},e)},ui:i()}}))}RY()})()}).call(this,e("2409"))},cd32:function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},e=function(n){return function(e){return t(e)===n}},r=function(n){return function(t){return typeof t===n}},o=e("string"),i=e("object"),u=e("array"),a=r("boolean"),c=r("function"),s=r("number"),l=function(){},f=function(n){return function(){return n}},d=function(n){return function(t){return!n(t)}},m=f(!1),g=f(!0),p=function(){return h},h=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},r={fold:function(n,t){return n()},is:m,isSome:m,isNone:g,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:f(null),getOrUndefined:f(void 0),or:e,orThunk:t,map:p,each:l,bind:p,exists:m,forall:g,filter:p,equals:n,equals_:n,toArray:function(){return[]},toString:f("none()")};return r}(),v=function(n){var t=f(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:g,isNone:m,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return v(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:h},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(m,(function(t){return e(n,t)}))}};return o},b=function(n){return null===n||void 0===n?h:v(n)},y={some:v,none:p,from:b},w=Array.prototype.slice,x=Array.prototype.push,S=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},C=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},k=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},O=function(n,t){if(0===n.length)return[];for(var e=t(n[0]),r=[],o=[],i=0,u=n.length;i<u;i++){var a=n[i],c=t(a);c!==e&&(r.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&r.push(o),r},T=function(n,t,e){return C(n,(function(n){e=t(e,n)})),e},D=function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(t(i,r))return y.some(i);if(e(i,r))break}return y.none()},E=function(n,t){return D(n,t,m)},_=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!u(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);x.apply(t,n[e])}return t},A=function(n,t){return _(S(n,t))},R=function(n){var t=w.call(n,0);return t.reverse(),t},B=function(n,t){return t>=0&&t<n.length?y.some(n[t]):y.none()},M=function(n){return B(n,0)},I=function(n){return B(n,n.length-1)},N=function(){return N=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},N.apply(this,arguments)};function F(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var P=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},L=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),s=i||u&&!c,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!s&&!c&&!l;return{isiPad:f(o),isiPhone:f(i),isTablet:f(c),isPhone:f(s),isTouch:f(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:f(l),isDesktop:f(d)}},z=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}},j=function(n,t){var e=z(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return U(r(1),r(2))},H=function(n,t){var e=String(t).toLowerCase();return 0===n.length?V():j(n,e)},V=function(){return U(0,0)},U=function(n,t){return{major:n,minor:t}},W={nu:U,detect:H,unknown:V},G=function(n,t){var e=String(t).toLowerCase();return E(n,(function(n){return n.search(e)}))},q=function(n,t){return G(n,t).map((function(n){var e=W.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},$=function(n,t){return G(n,t).map((function(n){var e=W.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},X={detectBrowser:q,detectOs:$},K=function(n,t){return-1!==n.indexOf(t)},Y=function(n){return function(t){return t.replace(n,"")}},J=Y(/^\s+|\s+$/g),Q=function(n){return n.length>0},Z=function(n){return!Q(n)},nn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tn=function(n){return function(t){return K(t,n)}},en=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return K(n,"edge/")&&K(n,"chrome")&&K(n,"safari")&&K(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nn],search:function(n){return K(n,"chrome")&&!K(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return K(n,"msie")||K(n,"trident")}},{name:"Opera",versionRegexes:[nn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tn("firefox")},{name:"Safari",versionRegexes:[nn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(K(n,"safari")||K(n,"mobile/"))&&K(n,"applewebkit")}}],rn=[{name:"Windows",search:tn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return K(n,"iphone")||K(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:tn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tn("linux"),versionRegexes:[]},{name:"Solaris",search:tn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],on={browsers:f(en),oses:f(rn)},un="Edge",an="Chrome",cn="IE",sn="Opera",ln="Firefox",fn="Safari",dn=function(){return mn({current:void 0,version:W.unknown()})},mn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(un),isChrome:r(an),isIE:r(cn),isOpera:r(sn),isFirefox:r(ln),isSafari:r(fn)}},gn={unknown:dn,nu:mn,edge:f(un),chrome:f(an),ie:f(cn),opera:f(sn),firefox:f(ln),safari:f(fn)},pn="Windows",hn="iOS",vn="Android",bn="Linux",yn="OSX",wn="Solaris",xn="FreeBSD",Sn="ChromeOS",Cn=function(){return kn({current:void 0,version:W.unknown()})},kn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(pn),isiOS:r(hn),isAndroid:r(vn),isOSX:r(yn),isLinux:r(bn),isSolaris:r(wn),isFreeBSD:r(xn),isChromeOS:r(Sn)}},On={unknown:Cn,nu:kn,windows:f(pn),ios:f(hn),android:f(vn),linux:f(bn),osx:f(yn),solaris:f(wn),freebsd:f(xn),chromeos:f(Sn)},Tn=function(n,t){var e=on.browsers(),r=on.oses(),o=X.detectBrowser(e,n).fold(gn.unknown,gn.nu),i=X.detectOs(r,n).fold(On.unknown,On.nu),u=L(i,o,n,t);return{browser:o,os:i,deviceType:u}},Dn={detect:Tn},En=function(n){return window.matchMedia(n).matches},_n=P((function(){return Dn.detect(navigator.userAgent,En)})),An=function(){return _n()},Rn=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},Bn=function(n,t){return Rn(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},Mn=1,In=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw new Error("HTML must have a single root node");return Pn(r.childNodes[0])},Nn=function(n,t){var e=t||document,r=e.createElement(n);return Pn(r)},Fn=function(n,t){var e=t||document,r=e.createTextNode(n);return Pn(r)},Pn=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},Ln=function(n,t,e){return y.from(n.dom.elementFromPoint(t,e)).map(Pn)},zn={fromHtml:In,fromTag:Nn,fromText:Fn,fromDom:Pn,fromPoint:Ln},jn=function(n,t){var e=n.dom;if(e.nodeType!==Mn)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Hn=function(n,t){return n.dom===t.dom},Vn=function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)},Un=function(n,t){return Bn(n.dom,t.dom)},Wn=function(n,t){return An().browser.isIE()?Un(n,t):Vn(n,t)},Gn=jn,qn=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),$n=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Xn=tinymce.util.Tools.resolve("tinymce.util.VK"),Kn=Object.keys,Yn=function(n,t){for(var e=Kn(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},Jn=function(n){return function(t,e){n[e]=t}},Qn=function(n,t,e,r){var o={};return Yn(n,(function(n,o){(t(n,o)?e:r)(n,o)})),o},Zn=function(n,t){var e={};return Qn(n,t,Jn(e),l),e},nt=("undefined"!==typeof window?window:Function("return this;")(),function(n){var t=n.dom.nodeName;return t.toLowerCase()}),tt=function(n){return n.dom.nodeType},et=function(n){return function(t){return tt(t)===n}},rt=et(Mn),ot=function(n,t,e){if(!(o(e)||a(e)||s(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")},it=function(n,t){var e=n.dom;Yn(t,(function(n,t){ot(e,t,n)}))},ut=function(n){return T(n.dom.attributes,(function(n,t){return n[t.name]=t.value,n}),{})},at=function(n){return y.from(n.dom.parentNode).map(zn.fromDom)},ct=function(n){return S(n.dom.childNodes,zn.fromDom)},st=function(n,t){var e=n.dom.childNodes;return y.from(e[t]).map(zn.fromDom)},lt=function(n){return st(n,0)},ft=function(n){return st(n,n.dom.childNodes.length-1)},dt=function(n,t){var e=at(n);e.each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},mt=function(n,t){n.dom.appendChild(t.dom)},gt=function(n,t){C(t,(function(t){dt(n,t)}))},pt=function(n,t){C(t,(function(t){mt(n,t)}))},ht=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},vt=function(n,t){return zn.fromDom(n.dom.cloneNode(t))},bt=function(n){return vt(n,!0)},yt=function(n,t){var e=zn.fromTag(t),r=ut(n);return it(e,r),e},wt=function(n,t){var e=yt(n,t);dt(n,e);var r=ct(n);return pt(e,r),ht(n),e},xt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),St=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ct=function(n){return function(t){return t&&t.nodeName.toLowerCase()===n}},kt=function(n){return function(t){return t&&n.test(t.nodeName)}},Ot=function(n){return n&&3===n.nodeType},Tt=kt(/^(OL|UL|DL)$/),Dt=kt(/^(OL|UL)$/),Et=Ct("ol"),_t=kt(/^(LI|DT|DD)$/),At=kt(/^(DT|DD)$/),Rt=kt(/^(TH|TD)$/),Bt=Ct("br"),Mt=function(n){return n.parentNode.firstChild===n},It=function(n,t){return t&&!!n.schema.getTextBlockElements()[t.nodeName]},Nt=function(n,t){return n&&n.nodeName in t},Ft=function(n,t){return!!Bt(t)&&(n.isBlock(t.nextSibling)&&!Bt(t.previousSibling))},Pt=function(n,t,e){var r=n.isEmpty(t);return!(e&&n.select("span[data-mce-type=bookmark]",t).length>0)&&r},Lt=function(n,t){return n.isChildOf(t,n.getRoot())},zt=function(n){return n.getParam("lists_indent_on_tab",!0)},jt=function(n){var t=n.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Ht=function(n){return n.getParam("forced_root_block_attrs",{})},Vt=function(n,t){var e,r,o,i=n.dom,u=n.schema.getBlockElements(),a=i.createFragment(),c=jt(n);if(c&&(r=i.create(c),r.tagName===c.toUpperCase()&&i.setAttribs(r,Ht(n)),Nt(t.firstChild,u)||a.appendChild(r)),t)while(e=t.firstChild){var s=e.nodeName;o||"SPAN"===s&&"bookmark"===e.getAttribute("data-mce-type")||(o=!0),Nt(e,u)?(a.appendChild(e),r=null):c?(r||(r=i.create(c),a.appendChild(r)),r.appendChild(e)):a.appendChild(e)}return c?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):a.appendChild(i.create("br")),a},Ut=xt.DOM,Wt=function(n,t,e){var r=function(n){St.each(o,(function(t){n.parentNode.insertBefore(t,e.parentNode)})),Ut.remove(n)},o=Ut.select('span[data-mce-type="bookmark"]',t),i=Vt(n,e),u=Ut.createRng();u.setStartAfter(e),u.setEndAfter(t);for(var a=u.extractContents(),c=a.firstChild;c;c=c.firstChild)if("LI"===c.nodeName&&n.dom.isEmpty(c)){Ut.remove(c);break}n.dom.isEmpty(a)||Ut.insertAfter(a,t),Ut.insertAfter(i,t),Pt(n.dom,e.parentNode)&&r(e.parentNode),Ut.remove(e),Pt(n.dom,t)&&Ut.remove(t)},Gt=function(n,t){Gn(t,"dd")?wt(t,"dt"):Gn(t,"dt")&&at(t).each((function(e){return Wt(n,e.dom,t.dom)}))},qt=function(n){Gn(n,"dt")&&wt(n,"dd")},$t=function(n,t,e){C(e,"Indent"===t?qt:function(t){return Gt(n,t)})},Xt=function(n,t){if(Ot(n))return{container:n,offset:t};var e=qn.getNode(n,t);return Ot(e)?{container:e,offset:t>=n.childNodes.length?e.data.length:0}:e.previousSibling&&Ot(e.previousSibling)?{container:e.previousSibling,offset:e.previousSibling.data.length}:e.nextSibling&&Ot(e.nextSibling)?{container:e.nextSibling,offset:0}:{container:n,offset:t}},Kt=function(n){var t=n.cloneRange(),e=Xt(n.startContainer,n.startOffset);t.setStart(e.container,e.offset);var r=Xt(n.endContainer,n.endOffset);return t.setEnd(r.container,r.offset),t},Yt=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Jt=function(n,t){var e=t||n.selection.getStart(!0);return n.dom.getParent(e,"OL,UL,DL",oe(n,e))},Qt=function(n,t){return n&&1===t.length&&t[0]===n},Zt=function(n){return St.grep(n.querySelectorAll("ol,ul,dl"),(function(n){return Tt(n)}))},ne=function(n){var t=Jt(n),e=n.selection.getSelectedBlocks();return Qt(t,e)?Zt(t):St.grep(e,(function(n){return Tt(n)&&t!==n}))},te=function(n,t){var e=St.map(t,(function(t){var e=n.dom.getParent(t,"li,dd,dt",oe(n,t));return e||t}));return Yt.unique(e)},ee=function(n){var t=n.selection.getSelectedBlocks();return St.grep(te(n,t),(function(n){return _t(n)}))},re=function(n){return k(ee(n),At)},oe=function(n,t){var e=n.dom.getParents(t,"TD,TH"),r=e.length>0?e[0]:n.getBody();return r},ie=function(n,t){var e=n.dom.getParents(t,"ol,ul",oe(n,t));return I(e)},ue=function(n){var t=ie(n,n.selection.getStart()),e=k(n.selection.getSelectedBlocks(),Dt);return t.toArray().concat(e)},ae=function(n){var t=ue(n);return ce(n,t)},ce=function(n,t){var e=S(t,(function(t){return ie(n,t).getOr(t)}));return Yt.unique(e)},se=function(n,t,e){return n.isSome()&&t.isSome()?y.some(e(n.getOrDie(),t.getOrDie())):y.none()},le=function(n,t){var e=t||document,r=e.createDocumentFragment();return C(n,(function(n){r.appendChild(n.dom)})),zn.fromDom(r)},fe=function(n,t,e){return n.fire("ListMutation",{action:t,element:e})},de=function(n){return void 0!==n.style&&c(n.style.getPropertyValue)},me=function(n,t,e){if(!o(e))throw new Error("CSS value must be a string: "+e);de(n)&&n.style.setProperty(t,e)},ge=function(n,t,e){var r=n.dom;me(r,t,e)},pe=function(n,t){mt(n.item,t.list)},he=function(n){for(var t=1;t<n.length;t++)pe(n[t-1],n[t])},ve=function(n,t){se(I(n),M(t),pe)},be=function(n,t){var e={list:zn.fromTag(t,n),item:zn.fromTag("li",n)};return mt(e.list,e.item),e},ye=function(n,t,e){for(var r=[],o=0;o<e;o++)r.push(be(n,t.listType));return r},we=function(n,t){for(var e=0;e<n.length-1;e++)ge(n[e].item,"list-style-type","none");I(n).each((function(n){it(n.list,t.listAttributes),it(n.item,t.itemAttributes),pt(n.item,t.content)}))},xe=function(n,t){nt(n.list)!==t.listType&&(n.list=wt(n.list,t.listType)),it(n.list,t.listAttributes)},Se=function(n,t,e){var r=zn.fromTag("li",n);return it(r,t),pt(r,e),r},Ce=function(n,t){mt(n.list,t),n.item=t},ke=function(n,t,e){var r=t.slice(0,e.depth);return I(r).each((function(t){var r=Se(n,e.itemAttributes,e.content);Ce(t,r),xe(t,e)})),r},Oe=function(n,t,e){var r=ye(n,e,e.depth-t.length);return he(r),we(r,e),ve(t,r),t.concat(r)},Te=function(n,t){var e=T(t,(function(t,e){return e.depth>t.length?Oe(n,t,e):ke(n,t,e)}),[]);return M(e).map((function(n){return n.list}))},De=function(n){return Gn(n,"OL,UL")},Ee=function(n){return lt(n).map(De).getOr(!1)},_e=function(n){return ft(n).map(De).getOr(!1)},Ae=function(n){return n.depth>0},Re=function(n){return n.isSelected},Be=function(n){var t=ct(n),e=_e(n)?t.slice(0,-1):t;return S(e,bt)},Me=function(n,t,e){return at(n).filter(rt).map((function(r){return{depth:t,dirty:!1,isSelected:e,content:Be(n),itemAttributes:ut(n),listAttributes:ut(r),listType:nt(r)}}))},Ie=function(n,t){switch(n){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0},Ne=function(n,t){n.listType=t.listType,n.listAttributes=N({},t.listAttributes)},Fe=function(n){n.listAttributes=Zn(n.listAttributes,(function(n,t){return"start"!==t}))},Pe=function(n,t){var e=n[t].depth,r=function(n){return n.depth===e&&!n.dirty},o=function(n){return n.depth<e};return D(R(n.slice(0,t)),r,o).orThunk((function(){return D(n.slice(t+1),r,o)}))},Le=function(n){return C(n,(function(t,e){Pe(n,e).fold((function(){t.dirty&&Fe(t)}),(function(n){return Ne(t,n)}))})),n},ze=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},je=function(n,t,e,r){return lt(r).filter(De).fold((function(){t.each((function(n){Hn(n.start,r)&&e.set(!0)}));var o=Me(r,n,e.get());t.each((function(n){Hn(n.end,r)&&e.set(!1)}));var i=ft(r).filter(De).map((function(r){return He(n,t,e,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return He(n,t,e,r)}))},He=function(n,t,e,r){return A(ct(r),(function(r){var o=De(r)?He:je,i=n+1;return o(i,t,e,r)}))},Ve=function(n,t){var e=ze(!1),r=0;return S(n,(function(n){return{sourceList:n,entries:He(r,t,e,n)}}))},Ue=function(n,t){var e=Le(t);return S(e,(function(t){var e=le(t.content);return zn.fromDom(Vt(n,e.dom))}))},We=function(n,t){var e=Le(t);return Te(n.contentDocument,e).toArray()},Ge=function(n,t){return A(O(t,Ae),(function(t){var e=M(t).map(Ae).getOr(!1);return e?We(n,t):Ue(n,t)}))},qe=function(n,t){C(k(n,Re),(function(n){return Ie(t,n)}))},$e=function(n){var t=S(ee(n),zn.fromDom);return se(E(t,d(Ee)),E(R(t),d(Ee)),(function(n,t){return{start:n,end:t}}))},Xe=function(n,t,e){var r=Ve(t,$e(n));C(r,(function(t){qe(t.entries,e);var r=Ge(n,t.entries);C(r,(function(t){fe(n,"Indent"===e?"IndentList":"OutdentList",t.dom)})),gt(t.sourceList,r),ht(t.sourceList)}))},Ke=function(n,t){var e=S(ae(n),zn.fromDom),r=S(re(n),zn.fromDom),o=!1;if(e.length||r.length){var i=n.selection.getBookmark();Xe(n,e,t),$t(n,t,r),n.selection.moveToBookmark(i),n.selection.setRng(Kt(n.selection.getRng())),n.nodeChanged(),o=!0}return o},Ye=function(n){return Ke(n,"Indent")},Je=function(n){return Ke(n,"Outdent")},Qe=function(n){return Ke(n,"Flatten")},Ze=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),nr=xt.DOM,tr=function(n){var t={},e=function(e){var r,o,i;o=n[e?"startContainer":"endContainer"],i=n[e?"startOffset":"endOffset"],1===o.nodeType&&(r=nr.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),e?o.insertBefore(r,o.childNodes[i]):nr.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[e?"startContainer":"endContainer"]=o,t[e?"startOffset":"endOffset"]=i};return e(!0),n.collapsed||e(),t},er=function(n){var t=function(t){var e,r,o,i=function(n){var t=n.parentNode.firstChild,e=0;while(t){if(t===n)return e;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||e++,t=t.nextSibling}return-1};e=o=n[t?"startContainer":"endContainer"],r=n[t?"startOffset":"endOffset"],e&&(1===e.nodeType&&(r=i(e),e=e.parentNode,nr.remove(o),!e.hasChildNodes()&&nr.isBlock(e)&&e.appendChild(nr.create("br"))),n[t?"startContainer":"endContainer"]=e,n[t?"startOffset":"endOffset"]=r)};t(!0),t();var e=nr.createRng();return e.setStart(n.startContainer,n.startOffset),n.endContainer&&e.setEnd(n.endContainer,n.endOffset),Kt(e)},rr=function(n){switch(n){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},or=function(n){return/\btox\-/.test(n.className)},ir=function(n,t,e){var r=function(n){var r=D(n.parents,Tt,Rt).filter((function(n){return n.nodeName===t&&!or(n)})).isSome();e(r)},o=n.dom.getParents(n.selection.getNode());return r({parents:o}),n.on("NodeChange",r),function(){return n.off("NodeChange",r)}},ur=function(n,t,e){var r=e["list-style-type"]?e["list-style-type"]:null;n.setStyle(t,"list-style-type",r)},ar=function(n,t){St.each(t,(function(t,e){n.setAttribute(e,t)}))},cr=function(n,t,e){ar(t,e["list-attributes"]),St.each(n.select("li",t),(function(n){ar(n,e["list-item-attributes"])}))},sr=function(n,t,e){ur(n,t,e),cr(n,t,e)},lr=function(n,t,e){St.each(e,(function(e){var r;return n.setStyle(t,(r={},r[e]="",r))}))},fr=function(n,t,e,r){var o=t[e?"startContainer":"endContainer"],i=t[e?"startOffset":"endOffset"];1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!e&&Bt(o.nextSibling)&&(o=o.nextSibling);while(o.parentNode!==r){if(It(n,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},dr=function(n,t,e){for(var r,o=[],i=n.dom,u=fr(n,t,!0,e),a=fr(n,t,!1,e),c=[],s=u;s;s=s.nextSibling)if(c.push(s),s===a)break;return St.each(c,(function(t){if(It(n,t))return o.push(t),void(r=null);if(i.isBlock(t)||Bt(t))return Bt(t)&&i.remove(t),void(r=null);var u=t.nextSibling;Ze.isBookmarkNode(t)&&(Tt(u)||It(n,u)||!u&&t.parentNode===e)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o},mr=function(n,t,e){var r=n.getStyle(t,"list-style-type"),o=e?e["list-style-type"]:"";return o=null===o?"":o,r===o},gr=function(n,t,e){var r=n.selection.getRng(),o="LI",i=oe(n,n.selection.getStart(!0)),u=n.dom;if("false"!==u.getContentEditable(n.selection.getNode())){t=t.toUpperCase(),"DL"===t&&(o="DT");var a=tr(r),c=dr(n,r,i);St.each(c,(function(r){var i,a=r.previousSibling,c=r.parentNode;_t(c)||(a&&Tt(a)&&a.nodeName===t&&mr(u,a,e)?(i=a,r=u.rename(r,o),a.appendChild(r)):(i=u.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=u.rename(r,o)),lr(u,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),sr(u,i,e),yr(n.dom,i))})),n.selection.setRng(er(a))}},pr=function(n,t){return n&&t&&Tt(n)&&n.nodeName===t.nodeName},hr=function(n,t,e){var r=n.getStyle(t,"list-style-type",!0),o=n.getStyle(e,"list-style-type",!0);return r===o},vr=function(n,t){return n.className===t.className},br=function(n,t,e){return pr(t,e)&&hr(n,t,e)&&vr(t,e)},yr=function(n,t){var e,r;if(e=t.nextSibling,br(n,t,e)){while(r=e.firstChild)t.appendChild(r);n.remove(e)}if(e=t.previousSibling,br(n,t,e)){while(r=e.lastChild)t.insertBefore(r,t.firstChild);n.remove(e)}},wr=function(n,t,e,r){if(t.nodeName!==e){var o=n.dom.rename(t,e);sr(n.dom,o,r),fe(n,rr(e),o)}else sr(n.dom,t,r),fe(n,rr(e),t)},xr=function(n,t,e,r,o){var i=Tt(t);if(i&&t.nodeName===r&&!Sr(o))Qe(n);else{gr(n,r,o);var u=tr(n.selection.getRng(!0)),a=i?F([t],e):e;St.each(a,(function(t){wr(n,t,r,o)})),n.selection.setRng(er(u))}},Sr=function(n){return"list-style-type"in n},Cr=function(n,t,e,r){if(t!==n.getBody())if(t)if(t.nodeName!==e||Sr(r)||or(t)){var o=tr(n.selection.getRng(!0));sr(n.dom,t,r);var i=n.dom.rename(t,e);yr(n.dom,i),n.selection.setRng(er(o)),gr(n,e,r),fe(n,rr(e),i)}else Qe(n);else gr(n,e,r),fe(n,rr(e),t)},kr=function(n,t,e){var r=Jt(n),o=ne(n),u=i(e)?e:{};o.length>0?xr(n,r,o,t,u):Cr(n,r,t,u)},Or=xt.DOM,Tr=function(n,t){var e,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&(e=r.previousSibling,e&&"LI"===e.nodeName?(e.appendChild(t),Pt(n,r)&&Or.remove(r)):Or.setStyle(r,"listStyleType","none")),Tt(r)&&(e=r.previousSibling,e&&"LI"===e.nodeName&&e.appendChild(t))},Dr=function(n,t){St.each(St.grep(n.select("ol,ul",t)),(function(t){Tr(n,t)}))},Er=function(n,t,e,r){var o=t.startContainer,i=t.startOffset;if(Ot(o)&&(e?i<o.data.length:i>0))return o;var u=n.schema.getNonEmptyElements();1===o.nodeType&&(o=qn.getNode(o,i));var a=new $n(o,r);e&&Ft(n.dom,o)&&a.next();while(o=a[e?"next":"prev2"]()){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(Ot(o)&&o.data.length>0)return o}},_r=function(n,t){var e=t.childNodes;return 1===e.length&&!Tt(e[0])&&n.isBlock(e[0])},Ar=function(n,t){_r(n,t)&&n.remove(t.firstChild,!0)},Rr=function(n,t,e){var r,o=_r(n,e)?e.firstChild:e;if(Ar(n,t),!Pt(n,t,!0))while(r=t.firstChild)o.appendChild(r)},Br=function(n,t,e){var r,o=t.parentNode;if(Lt(n,t)&&Lt(n,e)){Tt(e.lastChild)&&(r=e.lastChild),o===e.lastChild&&Bt(o.previousSibling)&&n.remove(o.previousSibling);var i=e.lastChild;i&&Bt(i)&&t.hasChildNodes()&&n.remove(i),Pt(n,e,!0)&&n.$(e).empty(),Rr(n,t,e),r&&e.appendChild(r);var u=Wn(zn.fromDom(e),zn.fromDom(t)),a=u?n.getParents(t,Tt,e):[];n.remove(t),C(a,(function(t){Pt(n,t)&&t!==n.getRoot()&&n.remove(t)}))}},Mr=function(n,t,e){n.dom.$(e).empty(),Br(n.dom,t,e),n.selection.setCursorLocation(e,0)},Ir=function(n,t,e,r){var o=n.dom;if(o.isEmpty(r))Mr(n,e,r);else{var i=tr(t);Br(o,e,r),n.selection.setRng(er(i))}},Nr=function(n,t,e,r){var o=tr(t);Br(n.dom,e,r);var i=er(o);n.selection.setRng(i)},Fr=function(n,t){var e=n.dom,r=n.selection,o=r.getStart(),i=oe(n,o),u=e.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===n.getBody()&&Pt(e,a))return!0;var c=Kt(r.getRng()),s=e.getParent(Er(n,c,t,i),"LI",i);if(s&&s!==u)return n.undoManager.transact((function(){t?Ir(n,c,s,u):Mt(u)?Je(n):Nr(n,c,u,s)})),!0;if(!s&&!t&&0===c.startOffset&&0===c.endOffset)return n.undoManager.transact((function(){Qe(n)})),!0}return!1},Pr=function(n,t,e){var r=n.getParent(t.parentNode,n.isBlock,e);n.remove(t),r&&n.isEmpty(r)&&n.remove(r)},Lr=function(n,t){var e=n.dom,r=n.selection.getStart(),o=oe(n,r),i=e.getParent(r,e.isBlock,o);if(i&&e.isEmpty(i)){var u=Kt(n.selection.getRng()),a=e.getParent(Er(n,u,t,o),"LI",o);if(a)return n.undoManager.transact((function(){Pr(e,i,o),yr(e,a.parentNode),n.selection.select(a,!0),n.selection.collapse(t)})),!0}return!1},zr=function(n,t){return Fr(n,t)||Lr(n,t)},jr=function(n){var t=n.selection.getStart(),e=oe(n,t),r=n.dom.getParent(t,"LI,DT,DD",e);return!!(r||ee(n).length>0)&&(n.undoManager.transact((function(){n.execCommand("Delete"),Dr(n.dom,n.getBody())})),!0)},Hr=function(n,t){return n.selection.isCollapsed()?zr(n,t):jr(n)},Vr=function(n){n.on("keydown",(function(t){t.keyCode===Xn.BACKSPACE?Hr(n,!1)&&t.preventDefault():t.keyCode===Xn.DELETE&&Hr(n,!0)&&t.preventDefault()}))},Ur=function(n){return{backspaceDelete:function(t){Hr(n,t)}}},Wr=function(n,t){var e=Jt(n);n.undoManager.transact((function(){i(t.styles)&&n.dom.setStyles(e,t.styles),i(t.attrs)&&Yn(t.attrs,(function(t,r){return n.dom.setAttrib(e,r,t)}))}))},Gr=function(n){var t=R(J(n).split("")),e=S(t,(function(n,t){var e=n.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*e}));return T(e,(function(n,t){return n+t}),0)},qr=function(n){if(n--,n<0)return"";var t=n%26,e=Math.floor(n/26),r=qr(e),o=String.fromCharCode("A".charCodeAt(0)+t);return r+o},$r=function(n){return/^[A-Z]+$/.test(n)},Xr=function(n){return/^[a-z]+$/.test(n)},Kr=function(n){return/^[0-9]+$/.test(n)},Yr=function(n){return Kr(n)?2:$r(n)?0:Xr(n)?1:Z(n)?3:4},Jr=function(n){switch(Yr(n)){case 2:return y.some({listStyleType:y.none(),start:n});case 0:return y.some({listStyleType:y.some("upper-alpha"),start:Gr(n).toString()});case 1:return y.some({listStyleType:y.some("lower-alpha"),start:Gr(n).toString()});case 3:return y.some({listStyleType:y.none(),start:""});case 4:return y.none()}},Qr=function(n){var t=parseInt(n.start,10);return n.listStyleType.is("upper-alpha")?qr(t):n.listStyleType.is("lower-alpha")?qr(t).toLowerCase():n.start},Zr=function(n){var t=Jt(n);Et(t)&&n.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Qr({start:n.dom.getAttrib(t,"start","1"),listStyleType:y.some(n.dom.getStyle(t,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(t){var e=t.getData();Jr(e.start).each((function(t){n.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})})),t.close()}})},no=function(n,t){return function(){var e=Jt(n);return e&&e.nodeName===t}},to=function(n){n.addCommand("mceListProps",(function(){Zr(n)}))},eo=function(n){n.on("BeforeExecCommand",(function(t){var e=t.command.toLowerCase();"indent"===e?Ye(n):"outdent"===e&&Je(n)})),n.addCommand("InsertUnorderedList",(function(t,e){kr(n,"UL",e)})),n.addCommand("InsertOrderedList",(function(t,e){kr(n,"OL",e)})),n.addCommand("InsertDefinitionList",(function(t,e){kr(n,"DL",e)})),n.addCommand("RemoveList",(function(){Qe(n)})),to(n),n.addCommand("mceListUpdate",(function(t,e){i(e)&&Wr(n,e)})),n.addQueryStateHandler("InsertUnorderedList",no(n,"UL")),n.addQueryStateHandler("InsertOrderedList",no(n,"OL")),n.addQueryStateHandler("InsertDefinitionList",no(n,"DL"))},ro=function(n){n.on("keydown",(function(t){t.keyCode!==Xn.TAB||Xn.metaKeyPressed(t)||n.undoManager.transact((function(){(t.shiftKey?Je(n):Ye(n))&&t.preventDefault()}))}))},oo=function(n){zt(n)&&ro(n),Vr(n)},io=function(n){var t=function(t){return function(){return n.execCommand(t)}};n.hasPlugin("advlist")||(n.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return ir(n,"OL",t.setActive)}}),n.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return ir(n,"UL",t.setActive)}}))},uo=function(n){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return n.execCommand("mceListProps")},onSetup:function(t){return ir(n,"OL",(function(n){return t.setDisabled(!n)}))}};n.ui.registry.addMenuItem("listprops",t),n.ui.registry.addContextMenu("lists",{update:function(t){var e=Jt(n,t);return Et(e)?["listprops"]:[]}})};function ao(){n.add("lists",(function(n){return!1===n.hasPlugin("rtc",!0)?(oo(n),eo(n)):to(n),io(n),uo(n),Ur(n)}))}ao()})()},cde2:function(n,t,e){e("8b69")},e391:function(n,t){(function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(n){return n},e=function(){return e=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},e.apply(this,arguments)},r="\ufeff",o=function(n){return n.replace(/\uFEFF/g,"")},i=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},u="[!-#%-*,-\\/:;?@\\[-\\]_{};----------------------------------------------]",a={aletter:"[A-Za-z---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]",midnumlet:"[-'\\.]",midletter:"[:]",midnum:"[+*/,;;]",numeric:"[0-9---------------------------------]",cr:"\\r",lf:"\\n",newline:"[\v\f\u2028\u2029]",extend:"[------------------------------------------------------------------------------------------------------]",format:"[----\ufeff-]",katakana:"[-------]",extendnumlet:"[=_--<>]",punctuation:u},c={ALETTER:0,MIDNUMLET:1,MIDLETTER:2,MIDNUM:3,NUMERIC:4,CR:5,LF:6,NEWLINE:7,EXTEND:8,FORMAT:9,KATAKANA:10,EXTENDNUMLET:11,AT:12,OTHER:13},s=[new RegExp(a.aletter),new RegExp(a.midnumlet),new RegExp(a.midletter),new RegExp(a.midnum),new RegExp(a.numeric),new RegExp(a.cr),new RegExp(a.lf),new RegExp(a.newline),new RegExp(a.extend),new RegExp(a.format),new RegExp(a.katakana),new RegExp(a.extendnumlet),new RegExp("@")],l="",f=new RegExp("^"+a.punctuation+"$"),d=/^\s+$/,m=s,g=c.OTHER,p=function(n){for(var t=g,e=m.length,r=0;r<e;++r){var o=m[r];if(o&&o.test(n)){t=r;break}}return t},h=function(n){var t={};return function(e){if(t[e])return t[e];var r=n(e);return t[e]=r,r}},v=function(n){var t=h(p);return i(n,t)},b=function(n,t){var e=n[t],r=n[t+1];if(t<0||t>n.length-1&&0!==t)return!1;if(e===c.ALETTER&&r===c.ALETTER)return!1;var o=n[t+2];if(e===c.ALETTER&&(r===c.MIDLETTER||r===c.MIDNUMLET||r===c.AT)&&o===c.ALETTER)return!1;var i=n[t-1];return(e!==c.MIDLETTER&&e!==c.MIDNUMLET&&r!==c.AT||r!==c.ALETTER||i!==c.ALETTER)&&((e!==c.NUMERIC&&e!==c.ALETTER||r!==c.NUMERIC&&r!==c.ALETTER)&&((e!==c.MIDNUM&&e!==c.MIDNUMLET||r!==c.NUMERIC||i!==c.NUMERIC)&&((e!==c.NUMERIC||r!==c.MIDNUM&&r!==c.MIDNUMLET||o!==c.NUMERIC)&&(e!==c.EXTEND&&e!==c.FORMAT&&i!==c.EXTEND&&i!==c.FORMAT&&r!==c.EXTEND&&r!==c.FORMAT&&((e!==c.CR||r!==c.LF)&&(e===c.NEWLINE||e===c.CR||e===c.LF||(r===c.NEWLINE||r===c.CR||r===c.LF||(e!==c.KATAKANA||r!==c.KATAKANA)&&((r!==c.EXTENDNUMLET||e!==c.ALETTER&&e!==c.NUMERIC&&e!==c.KATAKANA&&e!==c.EXTENDNUMLET)&&((e!==c.EXTENDNUMLET||r!==c.ALETTER&&r!==c.NUMERIC&&r!==c.KATAKANA)&&e!==c.AT)))))))))},y=l,w=d,x=f,S=function(n){return"http"===n||"https"===n},C=function(n,t){var e;for(e=t;e<n.length;e++)if(w.test(n[e]))break;return e},k=function(n,t){var e=C(n,t+1),r=n.slice(t+1,e).join(y);return"://"===r.substr(0,3)?e:t},O=function(n,t,e,r){for(var o=[],i=[],u=0;u<e.length;++u)if(i.push(n[u]),b(e,u)){var a=t[u];if((r.includeWhitespace||!w.test(a))&&(r.includePunctuation||!x.test(a))){var c=u-i.length+1,s=u+1,l=t.slice(c,s).join(y);if(S(l)){var f=k(t,u),d=n.slice(s,f);Array.prototype.push.apply(i,d),u=f}o.push(i)}i=[]}return o},T=function(){return{includeWhitespace:!1,includePunctuation:!1}},D=function(n,t,o){o=e(e({},T()),o);for(var i=[],u=[],a=0;a<n.length;a++){var c=t(n[a]);c!==r&&(i.push(n[a]),u.push(c))}var s=v(u);return O(i,u,s,o)},E=D,_=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),A=function(n,t){var e=t.getBlockElements(),r=t.getShortEndedElements(),i=function(n){return e[n.nodeName]||r[n.nodeName]},u=[],a="",c=new _(n,n);while(n=c.next())3===n.nodeType?a+=o(n.data):i(n)&&a.length&&(u.push(a),a="");return a.length&&u.push(a),u},R=function(n){return n.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},B=function(n,e){var r=A(n,e).join("\n");return E(r.split(""),t).length},M=function(n,t){var e=A(n,t).join("");return R(e)},I=function(n,t){var e=A(n,t).join("").replace(/\s/g,"");return R(e)},N=function(n,t){return function(){return t(n.getBody(),n.schema)}},F=function(n,t){return function(){return t(n.selection.getRng().cloneContents(),n.schema)}},P=function(n){return N(n,B)},L=function(n){return{body:{getWordCount:P(n),getCharacterCount:N(n,M),getCharacterCountWithoutSpaces:N(n,I)},selection:{getWordCount:F(n,B),getCharacterCount:F(n,M),getCharacterCountWithoutSpaces:F(n,I)},getCount:P(n)}},z=tinymce.util.Tools.resolve("tinymce.util.Delay"),j=function(n,t){n.fire("wordCountUpdate",{wordCount:{words:t.body.getWordCount(),characters:t.body.getCharacterCount(),charactersWithoutSpaces:t.body.getCharacterCountWithoutSpaces()}})},H=function(n,t){j(n,t)},V=function(n,t,e){var r=z.debounce((function(){return H(n,t)}),e);n.on("init",(function(){H(n,t),z.setEditorTimeout(n,(function(){n.on("SetContent BeforeAddUndo Undo Redo keyup",r)}),0)}))},U=function(n,t){n.windowManager.open({title:"Word Count",body:{type:"panel",items:[{type:"table",header:["Count","Document","Selection"],cells:[["Words",String(t.body.getWordCount()),String(t.selection.getWordCount())],["Characters (no spaces)",String(t.body.getCharacterCountWithoutSpaces()),String(t.selection.getCharacterCountWithoutSpaces())],["Characters",String(t.body.getCharacterCount()),String(t.selection.getCharacterCount())]]}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]})},W=function(n,t){n.ui.registry.addButton("wordcount",{tooltip:"Word count",icon:"character-count",onAction:function(){return U(n,t)}}),n.ui.registry.addMenuItem("wordcount",{text:"Word count",icon:"character-count",onAction:function(){return U(n,t)}})};function G(t){void 0===t&&(t=300),n.add("wordcount",(function(n){var e=L(n);return W(n,e),V(n,e,t),e}))}G()})()},e8c4e:function(n,t,e){e("3a36")}}]);