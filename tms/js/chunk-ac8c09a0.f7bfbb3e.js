(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac8c09a0","chunk-2d0de953","chunk-21d1d77d","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953"],{"1e5e":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{visible:e.previewVisible,footer:null,width:"40%"},on:{cancel:e.handleCancel}},[i("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])},r=[],a={name:"addSelect",props:{},watch:{},data:function(){return{previewVisible:!1,previewImage:""}},mounted:function(){},methods:{handleCancel:function(){this.previewVisible=!1},isOpen:function(e){this.previewVisible=!0,this.previewImage=e}}},s=a,c=i("cba8"),l=Object(c["a"])(s,n,r,!1,null,"6a8ddd32",null);t["default"]=l.exports},"2dab":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-date-picker",{attrs:{disabled:e.disabled||e.readOnly,placeholder:e.placeholder,value:e.momVal,showTime:e.showTime,format:e.dateFormat,getCalendarContainer:e.getCalendarContainer},on:{change:e.handleDateChange}})},r=[],a=i("caaf"),s=i.n(a),c={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(e){return e.parentNode}}},data:function(){var e=this.value;return{decorator:"",momVal:e?s()(e,this.dateFormat):null}},watch:{value:function(e){this.momVal=e?s()(e,this.dateFormat):null}},methods:{moment:s.a,handleDateChange:function(e,t){this.$emit("change",t)}},model:{prop:"value",event:"change"}},l=c,o=i("cba8"),u=Object(o["a"])(l,n,r,!1,null,null,null);t["default"]=u.exports},"505f":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-card",{attrs:{bordered:!1}},[i("div",{staticClass:"summary"},[i("div",{staticClass:"card-panel",staticStyle:{width:"45px"}},[i("span",{staticClass:"cardptit"},[e._v("合计")]),i("span",{staticClass:"number",staticStyle:{opacity:"0"}},[e._v("123123")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isTotal,expression:"isTotal == 1"}],staticClass:"card-panel"},[i("span",{staticClass:"cardptit"},[e._v("金额")]),i("span",{staticClass:"number"},[i("span",{staticClass:"number-text"},[e._v(" "+e._s(e.customerResult.returnMoney)),i("span",{staticClass:"summary-text"},[e._v("元")])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isTotal,expression:"isTotal == 1"}],staticClass:"card-panel"},[i("span",{staticClass:"cardptit"},[e._v(" 回款余额")]),i("span",{staticClass:"number"},[i("span",{staticClass:"number-text"},[e._v(" "+e._s(e.customerResult.balance)),i("span",{staticClass:"summary-text"},[e._v("元")])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:2==e.isTotal,expression:"isTotal == 2"}],staticClass:"card-panel"},[i("span",{staticClass:"cardptit"},[e._v("确认回款金额")]),i("span",{staticClass:"number"},[i("span",{staticClass:"number-text"},[e._v(" "+e._s(e.customerResult.returnMoney)),i("span",{staticClass:"summary-text"},[e._v("元")])])])])]),i("div",{staticClass:"table-operator"},[i("span",{directives:[{name:"show",rawName:"v-show",value:1==e.isTotal,expression:"isTotal == 1"}]},[e._v("\n      回款方：\n      "),i("a-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入回款方"},model:{value:e.queryParam.returnMechanism,callback:function(t){e.$set(e.queryParam,"returnMechanism","string"===typeof t?t.trim():t)},expression:"queryParam.returnMechanism"}}),e._v("\n      回款时间：\n      "),i("a-range-picker",{on:{change:e.onChangeReturn}}),e._v("\n      作废状态：\n      "),i("a-select",{staticStyle:{width:"120px"},attrs:{"label-in-value":"","default-value":{key:""}},on:{change:e.changeValue}},e._l(e.selectList,(function(t,n){return i("a-select-option",{key:n,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1),i("span",{directives:[{name:"show",rawName:"v-show",value:2==e.isTotal,expression:"isTotal == 2"}]},[e._v("\n      服务费单号:\n      "),i("a-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入服务费单号"},model:{value:e.queryParam.billNo,callback:function(t){e.$set(e.queryParam,"billNo","string"===typeof t?t.trim():t)},expression:"queryParam.billNo"}}),e._v("\n      核算周期：\n      "),i("addSelectTime",{staticStyle:{width:"150px"},on:{queryStartAccountingYear:e.queryStartAccountingYear,queryStartAccountingQuarter:e.queryStartAccountingQuarter,queryEndAccountingYear:e.queryEndAccountingYear,queryEndAccountingQuarter:e.queryEndAccountingQuarter}})],1),i("a-button",{staticClass:"btn-search",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"search"},on:{click:e.searchQuery}},[e._v("查询")]),1==e.isTotal?i("a-button",{attrs:{type:"primary",icon:"download"},on:{click:function(t){return e.handleExportXls("回款汇总")}}},[e._v("导出")]):e._e(),2==e.isTotal?i("a-button",{attrs:{type:"primary",icon:"download"},on:{click:function(t){return e.customerHandleExportXls("回款明细","/receipt/serviceReturnRegister/exportDetailXls")}}},[e._v("导出")]):e._e()],1),i("div",[i("a-tabs",{attrs:{"default-active-key":"1"},on:{change:e.contract_callback}},[i("a-tab-pane",{key:"1",attrs:{tab:"回款汇总"}}),i("a-tab-pane",{key:"2",attrs:{tab:"回款明细","force-render":""}})],1)],1),i("div",[i("a-table",{ref:"table",staticClass:"j-table-force-nowrap",attrs:{size:"middle",bordered:"",rowKey:"id",customRow:e.onClickRowMulti,columns:e.columns,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,getCheckboxProps:e.onGetCheckboxProps},dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"accountingYear",fn:function(t,n){return i("span",{},[i("span",[e._v(e._s(t)+"年Q"+e._s(n.accountingQuarter)+"季度")])])}},{key:"enclosurePath",fn:function(t,n){return[i("a",{attrs:{title:t},on:{click:function(t){return t.stopPropagation(),e.previewFiles(n)}}},[e._v(" "+e._s(t))])]}},{key:"fileList",fn:function(t,n){return[e.showFileListBtn(t)?i("span",{staticStyle:{"font-size":"12px","font-style":"italic"}},[e._v("无文件")]):i("a-button",{attrs:{ghost:!0,type:"primary",icon:"download",size:"small"},on:{click:function(t){return e.uploadFile(n.fileList)}}},[e._v("\n          下载\n        ")])]}},{key:"isNullify",fn:function(t,n){return i("span",{},[1===n.isNullify?i("a-tag",{attrs:{color:"red"}},[e._v("\n          已作废\n        ")]):e._e(),0===n.isNullify?i("a-tag",{attrs:{color:"green"}},[e._v("\n          未作废\n        ")]):e._e()],1)}},{key:"serviceChargePoints",fn:function(t,n){return i("span",{},[e._v(" "+e._s(n.serviceChargePoints)+"% ")])}},{key:"action",fn:function(t,n){return i("span",{},[i("a",{class:{isnotAllow:1===n.isNullify},on:{click:function(t){return e.paymentConfirm(n)}}},[e._v("回款确认")]),i("a",{class:{isnotAllow:1===n.isNullify},staticStyle:{"margin-left":"10px","margin-right":"10px"},on:{click:function(t){return e.editConfirm(n)}}},[e._v("修改")]),i("a",{class:{isnotAllow:1===n.isNullify,allow:0===n.isNullify},on:{click:function(t){return e.clickUpdate(n)}}},[e._v("作废")])])}}])})],1),i("ServiceConfirmModal",{ref:"ServiceConfirmModal",on:{ok:e.modalFormOk}}),i("imagePreviews",{ref:"imagePre"})],1)},r=[],a=i("0fea"),s=i("7c98"),c=i.n(s),l=(i("6eb7"),i("ac0d")),o=i("b65a"),u=i("a6f0"),d=i("5bd8"),m=i("1e5e"),f=[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(e,t,i){return parseInt(i)+1}},{title:"回款方",align:"center",dataIndex:"returnMechanism"},{title:"金额（元）",align:"center",width:120,dataIndex:"returnMoney"},{title:"回款余额（元）",align:"center",width:120,dataIndex:"balance"},{title:"回款日期",align:"center",dataIndex:"returnTime"},{title:"回款单附件",align:"center",dataIndex:"enclosureName",scopedSlots:{customRender:"enclosurePath"}},{title:"附件说明",align:"center",dataIndex:"fileList",scopedSlots:{customRender:"fileList"}},{title:"提交时间",align:"center",dataIndex:"createTime"},{title:"提交人",align:"center",dataIndex:"createByName"},{title:"修改时间",align:"center",dataIndex:"updateTime"},{title:"修改人",align:"center",dataIndex:"updateByName"},{title:"是否作废",align:"center",dataIndex:"isNullify",scopedSlots:{customRender:"isNullify"}},{title:"操作",dataIndex:"action",align:"center",width:147,scopedSlots:{customRender:"action"}}],p=[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(e,t,i){return parseInt(i)+1}},{title:"服务费单号",align:"center",width:180,dataIndex:"billNo"},{title:"供应商",align:"center",width:330,dataIndex:"supplierName"},{title:"项目",align:"center",width:260,dataIndex:"projectName"},{title:"确认回款金额",align:"center",width:150,dataIndex:"confirmReturnMoney"},{title:"核算周期",align:"center",dataIndex:"accountingYear",scopedSlots:{customRender:"accountingYear"}},{title:"确认时间",align:"center",dataIndex:"createTime"},{title:"确认人",align:"center",dataIndex:"createByName"}],h={name:"ContractList",mixins:[o["a"],l["b"]],components:{addSelectTime:u["default"],ServiceConfirmModal:d["default"],imagePreviews:m["default"]},data:function(){return{isTotal:1,selectList:[{key:"",name:"全部"},{key:"1",name:"已作废"},{key:"0",name:"未作废"}],ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",description:"",contractNo:"",supplierName:"",projectName:"",effective_times:"",contractState:1,columns:f,url:{list:"/receipt/serviceReturnRegister/list",delete:"/servicefree/serviceFreeMaintain/delete",deleteBatch:"/contract//deleteBatch",exportXlsUrl:"/receipt/serviceReturnRegister/exportXls",importExcelUrl:"contract/contractSignRegister/importExcel"},dictOptions:{}}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},created:function(){},methods:{showFileListBtn:function(e){return c.a.isEmpty(e)},uploadFile:function(e){if(e)for(var t="",i=0;i<e.length;i++)t=this.ImagesUrl+e[i].enclosurePath,window.open(t);else this.$message.warning("未知的文件")},previewFiles:function(e){this.previewImage=this.ImagesUrl+e.enclosurePath,this.$refs.imagePre.isOpen(this.previewImage)},editConfirm:function(e){var t=this;if(e.isNullify)return!1;var i={returnId:e.id,type:2},n=this;Object(a["c"])("/receipt/serviceReturnRegister/updateInvoice",i).then((function(e){e.success?(e.result.isEdit=!0,t.$refs.ServiceConfirmModal.edit(e.result),t.$refs.ServiceConfirmModal.title="回款单确认修改",t.$refs.ServiceConfirmModal.disableSubmit=!1,t.$refs.ServiceConfirmModal.isEdit=!0):n.$message.warning(e.message)})).finally((function(){}))},paymentConfirm:function(e){var t=this,i={returnId:e.id,type:1},n=this;Object(a["c"])("/receipt/serviceReturnRegister/updateInvoice",i).then((function(e){e.success?(t.$refs.ServiceConfirmModal.edit(e.result),t.$refs.ServiceConfirmModal.title="回款单确认",t.$refs.ServiceConfirmModal.disableSubmit=!1,t.$refs.ServiceConfirmModal.isEdit=!1):n.$message.warning(e.message)})).finally((function(){}))},clickUpdate:function(e){if(e.isNullify)return!1;var t=this;this.$confirm({title:"提示",content:"您确定作废么？",onOk:function(){var i={returnId:e.id,type:3};Object(a["c"])("/receipt/serviceReturnRegister/updateInvoice",i).then((function(e){e.success&&(t.selectedRowKeys=[],t.searchQuery())})).finally((function(){}))},onCancel:function(){}})},onGetCheckboxProps:function(e){return{props:{disabled:1===e.isNullify}}},onClickRowMulti:function(e){var t=this;return{on:{click:function(){var i=t.selectedRowKeys;if(1===e.isNullify)return!1;i.length>0&&i.includes(e.id)?i.splice(i.indexOf(e.id),1):i.push(e.id),t.selectedRowKeys=i}}}},onChangeReturn:function(e,t){this.queryParam.queryStartTime=t[0],this.queryParam.queryEndTime=t[1]},changeValue:function(e){this.queryParam.isNullify=e.key},handleMyType:function(e){var t=this,i={id:e.id};Object(a["c"])("/servicefree/serviceFreeMaintain/queryById",i).then((function(e){3===t.contractState?(e.result.isFreeConfirm=!1,t.$refs.ServiceFreeConfirm.edit(e.result),t.$refs.ServiceFreeConfirm.title="固定金额减免详情",t.$refs.ServiceFreeConfirm.disableSubmit=!1):(t.$refs.serviceFreeModal.edit(e.result),t.$refs.serviceFreeModal.title="固定金额减免详情",t.$refs.serviceFreeModal.disableSubmit=!1)})).finally((function(){}))},effectiveChange:function(e,t){this.effective_times=t},handle_add:function(){this.$router.push({name:"addNews"})},contract_callback:function(e){this.isTotal=e,this.contractState=Number(e),"1"===e?(this.url.list="/receipt/serviceReturnRegister/list",this.columns=f):"2"===e&&(this.queryParam.returnId=this.selectedRowKeys.toString(),this.columns=p,this.url.list="/receipt/serviceReturnRegister/returnDetail",this.selectedRowKeys=[]),this.searchQuery()},queryStartAccountingYear:function(e){this.queryParam.queryStartAccountingYear=e},queryStartAccountingQuarter:function(e){this.queryParam.queryStartAccountingQuarter=e},queryEndAccountingYear:function(e){this.queryParam.queryEndAccountingYear=e},queryEndAccountingQuarter:function(e){this.queryParam.queryEndAccountingQuarter=e},handleAddModelAdd:function(){this.$refs.serviceFreeModal.add(),this.$refs.serviceFreeModal.title="添加",this.$refs.serviceFreeModal.disableSubmit=!1}}},v=h,g=(i("687d"),i("cba8")),y=Object(g["a"])(v,n,r,!1,null,"6445ea7c",null);t["default"]=y.exports},"5bd8":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("j-modal",{attrs:{title:e.title,width:"65%",visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",okText:e.okTextTit,cancelText:"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[i("a-form-model",{ref:"ruleForm",staticStyle:{"padding-left":"30px"},attrs:{model:e.form,layout:e.vertical}},[i("a-form-model-item",{attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"20px"},attrs:{label:"回款方",prop:"freeReductionId"}},[i("a-input",{attrs:{disabled:""},model:{value:e.form.returnMechanism,callback:function(t){e.$set(e.form,"returnMechanism",t)},expression:"form.returnMechanism"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"20px"},attrs:{label:"回款时间",prop:"freeReductionId"}},[i("a-input",{attrs:{disabled:""},model:{value:e.form.returnTime,callback:function(t){e.$set(e.form,"returnTime",t)},expression:"form.returnTime"}})],1),i("a-form-model-item",{staticStyle:{width:"180px"},attrs:{label:"回款金额",prop:"freeMoney"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:e.form.returnMoney,callback:function(t){e.$set(e.form,"returnMoney",t)},expression:"form.returnMoney"}})],1)],1)]),i("a-form-model-item",{staticStyle:{"margin-top":"-20px"},attrs:{label:""}},[i("a",{on:{click:e.addRow}},[e._v("添加行")])]),e._l(e.serviceReturnsList,(function(t,n){return i("a-form-model-item",{key:n,staticStyle:{"margin-top":"-10px"},attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{prop:"billNo",label:"服务费单号"}},[i("a-input-search",{staticStyle:{height:"32px"},attrs:{placeholder:"请选择服务费单号",disabled:"",size:"large"},model:{value:t.billNo,callback:function(i){e.$set(t,"billNo",i)},expression:"item.billNo"}},[i("a-button",{attrs:{slot:"enterButton"},nativeOn:{click:function(i){return i.stopPropagation(),e.clickPlus(t,n)}},slot:"enterButton"},[e._v("\n              +\n            ")])],1)],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"项目"}},[i("a-input",{attrs:{disabled:""},model:{value:t.projectName,callback:function(i){e.$set(t,"projectName",i)},expression:"item.projectName"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"供应商"}},[i("a-input",{attrs:{disabled:""},model:{value:t.supplierName,callback:function(i){e.$set(t,"supplierName",i)},expression:"item.supplierName"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"核算周期"}},[i("a-input",{attrs:{disabled:""},model:{value:t.accounting,callback:function(i){e.$set(t,"accounting",i)},expression:"item.accounting"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"实际应收服务费"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:t.actualReceivablesMoney,callback:function(i){e.$set(t,"actualReceivablesMoney",i)},expression:"item.actualReceivablesMoney"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"已收服务费"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:t.receivedMoney,callback:function(i){e.$set(t,"receivedMoney",i)},expression:"item.receivedMoney"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"确认回款金额"}},[i("a-input",{attrs:{ype:"number",suffix:"元"},model:{value:t.commitReturnMoney,callback:function(i){e.$set(t,"commitReturnMoney",i)},expression:"item.commitReturnMoney"}})],1),i("a-form-model-item",{staticStyle:{display:"flex","padding-top":"28px","align-items":"center","margin-left":"10px"},attrs:{label:""}})],1)])})),i("a-form-model-item",{attrs:{label:"附件说明"}},[i("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,multiple:!0,accept:".doc,.docx,.pdf,.jpg",customRequest:e.downloadFilesCustomRequest,"file-list":e.fileList,remove:e.removeFile},on:{change:e.handleChange}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v(" 上传文件\n          ")],1),i("span",{staticStyle:{"margin-left":"20px"}},[e._v("支持扩展名：doc、docx、pdf、jpg 文件大小不超过10M")])],1)],1)],2),i("Serviceaddfree",{ref:"modalForm",on:{confirmAddItem:e.confirmAddItem}})],1)},r=[],a=i("0fea"),s=i("85ee"),c=i.n(s),l=(i("ca00"),i("2dab")),o=i("fcc6");function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d={name:"ServiceAdd",components:{JDate:l["default"],Serviceaddfree:o["default"]},data:function(){var e;return e={isEdit:!1,ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",clickIndex:0,serviceReturnsList:[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],okTextTit:"确定",ClickItem:{},freeItem:{accounting:""},visibleModel:!1,confirmContent:"",uploadList:[],fileList:[],vertical:"vertical",form:this.$form.createForm(this),title:"操作",width:800,visible:!1,loading:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{},url:{add:"/servicebill/serviceBillMaking/commitReturn",edit:"/servicefree/serviceFreeMaintain/edit"}},u(e,"labelCol",{span:4}),u(e,"wrapperCol",{span:14}),u(e,"other",""),u(e,"form",{freeReductionId:"",freeMoney:"",billNo:"",remarks:"",fileList:[]}),u(e,"rules",{freeReductionId:[{required:!0,message:"请选择减免类型",trigger:"blur"}],freeMoney:[{required:!0,message:"请选输入免金额",trigger:"blur"},{type:"number",message:"仅支持输入小数点后两位",trigger:"blur",transform:function(e){if(e){var t=Number(e);return!!/^\d+\.?\d{0,2}$/.test(t)&&t}}}],billNo:[{required:!0,message:"请选择服务费单号",trigger:"blur"}],projectName:[{required:!0,message:"请选择服务费单号",trigger:"blur"}],supplierName:[{required:!0,message:"请选择服务费单号",trigger:"blur"}]}),e},created:function(){},methods:{addRow:function(){this.serviceReturnsList.push({billNo:"",projectName:"",id:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}),this.clickIndex=this.serviceReturnsList.length-1},confirmAddItem:function(e){var t={billNo:e.billNo,projectName:e.projectName,id:e.id,supplierName:e.supplierName,accountingQuarter:e.accountingQuarter,accountingYear:e.accountingYear,accounting:e.accountingYear+"年Q"+e.accountingQuarter+"季度",actualReceivablesMoney:e.actualReceivablesMoney,receivedMoney:e.receivedMoney,unreceivedMoney:e.unreceivedMoney,commitReturnMoney:0};1===this.serviceReturnsList.length?this.$set(this.serviceReturnsList,0,t):this.$set(this.serviceReturnsList,this.clickIndex,t),this.freeItem=e,this.form.billNo=e.billNo,this.form.billId=e.id,this.freeItem.accounting=this.freeItem.accountingYear+"年Q"+this.freeItem.accountingQuarter+"季度"},clickPlus:function(e,t){this.clickIndex=t,this.$refs.modalForm.add(),this.$refs.modalForm.title="添加服务费账单",this.$refs.modalForm.disableSubmit=!1},add:function(){this.edit({})},edit:function(e){var t=this;if(e.isEdit){if(this.ClickItem=e.serviceReturn,this.form.returnMechanism=e.serviceReturn.returnMechanism,this.form.returnTime=e.serviceReturn.returnTime,this.form.returnMoney=e.serviceReturn.returnMoney,e.serviceBills.length&&e.serviceBills.forEach((function(e,t){e.accounting=e.accountingYear+"年Q"+e.accountingQuarter+"季度",e.commitReturnMoney||(e.commitReturnMoney=0)})),e.serviceBills.length)for(var i=0;i<e.serviceBills.length;i++)this.$set(this.serviceReturnsList,i,e.serviceBills[i]);this.fileList=[];var n=[];this.uploadList=e.serviceReturn.fileList?e.serviceReturn.fileList:[],e.serviceReturn.fileList&&e.serviceReturn.fileList.forEach((function(e,i){n.push({uid:i+1,name:e.enclosureName,status:"done",url:t.ImagesUrl+e.enclosurePath})})),this.fileList=n}else{if(this.ClickItem=e.serviceReturn,this.form.returnMechanism=this.ClickItem.returnMechanism,this.form.returnTime=this.ClickItem.returnTime,this.form.returnMoney=this.ClickItem.returnMoney,e.serviceBills.length&&e.serviceBills.forEach((function(e,t){e.accounting=e.accountingYear+"年Q"+e.accountingQuarter+"季度",e.commitReturnMoney||(e.commitReturnMoney=0)})),e.serviceBills.length)for(i=0;i<e.serviceBills.length;i++)this.$set(this.serviceReturnsList,i,e.serviceBills[i]);this.fileList=[];var r=[];this.uploadList=e.serviceReturn.fileList?e.serviceReturn.fileList:[],e.serviceReturn.fileList&&e.serviceReturn.fileList.forEach((function(e,i){r.push({uid:i+1,name:e.enclosureName,status:"done",url:t.ImagesUrl+e.enclosurePath})})),this.fileList=r}this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}]},handleOk:function(){var e=this,t=!1;if(this.serviceReturnsList.forEach((function(e,i){e.billNo||(t=!0)})),t)this.$message.warning("请填写完整！");else{var i=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;i.confirmLoading=!0;var n="",r="";i.form.id?(n+=i.url.edit,r="put"):(n+=i.url.add,r="post");var s=[];if(s=e.serviceReturnsList.filter((function(e,t){return e.commitReturnMoney})),0===s.length)return e.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],e.close(),e.$emit("ok"),e.confirmLoading=!1,!1;var c={serviceReturn:{returnMechanism:e.form.returnMechanism,returnTime:e.form.returnTime,returnMoney:e.form.returnMoney,id:e.ClickItem.id,fileList:e.uploadList},serviceBills:s};Object(a["h"])(n,c,r).then((function(t){t.success?(e.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],i.$message.success("确认成功！"),i.close(),i.$emit("ok")):i.$message.warning(t.message)})).finally((function(){i.confirmLoading=!1}))}))}},handleCancel:function(){this.close()},popupCallback:function(e){this.form.setFieldsValue(c()(e,"billId","freeReductionId","freeMoney","remarks","freeState","createBy","createTime","updateBy","updateTime","isDelete"))},handleChange:function(e){e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))},removeFile:function(e,t){var i=this.fileList,n=this.uploadList;i.forEach((function(t,r){t===e&&(i.splice(r,1),n.splice(r,1))})),this.fileList=i},downloadFilesCustomRequest:function(e){},beforeUpload:function(e,t){var i=this,n=e.size/1024/1024<10;if(!n)return this.$message.error("图片大小超出限制，请修改后重新上传"),!1;if(e.name.length>60)return this.$message.error("文件名称过长"),!1;var r="/sys/common/upload",s=new FormData;s.append("biz","servicefree"),s.append("file",e),Object(a["l"])(r,s).then((function(e){if(e.success){i.uploadList.push({enclosurePath:e.message,enclosureName:e.result});var t=i.fileList.length;i.fileList.push({uid:t+1,name:e.result,status:"done",url:i.ImagesUrl+e.message})}})).finally((function(){}))}}},m=d,f=(i("94a3"),i("cba8")),p=Object(f["a"])(m,n,r,!1,null,"c5c618c0",null);t["default"]=p.exports},"687d":function(e,t,i){"use strict";i("d3e3")},"85ee":function(e,t,i){(function(t){var i=1/0,n=9007199254740991,r="[object Arguments]",a="[object Function]",s="[object GeneratorFunction]",c="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,o="object"==typeof self&&self&&self.Object===Object&&self,u=l||o||Function("return this")();function d(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function m(e,t){var i=-1,n=e?e.length:0,r=Array(n);while(++i<n)r[i]=t(e[i],i,e);return r}function f(e,t){var i=-1,n=t.length,r=e.length;while(++i<n)e[r+i]=t[i];return e}var p=Object.prototype,h=p.hasOwnProperty,v=p.toString,g=u.Symbol,y=p.propertyIsEnumerable,b=g?g.isConcatSpreadable:void 0,w=Math.max;function x(e,t,i,n,r){var a=-1,s=e.length;i||(i=C),r||(r=[]);while(++a<s){var c=e[a];t>0&&i(c)?t>1?x(c,t-1,i,n,r):f(r,c):n||(r[r.length]=c)}return r}function R(e,t){return e=Object(e),k(e,t,(function(t,i){return i in e}))}function k(e,t,i){var n=-1,r=t.length,a={};while(++n<r){var s=t[n],c=e[s];i(c,s)&&(a[s]=c)}return a}function M(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var i=arguments,n=-1,r=w(i.length-t,0),a=Array(r);while(++n<r)a[n]=i[t+n];n=-1;var s=Array(t+1);while(++n<t)s[n]=i[n];return s[t]=a,d(e,this,s)}}function C(e){return I(e)||N(e)||!!(b&&e&&e[b])}function S(e){if("string"==typeof e||j(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function N(e){return $(e)&&h.call(e,"callee")&&(!y.call(e,"callee")||v.call(e)==r)}var I=Array.isArray;function _(e){return null!=e&&q(e.length)&&!L(e)}function $(e){return T(e)&&_(e)}function L(e){var t=F(e)?v.call(e):"";return t==a||t==s}function q(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function T(e){return!!e&&"object"==typeof e}function j(e){return"symbol"==typeof e||T(e)&&v.call(e)==c}var P=M((function(e,t){return null==e?{}:R(e,m(x(t,1),S))}));e.exports=P}).call(this,i("2409"))},"94a3":function(e,t,i){"use strict";i("fe3e5")},d3e3:function(e,t,i){},fe3e5:function(e,t,i){}}]);