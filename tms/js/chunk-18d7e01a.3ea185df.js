(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18d7e01a"],{"202d":function(e,t,i){"use strict";i("465a")},"392e":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,visible:e.visible,"confirm-loading":e.confirmLoading,width:"50%"},on:{ok:e.handleOk,cancel:e.handleCancel}},[[i("div",[e._v("\n         名称: \n      "),i("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"名称"},model:{value:e.queryName,callback:function(t){e.queryName=t},expression:"queryName"}}),e._v("   \n      "),i("a-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.handle_query(1,null)}}},[e._v("查询")])],1),i("a-table",{attrs:{columns:e.columns,"data-source":e.data,customRow:e.rowClick,pagination:!1,scroll:{y:240}},scopedSlots:e._u([{key:"action",fn:function(t){return i("a",{attrs:{href:"javascript:;"}},[i("a-checkbox",{on:{change:e.onChange},model:{value:t.isChecked,callback:function(i){e.$set(t,"isChecked",i)},expression:"text.isChecked"}},[e._v("\n          选择\n        ")])],1)}}])}),i("div",{staticClass:"pageAtion"},[i("a-pagination",{attrs:{size:"small",total:e.total,"page-size":e.pageSize,"show-size-changer":"","show-quick-jumper":""},on:{change:e.changePage,showSizeChange:e.changePageSize}})],1)]],2)},r=[],s=i("0fea"),o={name:"addSelect",props:{visble:null,title:null,typeKinds:null,checkProjectId:null,checkSupplerId:null},watch:{visble:function(e){this.visible=e,e&&this.getList()},queryName:function(e){this.queryName=e.replace(/(^\s*)|(\s*$)/g,"")},typeKinds:function(e){},checkProjectId:function(e){},checkSupplerId:function(e){}},data:function(){return{myCheckedItem:{},queryName:"",total:null,pageNo:1,pageSize:10,data:[],columns:[{title:"名称",dataIndex:"name",with:"auto"},{width:150,title:"选择",dataIndex:"",key:"x",scopedSlots:{customRender:"action"}}],ModalText:"Content of the modal",visible:!1,confirmLoading:!1}},methods:{onChange:function(e){},rowClick:function(e,t){var i=this;return{on:{click:function(){i.data.forEach((function(e,t){e.isChecked=!1,i.$set(i.data,t,e)})),e.isChecked=!e.isChecked,i.$set(i.data,t,e),e.isChecked&&(i.myCheckedItem=e)}}}},handle_query:function(e,t){var i=this,a={pageNo:e};a.pageSize=t||this.pageSize,a.name=this.queryName;var r="project"===this.typeKinds?"/basicdata/baseProject/getBaseProject?supplierId=".concat(this.checkSupplerId):"/basicdata/baseSupplier/getBaseSupplier?projectId=".concat(this.checkProjectId);Object(s["c"])(r,a).then((function(e){e.success&&e.result&&(i.data=e.result.records,i.total=e.result.total)}))},changePage:function(e,t){this.pageNo=e,this.pageSize=t,this.handle_query(e,t)},changePageSize:function(e,t){this.pageNo=e,this.pageSize=t,this.data=[],this.total=0,this.handle_query(e,t)},getList:function(){var e=this;this.myCheckedItem={},this.queryName="";var t="project"===this.typeKinds?"/basicdata/baseProject/getBaseProject?supplierId=".concat(this.checkSupplerId):"/basicdata/baseSupplier/getBaseSupplier?projectId=".concat(this.checkProjectId);this.pageSize=10,this.pageNo=1;var i={pageNo:this.pageNo,pageSize:this.pageSize};Object(s["c"])(t,i).then((function(t){t.success&&t.result&&(e.data=t.result.records,e.total=t.result.total)}))},close:function(){},showModal:function(){this.visible=!0},handleOk:function(e){if(!this.myCheckedItem.id)return this.$message.error("请选择！"),!1;this.$emit("closeVisible",!1),"project"===this.typeKinds?this.$emit("clicktableRow",this.myCheckedItem):this.$emit("clicktableRowSupper",this.myCheckedItem)},handleCancel:function(e){this.$emit("closeVisible",!1)}}},n=o,l=(i("202d"),i("cba8")),c=Object(l["a"])(n,a,r,!1,null,"0555d77b",null);t["default"]=c.exports},"465a":function(e,t,i){},"5b07":function(e,t,i){},"783a":function(e,t,i){"use strict";i("5b07")},de26:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("j-modal",{staticClass:"addGHt",attrs:{title:e.title,width:"900px",visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",okText:e.isEdit,cancelText:"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[[1===e.recordDetail.contractState?i("div",{staticClass:"allStatus beConfirm"},[i("span",[e._v("状态：待确认")])]):e._e(),3===e.recordDetail.contractState?i("div",{staticClass:"allStatus Confirm"},[i("span",[e._v("状态：通过")])]):e._e(),2===e.recordDetail.contractState?i("div",{staticClass:"allStatus notPass"},[i("div",[e._v("状态：未通过")])]):e._e(),2===e.recordDetail.contractState?i("div",{staticClass:"notpassDesc"},[e._v("驳回原因："+e._s(e.recordDetail.confirmContent||""))]):e._e(),i("a-form-model",{ref:"ruleForm",attrs:{model:e.formAd,layout:e.vertical,rules:e.rules}},[i("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{ref:"contractNo",attrs:{label:"合同编号",prop:"contractNo"}},[i("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[i("a-input",{model:{value:e.formAd.contractNo,callback:function(t){e.$set(e.formAd,"contractNo",t)},expression:"formAd.contractNo"}})],1)]),i("a-form-model-item",{ref:"taxRegistrationNumber",attrs:{label:"税务登记号",prop:"taxRegistrationNumber"}},[i("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[i("a-input",{attrs:{disabled:""},model:{value:e.formAd.taxRegistrationNumber,callback:function(t){e.$set(e.formAd,"taxRegistrationNumber",t)},expression:"formAd.taxRegistrationNumber"}})],1)])],1)]),i("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{ref:"projectName",attrs:{label:"项目",prop:"projectName"}},[i("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[i("a-input",{attrs:{disabled:""},model:{value:e.formAd.projectName,callback:function(t){e.$set(e.formAd,"projectName",t)},expression:"formAd.projectName"}}),"1"===e.editDisabled?i("a-icon",{staticStyle:{"margin-left":"8px",float:"right"},attrs:{type:"plus"},on:{click:function(t){return e.addProject("project")}}}):e._e()],1)]),i("a-form-model-item",{attrs:{label:"签订供应商",prop:"supplierName"}},[i("div",{staticStyle:{width:"360px","margin-right":"80px",display:"flex","align-items":"center"}},[i("a-input",{attrs:{disabled:""},model:{value:e.formAd.supplierName,callback:function(t){e.$set(e.formAd,"supplierName",t)},expression:"formAd.supplierName"}}),"1"===e.editDisabled?i("a-icon",{staticStyle:{"margin-left":"8px"},attrs:{type:"plus"},on:{click:function(t){return e.addProject("supplier")}}}):e._e()],1)])],1)]),i("a-form-model-item",{staticStyle:{"margin-bottom":"-20px"},attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{staticStyle:{width:"360px","margin-right":"80px"},attrs:{label:"服务费点数",required:"",prop:"serviceChargePoints"}},[i("a-input-search",{attrs:{disabled:e.editDisabled,max:100,placeholder:""},model:{value:e.formAd.serviceChargePoints,callback:function(t){e.$set(e.formAd,"serviceChargePoints",t)},expression:"formAd.serviceChargePoints"}},[i("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("\n                %\n              ")])],1)],1),i("a-form-model-item",{staticStyle:{width:"360px"},attrs:{label:"合同有限期",prop:"date1"}},[e.startTime?i("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",allowClear:!1,disabled:e.editDisabled,placeholder:["开始时间","结束时间"],"default-value":[e.moment(e.startTime,e.dateFormat),e.moment(e.endTime,e.dateFormat)]},on:{change:e.onChange,ok:e.onOk},model:{value:e.formAd.date1,callback:function(t){e.$set(e.formAd,"date1",t)},expression:"formAd.date1"}}):e._e()],1)],1)]),i("a-form-model-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:""}},[i("a-form-model-item",{attrs:{label:"合同附件",prop:"desc"}},[!e.editDisabled||e.fileList.length?i("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,multiple:!0,accept:".pdf,.jpg,.doc,docx",customRequest:e.downloadFilesCustomRequest,remove:e.removeFile,"file-list":e.fileList},on:{change:e.handleChange}},[e.editDisabled?e._e():i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v(" 上传文件\n            ")],1),e.editDisabled?e._e():i("span",{staticStyle:{}},[e._v("支持扩展名：pdf、jpg、doc、docx、文件大小不超过5M")])],1):i("span",[e._v("暂无附件")])],1)],1),i("a-form-model-item",{staticStyle:{"margin-bottom":"-10px"},attrs:{label:""}},[i("a-form-model-item",{attrs:{label:"备注"}},[i("a-input",{staticStyle:{width:"800px",height:"90px"},attrs:{maxLength:200,disabled:e.editDisabled,placeholder:"此处为备注说明， 限制200字以内",type:"textarea"},model:{value:e.formAd.remarks,callback:function(t){e.$set(e.formAd,"remarks",t)},expression:"formAd.remarks"}})],1)],1)],1)],i("addSelectModal",{attrs:{title:e.myaddTitle,typeKinds:e.typeKinds,visble:e.isShow},on:{clicktableRowSupper:e.clicktableRowSupper,clicktableRow:e.clicktableRow,closeVisible:e.closeVisible}})],2)},r=[],s=i("caaf"),o=i.n(s),n=(i("10ef"),i("0fea")),l=i("85ee"),c=i.n(l),d=(i("ca00"),i("2dab")),m=i("392e");function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p={name:"ContractModal",components:{JDate:d["default"],addSelectModal:m["default"]},data:function(){var e;return e={vertical:"vertical",startTime:"",endTime:"",dateFormat:"YYYY-MM-DD",recordDetail:"",moment:o.a,editDisabled:!0,isEdit:"修改",SupperItem:{},projectItem:{},ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",uploadList:[],fileList:[],typeKinds:"",isShow:!1,myaddTitle:"",headers:{authorization:"authorization-text"},myTime:"",form:this.$form.createForm(this),title:"新增",width:800,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{},url:{add:"/contract/contract/add",edit:"/contract/contract/edit"}},u(e,"labelCol",{span:4}),u(e,"wrapperCol",{span:14}),u(e,"other",""),u(e,"formAd",{projectName:"",supplierName:void 0,taxRegistrationNumber:void 0,serviceChargePoints:"",contractNo:"",date1:["2020-08-12T16:00:00.000Z","2020-09-29T16:00:00.000Z"],remarks:""}),u(e,"rules",{projectName:[{required:!0,message:"请选择项目",trigger:"blur"}],supplierName:[{required:!0,message:"请选择签订供应商",trigger:"blur"}],taxRegistrationNumber:[{required:!0,message:"税务登记号不能为空 ，请到供应商维护",trigger:"change"}],contractNo:[{required:!0,message:"请输入合同编号",trigger:"change"}],serviceChargePoints:[{required:!0,message:"请输入服务费点数",trigger:"change"},{type:"number",message:"仅支持输入0-100之间的支持输入小数点后两位",trigger:"blur",transform:function(e){if(e){var t=Number(e);return!(t>100)&&(!!/^(\d|[1-9]\d|100)(\.\d{1,2})?$/.test(t)&&t)}}}],date1:[{required:!0,message:"请选择合同有效期",trigger:"change"}],remarks:[{required:!0,message:"Please input activity form",trigger:"blur"}]}),e},methods:{removeFile:function(e,t){if(this.editDisabled)return this.$message.error("请先更改修改状态！"),!1;var i=this.fileList,a=this.uploadList;i.forEach((function(t,r){t===e&&(i.splice(r,1),a.splice(r,1))})),this.fileList=i,this.uploadList=a},downloadFilesCustomRequest:function(e){},beforeUpload:function(e,t){var i=this,a="/sys/common/upload",r=new FormData;r.append("biz","contract"),r.append("file",e),Object(n["l"])(a,r).then((function(e){if(e.success){i.uploadList.push({enclosurePath:e.message,enclosureName:e.result});var t=i.fileList.length;i.fileList.push({uid:t+1,name:e.result,status:"done",url:i.ImagesUrl+e.message})}})).finally((function(){}))},clicktableRowSupper:function(e){this.formAd.supplierName=e.name,this.formAd.taxRegistrationNumber=e.taxRegistrationNumber,this.SupperItem=e},clicktableRow:function(e){this.formAd.projectName=e.name,this.formAd.taxRegistrationNumber=e.taxRegistrationNumber,this.projectItem=e},closeVisible:function(e){this.isShow=e},addProject:function(e){if(this.editDisabled)return!1;this.isShow=!0,this.myaddTitle="project"===e?"添加项目":"添加供应商",this.typeKinds=e},handleChange:function(e){e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))},onChange:function(e,t){},onOk:function(e){},onSubmit:function(){this.$refs.ruleForm.validate((function(e){if(!e)return!1}))},resetForm:function(){this.$refs.ruleForm.resetFields()},add:function(){this.edit({})},edit:function(e){var t=this;this.editDisabled=!0,this.isEdit="修改",e.isEdit&&(this.isEdit="确定",this.editDisabled=!1),this.form.resetFields(),this.fileList=[],this.uploadList=[],this.model=Object.assign({},e),this.recordDetail=e;var i={projectName:e.projectName,supplierName:e.supplierName,taxRegistrationNumber:e.taxRegistrationNumber,serviceChargePoints:e.serviceChargePoints,contractNo:e.contractNo,remarks:e.remarks,date1:[this.moment(e.startTime,this.dateFormat),o()(e.endTime,this.dateFormat)]};this.uploadList=e.fileList;e.fileList.length&&e.fileList.forEach((function(e,i){t.fileList.push({uid:i+1,name:e.enclosureName,status:"done",url:t.ImagesUrl+e.enclosurePath})})),this.formAd=i,this.startTime=e.startTime,this.endTime=e.endTime,this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},formatDateTime:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1;a=a<10?"0"+a:a;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var o=t.getMinutes(),n=t.getSeconds();return o=o<10?"0"+o:o,n=n<10?"0"+n:n,i+"-"+a+"-"+r+" "+s+":"+o+":"+n},handleOk:function(){var e=this;if("修改"===this.isEdit)return this.editDisabled=!1,this.isEdit="保存",!1;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var i={projectId:e.projectItem.id?e.projectItem.id:e.recordDetail.projectId,supplierId:e.SupperItem.id?e.SupperItem.id:e.recordDetail.supplierId,serviceChargePoints:e.formAd.serviceChargePoints,taxRegistrationNumber:e.formAd.taxRegistrationNumber,contractNo:e.formAd.contractNo,fileList:e.uploadList,remarks:e.formAd.remarks,startTime:e.formatDateTime(e.formAd.date1[0]._d),endTime:e.formatDateTime(e.formAd.date1[1]._d),id:e.recordDetail.id};Object(n["k"])("/contract/edit",i).then((function(t){t.success&&(e.visible=!1,e.$message.success(t.message),e.$emit("ok"),e.projectItem={},e.recordDetail={},e.formAd.projectName="",e.formAd.supplierName="",e.formAd.taxRegistrationNumber="",e.formAd.projectName="",e.formAd.serviceChargePoints="",e.formAd.contractNo="",e.$refs.ruleForm.resetFields(),e.formAd.remarks="",e.uploadList=[],e.fileList=[],e.startTime="",e.endTime="")})).finally((function(){}))}))},handleCancel:function(){this.close(),this.projectItem={},this.recordDetail={},this.formAd.projectName="",this.formAd.supplierName="",this.formAd.taxRegistrationNumber="",this.formAd.projectName="",this.formAd.serviceChargePoints="",this.formAd.contractNo="",this.formAd.date1="",this.formAd.remarks="",this.uploadList=[],this.fileList=[],this.startTime="",this.endTime="",this.$refs.ruleForm.resetFields()},popupCallback:function(e){this.form.setFieldsValue(c()(e,"contractNo","projectId","supplierId","serviceChargePoints","taxRegistrationNumber","contractNo","startTime","endTime","remarks","contractState","contractType","createBy","createTime","confirmBy","confirmTime","confirmContent","isNullify"))}}},h=p,f=(i("783a"),i("cba8")),g=Object(f["a"])(h,a,r,!1,null,"7e55739c",null);t["default"]=g.exports}}]);