(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21d1d77d","chunk-2d0de953","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-418fc05a","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953","chunk-2d0de953"],{"2dab":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-date-picker",{attrs:{disabled:e.disabled||e.readOnly,placeholder:e.placeholder,value:e.momVal,showTime:e.showTime,format:e.dateFormat,getCalendarContainer:e.getCalendarContainer},on:{change:e.handleDateChange}})},n=[],a=i("caaf"),l=i.n(a),s={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(e){return e.parentNode}}},data:function(){var e=this.value;return{decorator:"",momVal:e?l()(e,this.dateFormat):null}},watch:{value:function(e){this.momVal=e?l()(e,this.dateFormat):null}},methods:{moment:l.a,handleDateChange:function(e,t){this.$emit("change",t)}},model:{prop:"value",event:"change"}},o=s,c=i("cba8"),u=Object(c["a"])(o,r,n,!1,null,null,null);t["default"]=u.exports},"5bd8":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("j-modal",{attrs:{title:e.title,width:"65%",visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",okText:e.okTextTit,cancelText:"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[i("a-form-model",{ref:"ruleForm",staticStyle:{"padding-left":"30px"},attrs:{model:e.form,layout:e.vertical}},[i("a-form-model-item",{attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"20px"},attrs:{label:"回款方",prop:"freeReductionId"}},[i("a-input",{attrs:{disabled:""},model:{value:e.form.returnMechanism,callback:function(t){e.$set(e.form,"returnMechanism",t)},expression:"form.returnMechanism"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"20px"},attrs:{label:"回款时间",prop:"freeReductionId"}},[i("a-input",{attrs:{disabled:""},model:{value:e.form.returnTime,callback:function(t){e.$set(e.form,"returnTime",t)},expression:"form.returnTime"}})],1),i("a-form-model-item",{staticStyle:{width:"180px"},attrs:{label:"回款金额",prop:"freeMoney"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:e.form.returnMoney,callback:function(t){e.$set(e.form,"returnMoney",t)},expression:"form.returnMoney"}})],1)],1)]),i("a-form-model-item",{staticStyle:{"margin-top":"-20px"},attrs:{label:""}},[i("a",{on:{click:e.addRow}},[e._v("添加行")])]),e._l(e.serviceReturnsList,(function(t,r){return i("a-form-model-item",{key:r,staticStyle:{"margin-top":"-10px"},attrs:{label:""}},[i("div",{staticStyle:{display:"flex"}},[i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{prop:"billNo",label:"服务费单号"}},[i("a-input-search",{staticStyle:{height:"32px"},attrs:{placeholder:"请选择服务费单号",disabled:"",size:"large"},model:{value:t.billNo,callback:function(i){e.$set(t,"billNo",i)},expression:"item.billNo"}},[i("a-button",{attrs:{slot:"enterButton"},nativeOn:{click:function(i){return i.stopPropagation(),e.clickPlus(t,r)}},slot:"enterButton"},[e._v("\n              +\n            ")])],1)],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"项目"}},[i("a-input",{attrs:{disabled:""},model:{value:t.projectName,callback:function(i){e.$set(t,"projectName",i)},expression:"item.projectName"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"供应商"}},[i("a-input",{attrs:{disabled:""},model:{value:t.supplierName,callback:function(i){e.$set(t,"supplierName",i)},expression:"item.supplierName"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"核算周期"}},[i("a-input",{attrs:{disabled:""},model:{value:t.accounting,callback:function(i){e.$set(t,"accounting",i)},expression:"item.accounting"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"实际应收服务费"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:t.actualReceivablesMoney,callback:function(i){e.$set(t,"actualReceivablesMoney",i)},expression:"item.actualReceivablesMoney"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"已收服务费"}},[i("a-input",{attrs:{disabled:"",suffix:"元"},model:{value:t.receivedMoney,callback:function(i){e.$set(t,"receivedMoney",i)},expression:"item.receivedMoney"}})],1),i("a-form-model-item",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{label:"确认回款金额"}},[i("a-input",{attrs:{ype:"number",suffix:"元"},model:{value:t.commitReturnMoney,callback:function(i){e.$set(t,"commitReturnMoney",i)},expression:"item.commitReturnMoney"}})],1),i("a-form-model-item",{staticStyle:{display:"flex","padding-top":"28px","align-items":"center","margin-left":"10px"},attrs:{label:""}})],1)])})),i("a-form-model-item",{attrs:{label:"附件说明"}},[i("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,multiple:!0,accept:".doc,.docx,.pdf,.jpg",customRequest:e.downloadFilesCustomRequest,"file-list":e.fileList,remove:e.removeFile},on:{change:e.handleChange}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v(" 上传文件\n          ")],1),i("span",{staticStyle:{"margin-left":"20px"}},[e._v("支持扩展名：doc、docx、pdf、jpg 文件大小不超过10M")])],1)],1)],2),i("Serviceaddfree",{ref:"modalForm",on:{confirmAddItem:e.confirmAddItem}})],1)},n=[],a=i("0fea"),l=i("85ee"),s=i.n(l),o=(i("ca00"),i("2dab")),c=i("fcc6");function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var m={name:"ServiceAdd",components:{JDate:o["default"],Serviceaddfree:c["default"]},data:function(){var e;return e={isEdit:!1,ImagesUrl:window._CONFIG["domianURL"]+"/sys/common/static/",clickIndex:0,serviceReturnsList:[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],okTextTit:"确定",ClickItem:{},freeItem:{accounting:""},visibleModel:!1,confirmContent:"",uploadList:[],fileList:[],vertical:"vertical",form:this.$form.createForm(this),title:"操作",width:800,visible:!1,loading:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{},url:{add:"/servicebill/serviceBillMaking/commitReturn",edit:"/servicefree/serviceFreeMaintain/edit"}},u(e,"labelCol",{span:4}),u(e,"wrapperCol",{span:14}),u(e,"other",""),u(e,"form",{freeReductionId:"",freeMoney:"",billNo:"",remarks:"",fileList:[]}),u(e,"rules",{freeReductionId:[{required:!0,message:"请选择减免类型",trigger:"blur"}],freeMoney:[{required:!0,message:"请选输入免金额",trigger:"blur"},{type:"number",message:"仅支持输入小数点后两位",trigger:"blur",transform:function(e){if(e){var t=Number(e);return!!/^\d+\.?\d{0,2}$/.test(t)&&t}}}],billNo:[{required:!0,message:"请选择服务费单号",trigger:"blur"}],projectName:[{required:!0,message:"请选择服务费单号",trigger:"blur"}],supplierName:[{required:!0,message:"请选择服务费单号",trigger:"blur"}]}),e},created:function(){},methods:{addRow:function(){this.serviceReturnsList.push({billNo:"",projectName:"",id:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}),this.clickIndex=this.serviceReturnsList.length-1},confirmAddItem:function(e){var t={billNo:e.billNo,projectName:e.projectName,id:e.id,supplierName:e.supplierName,accountingQuarter:e.accountingQuarter,accountingYear:e.accountingYear,accounting:e.accountingYear+"年Q"+e.accountingQuarter+"季度",actualReceivablesMoney:e.actualReceivablesMoney,receivedMoney:e.receivedMoney,unreceivedMoney:e.unreceivedMoney,commitReturnMoney:0};1===this.serviceReturnsList.length?this.$set(this.serviceReturnsList,0,t):this.$set(this.serviceReturnsList,this.clickIndex,t),this.freeItem=e,this.form.billNo=e.billNo,this.form.billId=e.id,this.freeItem.accounting=this.freeItem.accountingYear+"年Q"+this.freeItem.accountingQuarter+"季度"},clickPlus:function(e,t){this.clickIndex=t,this.$refs.modalForm.add(),this.$refs.modalForm.title="添加服务费账单",this.$refs.modalForm.disableSubmit=!1},add:function(){this.edit({})},edit:function(e){var t=this;if(e.isEdit){if(this.ClickItem=e.serviceReturn,this.form.returnMechanism=e.serviceReturn.returnMechanism,this.form.returnTime=e.serviceReturn.returnTime,this.form.returnMoney=e.serviceReturn.returnMoney,e.serviceBills.length&&e.serviceBills.forEach((function(e,t){e.accounting=e.accountingYear+"年Q"+e.accountingQuarter+"季度",e.commitReturnMoney||(e.commitReturnMoney=0)})),e.serviceBills.length)for(var i=0;i<e.serviceBills.length;i++)this.$set(this.serviceReturnsList,i,e.serviceBills[i]);this.fileList=[];var r=[];this.uploadList=e.serviceReturn.fileList?e.serviceReturn.fileList:[],e.serviceReturn.fileList&&e.serviceReturn.fileList.forEach((function(e,i){r.push({uid:i+1,name:e.enclosureName,status:"done",url:t.ImagesUrl+e.enclosurePath})})),this.fileList=r}else{if(this.ClickItem=e.serviceReturn,this.form.returnMechanism=this.ClickItem.returnMechanism,this.form.returnTime=this.ClickItem.returnTime,this.form.returnMoney=this.ClickItem.returnMoney,e.serviceBills.length&&e.serviceBills.forEach((function(e,t){e.accounting=e.accountingYear+"年Q"+e.accountingQuarter+"季度",e.commitReturnMoney||(e.commitReturnMoney=0)})),e.serviceBills.length)for(i=0;i<e.serviceBills.length;i++)this.$set(this.serviceReturnsList,i,e.serviceBills[i]);this.fileList=[];var n=[];this.uploadList=e.serviceReturn.fileList?e.serviceReturn.fileList:[],e.serviceReturn.fileList&&e.serviceReturn.fileList.forEach((function(e,i){n.push({uid:i+1,name:e.enclosureName,status:"done",url:t.ImagesUrl+e.enclosurePath})})),this.fileList=n}this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}]},handleOk:function(){var e=this,t=!1;if(this.serviceReturnsList.forEach((function(e,i){e.billNo||(t=!0)})),t)this.$message.warning("请填写完整！");else{var i=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;i.confirmLoading=!0;var r="",n="";i.form.id?(r+=i.url.edit,n="put"):(r+=i.url.add,n="post");var l=[];if(l=e.serviceReturnsList.filter((function(e,t){return e.commitReturnMoney})),0===l.length)return e.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],e.close(),e.$emit("ok"),e.confirmLoading=!1,!1;var s={serviceReturn:{returnMechanism:e.form.returnMechanism,returnTime:e.form.returnTime,returnMoney:e.form.returnMoney,id:e.ClickItem.id,fileList:e.uploadList},serviceBills:l};Object(a["h"])(r,s,n).then((function(t){t.success?(e.serviceReturnsList=[{billNo:"",projectName:"",supplierName:"",accounting:"",actualReceivablesMoney:"",receivedMoney:"",commitReturnMoney:0}],i.$message.success("确认成功！"),i.close(),i.$emit("ok")):i.$message.warning(t.message)})).finally((function(){i.confirmLoading=!1}))}))}},handleCancel:function(){this.close()},popupCallback:function(e){this.form.setFieldsValue(s()(e,"billId","freeReductionId","freeMoney","remarks","freeState","createBy","createTime","updateBy","updateTime","isDelete"))},handleChange:function(e){e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))},removeFile:function(e,t){var i=this.fileList,r=this.uploadList;i.forEach((function(t,n){t===e&&(i.splice(n,1),r.splice(n,1))})),this.fileList=i},downloadFilesCustomRequest:function(e){},beforeUpload:function(e,t){var i=this,r=e.size/1024/1024<10;if(!r)return this.$message.error("图片大小超出限制，请修改后重新上传"),!1;if(e.name.length>60)return this.$message.error("文件名称过长"),!1;var n="/sys/common/upload",l=new FormData;l.append("biz","servicefree"),l.append("file",e),Object(a["l"])(n,l).then((function(e){if(e.success){i.uploadList.push({enclosurePath:e.message,enclosureName:e.result});var t=i.fileList.length;i.fileList.push({uid:t+1,name:e.result,status:"done",url:i.ImagesUrl+e.message})}})).finally((function(){}))}}},d=m,f=(i("94a3"),i("cba8")),h=Object(f["a"])(d,r,n,!1,null,"c5c618c0",null);t["default"]=h.exports},"85ee":function(e,t,i){(function(t){var i=1/0,r=9007199254740991,n="[object Arguments]",a="[object Function]",l="[object GeneratorFunction]",s="[object Symbol]",o="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=o||c||Function("return this")();function m(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function d(e,t){var i=-1,r=e?e.length:0,n=Array(r);while(++i<r)n[i]=t(e[i],i,e);return n}function f(e,t){var i=-1,r=t.length,n=e.length;while(++i<r)e[n+i]=t[i];return e}var h=Object.prototype,p=h.hasOwnProperty,v=h.toString,g=u.Symbol,b=h.propertyIsEnumerable,y=g?g.isConcatSpreadable:void 0,M=Math.max;function R(e,t,i,r,n){var a=-1,l=e.length;i||(i=N),n||(n=[]);while(++a<l){var s=e[a];t>0&&i(s)?t>1?R(s,t-1,i,r,n):f(n,s):r||(n[n.length]=s)}return n}function k(e,t){return e=Object(e),x(e,t,(function(t,i){return i in e}))}function x(e,t,i){var r=-1,n=t.length,a={};while(++r<n){var l=t[r],s=e[l];i(s,l)&&(a[l]=s)}return a}function L(e,t){return t=M(void 0===t?e.length-1:t,0),function(){var i=arguments,r=-1,n=M(i.length-t,0),a=Array(n);while(++r<n)a[r]=i[t+r];r=-1;var l=Array(t+1);while(++r<t)l[r]=i[r];return l[t]=a,m(e,this,l)}}function N(e){return $(e)||j(e)||!!(y&&e&&e[y])}function w(e){if("string"==typeof e||O(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function j(e){return C(e)&&p.call(e,"callee")&&(!b.call(e,"callee")||v.call(e)==n)}var $=Array.isArray;function I(e){return null!=e&&F(e.length)&&!S(e)}function C(e){return T(e)&&I(e)}function S(e){var t=B(e)?v.call(e):"";return t==a||t==l}function F(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function B(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function T(e){return!!e&&"object"==typeof e}function O(e){return"symbol"==typeof e||T(e)&&v.call(e)==s}var q=L((function(e,t){return null==e?{}:k(e,d(R(t,1),w))}));e.exports=q}).call(this,i("2409"))},"94a3":function(e,t,i){"use strict";i("fe3e5")},fe3e5:function(e,t,i){}}]);